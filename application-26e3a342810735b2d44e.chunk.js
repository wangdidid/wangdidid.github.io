/*! For license information please see application-26e3a342810735b2d44e.chunk.js.LICENSE.txt */
(window.webpackJsonp = window.webpackJsonp || []).push([
    [1], {
        0: function(e, t, n) {
            "use strict";
            n.d(t, "kb", (function() {
                return k
            })), n.d(t, "R", (function() {
                return C
            })), n.d(t, "db", (function() {
                return N
            })), n.d(t, "Y", (function() {
                return T
            })), n.d(t, "S", (function() {
                return L
            })), n.d(t, "Q", (function() {
                return P
            })), n.d(t, "bb", (function() {
                return A
            })), n.d(t, "j", (function() {
                return D
            })), n.d(t, "v", (function() {
                return M
            })), n.d(t, "Z", (function() {
                return q
            })), n.d(t, "ab", (function() {
                return I
            })), n.d(t, "cb", (function() {
                return R
            })), n.d(t, "M", (function() {
                return B
            })), n.d(t, "G", (function() {
                return F
            })), n.d(t, "I", (function() {
                return G
            })), n.d(t, "hb", (function() {
                return H
            })), n.d(t, "ib", (function() {
                return U
            })), n.d(t, "K", (function() {
                return z
            })), n.d(t, "F", (function() {
                return W
            })), n.d(t, "l", (function() {
                return Y
            })), n.d(t, "yb", (function() {
                return V
            })), n.d(t, "L", (function() {
                return X
            })), n.d(t, "d", (function() {
                return K
            })), n.d(t, "O", (function() {
                return $
            })), n.d(t, "mb", (function() {
                return Z
            })), n.d(t, "g", (function() {
                return J
            })), n.d(t, "gb", (function() {
                return Q
            })), n.d(t, "n", (function() {
                return ee
            })), n.d(t, "p", (function() {
                return te
            })), n.d(t, "o", (function() {
                return ne
            })), n.d(t, "sb", (function() {
                return re
            })), n.d(t, "x", (function() {
                return oe
            })), n.d(t, "w", (function() {
                return ae
            })), n.d(t, "E", (function() {
                return ie
            })), n.d(t, "pb", (function() {
                return se
            })), n.d(t, "rb", (function() {
                return ce
            })), n.d(t, "lb", (function() {
                return le
            })), n.d(t, "xb", (function() {
                return de
            })), n.d(t, "B", (function() {
                return ue
            })), n.d(t, "J", (function() {
                return pe
            })), n.d(t, "D", (function() {
                return fe
            })), n.d(t, "h", (function() {
                return he
            })), n.d(t, "nb", (function() {
                return ge
            })), n.d(t, "N", (function() {
                return me
            })), n.d(t, "T", (function() {
                return ye
            })), n.d(t, "b", (function() {
                return be
            })), n.d(t, "c", (function() {
                return ve
            })), n.d(t, "P", (function() {
                return _e
            })), n.d(t, "k", (function() {
                return we
            })), n.d(t, "qb", (function() {
                return Oe
            })), n.d(t, "U", (function() {
                return Ee
            })), n.d(t, "ub", (function() {
                return je
            })), n.d(t, "tb", (function() {
                return Se
            })), n.d(t, "V", (function() {
                return xe
            })), n.d(t, "eb", (function() {
                return ke
            })), n.d(t, "ob", (function() {
                return Ce
            })), n.d(t, "A", (function() {
                return Ne
            })), n.d(t, "H", (function() {
                return Te
            })), n.d(t, "z", (function() {
                return Le
            })), n.d(t, "y", (function() {
                return Pe
            })), n.d(t, "u", (function() {
                return Ae
            })), n.d(t, "t", (function() {
                return De
            })), n.d(t, "f", (function() {
                return Me
            })), n.d(t, "s", (function() {
                return qe
            })), n.d(t, "a", (function() {
                return Ie
            })), n.d(t, "e", (function() {
                return Re
            })), n.d(t, "vb", (function() {
                return Be
            })), n.d(t, "fb", (function() {
                return Fe
            })), n.d(t, "r", (function() {
                return Ge
            })), n.d(t, "W", (function() {
                return He
            })), n.d(t, "m", (function() {
                return Ue
            })), n.d(t, "q", (function() {
                return ze
            })), n.d(t, "jb", (function() {
                return We
            })), n.d(t, "C", (function() {
                return Ye
            })), n.d(t, "wb", (function() {
                return Ve
            })), n.d(t, "X", (function() {
                return Xe
            })), n.d(t, "i", (function() {
                return Ke
            }));
            var r = n(4),
                o = n(91),
                a = n(93),
                i = n.n(a),
                s = n(12),
                c = n.n(s),
                l = n(32),
                d = n.n(l),
                u = n(146),
                p = n.n(u),
                f = n(63);
            var h = n(3),
                g = n(5),
                m = n(7);

            function y(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function b(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? y(Object(n), !0).forEach((function(t) {
                        v(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : y(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function v(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var _, w, O, E, j, S, x, k = (_ = function(e) {
                    var t, n, r, o = [];
                    for (t = 0; t < e; t += 1) o.push(t);
                    for (t = 0; t < e; t += 1) n = Math.floor(Math.random() * e), r = o[t], o[t] = o[n], o[n] = r;
                    return o
                }((w = ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22"]).length), function() {
                    var e = _[0];
                    return _.shift(), _.push(e), w[e]
                }),
                C = function(e) {
                    var t = document.getElementById(e).querySelector("a.graph-recommend");
                    t.getAttribute("actionAdded") || (t.setAttribute("actionAdded", !0), t.addEventListener("click", (function(n) {
                        if (n.preventDefault(), "1" == t.getAttribute("data-recommended")) {
                            Object(g.unrecommend)(e), t.setAttribute("data-recommended", "0"), ge(t, "recommended");
                            var r = t.querySelector("span.count-value"),
                                o = Number(r.innerHTML);
                            r.innerHTML = 1 == o ? "" : o - 1
                        } else {
                            Object(g.recommend)(e), t.setAttribute("data-recommended", "1"), he(t, "recommended");
                            var a = t.querySelector("span.count-value"),
                                i = Number(a.innerHTML);
                            a.innerHTML = i + 1
                        }
                        return !1
                    })));
                    var n = document.getElementById(e).querySelector('input[type="checkbox"]');
                    n && n.addEventListener("change", (function() {
                        var t = this.checked;
                        Object(g.featureGraph)(e, t, (function() {
                            t ? f.a.info("Graph is featured now") : f.a.info("Graph is unfeatured")
                        }), (function() {
                            f.a.error("Please try again")
                        }))
                    }))
                },
                N = function(e, t) {
                    var n = t.innerHTML,
                        r = "",
                        o = 0,
                        a = !1;
                    if (function e(t) {
                            for (var n = t.childNodes, r = 0; r < n.length; r += 1)
                                if (a) t.removeChild(n[r]), r -= 1;
                                else {
                                    if (3 === n[r].nodeType) {
                                        var i = n[r].nodeValue.length;
                                        (o += i) > 80 && (a = !0, n[r].nodeValue = n[r].nodeValue.substring(0, i - o + 80))
                                    }
                                    e(n[r])
                                }
                        }(t), a) {
                        r = t.innerHTML;
                        var i = e.createElement("a");
                        i.setAttribute("class", "gc-more-less");
                        var s = function e() {
                                return i.removeEventListener("click", e), t.innerHTML = n + " ", i.innerHTML = "less", t.appendChild(i), i.addEventListener("click", c), !1
                            },
                            c = function e() {
                                return i.removeEventListener("click", e), t.innerHTML = r + "... ", i.innerHTML = "more", t.appendChild(i), i.addEventListener("click", s), !1
                            };
                        t.innerHTML = r, t.innerHTML += "... ", t.appendChild(i), i.innerHTML = "more", i.addEventListener("click", s)
                    }
                },
                T = (E = {}, j = {}, window.addEventListener("keydown", (function(e) {
                    switch (e.keyCode) {
                        case 16:
                            if (E.shift = !0, j.shift)
                                for (O in j.shift) Object.prototype.hasOwnProperty.call(j.shift, O) && "function" === typeof j.shift[O].on && j.shift[O].on.call(j.shift[O].ctx);
                            break;
                        case 17:
                            if (E.ctrl = !0, j.ctrl)
                                for (O in j.ctrl) "function" === typeof j.ctrl[O].on && j.ctrl[O].on.call(j.ctrl[O].ctx);
                            break;
                        case 18:
                            if (E.alt = !0, j.alt)
                                for (O in j.alt) "function" === typeof j.alt[O].on && j.alt[O].on.call(j.alt[O].ctx);
                            break;
                        case 224:
                        case 91:
                            if (E.cmd = !0, j.cmd)
                                for (O in j.cmd) "function" === typeof j.cmd[O].on && j.cmd[O].on.call(j.cmd[O].ctx)
                    }
                }), !1), window.addEventListener("keyup", (function(e) {
                    switch (e.keyCode) {
                        case 16:
                            if (E.shift = !1, j.shift)
                                for (O in j.shift) "function" === typeof j.shift[O].off && j.shift[O].off.call(j.shift[O].ctx);
                            break;
                        case 17:
                            if (E.ctrl = !1, j.ctrl)
                                for (O in j.ctrl) "function" === typeof j.ctrl[O].off && j.ctrl[O].off.call(j.ctrl[O].ctx);
                            break;
                        case 18:
                            if (E.alt = !1, j.alt)
                                for (O in j.alt) "function" === typeof j.alt[O].off && j.alt[O].off.call(j.alt[O].ctx);
                            break;
                        case 224:
                        case 91:
                            if (E.cmd = !1, j.cmd)
                                for (O in j.cmd) "function" === typeof j.cmd[O].off && j.cmd[O].off.call(j.cmd[O].ctx)
                    }
                }), !1), {
                    isShiftPressed: function() {
                        return E.shift
                    },
                    isCmdPressed: function() {
                        return E.cmd
                    },
                    isCtrlPressed: function() {
                        return E.ctrl
                    },
                    on: function(e, t, n, r, o) {
                        var a, i = Array.isArray(e) ? e : [e];
                        for (a = 0; a < i.length; a += 1) j[i[a]] = j[i[a]] || {}, j[i[a]][t] = {
                            on: n,
                            off: r,
                            ctx: o
                        }
                    },
                    off: function(e, t) {
                        delete j[e][t]
                    }
                }),
                L = function(e, t) {
                    e.on("keydown", (function(n) {
                        13 == n.keyCode && (window.location = (t.hub_id ? "/hubs/".concat(t.hub_id) : "") + "/search?q=" + e.val())
                    }));
                    var n = function() {
                            e && e.typeahead("val", ""), ge(document.body, "searching")
                        },
                        o = "/site/quick_search.json?l=10&q=%QUERY";
                    t && t.hub_id && (o += "&h=" + t.hub_id);
                    var a = e[0],
                        i = new d.a({
                            datumTokenizer: function(e) {
                                d.a.tokenizers.obj.whitespace(e.node.name)
                            },
                            queryTokenizer: d.a.tokenizers.whitespace,
                            remote: {
                                url: o,
                                wildcard: "%QUERY",
                                prepare: function(e, t) {
                                    return b(b({}, t), {}, {
                                        url: t.url.replace("%QUERY", e) + "&rand=r" + Math.floor(2e4 * Math.random())
                                    })
                                },
                                transport: function(e, t, n) {
                                    r.a.ajax(b(b({}, e), {}, {
                                        beforeSend: function(e, t) {
                                            if (a.className += " loading", U(t.url.substring(12), "q").length < 3) return e.abort(), a.className = a.className.replace(/\bloading\b/, "").trim(), !1
                                        }
                                    })).done((function(e) {
                                        t(e)
                                    })).fail((function(e, t, r) {
                                        a.className = a.className.replace(/\bloading\b/, "").trim(), n(r)
                                    }))
                                },
                                transform: function(e) {
                                    return a.className = a.className.replace(/\bloading\b/, "").trim(), e.push({
                                        obj: "GoToSearch",
                                        query: a.value,
                                        hub_id: t.hub_id
                                    }), e.map((function(e) {
                                        return "Node" === e.obj && (e.typeFirstChar = e.type.name.charAt(0).toUpperCase()), e.graph && e.graph.constructor === Array && e.graph.length > 0 && (e.graph = {
                                            id: e.graph[0].id,
                                            name: e.graph[0].name
                                        }), e.created_at && (e.created_at = new Date(1e3 * e.created_at).toLocaleDateString(void 0, {
                                            year: "numeric",
                                            month: "short",
                                            day: "numeric"
                                        })), t.hub_id && delete e.hub, e
                                    }))
                                }
                            },
                            limit: 40
                        });
                    i.initialize(), e.typeahead(be, b(b({}, ve), {}, {
                        name: "nodes-db",
                        displayKey: "name",
                        source: i.ttAdapter(),
                        templates: {
                            suggestion: h.a["graphs/search_result_remote_multiple_types"]
                        }
                    })).on("typeahead:selected", (function(e, t) {
                        switch (t.obj) {
                            case "Node":
                                return void(window.location = "/nodes/" + t.id);
                            case "Graph":
                                return void(window.location = "/graphs/" + t.id);
                            case "User":
                                return void(window.location = "/users/" + t.id);
                            case "Story":
                                return void(window.location = "/stories/" + t.id);
                            case "Hub":
                                return void(window.location = "/hubs/" + t.id);
                            case "GoToSearch":
                                return void(window.location = (t.hub_id ? "/hubs/".concat(t.hub_id) : "") + "/search?q=" + t.query)
                        }
                    })).on("typeahead:closed", n);
                    var s = function(t) {
                        27 === t.keyCode && me(document.body, "searching") && (e.typeahead("close"), n())
                    };
                    document.addEventListener("keydown", s, !1);
                    var c = document.body.querySelector("a.toggle-search");
                    c && (c.addEventListener("click", (function(e) {
                        e.preventDefault(), he(document.body, "searching"), setTimeout("$('.search .typeahead').focus();", 10)
                    })), document.body.querySelector("a.close-search").addEventListener("click", (function(e) {
                        e.preventDefault(), ge(document.body, "searching"), a.value = ""
                    })));
                    return a.addEventListener("blur", (function() {
                        a.value = "", ge(document.body, "searching")
                    })), {
                        cleanUp: function() {
                            document.removeEventListener("keydown", s, !1)
                        },
                        getBloodhound: function() {
                            return i
                        }
                    }
                },
                P = function(e, t, n, o) {
                    var a, i = e.GraphHistory,
                        s = e.graphStore,
                        c = "/site/search.json?q=%QUERY&g=" + s.get("id");
                    s.get("belongsToHub") && "user" === o && (c = c + "&h=" + s.get("hub").id);
                    var l = new d.a({
                        datumTokenizer: function(e) {
                            d.a.tokenizers.obj.whitespace(e.node.name)
                        },
                        queryTokenizer: d.a.tokenizers.whitespace,
                        remote: {
                            url: c,
                            wildcard: "%QUERY",
                            prepare: function(e, n) {
                                return b(b({}, n), {}, {
                                    url: n.url.replace("%QUERY", e) + "&t=" + (t ? t.value : "") + "&rand=r" + Math.floor(2e4 * Math.random())
                                })
                            },
                            transport: function(e, t, o) {
                                r.a.ajax(b(b({}, e), {}, {
                                    beforeSend: function(e, t) {
                                        var r = s.get("belongsToHub") ? 1 : 3;
                                        if (U(t.url.substring(12), "q").length < r) return n.className = n.className.replace(/\bloading\b/, "").trim(), e.abort(), !1;
                                        n.className += " loading"
                                    }
                                })).done((function(e) {
                                    t(e)
                                })).fail((function(e, t, r) {
                                    n.className = n.className.replace(/\bloading\b/, "").trim(), o(r)
                                }))
                            },
                            transform: function(e) {
                                if (a = e, n.className = n.className.replace(/\bloading\b/, "").trim(), !e.nodes || e.nodes.length < 1) return [];
                                var t = e.nodes,
                                    r = e.nodeTypes;
                                return t.filter((function(e) {
                                    return !i.getNodeById(e.id)
                                })).map((function(e) {
                                    var t, n = "#000";
                                    if (r)
                                        for (t = 0; t < r.length; t += 1)
                                            if (r[t].id === e.type_id) {
                                                n = r[t].color;
                                                break
                                            }
                                    return {
                                        name: e.name,
                                        type: e.type,
                                        typeFirstChar: e.type.charAt(0).toUpperCase(),
                                        graph_name: e.graphs.length > 0 ? e.graphs[0].name : null,
                                        id: e.id,
                                        color: n,
                                        status: e.status,
                                        type_id: e.type_id,
                                        external: !0,
                                        data: e
                                    }
                                }))
                            }
                        },
                        limit: 10
                    });
                    return l.initialize(), {
                        getBloodhound: function() {
                            return l
                        },
                        getLastResponse: function() {
                            return a
                        }
                    }
                },
                A = function(e, t) {
                    var n = t || {},
                        r = n.dispatcher,
                        o = n.GraphHistory,
                        a = !1,
                        i = !1,
                        s = function(e) {
                            27 === e.keyCode && (i || c(!0))
                        };

                    function c(t) {
                        document.removeEventListener("keydown", s, !1), document.body.classList.remove("modal-open"), e.element.removeEventListener("click", c), document.body.removeChild(e.element), o && r.emit("onModalClosed"), e.close_actions && e.close_actions.call(), e.url_param && V("show", null), t && e.onCancel && e.onCancel.call()
                    }
                    var l = function(e) {
                        return e.preventDefault(), c(!0), !1
                    };
                    document.body.classList.add("modal-open"), e.disableCancel || (document.addEventListener("keydown", s, !1), e.element.addEventListener("click", (function() {
                        a ? a = !1 : i || c(!0)
                    }), !1));
                    var d = e.element.querySelector("div");
                    d.addEventListener("click", (function() {
                        return a = !0, !1
                    }), !1), o && r.emit("onModalOpened", e.close_others), e.url_param && V("show", e.url_param);
                    var u, p = d.querySelector(e.close_button_selector || ".gc-dlg-cancel");
                    return p && (p.addEventListener("click", l), u = !0), {
                        close: function(e) {
                            c(e)
                        },
                        setWorking: function(e) {
                            i = e
                        },
                        closeButton: function(e) {
                            e && (u && p.removeEventListener("click", l), e.addEventListener("click", l, !1))
                        },
                        elem: function() {
                            return e.element
                        }
                    }
                },
                D = function(e) {
                    var t = e.graphStore,
                        n = e.GraphHistory,
                        r = n.getNodeTypes(),
                        o = n.getEdgeTypes();
                    t.get("belongsToHub") && (r = r.filter((function(e) {
                        return e.count > 0
                    })), o = o.filter((function(e) {
                        return e.count > 0
                    })));
                    var a = function(e, t) {
                            var n, r, o, a, i = {
                                min: void 0,
                                max: void 0
                            };
                            for (n in e)
                                if (Object.prototype.hasOwnProperty.call(e, n) && e[n])
                                    for (o in r = e[n]) Object.prototype.hasOwnProperty.call(r, o) && r[o] && (a = r[o][t], isNaN(a) && (a = 0), (void 0 === i.min || i.min > a) && (i.min = a), (void 0 === i.max || i.max < a) && (i.max = a));
                            return i.min % 1 !== 0 && (i.min = i.min ? i.min.toFixed(2) : "0.00"), i.max % 1 !== 0 && (i.max = i.max ? i.max.toFixed(2) : "0.00"), {
                                msg: ["From", i.min, "to", i.max].join(" "),
                                type: "range",
                                range: {
                                    min: i.min,
                                    max: i.max
                                }
                            }
                        },
                        i = function(e, t) {
                            var n, r, o = {
                                min: void 0,
                                max: void 0
                            };
                            for (n in e) Object.prototype.hasOwnProperty.call(e, n) && e[n] && (r = e[n][t], isNaN(r) && (r = 0), (void 0 === o.min || o.min > r) && (o.min = r), (void 0 === o.max || o.max < r) && (o.max = r));
                            return o.min % 1 !== 0 && (o.min = o.min ? o.min.toFixed(2) : "0.00"), o.max % 1 !== 0 && (o.max = o.max ? o.max.toFixed(2) : "0.00"), {
                                msg: ["From", o.min, "to", o.max].join(" "),
                                type: "range",
                                range: {
                                    min: o.min,
                                    max: o.max
                                }
                            }
                        },
                        s = function(e) {
                            var t = {
                                min: void 0,
                                max: void 0
                            };
                            return e.forEach((function(e) {
                                var n;
                                n = isNaN(e.weight) ? 1 : parseFloat(e.weight), (void 0 === t.min || t.min > n) && (t.min = n), (void 0 === t.max || t.max < n) && (t.max = n)
                            })), {
                                msg: ["From", t.min, "to", t.max].join(" "),
                                type: "range",
                                range: {
                                    min: t.min,
                                    max: t.max
                                }
                            }
                        },
                        c = function(e, t, n) {
                            switch (n) {
                                case 0:
                                    return {
                                        msg: "No Values",
                                        type: "empty",
                                        missing: e ? e.length : 0
                                    };
                                case 1:
                                    return function(e, t) {
                                        var n = {
                                                min: void 0,
                                                max: void 0
                                            },
                                            r = 0;
                                        return e.forEach((function(e) {
                                            var o = e.properties && e.properties[t];
                                            "string" === typeof o && (o = o.trim()), "" == o || isNaN(o) ? r += 1 : (o = parseFloat(o), (void 0 === n.min || n.min > o) && (n.min = o), (void 0 === n.max || n.max < o) && (n.max = o))
                                        })), {
                                            msg: ["From", n.min, "to", n.max].join(" "),
                                            type: "range",
                                            range: {
                                                min: n.min,
                                                max: n.max
                                            },
                                            missing: r
                                        }
                                    }(e, t);
                                case 2:
                                    return function(e, t) {
                                        var n, r, o = {};
                                        for (n = e.length - 1; n >= 0; n -= 1)
                                            if ((r = e[n].properties) && Object.prototype.hasOwnProperty.call(r, t)) {
                                                if (void 0 === r[t] || null === r[t]) continue;
                                                o[r[t]] ? o[r[t]] += 1 : o[r[t]] = 1
                                            }
                                        var a = Object.keys(o).map((function(e) {
                                                return {
                                                    name: e,
                                                    count: o[e]
                                                }
                                            })).sort((function(e, t) {
                                                return t.count - e.count
                                            })),
                                            i = a.reduce((function(e, t) {
                                                return e + t.count
                                            }), 0);
                                        return e.length > i && a.push({
                                            name: "(empty values)",
                                            empty: !0,
                                            count: e.length - i
                                        }), {
                                            msg: we(a.length, "option", "options", "{quantity} {item}"),
                                            type: "distinct",
                                            values: a
                                        }
                                    }(e, t);
                                default:
                                    return null
                            }
                        },
                        l = function(e, t) {
                            var n = e.filter((function(e) {
                                if (!e.properties) return !1;
                                var n = e.properties[t];
                                return !(!n || "string" === typeof n && "" === n.trim())
                            }));
                            return 0 === n.length ? 0 : n.find((function(e) {
                                return isNaN(e.properties[t])
                            })) ? 2 : 1
                        };
                    return function() {
                        var e = {},
                            t = n.getFilterManager().getCentralities(),
                            d = n.getLinks();
                        e.et_all = {}, e.et_all.name = "All Vector Orders", e.et_all.color = "", e.et_all.count = d.length, e.et_all.isNodeType = !1, e.et_all.weight = s(d), e.et_all.properties = {}, e.nt_all = {}, e.nt_all.name = "All Node Types", e.nt_all.color = "", e.nt_all.count = n.getNodes().length, e.nt_all.isNodeType = !0, e.nt_all.degree = a(t, "degree"), e.nt_all.betweenness = a(t, "betweenness"), e.nt_all.properties = {}, r.forEach((function(r) {
                            if (e[r.id] = {}, e[r.id].name = r.name, e[r.id].color = r.color, e[r.id].count = r.count, e[r.id].isNodeType = !0, e[r.id].properties = {}, e[r.id].degree = i(t[r.id], "degree"), e[r.id].betweenness = i(t[r.id], "betweenness"), r.properties) {
                                var o = n.getNodesByTypeId(r.id);
                                r.properties.forEach((function(t) {
                                    var n = l(o, t.name);
                                    e[r.id].properties[t.name] = c(o, t.name, n)
                                }))
                            }
                        })), r.forEach((function(t) {
                            var o = function(o) {
                                if (e[t.id].properties[o])
                                    if (e.nt_all.properties[o])
                                        if (e.nt_all.properties[o].found_in += 1, e.nt_all.properties[o].type_list.push(t.name), e.nt_all.properties[o].msg = ["In", e.nt_all.properties[o].found_in, "Node Types"].join(" "), "empty" === e.nt_all.properties[o].type) switch (e.nt_all.properties[o].type = e[t.id].properties[o].type, e[t.id].properties[o].type) {
                                            case "range":
                                                e.nt_all.properties[o].range = e[t.id].properties[o].range, e.nt_all.properties[o].missing -= n.getNodesByTypeId(t.id).length - e[t.id].properties[o].missing;
                                                break;
                                            case "distinct":
                                                e.nt_all.properties[o].values = ne(e[t.id].properties[o].values.filter((function(e) {
                                                    return !e.empty
                                                })));
                                                break;
                                            case "empty":
                                                e.nt_all.properties[o].missing -= n.getNodesByTypeId(t.id).length - e[t.id].properties[o].missing
                                        } else {
                                            if ("empty" !== e[t.id].properties[o].type && e.nt_all.properties[o].type !== e[t.id].properties[o].type) return console.log("type mismatch for", t.name, o), "continue";
                                            switch (e[t.id].properties[o].type) {
                                                case "range":
                                                    e.nt_all.properties[o].range.min > e[t.id].properties[o].range.min && (e.nt_all.properties[o].range.min = e[t.id].properties[o].range.min), e.nt_all.properties[o].range.max < e[t.id].properties[o].range.max && (e.nt_all.properties[o].range.max = e[t.id].properties[o].range.max), e.nt_all.properties[o].missing -= n.getNodesByTypeId(t.id).length - e[t.id].properties[o].missing;
                                                    break;
                                                case "distinct":
                                                    e[t.id].properties[o].values.forEach((function(t) {
                                                        if (!t.empty) {
                                                            var n = e.nt_all.properties[o].values.filter((function(e) {
                                                                return t.name === e.name
                                                            }));
                                                            n.length > 0 ? n[0].count += t.count : e.nt_all.properties[o].values.push({
                                                                name: t.name,
                                                                count: t.count
                                                            })
                                                        }
                                                    }));
                                                    break;
                                                case "empty":
                                                    e.nt_all.properties[o].missing -= n.getNodesByTypeId(t.id).length - e[t.id].properties[o].missing
                                            }
                                        } else switch (e.nt_all.properties[o] = {
                                            found_in: 1,
                                            msg: "In 1 Node Type",
                                            type: e[t.id].properties[o].type,
                                            type_list: [t.name],
                                            missing: r.filter((function(e) {
                                                return Array.isArray(e.properties) && e.properties.find((function(e) {
                                                    return e.name === o
                                                }))
                                            })).reduce((function(e, t) {
                                                return e + t.count
                                            }), 0)
                                        }, e[t.id].properties[o].type) {
                                            case "range":
                                                e.nt_all.properties[o].range = e[t.id].properties[o].range, e.nt_all.properties[o].missing -= n.getNodesByTypeId(t.id).length - e[t.id].properties[o].missing;
                                                break;
                                            case "distinct":
                                                e.nt_all.properties[o].values = ne(e[t.id].properties[o].values.filter((function(e) {
                                                    return !e.empty
                                                })));
                                                break;
                                            case "empty":
                                                e.nt_all.properties[o].msg = "No Values", e.nt_all.properties[o].missing -= n.getNodesByTypeId(t.id).length - e[t.id].properties[o].missing
                                        }
                            };
                            for (var a in e[t.id].properties) o(a)
                        }));
                        var u = function(t) {
                            if ("distinct" === e.nt_all.properties[t].type) {
                                e.nt_all.properties[t].values = e.nt_all.properties[t].values.sort((function(e, t) {
                                    return t.count - e.count
                                }));
                                var n = e.nt_all.properties[t].values.reduce((function(e, t) {
                                        return Number(e) + t.count
                                    }), 0),
                                    o = r.filter((function(e) {
                                        return Array.isArray(e.properties) && e.properties.find((function(e) {
                                            return e.name === t
                                        }))
                                    })).reduce((function(e, t) {
                                        return e + t.count
                                    }), 0);
                                o != n && e.nt_all.properties[t].values.push({
                                    name: "(empty values)",
                                    empty: !0,
                                    count: o - n
                                })
                            }
                        };
                        for (var p in e.nt_all.properties) u(p);
                        o.forEach((function(t) {
                            e[t.id] = {}, e[t.id].name = t.name, e[t.id].color = t.color, e[t.id].count = t.count, e[t.id].properties = {};
                            var r = n.getEdgesByTypeId(t.id);
                            e[t.id].weight = s(r), t.properties && t.properties.forEach((function(n) {
                                var o = l(r, n.name);
                                e[t.id].properties[n.name] = c(r, n.name, o)
                            }))
                        })), o.forEach((function(t) {
                            var r = function(r) {
                                if (e[t.id].properties[r])
                                    if (e.et_all.properties[r])
                                        if (e.et_all.properties[r].found_in += 1, e.et_all.properties[r].msg = ["In", e.et_all.properties[r].found_in, "Edge Types"].join(" "), "empty" === e.et_all.properties[r].type) switch (e.et_all.properties[r].type = e[t.id].properties[r].type, e[t.id].properties[r].type) {
                                            case "range":
                                                e.et_all.properties[r].range = e[t.id].properties[r].range, e.et_all.properties[r].missing -= n.getEdgesByTypeId(t.id) - e[t.id].properties[r].missing;
                                                break;
                                            case "distinct":
                                                e.et_all.properties[r].values = ne(e[t.id].properties[r].values.filter((function(e) {
                                                    return !e.empty
                                                })));
                                                break;
                                            case "empty":
                                                e.et_all.properties[r].missing -= n.getEdgesByTypeId(t.id) - e[t.id].properties[r].missing
                                        } else {
                                            if ("empty" !== e[t.id].properties[r].type && e.et_all.properties[r].type !== e[t.id].properties[r].type) return console.log("type mismatch for", t.name, r), "continue";
                                            switch (e[t.id].properties[r].type) {
                                                case "range":
                                                    e.et_all.properties[r].range.min > e[t.id].properties[r].range.min && (e.et_all.properties[r].range.min = e[t.id].properties[r].range.min), e.et_all.properties[r].range.max < e[t.id].properties[r].range.max && (e.et_all.properties[r].range.max = e[t.id].properties[r].range.max), e.et_all.properties[r].missing -= n.getEdgesByTypeId(t.id) - e[t.id].properties[r].missing;
                                                    break;
                                                case "distinct":
                                                    e[t.id].properties[r].values.forEach((function(t) {
                                                        if (!t.empty) {
                                                            var n = e.et_all.properties[r].values.filter((function(e) {
                                                                return t.name === e.name
                                                            }));
                                                            n.length > 0 ? n[0].count += t.count : e.et_all.properties[r].values.push({
                                                                name: t.name,
                                                                count: t.count
                                                            })
                                                        }
                                                    }));
                                                    break;
                                                case "empty":
                                                    e.et_all.properties[r].missing -= n.getEdgesByTypeId(t.id) - e[t.id].properties[r].missing
                                            }
                                        } else switch (e.et_all.properties[r] = {
                                            found_in: 1,
                                            msg: "In 1 Vector Type",
                                            type: e[t.id].properties[r].type,
                                            missing: o.filter((function(e) {
                                                return Array.isArray(e.properties) && e.properties.find((function(e) {
                                                    return e.name === r
                                                }))
                                            })).reduce((function(e, t) {
                                                return e + t.count
                                            }), 0)
                                        }, e[t.id].properties[r].type) {
                                            case "range":
                                                e.et_all.properties[r].range = e[t.id].properties[r].range, e.et_all.properties[r].missing -= n.getEdgesByTypeId(t.id) - e[t.id].properties[r].missing;
                                                break;
                                            case "distinct":
                                                e.et_all.properties[r].values = ne(e[t.id].properties[r].values.filter((function(e) {
                                                    return !e.empty
                                                })));
                                                break;
                                            case "empty":
                                                e.et_all.properties[r].msg = "No Values", e.et_all.properties[r].missing -= n.getEdgesByTypeId(t.id) - e[t.id].properties[r].missing
                                        }
                            };
                            for (var a in e[t.id].properties) r(a)
                        }));
                        var f = function(t) {
                            if ("distinct" === e.et_all.properties[t].type) {
                                e.et_all.properties[t].values = e.et_all.properties[t].values.sort((function(e, t) {
                                    return t.count - e.count
                                }));
                                var n = e.et_all.properties[t].values.reduce((function(e, t) {
                                        return Number(e) + t.count
                                    }), 0),
                                    r = o.filter((function(e) {
                                        return Array.isArray(e.properties) && e.properties.find((function(e) {
                                            return e.name === t
                                        }))
                                    })).reduce((function(e, t) {
                                        return e + t.count
                                    }), 0);
                                e.et_all.properties[t].values.push({
                                    name: "(empty values)",
                                    empty: !0,
                                    count: r - n
                                })
                            }
                        };
                        for (var h in e.et_all.properties) f(h);
                        return e
                    }()
                },
                M = function(e, t) {
                    var n, r, o = [],
                        a = [];
                    Array.isArray(e) && (o = e.map((function(e) {
                        return {
                            id: e.id,
                            name: e.name,
                            type: "nt",
                            color: e.color,
                            is_nt: !0,
                            count: e.count
                        }
                    })), (n = {
                        id: "All",
                        name: "All Node Types",
                        type: "nt",
                        is_nt: !0
                    }).count = e.reduce((function(e, t) {
                        return e + t.count
                    }), 0)), Array.isArray(t) && (a = t.map((function(e) {
                        return {
                            id: e.id,
                            name: e.name,
                            type: "et",
                            color: e.color,
                            is_nt: !1,
                            count: e.count
                        }
                    })), (r = {
                        id: "All",
                        name: "All Vector Orders",
                        type: "et",
                        is_nt: !1
                    }).count = t.reduce((function(e, t) {
                        return e + t.count
                    }), 0));
                    var i = [];
                    return n && i.push(n), r && i.push(r), i.concat(o).concat(a)
                },
                q = function(e) {
                    return e && (e = (e += "").replace(/((https?:\/\/)|(www\.))(\S+)(\w{2,4})(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-/]))?/gi, (function(e) {
                        var t = e;
                        return t.match("^https?://") || (t = "http://" + t), "<a href='" + t + "' target='_blank'>" + e + "</a>"
                    }))), e
                },
                I = function(e) {
                    Object(r.a)(e).linkify()
                },
                R = function(e, t) {
                    var n = t.innerHTML,
                        r = e.createElement("a");

                    function o() {
                        return r.removeEventListener("click", o), t.innerHTML = n + " ", r.innerHTML = "less", t.appendChild(r), r.addEventListener("click", a), !1
                    }

                    function a() {
                        return r.removeEventListener("click", a), t.innerHTML = n.substring(0, 80) + "... ", r.innerHTML = "more", t.appendChild(r), r.addEventListener("click", o), !1
                    }
                    r.setAttribute("class", "gc-more-less"), t.innerHTML = n.substring(0, 80), t.innerHTML += "... ", t.appendChild(r), r.innerHTML = "more", r.addEventListener("click", o)
                },
                B = function() {
                    function e() {
                        return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1)
                    }
                    return function() {
                        return e() + e() + "-" + e() + "-" + e() + "-" + e() + "-" + e() + e() + e()
                    }
                }(),
                F = (window.addEventListener("mousemove", (function(e) {
                    S = e.clientX, x = e.clientY
                }), !1), function() {
                    return {
                        x: S,
                        y: x
                    }
                }),
                G = function() {
                    var e = window,
                        t = document,
                        n = t.documentElement,
                        r = t.getElementsByTagName("body")[0];
                    return {
                        x: e.innerWidth || n.clientWidth || r.clientWidth,
                        y: e.innerHeight || n.clientHeight || r.clientHeight
                    }
                },
                H = function(e) {
                    var t = (Object(r.a)(window).width() - 575) / 2,
                        n = "status=1,width=575,height=300,top=" + (Object(r.a)(window).height() - 300) / 2 + ",left=" + t;
                    window.open(e, "", n)
                },
                U = function(e, t) {
                    t = t.replace(/[[]/, "\\[").replace(/[\]]/, "\\]");
                    var n = new RegExp("[\\?&]" + t + "=([^&#]*)").exec(e);
                    return null === n ? "" : decodeURIComponent(n[1].replace(/\+/g, " "))
                },
                z = function(e) {
                    var t = {},
                        n = e || "";
                    return n.length > 1 && "?" === n[0] && (n = n.substring(1)), n.replace(new RegExp("([^?=&]+)(=([^&]*))?", "g"), (function(e, n, r, o) {
                        t[decodeURIComponent(n).toLowerCase()] = decodeURIComponent(o)
                    })), t
                },
                W = function() {
                    var e;
                    try {
                        var t = z(window.location.search).filters;
                        t && (e = JSON.parse(decodeURIComponent(t)))
                    } catch (n) {
                        console.warn("invalid rules string")
                    }
                    return e
                },
                Y = function(e) {
                    var t = [];
                    Object.keys(e).forEach((function(n) {
                        if (e[n]) {
                            var r = [];
                            r.push(encodeURIComponent(n)), r.push("="), r.push(encodeURIComponent(e[n])), t.push(r.join(""))
                        }
                    }));
                    var n = t.join("&");
                    return n.length > 0 && (n = "?" + n), n
                },
                V = function(e, t) {
                    var n = pe(),
                        r = z(n);
                    r[e] = t, de(window.location.pathname + Y(r))
                },
                X = function(e) {
                    return z(pe())[e]
                },
                K = function() {
                    var e = null,
                        t = function(e) {
                            16 === e.which && n()
                        };

                    function n() {
                        e && (e.close(), e = null), document.removeEventListener("keyup", t)
                    }
                    return {
                        create: function(n, r) {
                            null === e ? (e = function(e, t, n) {
                                var r;
                                t = t || {
                                    x: 0,
                                    y: 0
                                };
                                var o = document.querySelector("div.marquee-overlay");
                                o.style.display = "block";
                                var a = o.querySelector("div.marquee-selection");
                                a || ((a = document.createElement("div")).className += "marquee-selection", a.style.width = 0, a.style.height = 0, o.appendChild(a));
                                var i = t.x,
                                    s = t.y;
                                a.style.left = i - 0 + "px", a.style.top = s - 0 + "px", a.style.width = 0, a.style.height = 0;
                                var c = function(e) {
                                    var t = e.clientX - i,
                                        n = e.clientY - s;
                                    return a.style.width = Math.abs(t) + "px", a.style.height = Math.abs(n) + "px", a.style.left = t < 0 ? e.clientX - 0 + "px" : i - 0 + "px", a.style.top = n < 0 ? e.clientY - 0 + "px" : s - 0 + "px", r && r({
                                        left: a.style.left.substr(0, a.style.left.length - 2),
                                        top: a.style.top.substr(0, a.style.top.length - 2),
                                        width: a.style.width.substr(0, a.style.width.length - 2),
                                        height: a.style.height.substr(0, a.style.height.length - 2)
                                    }), document.onselectstart = function(e) {
                                        return e.stopPropagation(), !1
                                    }, document.ondragstart = function(e) {
                                        return e.stopPropagation(), !1
                                    }, e.preventDefault(), e.stopPropagation(), !1
                                };
                                document.addEventListener("mousemove", c);
                                var l = function() {
                                    var e = {
                                        left: Number(a.style.left.substr(0, a.style.left.length - 2)),
                                        top: Number(a.style.top.substr(0, a.style.top.length - 2)),
                                        width: Number(a.style.width.substr(0, a.style.width.length - 2)),
                                        height: Number(a.style.height.substr(0, a.style.height.length - 2))
                                    };
                                    document.removeEventListener("keyup", d), document.removeEventListener("mousemove", c), o.style.display = "none", n && n(e)
                                };

                                function d(e) {
                                    27 === e.keyCode && l()
                                }
                                return document.addEventListener("keyup", d, !1), {
                                    onSelected: function() {},
                                    onSelectionChange: function(e) {
                                        r = e
                                    },
                                    onSelectionStart: function() {},
                                    close: l
                                }
                            }(0, F(), r), document.addEventListener("keyup", t)) : console.log("already created")
                        },
                        destroy: n,
                        isActive: function() {
                            return null !== e
                        }
                    }
                }(),
                $ = function() {
                    var e = !1;
                    try {
                        new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash") && (e = !0)
                    } catch (t) {
                        navigator.mimeTypes && void 0 !== navigator.mimeTypes["application/x-shockwave-flash"] && navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin && (e = !0)
                    }
                    return e
                },
                Z = function(e) {
                    var t = document.querySelector(e),
                        n = t.querySelectorAll("img"),
                        r = n[0],
                        o = n[1];
                    t.addEventListener("click", (function() {
                        i.a.enabled && (i.a.isFullscreen ? i.a.exit() : i.a.request())
                    }), !1);
                    var a = !1;

                    function s() {
                        a ? (r.classList.add("not-shown"), o.classList.remove("not-shown")) : (r.classList.remove("not-shown"), o.classList.add("not-shown"))
                    }
                    window.addEventListener("resize", (function() {
                        window.outerWidth === screen.width && window.outerHeight === screen.height ? a || (a = !0, s()) : a && (a = !1, s())
                    }))
                },
                J = function(e, t) {
                    var n, r, o = e.length,
                        a = {};
                    for (t = t || "id", n = 0; n < o; n += 1) a[(r = e[n])[t]] = r;
                    return a
                },
                Q = function(e) {
                    var t, n = [];
                    for (t in e) Object.prototype.hasOwnProperty.call(e, t) && void 0 !== e[t] && n.push(e[t]);
                    return n
                },
                ee = function(e, t) {
                    var n;
                    if (e.length !== t.length) return !1;
                    for (n = e.length; n--;)
                        if (e[n] !== t[n]) return !1;
                    return !0
                },
                te = function e(t, n) {
                    if ("object" === typeof t) {
                        var r, o = Array.isArray(n) ? n : [],
                            a = {};
                        for (r in t)
                            if (Object.prototype.hasOwnProperty.call(t, r)) {
                                if (o.indexOf(r) >= 0) continue;
                                null === t[r] ? a[r] = null : Array.isArray(t[r]) ? a[r] = ne(t[r]) : "object" === typeof t[r] ? a[r] = e(t[r]) : a[r] = t[r]
                            }
                        return a
                    }
                },
                ne = function e(t) {
                    if (Array.isArray(t)) {
                        var n, r, o = [];
                        for (r = 0; r < t.length; r += 1) n = t[r], Array.isArray(n) ? o.push(e(n)) : "object" === typeof n ? o.push(te(n)) : o.push(n);
                        return o
                    }
                },
                re = function(e) {
                    if (!Array.isArray(e)) return null;
                    var t = [];
                    return e.forEach((function(e) {
                        t.push(e)
                    })), t
                },
                oe = function() {
                    Object(r.a)(window).on("keydown", (function(e) {
                        16 != e.keyCode || Object(r.a)(".gc-dlg").is(":visible") || Object(r.a)(".shift-alert").show(), 8 != e.keyCode || Object(r.a)(".gc-dlg").is(":visible") || Object(r.a)(".delete-alert").show(), 9 != e.keyCode || Object(r.a)(".gc-dlg").is(":visible") || Object(r.a)(".tab-alert").show(), 32 != e.keyCode || Object(r.a)(".gc-dlg").is(":visible") || Object(r.a)(".spacebar-alert").show()
                    })), Object(r.a)(window).on("keyup", (function() {
                        Object(r.a)(".shift-alert").hide(), Object(r.a)(".delete-alert").hide(), Object(r.a)(".tab-alert").hide(), Object(r.a)(".spacebar-alert").hide()
                    }))
                },
                ae = function(e, t, n) {
                    var r = new Image;
                    r.src = e, r.onload = function() {
                        var e = document.createElement("canvas");
                        document.body.appendChild(e), e.setAttribute("width", t.w), e.setAttribute("height", t.h), e.getContext("2d").drawImage(r, t.x, t.y, t.w, t.h, 0, 0, t.w, t.h);
                        var o = e.toDataURL("image/png;base64", 1);
                        e.parentNode.removeChild(e), n && n.call(null, o)
                    }
                },
                ie = function() {
                    var e = new Date;
                    return [e.getFullYear(), e.getMonth() + 1, e.getDate(), e.getHours(), e.getMinutes(), e.getSeconds()].join("-")
                },
                se = function(e, t) {
                    return void 0 !== h.a ? h.a[e](t) : p.a.compile(e)(t)
                },
                ce = function(e) {
                    document.body.style.cursor = e
                },
                le = function(e) {
                    window.location = e
                },
                de = function(e) {
                    window.history.replaceState({}, null, e)
                },
                ue = function() {
                    return window.location.origin
                },
                pe = function() {
                    return window.location.search
                },
                fe = function(e) {
                    var t = ("; " + document.cookie).split("; " + e + "=");
                    if (2 == t.length) return t.pop().split(";").shift()
                },
                he = function(e, t) {
                    if (e)
                        if (null != e.classList && "function" === typeof e.classList.add) e.classList.add(t);
                        else {
                            var n = (e.getAttribute("class") || "").split(" ");
                            n.indexOf(t) < 0 && n.push(t), e.setAttribute("class", n.join(" ").trim())
                        }
                },
                ge = function(e, t) {
                    if (e)
                        if (e.classList) e.classList.remove(t);
                        else {
                            var n = e.getAttribute("class");
                            if (!n) return;
                            var r = n.split(" "),
                                o = r.indexOf(t);
                            o >= 0 && r.splice(o, 1), e.setAttribute("class", r.join(" ").trim())
                        }
                },
                me = function(e, t) {
                    if (e) {
                        if (e.classList) return e.classList.contains(t);
                        var n = e.getAttribute("class");
                        return !!n && n.split(" ").indexOf(t) >= 0
                    }
                },
                ye = function(e) {
                    var t = e.reduce((function(e, t) {
                            var n = Object.prototype.hasOwnProperty.call(t, "id") ? t.id : t;
                            return b(b({}, e), {}, v({}, n, !0))
                        }), {}),
                        n = new d.a({
                            datumTokenizer: d.a.tokenizers.obj.whitespace("username"),
                            queryTokenizer: d.a.tokenizers.whitespace,
                            remote: {
                                url: "/users/search.json?q=%QUERY",
                                wildcard: "%QUERY",
                                transform: function(e) {
                                    return e.filter((function(e) {
                                        return !t[e.id]
                                    }))
                                }
                            },
                            limit: 20,
                            identify: function(e) {
                                return e.id
                            }
                        });
                    return n.clearPrefetchCache(), n.initialize(), n
                },
                be = {
                    hint: !1,
                    highlight: !0,
                    minLength: 0,
                    classNames: {
                        menu: "tt-dropdown-menu"
                    }
                },
                ve = {
                    limit: 500
                },
                _e = function() {
                    Object(r.a)(".tpd-tooltip").css("display", "none")
                },
                we = function(e, t, n, r) {
                    var o = r || "{quantity} {item}";
                    switch (e) {
                        case 1:
                            return o.replace("{quantity}", 1).replace("{item}", t);
                        default:
                            return o.replace("{quantity}", e).replace("{item}", n)
                    }
                },
                Oe = function(e, t) {
                    if (new RegExp("/users/" + e).test(window.location.pathname)) {
                        var n = ["/", window.location.pathname.replace(new RegExp("/users/" + e), t), pe()].join("");
                        window.history.replaceState({}, null, n)
                    }
                },
                Ee = function(e, t, n) {
                    c.a.create(n.parent, {
                        position: n.position || "top",
                        hideOnClickOutside: !0
                    });
                    var r = n.tipped,
                        o = ue() + "/nodes/" + t.id;
                    r.querySelector("a.email-share").addEventListener("click", (function(e) {
                        e.preventDefault();
                        var n = "mailto:?Subject=" + t.name + " - OntoGraph&body=" + t.name + " " + o;
                        return H(n), !1
                    })), r.querySelector("a.tw-share").addEventListener("click", (function(e) {
                        e.preventDefault();
                        var n = "https://twitter.com/share?url=" + o + "&text=" + t.name + "&via=graphcommons";
                        return H(n), !1
                    })), r.querySelector("a.fb-share").addEventListener("click", (function(e) {
                        return e.preventDefault(), H("https://www.facebook.com/sharer.php?u=" + o), !1
                    }));
                    var a = r.querySelector("a.embed-share");
                    a && a.addEventListener("click", (function(n) {
                        return n.preventDefault(), Object(m.nodeEmbedPanel)(e, t.id), !1
                    }))
                },
                je = function(e) {
                    var t = "https://twitter.com/share?url=" + e.url + "&text=" + e.text + "&via=graphcommons";
                    H(t)
                },
                Se = function(e) {
                    var t = "https://www.facebook.com/sharer.php?u=" + e.url;
                    H(t)
                },
                xe = function(e, t, n) {
                    var r = e.graphStore;
                    c.a.create(n.parent, {
                        position: n.position || "top",
                        hideOnClickOutside: !0
                    });
                    var o, a, i = n.tipped;
                    r.get("isHub") ? (o = ue() + "/hubs/" + r.get("id") + "/data/selection/" + t.join(","), a = "Selection from " + r.get("hub").name) : (o = ue() + "/graphs/" + r.get("id") + "/selection/" + t.join(","), a = "Selection from " + r.get("title")), i.querySelector("a.email-share").addEventListener("click", (function(e) {
                        return e.preventDefault(), H("mailto:?Subject=" + a + " - OntoGraph&body=" + a + " " + o), !1
                    })), i.querySelector("a.tw-share").addEventListener("click", (function(e) {
                        return e.preventDefault(), H("https://twitter.com/share?url=" + o + "&text=" + a + "&via=graphcommons"), !1
                    })), i.querySelector("a.fb-share").addEventListener("click", (function(e) {
                        return e.preventDefault(), H("https://www.facebook.com/sharer.php?u=" + o), !1
                    }))
                },
                ke = function(e, t) {
                    e.scrollTop = t
                },
                Ce = function() {
                    var e = document.getElementById("bgrec");
                    e && e.parentNode.removeChild(e)
                },
                Ne = function(e, t, n) {
                    var o = Object(r.a)(e).clone();
                    o.attr("xmlns:xlink", "http://www.w3.org/1999/xlink"), o.attr({
                        xmlns: "http://www.w3.org/2000/svg",
                        version: "1.1"
                    }), o.attr({
                        xmlns: "http://www.w3.org/2000/svg",
                        version: "1.1"
                    }), o.find(".expand-node").remove(), o.attr("width", t.width), o.attr("height", t.height), o[0].setAttribute("viewBox", Math.floor(t.left) + " " + Math.floor(t.top) + " " + t.width + " " + t.height);
                    var a = o[0].querySelector("rect");
                    return a && a.parentNode.removeChild(a), Array.from(o[0].querySelectorAll("defs path")).forEach((function(e) {
                        var t = e.getAttribute("d");
                        if (null == t || "" === t) {
                            var n = e.getAttribute("id");
                            e.parentNode.removeChild(e);
                            var r = o[0].querySelector('textPath[*|href="#' + n + '"]');
                            if (r) {
                                var a = r.parentNode;
                                a.parentNode.removeChild(a)
                            }
                        }
                    })), n ? o[0].outerHTML : '<html><head><meta charset="utf-8"/></head><body>' + o[0].outerHTML + "</body></html>"
                },
                Te = function(e, t) {
                    var n = Object(r.a)(e);
                    n.attr("xmlns:xlink", "http://www.w3.org/1999/xlink"), n.attr({
                        xmlns: "http://www.w3.org/2000/svg",
                        version: "1.1"
                    }), n.attr({
                        xmlns: "http://www.w3.org/2000/svg",
                        version: "1.1"
                    });
                    var o = Object(r.a)(window).width(),
                        a = Object(r.a)(window).height();
                    if (n.attr("width", o), n.attr("height", a), !t) {
                        n.prepend("<rect id='bgrec' x='0' y='0' width='100%' height='100%' fill='#FFF' />")
                    }
                    var i = n.parent().html(),
                        s = document.getElementById("bgrec");
                    return s && s.parentNode.removeChild(s), i
                },
                Le = function(e, t) {
                    var n = (t || {}).file_name || "capture",
                        r = new Blob([e], {
                            type: "image/svg+xml;charset=utf-8"
                        }),
                        o = URL.createObjectURL(r),
                        a = document.createElement("a");
                    a.href = o, a.download = n + ".svg", document.body.appendChild(a), a.click(), document.body.removeChild(a)
                },
                Pe = function(e, t) {
                    var n = (t || {}).file_name || "capture",
                        r = new Blob([e], {
                            type: "text/csv;charset=utf-8;"
                        }),
                        o = URL.createObjectURL(r),
                        a = document.createElement("a");
                    a.href = o, a.download = n + ".csv", document.body.appendChild(a), a.click(), document.body.removeChild(a)
                },
                Ae = function(e, t, n) {
                    var r = document.createElement("div");
                    document.body.appendChild(r), r.style.position = "absolute", r.style.width = "100%", r.style.height = "100vh", r.style.top = "100%", r.innerHTML = e.split("&nbsp;").join("");
                    var a = G(),
                        i = r.querySelector("svg");
                    i.style.width = a.x + "px", i.style.height = a.y + "px", i.setAttribute("width", a.x), i.setAttribute("height", a.y);
                    var s = i.querySelector("svg g");
                    t.viewBox && i.setAttribute("viewBox", t.viewBox), s.setAttribute("transform", t.transform), o("canvas", i.outerHTML, {
                        useCORS: !0,
                        renderErrorCallback: function() {
                            r.parentNode.removeChild(r), n()
                        },
                        renderCallback: function() {
                            var e = document.getElementById("canvas"),
                                o = document.createElement("canvas");
                            document.body.appendChild(o), o.width = t.width, o.height = t.height, o.getContext("2d").drawImage(e, t.x, t.y, t.width, t.height, 0, 0, t.width, t.height);
                            var a = o.toDataURL("image/png;base64", 1);
                            document.body.removeChild(o), r.parentNode.removeChild(r), n(a)
                        }
                    })
                },
                De = function(e, t) {
                    var n = Object(r.a)(e);
                    n.attr("xmlns:xlink", "http://www.w3.org/1999/xlink"), n.attr({
                        xmlns: "http://www.w3.org/2000/svg",
                        version: "1.1"
                    });
                    var a = Object(r.a)(window).width(),
                        i = Object(r.a)(window).height();
                    n.prepend("<rect id='bgrec' x='0' y='0' width='100%' height='100%' fill='#FFFFFF' />"), n.attr("width", a), n.attr("height", i);
                    var s = n[0].outerHTML;
                    o("canvas", s, {
                        useCORS: !0,
                        renderErrorCallback: function() {
                            t()
                        },
                        renderCallback: function() {
                            var e = document.getElementById("canvas").toDataURL("image/png;base64", 1);
                            t(e)
                        }
                    })
                },
                Me = function(e) {
                    if (void 0 === e || null === e) return !0;
                    switch (typeof e) {
                        case "string":
                            var t = e.trim();
                            return "" === t || isNaN(t);
                        case "number":
                            return !1;
                        default:
                            return !0
                    }
                },
                qe = function(e) {
                    Array.isArray(e) && e.forEach((function(e) {
                        "All" === e.id && ("et" === e.type.substring(0, 2) ? e.id = "et_all" : e.id = "nt_all")
                    }))
                },
                Ie = function(e, t) {
                    var n = {};
                    switch (n.algorithm = e, e) {
                        case "force_atlas2":
                            var r = t.getSettings();
                            n.linLogMode = r.linLogMode, n.outboundAttractionDistribution = r.outboundAttractionDistribution, n.adjustSizes = r.adjustSizes, n.edgeWeightInfluence = r.edgeWeightInfluence, n.scalingRatio = r.scalingRatio, n.strongGravityMode = r.strongGravityMode, n.gravity = r.gravity, n.slowDown = r.slowDown, n.barnesHutOptimize = r.barnesHutOptimize, n.barnesHutTheta = r.barnesHutTheta, n.startingIterations = r.startingIterations, n.iterationsPerRender = r.iterationsPerRender, n.stableThreshold = r.stableThreshold;
                            break;
                        case "force_directed":
                            var o = t.simulator;
                            n.springLength = o.springLength(), n.springCoeff = o.springCoeff(), n.gravity = o.gravity(), n.thetaCoeff = o.theta(), n.dragCoeff = o.dragCoeff(), n.timeStep = o.timeStep(), n.stableThreshold = o.stableThreshold()
                    }
                    return n
                },
                Re = function(e, t, n) {
                    var r = e.querySelectorAll("li");
                    r.length < n ? he(t, "not-shown") : t.addEventListener("click", (function() {
                        var o;
                        if (me(e, "expanded"))
                            for (ge(e, "expanded"), t.innerHTML = "+ More", o = r.length - 1; o >= n; o -= 1) he(r[o], "not-shown");
                        else
                            for (he(e, "expanded"), t.innerHTML = "- Less", o = n; o < r.length; o += 1) ge(r[o], "not-shown")
                    }), !1)
                },
                Be = function(e, t) {
                    var n = t || {},
                        r = function() {
                            Object(g.requestAuthentication)({
                                focus_tab: n.focus_tab,
                                email_only: n.email_only
                            }, (function(t) {
                                Object(m.authenticationPanel)(e, {
                                    data: t.html,
                                    onSignedIn: n.onSignedIn,
                                    onSignedUp: n.onSignUp,
                                    redirect_to: n.redirect_to,
                                    signup_redirect_to: n.signup_redirect_to,
                                    for_story: n.for_story,
                                    email_only: n.email_only
                                })
                            }))
                        };
                    n.bindTo ? (Array.isArray(n.bindTo) ? n.bindTo : [n.bindTo]).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return r(), e.preventDefault(), !1
                        }))
                    })) : r()
                },
                Fe = function(e) {
                    return e > 1e5 ? Math.round(e / 1e3) + "K" : e > 1e3 ? (e / 1e3).toFixed(1) + "K" : e
                },
                Ge = function(e) {
                    var t = document.createElement("textarea");
                    t.value = e, document.body.appendChild(t), t.focus(), t.select();
                    var n = !0;
                    try {
                        n = document.execCommand("copy"), console.log(n)
                    } catch (r) {
                        n = !1
                    }
                    return document.body.removeChild(t), n
                },
                He = function(e) {
                    if (e) {
                        if (e.type) {
                            var t = e.type;
                            if (["text", "password", "email"].find((function(e) {
                                    return t.indexOf(e) >= 0
                                }))) return !0
                        }
                        if ("true" === e.getAttribute("contenteditable")) return !0
                    }
                    return !1
                },
                Ue = function e(t, n, r) {
                    if (0 != n.length) {
                        n[0](t, (function(t) {
                            e(t, n.slice(1), r)
                        }), (function(e) {
                            r(e)
                        }))
                    } else r(null, t)
                },
                ze = function(e, t) {
                    Ge(t) ? f.a.infoWithLink("Link copied to clipboard", t) : Object(m.copyToClipboardDialog)(e, t)
                },
                We = function(e) {
                    if (e.focus(), "undefined" != typeof window.getSelection && "undefined" != typeof document.createRange) {
                        var t = document.createRange();
                        t.selectNodeContents(e), t.collapse(!1);
                        var n = window.getSelection();
                        n.removeAllRanges(), n.addRange(t)
                    } else if ("undefined" != typeof document.body.createTextRange) {
                        var r = document.body.createTextRange();
                        r.moveToElementText(e), r.collapse(!1), r.select()
                    }
                },
                Ye = function() {
                    var e = document.querySelector('meta[name="csrf-token"]');
                    if (e) return e.getAttribute("content")
                },
                Ve = function(e) {
                    var t = {};
                    return e.forEach((function(e) {
                        "string" === typeof e && (t[e] = !0)
                    })), Object.keys(t)
                },
                Xe = function() {
                    return !!window.matchMedia("(max-width: 40em)").matches
                },
                Ke = function(e, t) {
                    var n = [""];
                    return e.split(" ").forEach((function(e) {
                        var r = n[n.length - 1];
                        e.length >= t ? "" === r ? n[n.length - 1] = e : n.push(e) : (r = r + (r.length > 0 ? " " : "") + e, n[n.length - 1] = r, r.length >= t && n.push(""))
                    })), "" === n[n.length - 1].trim() && n.pop(), n
                }
        },
        10: function(e, t, n) {
            "use strict";
            n.d(t, "ib", (function() {
                return l
            })), n.d(t, "Kb", (function() {
                return d
            })), n.d(t, "J", (function() {
                return u
            })), n.d(t, "vb", (function() {
                return p
            })), n.d(t, "wb", (function() {
                return f
            })), n.d(t, "Pb", (function() {
                return h
            })), n.d(t, "Wb", (function() {
                return g
            })), n.d(t, "Eb", (function() {
                return m
            })), n.d(t, "w", (function() {
                return y
            })), n.d(t, "u", (function() {
                return b
            })), n.d(t, "jb", (function() {
                return v
            })), n.d(t, "c", (function() {
                return _
            })), n.d(t, "S", (function() {
                return w
            })), n.d(t, "Mb", (function() {
                return O
            })), n.d(t, "Ib", (function() {
                return E
            })), n.d(t, "Jb", (function() {
                return j
            })), n.d(t, "qb", (function() {
                return S
            })), n.d(t, "X", (function() {
                return x
            })), n.d(t, "o", (function() {
                return k
            })), n.d(t, "I", (function() {
                return C
            })), n.d(t, "Ab", (function() {
                return N
            })), n.d(t, "q", (function() {
                return T
            })), n.d(t, "z", (function() {
                return L
            })), n.d(t, "Tb", (function() {
                return P
            })), n.d(t, "g", (function() {
                return A
            })), n.d(t, "Ub", (function() {
                return D
            })), n.d(t, "nb", (function() {
                return M
            })), n.d(t, "n", (function() {
                return q
            })), n.d(t, "y", (function() {
                return I
            })), n.d(t, "Nb", (function() {
                return R
            })), n.d(t, "e", (function() {
                return B
            })), n.d(t, "Ob", (function() {
                return F
            })), n.d(t, "lb", (function() {
                return G
            })), n.d(t, "M", (function() {
                return H
            })), n.d(t, "f", (function() {
                return U
            })), n.d(t, "db", (function() {
                return z
            })), n.d(t, "cb", (function() {
                return W
            })), n.d(t, "mb", (function() {
                return Y
            })), n.d(t, "Sb", (function() {
                return V
            })), n.d(t, "O", (function() {
                return X
            })), n.d(t, "zb", (function() {
                return K
            })), n.d(t, "yb", (function() {
                return $
            })), n.d(t, "P", (function() {
                return Z
            })), n.d(t, "Q", (function() {
                return J
            })), n.d(t, "Z", (function() {
                return Q
            })), n.d(t, "Y", (function() {
                return ee
            })), n.d(t, "H", (function() {
                return te
            })), n.d(t, "K", (function() {
                return ne
            })), n.d(t, "Bb", (function() {
                return re
            })), n.d(t, "Cb", (function() {
                return oe
            })), n.d(t, "l", (function() {
                return ae
            })), n.d(t, "m", (function() {
                return ie
            })), n.d(t, "V", (function() {
                return se
            })), n.d(t, "s", (function() {
                return ce
            })), n.d(t, "x", (function() {
                return le
            })), n.d(t, "N", (function() {
                return de
            })), n.d(t, "k", (function() {
                return ue
            })), n.d(t, "L", (function() {
                return pe
            })), n.d(t, "D", (function() {
                return fe
            })), n.d(t, "xb", (function() {
                return he
            })), n.d(t, "p", (function() {
                return ge
            })), n.d(t, "v", (function() {
                return me
            })), n.d(t, "Db", (function() {
                return ye
            })), n.d(t, "A", (function() {
                return be
            })), n.d(t, "r", (function() {
                return ve
            })), n.d(t, "T", (function() {
                return _e
            })), n.d(t, "Gb", (function() {
                return we
            })), n.d(t, "bb", (function() {
                return Oe
            })), n.d(t, "pb", (function() {
                return Ee
            })), n.d(t, "a", (function() {
                return je
            })), n.d(t, "b", (function() {
                return Se
            })), n.d(t, "d", (function() {
                return xe
            })), n.d(t, "Vb", (function() {
                return ke
            })), n.d(t, "tb", (function() {
                return Ce
            })), n.d(t, "sb", (function() {
                return Ne
            })), n.d(t, "j", (function() {
                return Te
            })), n.d(t, "h", (function() {
                return Le
            })), n.d(t, "ab", (function() {
                return Pe
            })), n.d(t, "U", (function() {
                return Ae
            })), n.d(t, "t", (function() {
                return De
            })), n.d(t, "Yb", (function() {
                return Me
            })), n.d(t, "Zb", (function() {
                return qe
            })), n.d(t, "gb", (function() {
                return Ie
            })), n.d(t, "G", (function() {
                return Re
            })), n.d(t, "kb", (function() {
                return Be
            })), n.d(t, "C", (function() {
                return Fe
            })), n.d(t, "Hb", (function() {
                return Ge
            })), n.d(t, "B", (function() {
                return He
            })), n.d(t, "Rb", (function() {
                return Ue
            })), n.d(t, "R", (function() {
                return ze
            })), n.d(t, "Qb", (function() {
                return We
            })), n.d(t, "F", (function() {
                return Ye
            })), n.d(t, "Lb", (function() {
                return Ve
            })), n.d(t, "ub", (function() {
                return Xe
            })), n.d(t, "hb", (function() {
                return Ke
            })), n.d(t, "eb", (function() {
                return $e
            })), n.d(t, "ob", (function() {
                return Ze
            })), n.d(t, "i", (function() {
                return Je
            })), n.d(t, "Xb", (function() {
                return Qe
            })), n.d(t, "rb", (function() {
                return et
            })), n.d(t, "Fb", (function() {
                return tt
            })), n.d(t, "E", (function() {
                return nt
            })), n.d(t, "fb", (function() {
                return rt
            })), n.d(t, "W", (function() {
                return ot
            }));
            var r = n(16),
                o = n(4),
                a = n(8);

            function i(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function s(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? i(Object(n), !0).forEach((function(t) {
                        c(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : i(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function c(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var l = function(e, t, n) {
                    var r = "/graphs/" + e + "/recommend";
                    Object(a.a)("PUT", r, undefined, t, n)
                },
                d = function(e, t, n) {
                    var r = "/graphs/" + e + "/unrecommend";
                    Object(a.a)("PUT", r, null, t, n)
                },
                u = function(e, t, n, r) {
                    var o = "/graphs/" + e + ".json";
                    t && (o += t), Object(a.a)("GET", o, null, n, r)
                },
                p = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/add.json";
                    Object(a.a)("PUT", o, t, n, r)
                },
                f = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/layout.json";
                    Object(a.a)("PUT", o, t, n, r)
                },
                h = function(e, t, n, r) {
                    var o = "/graphs/" + e + ".json";
                    Object(a.a)("PATCH", o, t, n, r)
                },
                g = function(e, t, n, r) {
                    var o = "/users/" + e + ".json";
                    Object(a.a)("PUT", o, t, n, r)
                },
                m = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/set_status?r=" + Date.now(),
                        i = {
                            graph: {
                                status: t
                            }
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                y = function(e, t, n) {
                    var r = "/node_types/" + e;
                    Object(a.a)("DELETE", r, null, t, n)
                },
                b = function(e, t, n) {
                    var r = "/edge_types/" + e;
                    Object(a.a)("DELETE", r, null, t, n)
                },
                v = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/remove_collaborator.json",
                        i = {
                            user_id: t
                        };
                    Object(a.a)("DELETE", o, i, n, r)
                },
                _ = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/add_collaborator.json",
                        i = {
                            user_id: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                w = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/recommenders.json";
                    Object(a.a)("GET", o, null, n, r)
                },
                O = function(e, t, n, r, o, i) {
                    var s = "/graphs/" + e + "/update_collaborator_status.json",
                        c = {
                            user_id: t,
                            make_admin: n
                        };
                    Object(a.a)("PUT", s, c, r, o, i)
                },
                E = function(e, t, n, r, o) {
                    var i = {
                        user: {
                            login: e,
                            password: t,
                            remember_me: !1
                        }
                    };
                    n && (i.hub = n), Object(a.a)("POST", "/users/sign_in.json", i, r, o)
                },
                j = function(e, t, n, r, o, i) {
                    var s = {
                        user: {
                            username: e,
                            email: t,
                            password: n,
                            password_confirmation: r
                        }
                    };
                    Object(a.a)("POST", "/users.json", s, o, i)
                },
                S = function(e, t, n) {
                    var r = {
                        invitation: {
                            recipient_email: e
                        }
                    };
                    Object(a.a)("POST", "/invitations.json", r, t, n)
                },
                x = function(e, t, n) {
                    var r = "/users/" + e + "/hubs.json";
                    Object(a.a)("GET", r, null, t, n)
                },
                k = function(e) {
                    var t = "/graphs/new";
                    e && (t += "?hub=" + e + "&show=explore"), window.location = t
                },
                C = function(e, t, n) {
                    var r = "/graphs/new.json" + e;
                    Object(a.a)("GET", r, null, t, n)
                },
                N = function(e, t, n) {
                    Object(a.a)("POST", "/graphs.json", e, t, n)
                },
                T = function(e, t, n, r) {
                    var o = {
                        node_type: e
                    };
                    t && (o.hub = t), Object(a.a)("POST", "/node_types.json", o, n, r)
                },
                L = function(e, t, n) {
                    var r = "/node_types/" + e + ".json";
                    Object(a.a)("DELETE", r, null, t, n)
                },
                P = function(e, t, n, r) {
                    var o = "/node_types/" + e + ".json",
                        i = {
                            node_type: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                A = function(e, t, n, r) {
                    var o = "/node_types/" + e + "/add_property.json",
                        i = {
                            name: t,
                            name_alias: t
                        };
                    Object(a.a)("POST", o, i, n, r)
                },
                D = function(e, t, n, r, o) {
                    var i = "/node_types/" + e + "/update_property.json",
                        s = {
                            name: t,
                            prev_name: n
                        };
                    Object(a.a)("PUT", i, s, r, o)
                },
                M = function(e, t, n, r) {
                    var o = "/node_types/" + e + "/remove_property.json",
                        i = {
                            name: t
                        };
                    Object(a.a)("DELETE", o, i, n, r)
                },
                q = function(e, t, n, r) {
                    var o = {
                        edge_type: e
                    };
                    t && (o.hub = t), Object(a.a)("POST", "/edge_types.json", o, n, r)
                },
                I = function(e, t, n) {
                    var r = "/edge_types/" + e + ".json";
                    Object(a.a)("DELETE", r, null, t, n)
                },
                R = function(e, t, n, r) {
                    var o = "/edge_types/" + e + ".json",
                        i = {
                            edge_type: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                B = function(e, t, n, r) {
                    var o = "/edge_types/" + e + "/add_property.json",
                        i = {
                            name: t,
                            name_alias: t
                        };
                    Object(a.a)("POST", o, i, n, r)
                },
                F = function(e, t, n, r, o) {
                    var i = "/edge_types/" + e + "/update_property.json",
                        s = {
                            name: t,
                            prev_name: n
                        };
                    Object(a.a)("PUT", i, s, r, o)
                },
                G = function(e, t, n, r) {
                    var o = "/edge_types/" + e + "/remove_property.json",
                        i = {
                            name: t
                        };
                    Object(a.a)("DELETE", o, i, n, r)
                },
                H = function(e, t, n) {
                    var r = "/hubs/" + e + "/members.json";
                    Object(a.a)("GET", r, null, t, n)
                },
                U = function(e, t, n, r) {
                    var o = "/hubs/" + t + "/add_member.json",
                        i = {
                            user_id: e
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                z = function(e, t, n, r) {
                    var o = "/hubs/" + t + "/add_member.json",
                        i = {
                            email: e
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                W = function(e, t, n, r) {
                    var o = "/graphs/" + t + "/add_collaborator.json",
                        i = {
                            email: e
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                Y = function(e, t, n, r) {
                    var o = "/hubs/" + t + "/remove_member.json",
                        i = {
                            user_id: e
                        };
                    Object(a.a)("DELETE", o, i, n, r)
                },
                V = function(e, t, n, r, o, i) {
                    var s = "/hubs/" + t + "/update_member_status.json",
                        c = {
                            user_id: e,
                            make_admin: n
                        };
                    Object(a.a)("PUT", s, c, r, o, i)
                },
                X = function(e, t, n, r) {
                    var o = "/hubs/" + e + "/taxonomy.json";
                    Object(a.a)("GET", o, null, t, n, r)
                },
                K = function(e, t, n, r, o) {
                    var i = "/hubs/" + e + "/taxonomy";
                    Object(a.a)("POST", i, t, n, r, o)
                },
                $ = function(e, t, n, r, o) {
                    var i = "/hubs/" + e + "/nodes/" + t;
                    Object(a.a)("POST", i, n, r, o)
                },
                Z = function(e, t, n, r) {
                    var o = "/nodes/" + e + ".json";
                    Object(a.a)("GET", o, null, t, n, r)
                },
                J = function(e, t, n, r) {
                    var o = {
                        ids: e
                    };
                    Object(a.a)("GET", "/nodes.json", o, t, n, r)
                },
                Q = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/contributors.json";
                    Object(a.a)("GET", o, null, t, n, r)
                },
                ee = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/collaborators.json";
                    Object(a.a)("GET", o, null, t, n, r)
                },
                te = function(e, t, n, r) {
                    var o = "/nodes/" + e + "/edges.json";
                    Object(a.a)("GET", o, null, t, n, r)
                },
                ne = function(e, t, n, r) {
                    var o = "/nodes/" + e + "/graphs.json";
                    Object(a.a)("GET", o, null, t, n, r)
                },
                re = function(e, t, n, r, o, i) {
                    var s = {
                        q: e
                    };
                    t && (s.t = t), n && (s.h = n), Object(a.a)("GET", "/site/search.json", s, r, o, i)
                },
                oe = function(e, t, n, r, o, i) {
                    var s = {
                        q: e,
                        in: "Node",
                        h: n
                    };
                    t && (s.nt = t), Object(a.a)("GET", "/search.json", s, r, o, i)
                },
                ae = function(e, t, n, r, o, i) {
                    var s = "/nodes/" + e + "/check_edges_to.json",
                        c = {
                            edge_type_name: t,
                            nodes: n,
                            r: Math.ceil(25e3 * Math.random())
                        };
                    Object(a.a)("GET", s, c, r, o, i)
                },
                ie = function(e, t, n, r, o, i) {
                    var s = "/hubs/" + e + "/edges_for_nodes.json",
                        c = {
                            from_nodes: t,
                            to_nodes: n,
                            r: Math.ceil(25e3 * Math.random())
                        };
                    Object(a.a)("POST", s, c, r, o, i)
                },
                se = function(e, t, n, r, o) {
                    var i = "/hubs/" + e + "/types_graph.json",
                        s = {
                            node_types: t,
                            r: Math.ceil(25e3 * Math.random())
                        };
                    Object(a.a)("POST", i, s, n, r, o)
                },
                ce = function(e, t, n, o, i, s) {
                    var c = "/hubs/" + e + "/nodes/" + t + "/edge",
                        l = Object(r.pick)(n, ["sourceId", "targetId", "edgeTypeId"]);
                    Object(a.a)("POST", c, l, o, i, s)
                },
                le = function(e, t, n, o, i, c) {
                    var l = "/hubs/" + e + "/nodes/" + t + "/edge",
                        d = s(s({}, Object(r.pick)(n, ["sourceId", "targetId", "edgeTypeId"])), {}, {
                            operation: "DELETE"
                        });
                    Object(a.a)("POST", l, d, o, i, c)
                },
                de = function(e, t, n, r) {
                    var o = "/hubs/" + e + "/taxonomy/edges_schema_inferred";
                    Object(a.a)("GET", o, null, t, n, r)
                },
                ue = function(e, t, n, r, o, i) {
                    var s = "/nodes/" + e + "/check_edge_owner.json",
                        c = {
                            type: n,
                            edge: t
                        };
                    Object(a.a)("GET", s, c, r, o, i)
                },
                pe = function(e, t, n) {
                    var r = "/hubs/" + e + ".json";
                    Object(a.a)("GET", r, null, t, n)
                },
                fe = function(e, t, n, r) {
                    var o = "/hubs/" + e + "/explore.json" + t;
                    Object(a.a)("GET", o, null, n, r)
                },
                he = function(e, t, n, r) {
                    var o = "/hubs/" + e + "/add";
                    Object(a.a)("PUT", o, t, n, r)
                },
                ge = function(e, t, n, r) {
                    var o = "/hubs/" + e + "/create_graph.json";
                    Object(a.a)("PUT", o, t, n, r)
                },
                me = function(e, t, n) {
                    var r = "/invitations/" + e + ".json";
                    Object(a.a)("DELETE", r, null, t, n)
                },
                ye = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/set_explore_template.json",
                        i = {
                            remove: !!t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                be = function(e, t, n, r) {
                    var a = {
                        type: "PUT",
                        url: "/graphs/" + e + "/edit_description.json",
                        dataType: "json",
                        contentType: "application/json"
                    };
                    t && (a.data = JSON.stringify(t)), o.a.ajax(a).success(n).fail(r)
                },
                ve = function(e, t, n) {
                    Object(a.a)("POST", "/selections.json", e, t, n)
                },
                _e = function(e, t, n) {
                    var r = "/selections/" + e + ".json";
                    Object(a.a)("GET", r, null, t, n)
                },
                we = function(e, t, n, r) {
                    var o = "/hubs/" + e + "/update_nodes.json",
                        i = {
                            node_status: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                Oe = function(e, t, n, r) {
                    var o = "/hubs/" + e + ".json";
                    Object(a.a)("PUT", o, t, n, r)
                },
                Ee = function(e, t, n, r) {
                    var o, i = "/graphs/" + e + "/request_membership.json";
                    t && (o = {
                        msg: t
                    }), Object(a.a)("PUT", i, o, n, r)
                },
                je = function(e, t, n) {
                    var r = "/graphs/" + e + "/membership_request_status.json";
                    Object(a.a)("GET", r, undefined, t, n)
                },
                Se = function(e, t, n, r, o) {
                    var i = "/graphs/" + e + "/update_membership_request.json",
                        s = {
                            user_id: t,
                            accepted: n
                        };
                    Object(a.a)("PUT", i, s, r, o)
                },
                xe = function(e, t, n, r, o) {
                    var i = {
                        token: e
                    };
                    t && (i.plan = t), n && (i.proration_date = n), Object(a.a)("PUT", "/users/me/add_credit_card.json", i, r, o)
                },
                ke = function(e, t, n, r) {
                    var o = {
                        plan: e
                    };
                    t && (o.proration_date = t), Object(a.a)("PUT", "/users/me/update_plan.json", o, n, r)
                },
                Ce = function(e, t) {
                    Object(a.a)("GET", "/users/me/credit_cards.json", null, e, t)
                },
                Ne = function(e, t) {
                    var n = "/users/me/payments.json?r" + Math.floor(4e4 * Math.random());
                    Object(a.a)("GET", n, null, e, t)
                },
                Te = function(e, t, n) {
                    var r = {
                        plan: e
                    };
                    Object(a.a)("GET", "/users/me/calculate_proration.json", r, t, n)
                },
                Le = function(e, t, n) {
                    var r = {
                        coupon: e
                    };
                    Object(a.a)("POST", "/users/me/apply_coupon", r, t, n)
                },
                Pe = function(e) {
                    var t = "/graphs/" + e + "/ignore_blocked_node_warning.json";
                    Object(a.a)("POST", t)
                },
                Ae = function(e, t, n) {
                    var r = "/graphs/" + e + "/get_private_share";
                    Object(a.a)("GET", r, null, t, n)
                },
                De = function(e, t, n) {
                    var r = "/graphs/" + e + "/create_private_share";
                    Object(a.a)("PUT", r, null, t, n)
                },
                Me = function(e, t) {
                    Object(a.a)("POST", "/users/me/create_tour.json", null, e, t)
                },
                qe = function(e, t, n) {
                    var r = {
                        user: {
                            tour: {}
                        }
                    };
                    r.user.tour = e, Object(a.a)("PUT", "/users/me/update_tour.json", r, t, n)
                },
                Ie = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/comments.json",
                        i = {
                            comment: t
                        };
                    Object(a.a)("POST", o, i, n, r)
                },
                Re = function(e, t, n) {
                    var r = "/graphs/" + e + "/get_comments";
                    Object(a.a)("GET", r, null, t, n)
                },
                Be = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/remove_comment/" + t;
                    Object(a.a)("DELETE", o, null, n, r)
                },
                Fe = function(e, t, n) {
                    var r = "/nodes/" + e + "/get_embed_details.json?r=" + 1e3 * Math.random();
                    Object(a.a)("GET", r, null, t, n)
                },
                Ge = function(e, t, n, r) {
                    var o = "/node_types/" + e + "/embed_defaults.json",
                        i = {
                            embed_defaults: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                He = function(e, t, n, r) {
                    var o = "/nodes/" + e + "/embed.json" + (t || "");
                    Object(a.a)("GET", o, null, n, r)
                },
                Ue = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/update_filters.json",
                        i = {
                            filters: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                ze = function(e, t, n, r, o) {
                    var i = "/hubs/" + e + "/paths?from=" + t + "&to=" + n;
                    Object(a.a)("GET", i, null, r, o)
                },
                We = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/update_analysis_rules.json",
                        i = {
                            rules: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                Ye = function(e, t, n) {
                    var r = "/graphs/" + e + "/clusters.json",
                        o = {
                            r: Math.ceil(25e3 * Math.random())
                        };
                    Object(a.a)("GET", r, o, t, n)
                },
                Ve = function(e, t, n, r, o) {
                    var i = "/graphs/" + e + "/clusters/" + t,
                        s = n;
                    Object(a.a)("PUT", i, s, r, o)
                },
                Xe = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/analyse_clustering";
                    Object(a.a)("POST", o, t, n, r)
                },
                Ke = function(e, t, n, r) {
                    var o = "/hubs/" + e + "/advanced_explore";
                    Object(a.a)("POST", o, t, n, r)
                },
                $e = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/node_selected",
                        i = {
                            nodes: t
                        };
                    Object(a.a)("POST", o, i, n, r)
                },
                Ze = function(e, t, n) {
                    Object(a.a)("GET", "/users/sign_up.json", Object(r.pickBy)(e, (function(e) {
                        return !!e
                    })), t, n)
                },
                Je = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/calculate_circular_layout.json";
                    Object(a.a)("POST", o, t, n, r)
                },
                Qe = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/upload_screenshot.json",
                        i = {
                            data: t
                        };
                    Object(a.a)("POST", o, i, n, r)
                },
                et = function(e, t, n) {
                    var r = "/site/activity_feed.json?page=" + e + "&r=" + Math.floor(1e3 * Math.random());
                    Object(a.a)("GET", r, null, t, n)
                },
                tt = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/tags.json",
                        i = {
                            tag: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                nt = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/set_featured.json",
                        i = {
                            featured: t
                        };
                    Object(a.a)("PUT", o, i, n, r)
                },
                rt = function(e, t, n, r) {
                    var o = "/graphs/" + e + "/open_right_bar.json",
                        i = {
                            bar: t
                        };
                    Object(a.a)("POST", o, i, n, r)
                },
                ot = function(e, t, n) {
                    var r = "/users/" + e + "/graphs.json";
                    Object(a.a)("GET", r, null, t, n)
                }
        },
        100: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return o
            }));
            var r = n(0),
                o = function(e, t) {
                    var n = t || {},
                        o = e.querySelector("button.capture-square"),
                        a = e.querySelector("button.capture-rectangle"),
                        i = e.querySelector("button.capture-full"),
                        s = e.querySelector("button.reset"),
                        c = e.querySelector("button.zoom-in"),
                        l = e.querySelector("button.zoom-out");
                    n.hide_resize && (Object(r.h)(o, "not-shown"), Object(r.h)(a, "not-shown"), Object(r.h)(i, "not-shown")), o.addEventListener("click", (function() {
                        n.onCaptureSquareClicked()
                    })), a.addEventListener("click", (function() {
                        n.onCaptureRectangleClicked()
                    })), i.addEventListener("click", (function() {
                        n.onCaptureFullClicked()
                    })), s.addEventListener("click", (function() {
                        n.onCaptureResetClicked()
                    })), c.addEventListener("click", (function() {
                        n.onCaptureZoomInClicked()
                    })), l.addEventListener("click", (function() {
                        n.onCaptureZoomOutClicked()
                    }));
                    return {
                        resize: function(t, n, r, o) {
                            e.style.left = t + "px", e.style.top = n + "px", e.style.width = r + "px", e.style.height = o + "px"
                        },
                        hide: function() {
                            Object(r.h)(e, "not-shown")
                        },
                        show: function() {
                            Object(r.nb)(e, "not-shown")
                        }
                    }
                }
        },
        1003: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "History", (function() {
                return p
            }));
            var r = n(4),
                o = n(146),
                a = n.n(o),
                i = n(12),
                s = n.n(i),
                c = n(1),
                l = n.n(c),
                d = n(38),
                u = n.n(d);
            window.$ = window.jQuery = r.a, window.Handlebars = a.a, window.Tipped = s.a, window.React = l.a, window.ReactDOM = u.a;
            var p = function() {
                    function e() {
                        this.data = [], this.top = 0
                    }
                    e.prototype.push = function(e) {
                        this.data[this.top++] = e
                    }, e.prototype.pop = function() {
                        return this.top > 0 ? this.data[--this.top] : null
                    }, e.prototype.isEmpty = function() {
                        return 0 === this.top
                    }, e.prototype.empty = function() {
                        this.top = 0
                    }, e.prototype.peek = function() {
                        return this.data[this.top]
                    };
                    var t = new e,
                        n = new e;

                    function r() {
                        return t.peek()
                    }
                    return {
                        add: function(e) {
                            t.push(e), n.empty()
                        },
                        back: function() {
                            var e = t.pop();
                            return e && n.push(e), r()
                        },
                        fwd: function() {
                            var e = n.pop();
                            return e && t.push(e), e
                        },
                        hasBack: function() {
                            return !t.isEmpty()
                        },
                        hasFwd: function() {
                            return !n.isEmpty()
                        },
                        clear: function() {
                            t.empty(), n.empty()
                        },
                        current: r,
                        rewind: function() {
                            for (var e = t.pop(); e;) n.push(e), e = t.pop()
                        },
                        dumpBack: function() {
                            return t.data
                        }
                    }
                },
                f = n(5),
                h = n(67),
                g = n(78),
                m = n(2),
                y = n(22),
                b = {
                    testing: !1,
                    elementID: "klaro",
                    storageMethod: "cookie",
                    storageName: "klaro",
                    htmlTexts: !1,
                    cookieDomain: ".graphcommons.com",
                    cookieName: "klaro",
                    cookieExpiresAfterDays: 365,
                    default: !1,
                    mustConsent: !1,
                    acceptAll: !1,
                    hideDeclineAll: !0,
                    hideLearnMore: !1,
                    translations: {
                        zz: {
                            privacyPolicyUrl: "/privacy_policy"
                        },
                        en: {
                            privacyPolicyUrl: "/privacy_policy",
                            consentNotice: {
                                description: "We use necessary cookies to make our site work. We would also like to set optional mechanisms that help us improve your experience."
                            },
                            consentModal: {
                                title: "Information that we collect",
                                description: "Measuring our audience gives us useful statistics to improve the website and the products we build for you. By allowing these third party services, you accept their cookies and the use of tracking technologies necessary for their functioning. For more information on how these tracking mechanisms work please see our privacy policy."
                            },
                            purposes: {
                                analytics: {
                                    title: "Google Analytics",
                                    description: "Collection of information about how visitors use our website"
                                }
                            }
                        }
                    },
                    services: [{
                        name: "googleAnalytics",
                        default: !0,
                        translations: {
                            zz: {
                                title: "Google Analytics",
                                description: "Collection of information about how visitors use our website"
                            },
                            en: {
                                title: "Google Analytics",
                                description: "Collection of information about how visitors use our website"
                            }
                        },
                        purposes: ["analytics"],
                        cookies: [/^ga/i],
                        required: !1,
                        optOut: !1,
                        onlyOnce: !1
                    }]
                },
                v = n(429),
                _ = n(559),
                w = n.n(_),
                O = n(0),
                E = n(32),
                j = n.n(E);

            function S(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function x(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? S(Object(n), !0).forEach((function(t) {
                        k(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : S(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function k(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var C = {};

            function N(e, t, n) {
                if (n) {
                    var r, o = localStorage.getItem(e);
                    if (!o) return;
                    try {
                        r = JSON.parse(o)
                    } catch (a) {
                        return void console.error(a)
                    }
                    return r[t]
                }
                return C[t]
            }

            function T(e, t, n, r) {
                if (r) {
                    var o, a = localStorage.getItem(e);
                    try {
                        o = JSON.parse(a)
                    } catch (i) {
                        o = {}
                    }
                    localStorage.setItem(e, JSON.stringify(x(x({}, o), {}, k({}, t, n))))
                } else C[t] = n
            }
            var L, P, A = n(560),
                D = n.n(A);

            function M(e, t) {
                P.emit("message", JSON.stringify({
                    type: e,
                    channel: L,
                    message: t
                }))
            }

            function q(e) {
                var t = e.user,
                    n = e.verificationToken,
                    r = e.channel,
                    o = e.onMessage,
                    a = t.id,
                    i = "".concat(a, "/").concat(n, "/").concat(r);
                P = D()("/", {
                    path: "/graph-live-update",
                    query: {
                        token: i
                    }
                }), L = r, M("join", t), P.on("message", o)
            }

            function I(e) {
                M("broadcast", e)
            }
            var R = function(e) {
                    var t = e.users,
                        n = e.authenticatedUser,
                        r = t.filter((function(e) {
                            return e.id !== n.id
                        }));
                    return l.a.createElement("div", {
                        className: "connected-users"
                    }, l.a.createElement("span", null, "Live users"), r.map((function(e) {
                        var t = e.id,
                            n = e.username,
                            r = e.image;
                        return l.a.createElement("div", {
                            key: t,
                            className: "connected-users__user-item"
                        }, l.a.createElement("img", {
                            src: r,
                            alt: n
                        }), l.a.createElement("i", null, n))
                    })))
                },
                B = n(28);

            function F(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function G(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? F(Object(n), !0).forEach((function(t) {
                        H(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : F(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function H(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function U(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function z(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function W(e, t) {
                return (W = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function Y(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = X(e);
                    if (t) {
                        var o = X(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return V(this, n)
                }
            }

            function V(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function X(e) {
                return (X = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            var K = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && W(e, t)
                }(a, e);
                var t, n, r, o = Y(a);

                function a() {
                    var e;
                    U(this, a);
                    for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];
                    return (e = o.call.apply(o, [this].concat(n)))._coordinator = void 0, e
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        this._coordinator = new y.Coordinator(this.context, G(G({}, this.props.options), {}, {
                            onAnalysisCustomizeToggle: this.props.onAnalysisCustomizeToggle,
                            allowSpreadsheet: this.props.showSpreadsheet
                        }))
                    }
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        this._coordinator = null
                    }
                }, {
                    key: "getInstance",
                    value: function() {
                        return this._coordinator
                    }
                }, {
                    key: "render",
                    value: function() {
                        return null
                    }
                }]) && z(t.prototype, n), r && z(t, r), a
            }(l.a.Component);
            K.contextType = B.a;
            var Z = n(9);

            function J(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function Q(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function ee(e, t) {
                return (ee = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function te(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = re(e);
                    if (t) {
                        var o = re(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return ne(this, n)
                }
            }

            function ne(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function re(e) {
                return (re = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            var oe = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && ee(e, t)
                }(a, e);
                var t, n, r, o = te(a);

                function a() {
                    var e;
                    J(this, a);
                    for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];
                    return (e = o.call.apply(o, [this].concat(n)))._canvasInstance = void 0, e
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        var e = this.props,
                            t = e.openWithSnapshot,
                            n = e.onCreateNewNode;
                        this._canvasInstance = new y.Canvas("#map", this.context, Z.a.VIEW, t, n)
                    }
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        this._canvasInstance = null
                    }
                }, {
                    key: "refresh",
                    value: function() {
                        var e = this.props,
                            t = e.openWithSnapshot,
                            n = e.onCreateNewNode;
                        this.context.dispatcher.unbindTarget(this._canvasInstance), this._canvasInstance = new y.Canvas("#map", this.context, Z.a.VIEW, t, n)
                    }
                }, {
                    key: "getInstance",
                    value: function() {
                        return this._canvasInstance
                    }
                }, {
                    key: "render",
                    value: function() {
                        return null
                    }
                }]) && Q(t.prototype, n), r && Q(t, r), a
            }(l.a.Component);

            function ae(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function ie(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function se(e, t) {
                return (se = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function ce(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = de(e);
                    if (t) {
                        var o = de(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return le(this, n)
                }
            }

            function le(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function de(e) {
                return (de = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            oe.contextType = B.a;
            var ue = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && se(e, t)
                }(a, e);
                var t, n, r, o = ce(a);

                function a() {
                    var e;
                    ae(this, a);
                    for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];
                    return (e = o.call.apply(o, [this].concat(n)))._canvasInstance = void 0, e
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        var e = this.props.openWithSnapshot;
                        this._canvasInstance = new y.WebGLCanvas("#map", this.context, Z.a.VIEW, e)
                    }
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        this._canvasInstance = null
                    }
                }, {
                    key: "getInstance",
                    value: function() {
                        return this._canvasInstance
                    }
                }, {
                    key: "render",
                    value: function() {
                        return null
                    }
                }]) && ie(t.prototype, n), r && ie(t, r), a
            }(l.a.Component);

            function pe(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function fe(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function he(e, t) {
                return (he = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function ge(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = ye(e);
                    if (t) {
                        var o = ye(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return me(this, n)
                }
            }

            function me(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function ye(e) {
                return (ye = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            ue.contextType = B.a;
            var be = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && he(e, t)
                }(a, e);
                var t, n, r, o = ge(a);

                function a() {
                    var e;
                    pe(this, a);
                    for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];
                    return (e = o.call.apply(o, [this].concat(n)))._browserViewInstance = void 0, e
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        var e = this.props,
                            t = e.canvas,
                            n = e.viewCoordinator,
                            r = e.onSaveGraph,
                            o = e.onShowCartographyPanel,
                            a = e.onHideCartographyPanel;
                        this._browserViewInstance = new y.BrowserView($, this.context, t, null, n, this.props.options, r, o, a)
                    }
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        this._browserViewInstance = null
                    }
                }, {
                    key: "getInstance",
                    value: function() {
                        return this._browserViewInstance
                    }
                }, {
                    key: "render",
                    value: function() {
                        return null
                    }
                }]) && fe(t.prototype, n), r && fe(t, r), a
            }(l.a.Component);

            function ve(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function _e(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function we(e, t) {
                return (we = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function Oe(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = je(e);
                    if (t) {
                        var o = je(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return Ee(this, n)
                }
            }

            function Ee(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function je(e) {
                return (je = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            be.contextType = B.a;
            var Se = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && we(e, t)
                }(i, e);
                var t, n, o, a = Oe(i);

                function i() {
                    var e;
                    ve(this, i);
                    for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];
                    return (e = a.call.apply(a, [this].concat(n)))._hubBrowserViewInstance = void 0, e
                }
                return t = i, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        var e = this.props,
                            t = e.canvas,
                            n = e.spreadsheet;
                        this._hubBrowserViewInstance = new y.HubBrowserView(r.a, this.context, t, n, this.props.options)
                    }
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        this._hubBrowserViewInstance = null
                    }
                }, {
                    key: "getInstance",
                    value: function() {
                        return this._hubBrowserViewInstance
                    }
                }, {
                    key: "render",
                    value: function() {
                        return null
                    }
                }]) && _e(t.prototype, n), o && _e(t, o), i
            }(l.a.Component);

            function xe(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function ke(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function Ce(e, t) {
                return (Ce = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function Ne(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = Le(e);
                    if (t) {
                        var o = Le(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return Te(this, n)
                }
            }

            function Te(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function Le(e) {
                return (Le = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            Se.contextType = B.a;
            var Pe = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && Ce(e, t)
                }(a, e);
                var t, n, r, o = Ne(a);

                function a() {
                    var e;
                    xe(this, a);
                    for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];
                    return (e = o.call.apply(o, [this].concat(n)))._searchBoxInstance = void 0, e
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {}
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        this._searchBoxInstance = null
                    }
                }, {
                    key: "getInstance",
                    value: function() {
                        return this._searchBoxInstance
                    }
                }, {
                    key: "render",
                    value: function() {
                        return null
                    }
                }]) && ke(t.prototype, n), r && ke(t, r), a
            }(l.a.Component);

            function Ae(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function De(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function Me(e, t) {
                return (Me = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function qe(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = Re(e);
                    if (t) {
                        var o = Re(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return Ie(this, n)
                }
            }

            function Ie(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function Re(e) {
                return (Re = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            Pe.contextType = B.a;
            var Be = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && Me(e, t)
                }(a, e);
                var t, n, r, o = qe(a);

                function a() {
                    var e;
                    Ae(this, a);
                    for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];
                    return (e = o.call.apply(o, [this].concat(n)))._spreadsheetInstance = void 0, e
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        this._spreadsheetInstance = new y.Spreadsheet("#ssLinks", this.context, Z.a.VIEW)
                    }
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        this._spreadsheetInstance = null
                    }
                }, {
                    key: "getInstance",
                    value: function() {
                        return this._spreadsheetInstance
                    }
                }, {
                    key: "render",
                    value: function() {
                        return null
                    }
                }]) && De(t.prototype, n), r && De(t, r), a
            }(l.a.Component);

            function Fe(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function Ge(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function He(e, t) {
                return (He = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function Ue(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = We(e);
                    if (t) {
                        var o = We(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return ze(this, n)
                }
            }

            function ze(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function We(e) {
                return (We = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            Be.contextType = B.a;
            var Ye = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && He(e, t)
                }(a, e);
                var t, n, r, o = Ue(a);

                function a() {
                    var e;
                    Fe(this, a);
                    for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];
                    return (e = o.call.apply(o, [this].concat(n)))._spreadsheetSwitcherInstance = void 0, e
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        this._spreadsheetSwitcherInstance = new y.SpreadsheetSwitcher(".spreadsheet-switcher", this.context, Z.a.VIEW), this._spreadsheetSwitcherInstance.selectFirstType()
                    }
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        this._spreadsheetSwitcherInstance = null
                    }
                }, {
                    key: "getInstance",
                    value: function() {
                        return this._spreadsheetSwitcherInstance
                    }
                }, {
                    key: "render",
                    value: function() {
                        return null
                    }
                }]) && Ge(t.prototype, n), r && Ge(t, r), a
            }(l.a.Component);
            Ye.contextType = B.a;
            var Ve = function(e) {
                    var t = e.title,
                        n = e.children,
                        r = e.onCloseButtonClick,
                        o = e.onSubmitButtonClick,
                        a = e.disableSubmit,
                        i = e.disableClose,
                        s = e.showFooter,
                        d = e.width,
                        u = e.maxWidth,
                        p = e.bodyStyle,
                        f = e.labels,
                        h = void 0 === f ? {} : f;
                    return Object(c.useEffect)((function() {
                        var e = function(e) {
                            switch (e.key) {
                                case "Escape":
                                    r()
                            }
                        };
                        return document.addEventListener("keyup", e),
                            function() {
                                document.removeEventListener("keyup", e)
                            }
                    }), []), l.a.createElement("div", {
                        className: "full-cover",
                        onClick: function(e) {
                            e.target.matches(".full-cover") && r()
                        }
                    }, l.a.createElement("div", {
                        className: "gc-dlg dlg-md",
                        style: {
                            width: d,
                            maxWidth: u || d
                        }
                    }, t && l.a.createElement("div", {
                        className: "gc-dlg-header"
                    }, l.a.createElement("span", {
                        className: "gc-dlg-title"
                    }, t)), l.a.createElement("div", {
                        className: "gc-dlg-body",
                        style: p
                    }, n), s && l.a.createElement("div", {
                        className: "gc-dlg-action"
                    }, l.a.createElement("button", {
                        onClick: r,
                        className: "gc-btn gc-dlg-cancel text-muted",
                        disabled: i
                    }, h.close || "Close"), o && l.a.createElement("button", {
                        onClick: o,
                        className: "gc-btn gc-btn-confirm",
                        disabled: a
                    }, h.submit || "Submit"))))
                },
                Xe = n(51),
                Ke = n.n(Xe),
                $e = function(e) {
                    var t = e.children,
                        n = e.setCurrentTab,
                        r = e.currentTab,
                        o = l.a.Children.toArray(t).filter(Boolean);
                    return l.a.createElement("div", {
                        className: "tabset"
                    }, l.a.createElement("ul", {
                        className: "tabset__headers"
                    }, o.map((function(e, t) {
                        return l.a.createElement("li", {
                            key: t,
                            onClick: function() {
                                n(t)
                            },
                            className: Ke()({
                                tabset__header: !0,
                                "tabset__header--current": t === r
                            })
                        }, e.props.title)
                    }))), l.a.createElement("div", {
                        className: "tabset__tab-content"
                    }, o[r]))
                },
                Ze = function(e) {
                    return l.a.createElement("div", {
                        className: "tabset__item"
                    }, e.children)
                },
                Je = n(561),
                Qe = function(e) {
                    var t = e.children,
                        n = e.onEnter;
                    return Object(c.useEffect)((function() {
                        var e = function(e) {
                            switch (e.key) {
                                case "Enter":
                                    n()
                            }
                        };
                        return document.addEventListener("keypress", e),
                            function() {
                                document.removeEventListener("keypress", e)
                            }
                    })), l.a.createElement(l.a.Fragment, null, t)
                };

            function et(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return tt(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return tt(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function tt(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var nt = function(e) {
                    var t = e.onCancel,
                        n = e.hub,
                        r = e.onSave,
                        o = e.isNewGraph,
                        a = Object(c.useContext)(B.a),
                        i = a.graphStore,
                        s = a.GraphHistory.getNodeTypes(),
                        d = N(i.get("id"), "lastNodeType", !o),
                        u = Object(c.useRef)(null),
                        p = Object(c.useRef)(null),
                        f = et(Object(c.useState)(d), 2),
                        h = f[0],
                        g = f[1],
                        m = et(Object(c.useState)(""), 2),
                        y = m[0],
                        b = m[1],
                        v = et(Object(c.useState)(!1), 2),
                        _ = v[0],
                        w = v[1],
                        O = !h || !y || _;
                    Object(c.useEffect)((function() {
                        h && T(i.get("id"), "lastNodeType", h, !o)
                    }), [h]), Object(c.useEffect)((function() {
                        d ? p.current.focus() : u.current.focus()
                    }), []);
                    var E = function() {
                        O || (r({
                            nodeType: h,
                            nodeName: y
                        }), w(!0))
                    };
                    return l.a.createElement(Qe, {
                        onEnter: E
                    }, l.a.createElement("div", {
                        className: "gc-dlg-node-kv"
                    }, l.a.createElement("label", {
                        className: "gc-dlg-node-key"
                    }, "Order", l.a.createElement("span", {
                        className: "right text-muted"
                    }, "Person, Organization, Place, Event...")), l.a.createElement(Je.a, {
                        ref: u,
                        placeholder: "Enter the Vertex Order",
                        formatCreateLabel: function(e) {
                            return 'Create new "'.concat(e, '" Vertex Order')
                        },
                        options: s.map((function(e) {
                            return {
                                label: e.name,
                                value: e.name
                            }
                        })),
                        onChange: function(e) {
                            g(e.value), p.current && p.current.focus()
                        },
                        classNamePrefix: "react-select",
                        value: h && {
                            value: h,
                            label: h
                        }
                    })), l.a.createElement("div", {
                        className: "gc-dlg-node-kv"
                    }, l.a.createElement("label", {
                        className: "gc-dlg-node-key"
                    }, "Object", l.a.createElement("span", {
                        className: "right text-muted"
                    }, "Add a proper name")), l.a.createElement("input", {
                        ref: p,
                        type: "text",
                        placeholder: "Enter the Vertex Object",
                        value: y,
                        onChange: function(e) {
                            return b(e.target.value)
                        }
                    })), n && l.a.createElement("div", {
                        className: "gc-dlg-typewarning left"
                    }, l.a.createElement("label", {
                        className: "gc-dlg-warning"
                    }, "New data will be added to the hub")), l.a.createElement("div", {
                        className: "tabset__footer"
                    }, l.a.createElement("button", {
                        onClick: t,
                        className: "gc-btn gc-dlg-cancel",
                        disabled: _
                    }, "Cancel"), l.a.createElement("button", {
                        onClick: E,
                        className: "gc-btn gc-btn-confirm",
                        disabled: O
                    }, "ADD")))
                },
                rt = n(3),
                ot = ["onSelectItem", "name", "scope", "authenticatedUser", "hub", "focusOnMount"];

            function at(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function it(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? at(Object(n), !0).forEach((function(t) {
                        st(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : at(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function st(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function ct(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return lt(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return lt(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function lt(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }

            function dt(e, t) {
                if (null == e) return {};
                var n, r, o = function(e, t) {
                    if (null == e) return {};
                    var n, r, o = {},
                        a = Object.keys(e);
                    for (r = 0; r < a.length; r++) n = a[r], t.indexOf(n) >= 0 || (o[n] = e[n]);
                    return o
                }(e, t);
                if (Object.getOwnPropertySymbols) {
                    var a = Object.getOwnPropertySymbols(e);
                    for (r = 0; r < a.length; r++) n = a[r], t.indexOf(n) >= 0 || Object.prototype.propertyIsEnumerable.call(e, n) && (o[n] = e[n])
                }
                return o
            }
            var ut = function(e) {
                var t = e.onSelectItem,
                    n = e.name,
                    r = e.scope,
                    o = void 0 === r ? "public" : r,
                    a = e.authenticatedUser,
                    i = e.hub,
                    s = e.focusOnMount,
                    d = dt(e, ot),
                    u = Object(c.useContext)(B.a),
                    p = u.graphStore,
                    f = u.GraphHistory,
                    h = ct(Object(c.useState)(!1), 2),
                    g = h[0],
                    m = h[1],
                    y = Object(c.useRef)(null);
                return Object(c.useEffect)((function() {
                    var e = function(e) {
                            var t, n = e.graphHistory,
                                r = e.graphStore,
                                o = e.nodeType,
                                a = void 0 === o ? "" : o,
                                i = e.inputRef,
                                s = e.hub,
                                c = e.authenticatedUser,
                                l = e.scope,
                                d = void 0 === l ? "public" : l,
                                u = e.baseSearchUrl,
                                p = void 0 === u ? "/site/search.json" : u,
                                f = e.urlParams,
                                h = void 0 === f ? {} : f,
                                g = {};
                            switch (d) {
                                case "hub":
                                    g.h = s.id;
                                    break;
                                case "user":
                                    g.u = c.id
                            }
                            var m = new j.a({
                                datumTokenizer: function(e) {
                                    j.a.tokenizers.obj.whitespace(e.node.name)
                                },
                                queryTokenizer: j.a.tokenizers.whitespace,
                                remote: {
                                    url: p,
                                    prepare: function(e, t) {
                                        var n = new URLSearchParams(x(x({
                                            g: r.get("id"),
                                            q: e,
                                            t: a,
                                            rand: "" + Math.floor(2e4 * Math.random())
                                        }, g), h)).toString();
                                        return x(x({}, t), {}, {
                                            url: "".concat(p, "?").concat(n, ";")
                                        })
                                    },
                                    transport: function(e, t, n) {
                                        $.ajax(x(x({}, e), {}, {
                                            beforeSend: function(e, t) {
                                                var n = r.get("belongsToHub") ? 1 : 3;
                                                if (Object(O.ib)(t.url.substring(12), "q").length < n) return i.classList.remove("loading"), e.abort(), !1;
                                                i.classList.add("loading")
                                            }
                                        })).done((function(e) {
                                            t(e)
                                        })).fail((function(e, t, r) {
                                            i.classList.remove("loading"), n(r)
                                        }))
                                    },
                                    transform: function(e) {
                                        if (t = e, i.classList.remove("loading"), !e.nodes || e.nodes.length < 1) return [];
                                        var r = e.nodes,
                                            o = e.nodeTypes;
                                        return r.filter((function(e) {
                                            return !n.getNodeById(e.id)
                                        })).map((function(e) {
                                            var t = "#000";
                                            if (o) {
                                                var n = o.find((function(t) {
                                                    return t.id === e.type_id
                                                }));
                                                n && (t = n.color)
                                            }
                                            return {
                                                name: e.name,
                                                type: e.type,
                                                typeFirstChar: e.type.charAt(0).toUpperCase(),
                                                graph_name: e.graphs.length > 0 ? e.graphs[0].name : null,
                                                id: e.id,
                                                color: t,
                                                status: e.status,
                                                type_id: e.type_id,
                                                external: !0,
                                                data: e
                                            }
                                        }))
                                    }
                                },
                                limit: 10
                            });
                            return m.initialize(), {
                                getBloodhound: function() {
                                    return m
                                },
                                getLastResponse: function() {
                                    return t
                                }
                            }
                        }({
                            graphHistory: f,
                            graphStore: p,
                            authenticatedUser: a,
                            inputRef: y.current,
                            scope: o,
                            hub: i
                        }),
                        r = $(y.current);
                    return r.typeahead(O.b, [it(it({}, O.c), {}, {
                            name: n,
                            displayKey: "name",
                            source: e.getBloodhound().ttAdapter(),
                            templates: {
                                suggestion: rt.a["graphs/search_result_remote"]
                            }
                        })]).on("typeahead:selected", (function(n, r) {
                            var o = e.getLastResponse();
                            if (y.current.blur(), o) {
                                var a = o.nodeTypes.find((function(e) {
                                    return e.id === r.type_id
                                }));
                                t({
                                    nodeType: a,
                                    data: r.data
                                })
                            }
                        })),
                        function() {
                            r.typeahead("destroy")
                        }
                }), [o]), Object(c.useEffect)((function() {
                    g || (m(!0), s && y.current.focus())
                }), []), l.a.createElement("input", Object.assign({
                    ref: y,
                    type: "text"
                }, d))
            };

            function pt(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return ft(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return ft(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function ft(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var ht = function(e) {
                var t = e.onCancel,
                    n = e.onSave,
                    r = e.authenticatedUser,
                    o = e.hub,
                    a = pt(Object(c.useState)(null), 2),
                    i = a[0],
                    s = a[1],
                    d = pt(Object(c.useState)(o ? "hub" : "public"), 2),
                    u = d[0],
                    p = d[1],
                    f = function() {
                        n(i)
                    };
                return l.a.createElement(Qe, {
                    onEnter: f
                }, !o && l.a.createElement("div", {
                    className: "explanation"
                }, l.a.createElement("label", null, l.a.createElement("input", {
                    type: "radio",
                    checked: "public" === u,
                    onChange: function() {
                        return p("public")
                    },
                    name: "scope",
                    value: "public"
                }), " Search public Vertexs"), l.a.createElement("label", null, l.a.createElement("input", {
                    type: "radio",
                    checked: "user" === u,
                    onChange: function() {
                        return p("user")
                    },
                    name: "scope",
                    value: "user"
                }), " Search my Vertexs")), l.a.createElement("div", {
                    className: "gc-dlg-node-kv"
                }, l.a.createElement("label", {
                    className: "gc-dlg-node-key"
                }, "Object"), l.a.createElement(ut, {
                    focusOnMount: !0,
                    scope: u,
                    authenticatedUser: r,
                    hub: o,
                    onSelectItem: s,
                    placeholder: "Enter a Vertex Object",
                    tabIndex: 2
                })), l.a.createElement("div", {
                    className: "tabset__footer"
                }, l.a.createElement("button", {
                    onClick: t,
                    className: "gc-btn gc-dlg-cancel",
                    tabIndex: 4
                }, "Cancel"), l.a.createElement("button", {
                    onClick: f,
                    className: "gc-btn gc-btn-confirm",
                    tabIndex: 4,
                    disabled: !i
                }, "ADD")))
            };

            function gt(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return mt(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return mt(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function mt(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var yt = function(e) {
                    var t = e.onCancel,
                        n = e.onSave,
                        r = e.hub,
                        o = e.authenticatedUser,
                        a = e.isLoading,
                        i = gt(Object(c.useState)(null), 2),
                        s = i[0],
                        d = i[1],
                        u = gt(Object(c.useState)(null), 2),
                        p = u[0],
                        f = u[1],
                        h = function() {
                            return n(s, p)
                        },
                        g = r ? "hub" : "user";
                    return l.a.createElement(Qe, {
                        onEnter: h
                    }, l.a.createElement("div", {
                        className: "explanation"
                    }, "Find connections between two entities"), l.a.createElement("div", {
                        className: "flex-row"
                    }, l.a.createElement("div", {
                        className: "split-left"
                    }, l.a.createElement("label", null, "From"), l.a.createElement(ut, {
                        focusOnMount: !0,
                        name: "source",
                        hub: r,
                        authenticatedUser: o,
                        scope: g,
                        onSelectItem: function(e) {
                            var t = e.data;
                            return d(t)
                        },
                        placeholder: "Enter a node name",
                        tabIndex: 1
                    })), l.a.createElement("div", {
                        className: "split-right"
                    }, l.a.createElement("label", null, "To"), l.a.createElement(ut, {
                        hub: r,
                        scope: g,
                        name: "target",
                        authenticatedUser: o,
                        onSelectItem: function(e) {
                            var t = e.data;
                            return f(t)
                        },
                        placeholder: "Enter a node name",
                        tabIndex: 2
                    }))), l.a.createElement("br", null), l.a.createElement("div", {
                        className: "tabset__footer"
                    }, a && l.a.createElement("span", null, "Adding paths..."), l.a.createElement("button", {
                        onClick: t,
                        className: "gc-btn gc-dlg-cancel",
                        tabIndex: 4,
                        disabled: a
                    }, "Cancel"), l.a.createElement("button", {
                        onClick: h,
                        className: "gc-btn gc-btn-confirm",
                        tabIndex: 3,
                        disabled: a || !s || !p
                    }, "ADD")))
                },
                bt = n(7);

            function vt(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return _t(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _t(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function _t(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var wt = function(e) {
                var t = e.onCancel,
                    n = e.onSave,
                    r = e.initPosition,
                    o = Object(c.useContext)(B.a),
                    a = Object(c.useRef)(null),
                    i = vt(Object(c.useState)(!0), 2),
                    s = i[0],
                    d = i[1],
                    u = vt(Object(c.useState)("Loading, please wait."), 2),
                    p = u[0],
                    h = u[1],
                    g = function(e, t) {
                        d(!0), h(null), Object(f.getHubTaxonomy)(o.graphStore.get("hub").id, (function(e) {
                            d(!1), h(null), t({
                                nodeTypes: e.node_types,
                                edgeTypes: e.edge_types
                            })
                        }), (function() {
                            d(!1), h("Hub summary cannot be loaded")
                        }))
                    };
                return Object(c.useEffect)((function() {
                    Object(bt.advancedExplorePanel)(o, {
                        fnLoadData: g,
                        onSubmit: n,
                        onCancel: t,
                        showWaitMessage: function(e) {
                            d(!0), h(e)
                        },
                        hideWaitMessage: function() {
                            d(!1), h(null)
                        }
                    }, a.current, r)
                }), []), l.a.createElement("div", null, (s || p) && p, l.a.createElement("div", {
                    style: {
                        height: 400,
                        overflow: "auto",
                        marginBottom: 50,
                        display: s ? "none" : "block"
                    },
                    ref: a
                }))
            };

            function Ot(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return Et(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Et(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function Et(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var jt = function(e) {
                    var t = e.onCloseButtonClick,
                        n = e.onNodeCreate,
                        r = e.onAddExistingNode,
                        o = e.onAddPath,
                        a = e.initPosition,
                        i = e.isLoading,
                        s = e.hub,
                        d = e.authenticatedUser,
                        u = e.isNewGraph,
                        p = Object(c.useContext)(B.a).graphStore,
                        f = Ot(Object(c.useState)(0), 2),
                        h = f[0],
                        g = f[1],
                        m = s ? "80%" : "60%",
                        y = s ? "lastOpenTabForHubs" : "lastOpenTab";
                    return Object(c.useEffect)((function() {
                        var e = new URLSearchParams(window.location.search),
                            t = +N(p.get("id"), y, !0);
                        t ? g(t) : "explore" === e.get("show") && g(1)
                    }), []), l.a.createElement(Ve, {
                        width: m,
                        onCloseButtonClick: t,
                        showFooter: !1
                    }, l.a.createElement($e, {
                        currentTab: h,
                        setCurrentTab: function(e) {
                            g(e), T(p.get("id"), y, e, !0)
                        }
                    }, (!s && d.can_edit || s && d.is_admin) && l.a.createElement(Ze, {
                        title: "New Vertex",
                        name: "newNode"
                    }, l.a.createElement(nt, {
                        onSave: n,
                        onCancel: t,
                        hub: s,
                        isNewGraph: u
                    })), l.a.createElement(Ze, {
                        title: "Find Vertex",
                        name: "existingNode"
                    }, l.a.createElement(ht, {
                        authenticatedUser: d,
                        hub: s,
                        onSave: r,
                        onCancel: t
                    })), s && l.a.createElement(Ze, {
                        title: "Find Path",
                        name: "addPath"
                    }, l.a.createElement(yt, {
                        authenticatedUser: d,
                        hub: s,
                        onCancel: t,
                        onSave: o,
                        isLoading: i
                    })), s && l.a.createElement(Ze, {
                        title: "Explore",
                        name: "explore"
                    }, l.a.createElement(wt, {
                        authenticatedUser: d,
                        hub: s,
                        initPosition: a,
                        onCancel: t,
                        onSave: t
                    }))))
                },
                St = n(102),
                xt = n(562),
                kt = n.n(xt),
                Ct = n(571);

            function Nt(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || Lt(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function Tt(e) {
                return function(e) {
                    if (Array.isArray(e)) return Pt(e)
                }(e) || function(e) {
                    if ("undefined" !== typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                }(e) || Lt(e) || function() {
                    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function Lt(e, t) {
                if (e) {
                    if ("string" === typeof e) return Pt(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? Pt(e, t) : void 0
                }
            }

            function Pt(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var At = [{
                label: "Material UI",
                key: "material",
                colors: ["#f44336", "#e91e63", "#9c27b0", "#673ab7", "#3f51b5", "#2196f3", "#03a9f4", "#00bcd4", "#009688", "#4caf50", "#8bc34a", "#cddc39", "#ffeb3b", "#ffc107", "#ff9800", "#ff5722", "#795548", "#9e9e9e", "#607d8b"]
            }, {
                label: "Flat UI",
                key: "flat",
                colors: ["#1abc9c", "#2ecc71", "#3498db", "#9b59b6", "#34495e", "#16a085", "#27ae60", "#2980b9", "#8e44ad", "#2c3e50", "#f1c40f", "#e67e22", "#e74c3c", "#ecf0f1", "#95a5a6", "#f39c12", "#d35400", "#c0392b", "#bdc3c7", "#7f8c8d"]
            }, {
                label: "GraphCommons",
                key: "gc",
                colors: ["#da1e28", "#d12771", "#8a3ffc", "#0f62fe", "#0072c3", "#007d79", "#198038", "#697077", "#6f6f6f", "#736f6f", "#ff832b", "#f1c21b"]
            }, {
                label: "Custom",
                key: "custom",
                colors: []
            }];
            var Dt = function(e) {
                var t, n = e.color,
                    r = e.onSetColor,
                    o = Nt(Object(c.useState)(!1), 2),
                    a = o[0],
                    i = o[1],
                    s = Nt(Object(c.useState)("material"), 2),
                    d = s[0],
                    u = s[1],
                    p = N("gc-global", "lastPresetCategory", !0),
                    f = function() {
                        ! function(e) {
                            var t, n = N("gc-global", "color-history", !0);
                            T("gc-global", "color-history", [e].concat(Tt((t = n || []).filter((function(t) {
                                return t !== e
                            })).slice(0, 10))), !0)
                        }(n), i(!1), h()
                    },
                    h = function() {
                        var e = document.querySelector(".color-picker-overlay");
                        e && document.body.removeChild(e)
                    };
                return t = "custom" === d ? N("gc-global", "color-history", !0) || [] : At.find((function(e) {
                    return e.key === d
                })).colors, Object(c.useEffect)((function() {
                    p && u(p)
                }), [p]), l.a.createElement("div", {
                    className: "custom-color-picker-wrapper"
                }, l.a.createElement("span", {
                    onClick: function() {
                        if (a) i(!1), h();
                        else {
                            var e = document.createElement("div");
                            e.classList.add("color-picker-overlay"), e.addEventListener("click", f), document.body.appendChild(e), i(!0)
                        }
                    },
                    style: {
                        background: n,
                        width: 23,
                        height: 23,
                        display: "inline-block",
                        borderRadius: "50%",
                        cursor: "pointer"
                    }
                }), a && l.a.createElement("div", {
                    className: "custom-color-picker"
                }, l.a.createElement(Ct.a, {
                    color: n,
                    onChange: function(e) {
                        return r(e.hex)
                    }
                }), l.a.createElement("div", {
                    className: "color-picker-presets"
                }, l.a.createElement("div", {
                    className: "color-picker-preset-selection"
                }, l.a.createElement("div", {
                    style: {
                        float: "right"
                    }
                }, l.a.createElement("input", {
                    value: n,
                    onChange: function(e) {
                        return r(e.target.value)
                    },
                    className: "color-picker-hex-input"
                })), l.a.createElement("select", {
                    value: d,
                    onChange: function(e) {
                        var t = e.target.value;
                        u(t), T("gc-global", "lastPresetCategory", t, !0)
                    }
                }, At.map((function(e) {
                    var t = e.key,
                        n = e.label;
                    return l.a.createElement("option", {
                        value: t,
                        key: t
                    }, n)
                })))), l.a.createElement("div", {
                    className: "color-picker-preset-colors"
                }, t.map((function(e, t) {
                    return l.a.createElement("span", {
                        key: t,
                        onClick: function() {
                            return r(e)
                        },
                        style: {
                            background: e,
                            width: 20,
                            height: 20,
                            display: "inline-block",
                            borderRadius: 2,
                            cursor: "pointer"
                        }
                    })
                }))))))
            };

            function Mt(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function qt(e, t) {
                return (qt = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function It(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = Bt(e);
                    if (t) {
                        var o = Bt(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return Rt(this, n)
                }
            }

            function Rt(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function Bt(e) {
                return (Bt = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            var Ft = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && qt(e, t)
                }(a, e);
                var t, n, r, o = It(a);

                function a(e) {
                    var t;
                    return function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, a), (t = o.call(this, e)).el = void 0, t.el = document.createElement("div"), t.el.style.display = "contents", t
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        document.body.appendChild(this.el)
                    }
                }, {
                    key: "componentWillUnmount",
                    value: function() {
                        document.body.removeChild(this.el)
                    }
                }, {
                    key: "render",
                    value: function() {
                        var e = this.props,
                            t = e.width,
                            n = void 0 === t ? 200 : t,
                            r = e.top,
                            o = void 0 === r ? 0 : r,
                            a = e.left,
                            i = void 0 === a ? 0 : a,
                            s = e.anchorOffsetX,
                            d = void 0 === s ? 0 : s,
                            p = e.anchorOffsetY,
                            f = void 0 === p ? 0 : p,
                            h = e.children,
                            g = e.onClose,
                            m = e.showOverlay,
                            y = void 0 === m || m,
                            b = "tooltip-input";
                        return u.a.createPortal(l.a.createElement(c.Fragment, null, y && l.a.createElement("div", {
                            className: "".concat(b, "__overlay"),
                            onClick: g
                        }), l.a.createElement("div", {
                            className: b,
                            "data-offset-x": d,
                            "data-offset-y": f,
                            style: {
                                width: n,
                                top: o,
                                left: i
                            }
                        }, h)), this.el)
                    }
                }]) && Mt(t.prototype, n), r && Mt(t, r), a
            }(c.Component);

            function Gt(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || Yt(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function Ht(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Ut(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Ht(Object(n), !0).forEach((function(t) {
                        zt(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Ht(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function zt(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function Wt(e) {
                return function(e) {
                    if (Array.isArray(e)) return Vt(e)
                }(e) || function(e) {
                    if ("undefined" !== typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                }(e) || Yt(e) || function() {
                    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function Yt(e, t) {
                if (e) {
                    if ("string" === typeof e) return Vt(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? Vt(e, t) : void 0
                }
            }

            function Vt(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var Xt = [],
                Kt = [],
                $t = [{
                    value: "metric_degree",
                    label: "Connections"
                }, {
                    value: "metric_weighted_degree",
                    label: "Connections Weighted"
                }, {
                    value: "metric_in_degree",
                    label: "Connections Incoming"
                }, {
                    value: "metric_out_degree",
                    label: "Connections Outgoing"
                }, {
                    value: "metric_weighted_in_degree",
                    label: "Connections Incoming Weighted"
                }, {
                    value: "metric_weighted_out_degree",
                    label: "Connections Outgoing Weighted"
                }, {
                    value: "metric_betweenness",
                    label: "Betweenness Centrality"
                }];

            function Zt(e, t, n, r) {
                var o = {};
                return n.forEach((function(t) {
                    var n = new Set;
                    e.getEdgesByTypeId(t.id).forEach((function(t) {
                        var r = e.getNodeById(t.from).type_id,
                            o = e.getNodeById(t.to).type_id;
                        n.add(r), n.add(o)
                    })), o[t.id] = n
                })), n.reduce((function(e, n) {
                    var a, i = 0;
                    return o[n.id].forEach((function(e) {
                        var n = r[e];
                        n > i && (i = n, a = t.find((function(t) {
                            return t.id === e
                        })))
                    })), a ? Ut(Ut({}, e), {}, zt({}, n.id, a)) : e
                }), {})
            }
            var Jt = function(e) {
                    var t = e.nodeType,
                        n = e.index,
                        r = e.block,
                        o = e.onChangeNodeTypeLabel,
                        a = e.onChangeNodeTypeImageAsIcon,
                        i = e.onSetNodeTypeColor,
                        s = e.onChangeNodeTypeSize,
                        d = e.onChangeNodeTypeSizeLimit,
                        u = e.onChangeNodeTypeSecondaryLabel,
                        p = e.avgEdgeCounts,
                        f = e.canSetImageAsIcon,
                        h = Gt(Object(c.useState)({
                            top: 0,
                            left: 0,
                            show: !1
                        }), 2),
                        g = h[0],
                        m = h[1],
                        y = Gt(Object(c.useState)({
                            top: 0,
                            left: 0,
                            show: !1
                        }), 2),
                        b = y[0],
                        v = y[1],
                        _ = function(e) {
                            return [{
                                label: "Centrality Metric",
                                options: $t
                            }, {
                                label: "Property",
                                options: e.properties.map((function(e) {
                                    var t = e.name;
                                    return {
                                        value: e.name_alias,
                                        label: t
                                    }
                                }))
                            }, {
                                label: "Other",
                                options: [{
                                    value: "neutral",
                                    label: "Neutral"
                                }]
                            }]
                        }(t),
                        w = _.reduce((function(e, n) {
                            return e || n.options.find((function(e) {
                                return e.value === t.size
                            }))
                        }), null),
                        O = function(e) {
                            return [{
                                value: "name",
                                label: "Object"
                            }].concat(Wt(e.properties.map((function(e) {
                                var t = e.name;
                                return {
                                    value: e.name_alias,
                                    label: t
                                }
                            }))), [{
                                value: "",
                                label: "None"
                            }])
                        }(t),
                        E = function(e) {
                            return [{
                                value: "name",
                                label: "Object"
                            }].concat(Wt(e.properties.map((function(e) {
                                var t = e.name;
                                return {
                                    value: e.name_alias,
                                    label: t
                                }
                            }))), [{
                                value: "",
                                label: "None"
                            }]).filter((function(t) {
                                return t.value !== ("" === e.display_name ? "name" : e.display_name)
                            }))
                        }(t),
                        j = "".concat(t.id, "__image-as-icon-input");
                    return l.a.createElement("tr", {
                        key: t.id
                    }, l.a.createElement("td", {
                        className: "".concat(r, "__name-container")
                    }, l.a.createElement("span", {
                        style: {
                            color: t.color
                        }
                    }, t.name), p[t.id] ? l.a.createElement("span", {
                        className: "".concat(r, "__with-tooltip")
                    }, l.a.createElement("span", {
                        className: "ss-gizmo ss-info"
                    }), l.a.createElement("div", {
                        className: "tooltip-input"
                    }, p[t.id].toFixed(2), " connections in avg.")) : null), l.a.createElement("td", {
                        className: "".concat(r, "__color-container")
                    }, l.a.createElement(Dt, {
                        color: t.color,
                        onSetColor: i(n)
                    }), f && l.a.createElement(l.a.Fragment, null, " ", l.a.createElement("input", {
                        type: "checkbox",
                        id: j,
                        className: "".concat(r, "__image-as-icon"),
                        checked: !!t.image_as_icon,
                        onChange: function(e) {
                            return a(n)(e.target.checked)
                        }
                    }), l.a.createElement("label", {
                        htmlFor: j
                    }, "Image"))), l.a.createElement("td", {
                        style: {
                            verticalAlign: "top "
                        }
                    }, l.a.createElement(St.a, {
                        onChange: s(n),
                        value: w,
                        options: _
                    }), l.a.createElement("div", {
                        className: "".concat(r, "__max-size-input")
                    }, "Max size:", " ", l.a.createElement("a", {
                        href: "#",
                        onClick: function(e) {
                            e.preventDefault();
                            var t = e.clientX,
                                n = e.clientY;
                            m({
                                top: n + 20,
                                left: t - 70,
                                show: !0
                            })
                        },
                        style: {
                            color: "blue",
                            textDecoration: "underline"
                        }
                    }, t.size_limit), g.show && l.a.createElement(Ft, {
                        width: 120,
                        onClose: function() {
                            m(Ut(Ut({}, g), {}, {
                                show: !1
                            }))
                        },
                        left: g.left,
                        top: g.top
                    }, l.a.createElement("input", {
                        type: "number",
                        defaultValue: t.size_limit,
                        onBlur: function(e) {
                            return m(Ut(Ut({}, g), {}, {
                                show: !1
                            })), d(n)(e)
                        }
                    })))), l.a.createElement("td", {
                        style: {
                            verticalAlign: "top "
                        }
                    }, l.a.createElement(St.a, {
                        options: O,
                        value: O.find((function(e) {
                            return e.value === (t.hide_name ? "" : t.display_name || "name")
                        })),
                        onChange: o(n)
                    }), O.length > 2 && l.a.createElement("div", {
                        className: "".concat(r, "__second-label-input")
                    }, t.secondary_display_name && "2nd label: ", l.a.createElement("a", {
                        onClick: function(e) {
                            e.preventDefault();
                            var t = e.clientX,
                                n = e.clientY;
                            v({
                                top: n + 20,
                                left: t - 110,
                                show: !0
                            })
                        },
                        href: "#",
                        style: {
                            color: "blue",
                            textDecoration: "underline"
                        }
                    }, t.secondary_display_name || "Set secondary label"), b.show && l.a.createElement(Ft, {
                        width: 200,
                        onClose: function() {
                            v(Ut(Ut({}, b), {}, {
                                show: !1
                            }))
                        },
                        left: b.left,
                        top: b.top
                    }, l.a.createElement(St.a, {
                        options: E,
                        value: E.find((function(e) {
                            return e.value === (t.secondary_display_name || "name")
                        })),
                        onChange: function(e) {
                            return v(Ut(Ut({}, b), {}, {
                                show: !1
                            })), u(n)(e)
                        }
                    })))))
                },
                Qt = function(e) {
                    var t = e.onGraphSettingChange,
                        n = e.graphSettings,
                        r = "graph-settings";
                    return n ? l.a.createElement("div", {
                        className: "".concat(r, "__container")
                    }, l.a.createElement("div", {
                        className: "".concat(r, "__left")
                    }, l.a.createElement("h6", null, "Vertexs"), l.a.createElement("label", null, l.a.createElement("input", {
                        type: "checkbox",
                        onChange: t("hide_small_node_labels"),
                        checked: n.hide_small_node_labels || !1
                    }), " ", "Hide small Vertex labels"), l.a.createElement("label", null, l.a.createElement("input", {
                        type: "checkbox",
                        onChange: t("shorten_node_labels"),
                        checked: n.shorten_node_labels || !1
                    }), " ", "Shorten Vertex labels"), l.a.createElement("label", null, l.a.createElement("input", {
                        type: "checkbox",
                        onChange: t("lock_node_positions"),
                        checked: n.lock_node_positions || !1
                    }), " ", "Lock Vertex positions")), l.a.createElement("div", {
                        className: "".concat(r, "__right")
                    }, l.a.createElement("h6", null, "Vectors"), l.a.createElement("label", null, l.a.createElement("input", {
                        type: "checkbox",
                        onChange: t("use_curved_edges"),
                        checked: n.use_curved_edges || !1
                    }), " ", "Display curved Vectors"), l.a.createElement("label", null, l.a.createElement("input", {
                        type: "checkbox",
                        onChange: t("always_show_edge_names"),
                        checked: n.always_show_edge_names || !1
                    }), " ", "Always display Vector labels"), l.a.createElement("label", null, l.a.createElement("input", {
                        type: "checkbox",
                        onChange: t("show_edge_weights"),
                        checked: n.show_edge_weights || !1
                    }), " ", "Show Vector weights on labels"))) : null
                },
                en = function(e) {
                    var t = e.onCloseButtonClick,
                        n = e.onSave,
                        r = e.onPreview,
                        o = Object(c.useContext)(B.a),
                        a = o.graphStore,
                        i = o.uiStore,
                        s = o.GraphHistory,
                        d = "cartography-panel",
                        u = Gt(Object(c.useState)(Xt), 2),
                        p = u[0],
                        h = u[1],
                        g = Gt(Object(c.useState)(Kt), 2),
                        m = g[0],
                        y = g[1],
                        b = Gt(Object(c.useState)(null), 2),
                        v = b[0],
                        _ = b[1],
                        w = Gt(Object(c.useState)(["#00429d", "#96ffea", "#ffd006"]), 2),
                        O = w[0],
                        E = w[1],
                        j = Gt(Object(c.useState)([]), 2),
                        S = (j[0], j[1]),
                        x = Gt(Object(c.useState)({}), 2),
                        k = x[0],
                        C = x[1],
                        T = Gt(Object(c.useState)({}), 2),
                        L = T[0],
                        P = T[1],
                        A = Gt(Object(c.useState)({}), 2),
                        D = A[0],
                        M = A[1],
                        q = Gt(Object(c.useState)({}), 2),
                        I = q[0],
                        R = q[1],
                        F = Gt(Object(c.useState)(!1), 2),
                        G = F[0],
                        H = F[1],
                        U = function(e) {
                            return function(t) {
                                h(p.map((function(n, r) {
                                    return r === e ? Ut(Ut({}, n), {}, {
                                        color: t
                                    }) : n
                                })));
                                for (var n = p[e], r = Zt(s, p, m, L), o = function() {
                                        var e = i[a],
                                            r = (c = Gt(e, 2))[0];
                                        c[1].id === n.id && y(m.map((function(e) {
                                            return e.id === r ? Ut(Ut({}, e), {}, {
                                                color: t
                                            }) : e
                                        })))
                                    }, a = 0, i = Object.entries(r); a < i.length; a++) {
                                    var c;
                                    o()
                                }
                            }
                        },
                        z = function(e) {
                            return function(t) {
                                y(m.map((function(n, r) {
                                    return e === r ? Ut(Ut({}, n), {}, {
                                        display_name: t.target.value
                                    }) : n
                                })))
                            }
                        },
                        W = function(e, t) {
                            S(kt.a.scale(e).mode("hsl").colors(t.length))
                        },
                        Y = function(e) {
                            return function(t) {
                                var n = t.value;
                                h(p.map((function(t, r) {
                                    return r === e ? Ut(Ut({}, t), {}, {
                                        size: n
                                    }) : t
                                })))
                            }
                        },
                        V = function(e) {
                            return function(t) {
                                h(p.map((function(n, r) {
                                    return r === e ? Ut(Ut({}, n), {}, {
                                        size_limit: +t.target.value
                                    }) : n
                                })))
                            }
                        },
                        X = function(e) {
                            return function(t) {
                                var n = t.value;
                                h(p.map((function(t, r) {
                                    return r === e ? Ut(Ut({}, t), {}, {
                                        display_name: n,
                                        hide_name: !n,
                                        secondary_display_name: n ? t.secondary_display_name : null
                                    }) : t
                                })))
                            }
                        },
                        K = function(e) {
                            return function(t) {
                                h(p.map((function(n, r) {
                                    return r === e ? Ut(Ut({}, n), {}, {
                                        image_as_icon: t
                                    }) : n
                                })))
                            }
                        },
                        $ = function(e) {
                            return function(t) {
                                var n = t.value;
                                h(p.map((function(t, r) {
                                    return r === e ? Ut(Ut({}, t), {}, {
                                        secondary_display_name: n
                                    }) : t
                                })))
                            }
                        },
                        Z = function() {
                            p.forEach((function(e) {
                                var t = s.getNodeTypes().find((function(t) {
                                    return t.id === e.id
                                }));
                                Object.assign(t, e)
                            }))
                        },
                        J = function() {
                            m.forEach((function(e) {
                                var t = s.getEdgeTypes().find((function(t) {
                                    return t.id === e.id
                                }));
                                Object.assign(t, e)
                            }))
                        },
                        Q = function() {
                            a.set("layout", I), a.set("layoutNodeFullname", !I.shorten_node_labels), console.log("graphSettings", I)
                        };
                    Object(c.useEffect)((function() {
                        W(O, p)
                    }), [p, O]), Object(c.useEffect)((function() {
                        var e = function() {
                                var e, t;
                                return a.get("belongsToHub") ? (e = s.getNodeTypes().filter((function(e) {
                                    return e.count > 0
                                })), t = s.getEdgeTypes().filter((function(e) {
                                    return e.count > 0
                                }))) : (e = s.getNodeTypes(), t = s.getEdgeTypes()), {
                                    nodeTypes: e,
                                    edgeTypes: t
                                }
                            }(),
                            t = e.nodeTypes,
                            n = e.edgeTypes,
                            r = a.get("layout");
                        _(document.querySelector('meta[name="csrf-token"]').getAttribute("content"));
                        var o = N("gc-global", "inputColors", !0);
                        o && E(o);
                        var i = function(e, t, n) {
                            var r = n.map((function(e) {
                                return e.id
                            })).reduce((function(t, n) {
                                return [].concat(Wt(t), Wt(e.getEdgesByTypeId(n)))
                            }), []);
                            return t.reduce((function(t, n) {
                                var o = e.getNodesByTypeId(n.id).length,
                                    a = r.filter((function(t) {
                                        var r = e.getNodeById(t.from).type_id;
                                        return e.getNodeById(t.to).type_id === n.id || r === n.id
                                    })).length;
                                return Ut(Ut({}, t), {}, zt({}, n.id, a / o))
                            }), {})
                        }(s, t, n);
                        C(function(e, t) {
                            return t.reduce((function(t, n) {
                                var r = e.getNodesByTypeId(n.id).filter((function(e) {
                                    return !!e.image
                                })).length;
                                return Ut(Ut({}, t), {}, zt({}, n.id, !!r))
                            }), {})
                        }(s, t));
                        var c = t.concat().sort((function(e, t) {
                                return i[t.id] - i[e.id]
                            })),
                            l = function(e, t, n) {
                                var r = {};
                                return n.forEach((function(t) {
                                    var n = new Set;
                                    e.getEdgesByTypeId(t.id).forEach((function(t) {
                                        var r = e.getNodeById(t.from).type_id,
                                            o = e.getNodeById(t.to).type_id;
                                        n.add("".concat(r, "|").concat(o))
                                    })), r[t.id] = n
                                })), r
                            }(s, 0, n);
                        h(c), y(n), P(i), M(l), R(Ut(Ut({}, r), {}, {
                            shorten_node_labels: !a.get("layoutNodeFullname")
                        }))
                    }), []);
                    return l.a.createElement("div", {
                        className: d
                    }, l.a.createElement("form", {
                        acceptCharset: "utf-8",
                        onSubmit: function(e) {
                            e.preventDefault(), fetch("/graphs/".concat(a.get("id"), "/edit_cartography"), {
                                method: "put",
                                credentials: "same-origin",
                                headers: {
                                    "X-Requested-With": "XMLHttpRequest",
                                    "X-CSRF-Token": v,
                                    Accept: "application/json"
                                },
                                body: new FormData(e.target)
                            }).then((function() {
                                i.set("isPreviewMode", !1), J(), Z(), Q(), n({
                                    nodeTypes: p,
                                    edgeTypes: m
                                }), Object(f.updateGraph)(a.get("id"), {
                                    graph: {
                                        layout_use_curved_edges: I.use_curved_edges,
                                        layout_show_edge_weights: I.show_edge_weights,
                                        layout_always_show_edge_names: I.always_show_edge_names,
                                        layout_hide_small_node_labels: I.hide_small_node_labels,
                                        layout_lock_node_positions: I.lock_node_positions,
                                        layout_node_fullname: !I.shorten_node_labels
                                    },
                                    id: a.get("id")
                                })
                            }))
                        },
                        action: "/graphs/".concat(a.get("id"), "/edit_cartography"),
                        encType: "multipart/form-data",
                        method: "post"
                    }, v && l.a.createElement("input", {
                        type: "hidden",
                        name: "authenticity_token",
                        value: v
                    }), l.a.createElement("div", {
                        className: "".concat(d, "__panel-buttons")
                    }, l.a.createElement("button", {
                        onClick: function() {
                            i.set("isPreviewMode", !1), t()
                        }
                    }, l.a.createElement("i", {
                        className: "ss-gizmo ss-delete"
                    }))), p.map((function(e) {
                        var t = e.id,
                            n = e.color,
                            r = e.size,
                            o = e.size_limit,
                            a = e.display_name,
                            i = e.secondary_display_name,
                            s = e.hide_name,
                            d = e.image_as_icon;
                        return l.a.createElement(c.Fragment, {
                            key: t
                        }, l.a.createElement("input", {
                            name: "node_types[".concat(t, "][color]"),
                            type: "hidden",
                            defaultValue: n
                        }), l.a.createElement("input", {
                            name: "node_types[".concat(t, "][size]"),
                            type: "hidden",
                            defaultValue: r
                        }), l.a.createElement("input", {
                            name: "node_types[".concat(t, "][size_limit]"),
                            type: "hidden",
                            defaultValue: o
                        }), l.a.createElement("input", {
                            name: "node_types[".concat(t, "][display_name]"),
                            type: "hidden",
                            defaultValue: a
                        }), l.a.createElement("input", {
                            name: "node_types[".concat(t, "][secondary_display_name]"),
                            type: "hidden",
                            defaultValue: i
                        }), s ? l.a.createElement("input", {
                            name: "node_types[".concat(t, "][hide_name]"),
                            type: "hidden",
                            defaultValue: "" + s
                        }) : null, d ? l.a.createElement("input", {
                            name: "node_types[".concat(t, "][image_as_icon]"),
                            type: "hidden",
                            defaultValue: "" + d
                        }) : null)
                    })), m.map((function(e) {
                        var t = e.id,
                            n = e.color,
                            r = e.directed,
                            o = e.display_name;
                        return l.a.createElement(c.Fragment, {
                            key: t
                        }, l.a.createElement("input", {
                            name: "edge_types[".concat(t, "][color]"),
                            type: "hidden",
                            defaultValue: n
                        }), r ? l.a.createElement("input", {
                            name: "edge_types[".concat(t, "][directed]"),
                            type: "hidden",
                            value: "1"
                        }) : null, l.a.createElement("input", {
                            name: "edge_types[".concat(t, "][display_name]"),
                            type: "hidden",
                            defaultValue: o
                        }))
                    })), l.a.createElement("h5", null, "Vectors"), l.a.createElement("table", null, l.a.createElement("thead", null, l.a.createElement("tr", null, l.a.createElement("th", {
                        style: {
                            width: "25%"
                        }
                    }, "Order"), l.a.createElement("th", {
                        style: {
                            width: "15%"
                        }
                    }, "Color"), l.a.createElement("th", {
                        style: {
                            width: "25%"
                        }
                    }, "Size"), l.a.createElement("th", {
                        style: {
                            width: "25%"
                        }
                    }, "Label"))), l.a.createElement("tbody", null, p.map((function(e, t) {
                        return l.a.createElement(Jt, {
                            block: d,
                            onChangeNodeTypeLabel: X,
                            onChangeNodeTypeImageAsIcon: K,
                            onSetNodeTypeColor: U,
                            onChangeNodeTypeSize: Y,
                            onChangeNodeTypeSizeLimit: V,
                            onChangeNodeTypeSecondaryLabel: $,
                            nodeType: e,
                            key: t,
                            index: t,
                            canSetImageAsIcon: k[e.id],
                            avgEdgeCounts: L
                        })
                    })))), l.a.createElement("h5", null, "Vectors"), l.a.createElement("table", null, l.a.createElement("thead", null, l.a.createElement("tr", null, l.a.createElement("th", {
                        style: {
                            width: "25%"
                        }
                    }, "Order"), l.a.createElement("th", {
                        style: {
                            width: "15%"
                        }
                    }, "Color"), l.a.createElement("th", {
                        style: {
                            width: "25%"
                        }
                    }, "Direction"), l.a.createElement("th", {
                        style: {
                            width: "25%"
                        }
                    }, "Label"))), l.a.createElement("tbody", null, m.map((function(e, t) {
                        return l.a.createElement("tr", {
                            key: e.id
                        }, l.a.createElement("td", {
                            className: "".concat(d, "__name-container")
                        }, l.a.createElement("span", {
                            style: {
                                color: e.color
                            }
                        }, e.name), l.a.createElement("span", {
                            className: "".concat(d, "__with-tooltip")
                        }, l.a.createElement("span", {
                            className: "ss-gizmo ss-info"
                        }), l.a.createElement("div", {
                            className: "tooltip-input"
                        }, Array.from(D[e.id]).map((function(t, n) {
                            var r = Gt(t.split("|"), 2),
                                o = r[0],
                                a = r[1],
                                i = p.find((function(e) {
                                    return e.id === o
                                })),
                                s = p.find((function(e) {
                                    return e.id === a
                                }));
                            return i && s ? l.a.createElement("div", {
                                key: n,
                                className: "".concat(d, "__edge-type-summary")
                            }, l.a.createElement("span", {
                                style: {
                                    color: i.color
                                }
                            }, i.name), l.a.createElement("span", {
                                style: {
                                    color: e.color
                                }
                            }, "\u2192"), l.a.createElement("span", {
                                style: {
                                    color: s.color
                                }
                            }, s.name)) : null
                        }))))), l.a.createElement("td", null, l.a.createElement(Dt, {
                            color: e.color,
                            onSetColor: (a = t, function(e) {
                                y(m.map((function(t, n) {
                                    return n === a ? Ut(Ut({}, t), {}, {
                                        color: e
                                    }) : t
                                })))
                            })
                        })), l.a.createElement("td", null, l.a.createElement("label", null, l.a.createElement("input", {
                            type: "checkbox",
                            checked: 1 === e.directed,
                            onChange: (o = t, function() {
                                y(m.map((function(e, t) {
                                    return o === t ? Ut(Ut({}, e), {}, {
                                        directed: 1 === e.directed ? 0 : 1
                                    }) : e
                                })))
                            })
                        }), " ", "Directed")), l.a.createElement("td", null, l.a.createElement("select", {
                            value: e.display_name || "",
                            onChange: z(t)
                        }, (n = e, r = n.properties.map((function(e) {
                            var t = e.name;
                            return {
                                key: e.name_alias,
                                label: t
                            }
                        })), [{
                            key: "",
                            label: "Default"
                        }].concat(Wt(r))).map((function(e) {
                            var t = e.key,
                                n = e.label;
                            return l.a.createElement("option", {
                                key: t,
                                value: t
                            }, n)
                        })))));
                        var n, r, o, a
                    })))), l.a.createElement("h5", null, "Graph Settings"), l.a.createElement("div", {
                        className: "".concat(d, "__graph-settings")
                    }, l.a.createElement(Qt, {
                        graphSettings: I,
                        onGraphSettingChange: function(e) {
                            return function(t) {
                                var n = t.target.matches(":checked");
                                R(Ut(Ut({}, I), {}, zt({}, e, n)))
                            }
                        }
                    })), l.a.createElement("div", {
                        className: "".concat(d, "__footer")
                    }, l.a.createElement("button", {
                        className: "gc-btn gc-dlg-cancel",
                        onClick: function(e) {
                            e.preventDefault(), i.set("isPreviewMode", !0), Z(), J(), Q(), r({
                                nodeTypes: p,
                                edgeTypes: m
                            }), H(!0)
                        }
                    }, "Preview"), l.a.createElement("button", {
                        disabled: !G,
                        type: "submit",
                        className: "gc-btn gc-btn-confirm"
                    }, "Update"))))
                },
                tn = function(e) {
                    var t = e.graphHistory,
                        n = e.value,
                        r = e.onChange,
                        o = t.getNodeTypes().map((function(e) {
                            return {
                                label: e.name,
                                value: e.id
                            }
                        }));
                    return l.a.createElement("div", {
                        className: "node-type-selector"
                    }, l.a.createElement(St.a, {
                        className: "node-type-selector__input",
                        value: n,
                        onChange: r,
                        options: o
                    }))
                };

            function nn(e) {
                return function(e) {
                    if (Array.isArray(e)) return an(e)
                }(e) || function(e) {
                    if ("undefined" !== typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                }(e) || on(e) || function() {
                    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function rn(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || on(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function on(e, t) {
                if (e) {
                    if ("string" === typeof e) return an(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? an(e, t) : void 0
                }
            }

            function an(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var sn = "analysis-bar__centrality-tab",
                cn = [{
                    label: "Number of Connections",
                    value: "number-of-connections"
                }, {
                    label: "Pagerank",
                    value: "pagerank"
                }, {
                    label: "Eigenvector Centrality",
                    value: "eigenvector-centrality"
                }, {
                    label: "Closeness Centrality",
                    value: "closeness-centrality"
                }, {
                    label: "Betweenness Centrality",
                    value: "betweenness-centrality"
                }],
                ln = function() {
                    var e = Object(c.useContext)(B.a).GraphHistory,
                        t = rn(Object(c.useState)(null), 2),
                        n = t[0],
                        r = t[1],
                        o = [{
                            label: "Network Metrics",
                            options: cn
                        }];
                    return n && (o = [].concat(nn(o), [{
                        label: "Properties",
                        options: e.getNodeTypes().find((function(e) {
                            return e.id === n.value
                        })).properties.map((function(e) {
                            var t = e.name;
                            return {
                                label: e.name_alias,
                                value: t
                            }
                        }))
                    }])), l.a.createElement("div", {
                        className: sn
                    }, l.a.createElement("div", {
                        className: "".concat(sn, "__form")
                    }, l.a.createElement("div", null, "Show centralities of"), l.a.createElement("div", null, l.a.createElement(tn, {
                        onChange: function(e) {
                            r(e)
                        },
                        value: n,
                        graphHistory: e
                    })), l.a.createElement("div", null, "by"), l.a.createElement("div", null, l.a.createElement(St.a, {
                        className: "parameter-selector__input",
                        options: o
                    }))), l.a.createElement("div", {
                        className: "analysis-bar__footer"
                    }, l.a.createElement("button", null, "Cancel"), l.a.createElement("button", null, "OK")))
                };

            function dn(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return un(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return un(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function un(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var pn = function(e) {
                    var t = e.onToggle,
                        n = dn(Object(c.useState)(0), 2),
                        r = n[0],
                        o = n[1];
                    return l.a.createElement(Ve, {
                        width: "80%",
                        onCloseButtonClick: t,
                        showFooter: !1
                    }, l.a.createElement($e, {
                        currentTab: r,
                        setCurrentTab: function(e) {
                            o(e)
                        }
                    }, l.a.createElement(Ze, {
                        title: "Centrality",
                        name: "centraliy"
                    }, l.a.createElement(ln, null)), l.a.createElement(Ze, {
                        title: "Similarity",
                        name: "similarity"
                    }, "Similarity"), l.a.createElement(Ze, {
                        title: "Clustering",
                        name: "clustering"
                    }, "Clustering")))
                },
                fn = n(1006),
                hn = n(16),
                gn = ["children", "tag", "mode", "className", "portalTarget"];

            function mn(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function yn(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? mn(Object(n), !0).forEach((function(t) {
                        bn(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : mn(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function bn(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function vn(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return _n(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _n(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function _n(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }

            function wn(e, t) {
                if (null == e) return {};
                var n, r, o = function(e, t) {
                    if (null == e) return {};
                    var n, r, o = {},
                        a = Object.keys(e);
                    for (r = 0; r < a.length; r++) n = a[r], t.indexOf(n) >= 0 || (o[n] = e[n]);
                    return o
                }(e, t);
                if (Object.getOwnPropertySymbols) {
                    var a = Object.getOwnPropertySymbols(e);
                    for (r = 0; r < a.length; r++) n = a[r], t.indexOf(n) >= 0 || Object.prototype.propertyIsEnumerable.call(e, n) && (o[n] = e[n])
                }
                return o
            }
            var On = function(e) {
                    var t = e.children,
                        n = e.tag,
                        r = e.mode,
                        o = void 0 === r ? "center" : r,
                        a = e.className,
                        i = e.portalTarget,
                        s = wn(e, gn),
                        d = vn(t, 2),
                        p = d[0],
                        f = d[1],
                        h = Object(c.useRef)(),
                        g = vn(Object(c.useState)(!1), 2),
                        m = g[0],
                        y = g[1],
                        b = vn(Object(c.useState)(!1), 2),
                        v = b[0],
                        _ = b[1],
                        w = vn(Object(c.useState)({
                            x: 0,
                            top: 0,
                            left: 0
                        }), 2),
                        O = w[0],
                        E = w[1],
                        j = Object(c.useCallback)((function(e) {
                            if (h.current) {
                                var t = yn({}, O),
                                    n = h.current.getBoundingClientRect();
                                if (e) {
                                    var r = e.getBoundingClientRect();
                                    t.x = Math.max(r.width / 2 - n.x - n.width / 2 + 5, 0)
                                } else t = {
                                    x: 0,
                                    top: 0,
                                    left: 0
                                };
                                if (i) {
                                    t.left = n.left, t.top = n.top + n.height;
                                    var a = e && e.getBoundingClientRect();
                                    switch (o) {
                                        case "center":
                                            t.left += n.width / 2;
                                            break;
                                        case "left":
                                            t.left += ((null === a || void 0 === a ? void 0 : a.width) || 0) / 2;
                                            break;
                                        case "right":
                                            t.left += n.width / 2 - ((null === a || void 0 === a ? void 0 : a.width) || 0) / 2
                                    }
                                }
                                Object(hn.isEqual)(t, O) || E(t)
                            }
                        }), [h.current, O, E]),
                        S = l.a.createElement(fn.a, {
                            unmountOnExit: !1,
                            mountOnEnter: !1,
                            in: m,
                            timeout: 400,
                            classNames: "transition"
                        }, l.a.createElement("div", {
                            className: Ke()("tipped", "tipped-" + o, !v && "transition-exit-done"),
                            ref: function(e) {
                                return j(e)
                            },
                            style: yn({
                                marginLeft: O.x
                            }, i ? {
                                position: "absolute",
                                top: O.top,
                                left: O.left
                            } : {})
                        }, l.a.createElement("div", {
                            className: "tipped-arrow",
                            style: {
                                marginLeft: -O.x
                            }
                        }), f));
                    return l.a.createElement(n || "div", {
                        onMouseEnter: function() {
                            _(!0), y(!0)
                        },
                        onMouseLeave: function() {
                            return y(!1)
                        },
                        style: yn(yn({}, s.style || {}), {}, {
                            position: "relative"
                        }),
                        ref: h,
                        className: a
                    }, p, i ? u.a.createPortal(S, document.body) : S)
                },
                En = n(79),
                jn = n(354),
                Sn = n(19),
                xn = n(567),
                kn = n.n(xn),
                Cn = n(568),
                Nn = n.n(Cn);

            function Tn(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Ln(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Tn(Object(n), !0).forEach((function(t) {
                        Pn(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Tn(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function Pn(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function An(e) {
                var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                    n = new AbortController,
                    r = n.signal;
                return {
                    promise: fetch(e, Ln(Ln({}, t), {}, {
                        signal: r
                    })),
                    abort: function() {
                        n.abort()
                    }
                }
            }
            var Dn = ["children", "innerProps"];

            function Mn(e, t) {
                if (null == e) return {};
                var n, r, o = function(e, t) {
                    if (null == e) return {};
                    var n, r, o = {},
                        a = Object.keys(e);
                    for (r = 0; r < a.length; r++) n = a[r], t.indexOf(n) >= 0 || (o[n] = e[n]);
                    return o
                }(e, t);
                if (Object.getOwnPropertySymbols) {
                    var a = Object.getOwnPropertySymbols(e);
                    for (r = 0; r < a.length; r++) n = a[r], t.indexOf(n) >= 0 || Object.prototype.propertyIsEnumerable.call(e, n) && (o[n] = e[n])
                }
                return o
            }

            function qn(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function In(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? qn(Object(n), !0).forEach((function(t) {
                        Rn(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : qn(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function Rn(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function Bn(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return Fn(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Fn(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function Fn(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var Gn = {
                    id: "SELECT_IN_GRAPH",
                    label: "Select in graph",
                    image: "/assets/icons/select_node_icon.svg"
                },
                Hn = {
                    id: "ADD_TO_GRAPH",
                    label: "Add to graph",
                    image: "/assets/icons/add_to_graph_icon.svg"
                },
                Un = {
                    background: "#DEDEDE",
                    color: "white"
                },
                zn = 100,
                Wn = "Results in graph",
                Yn = "Results in hub",
                Vn = {
                    _type: "message",
                    message: "No result in graph"
                },
                Xn = {
                    _type: "message",
                    message: "No result in hub"
                },
                Kn = {
                    _type: "message",
                    message: "Searching for nodes in hub..."
                };

            function $n(e, t) {
                var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : function(e) {
                    return "...and ".concat(e, " more result").concat(e > 1 ? "s" : "", " in the graph")
                };
                return e.length > t ? e.slice(0, t).concat([{
                    _type: "message",
                    message: n(e.length - zn)
                }]) : e
            }
            var Zn = function(e) {
                    return "string" === typeof e.message ? l.a.createElement("div", {
                        className: "search-message"
                    }, e.message) : l.a.createElement("div", {
                        className: "search-result node",
                        "data-action": e.action.id
                    }, l.a.createElement("div", {
                        className: "icon"
                    }, l.a.createElement("span", {
                        className: "type-icon",
                        style: {
                            backgroundColor: e.color
                        }
                    }, e.typeFirstChar)), l.a.createElement("div", {
                        className: "content"
                    }, l.a.createElement("span", {
                        className: "title"
                    }, l.a.createElement(kn.a, {
                        searchWords: e.query.split(/ +/g),
                        textToHighlight: e.name,
                        highlightTag: "em"
                    })), l.a.createElement("div", null, l.a.createElement("div", null, l.a.createElement("div", {
                        className: "metadata"
                    }, e.type)))), l.a.createElement("div", {
                        className: "action"
                    }, l.a.createElement("img", {
                        src: e.action.image,
                        alt: "",
                        className: "action-image"
                    }), l.a.createElement("span", {
                        className: "action-label"
                    }, e.action.label)))
                },
                Jn = null,
                Qn = function(e) {
                    var t, n = e.onClickClose,
                        r = Object(c.useContext)(B.a),
                        o = r.GraphHistory,
                        a = r.graphStore,
                        i = Object(c.useRef)(null),
                        s = Object(c.useRef)(null),
                        d = !!a.get("belongsToHub") && (!a.get("id") || !(null === (t = a.get("user")) || void 0 === t || !t.can_edit)),
                        u = Bn(Object(c.useState)(""), 2),
                        p = u[0],
                        f = u[1],
                        h = Bn(Object(c.useState)(null), 2),
                        g = h[0],
                        y = h[1],
                        b = Object(c.useCallback)((function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1 / 0,
                                n = new RegExp(Nn()(Object(m.normalizeChars)(e)), "i");
                            return Object(hn.uniqBy)(o.getNodes().filter((function(e) {
                                return n.test(Object(m.normalizeChars)(o.nodeDisplayName(e.id)))
                            })).slice(0, t).map((function(e) {
                                var t = o.getNodeTypeById(e.type_id);
                                return {
                                    _type: "node",
                                    query: p,
                                    id: e.id,
                                    type: e.type,
                                    name: o.nodeDisplayName(e.id),
                                    typeFirstChar: e.type.charAt(0).toUpperCase(),
                                    color: t.color,
                                    raw: e,
                                    action: Gn
                                }
                            })), (function(e) {
                                return e.id
                            }))
                        }), [o]),
                        v = Object(c.useCallback)((function(e, t) {
                            if (d) {
                                g && (g(), y(null));
                                var n = An("/site/search.json?h=".concat(encodeURIComponent(a.get("hub").id), "&q=").concat(encodeURIComponent(e))),
                                    r = n.abort,
                                    i = n.promise;
                                y((function() {
                                    return r
                                })), i.then((function(e) {
                                    return e.json()
                                })).then((function(e) {
                                    var n = a.get("id"),
                                        r = Object(hn.keyBy)(o.getNodes(), "id");
                                    y(null), t(null, e.nodes.filter((function(e) {
                                        return !e.graphs.map((function(e) {
                                            return e.id
                                        })).includes(n) && !r[e.id]
                                    })).map((function(e) {
                                        var t = o.getNodeTypeById(e.type_id);
                                        return {
                                            _type: "node",
                                            query: p,
                                            id: e.id,
                                            type: t.name,
                                            name: e.name,
                                            color: t.color,
                                            typeFirstChar: t.name.charAt(0).toUpperCase(),
                                            raw: e,
                                            action: Hn
                                        }
                                    })))
                                })).catch((function(e) {
                                    "AbortError" === e.name || t(e, [])
                                }))
                            } else t(null, [])
                        }), [o, a, g, y]),
                        _ = Object(c.useCallback)((function() {
                            if (s) {
                                var e = s.current ? s.current.select.select.state.focusedOption : null;
                                e && "node" === e._type && "SELECT_IN_GRAPH" === e.action.id ? Jn !== e.id && (Jn = e.id, o.focusNode(e.id)) : Jn && (Jn = null, o.clearSelectedNodes())
                            }
                        }), [s]);
                    return Object(c.useEffect)((function() {
                        s && s.current && _()
                    }), [s]), Object(c.useEffect)((function() {
                        var e = function(e) {
                            i.current && !i.current.contains(e.target) && n()
                        };
                        return document.body.addEventListener("click", e),
                            function() {
                                document.body.removeEventListener("click", e)
                            }
                    }), []), l.a.createElement("div", {
                        className: "search-module search visible",
                        ref: i
                    }, l.a.createElement(jn.a, {
                        ref: s,
                        className: "react-select-root",
                        inputId: "search-input",
                        placeholder: "Search in graph",
                        styles: {
                            control: function(e) {
                                return In(In({}, e), {}, {
                                    border: "none",
                                    outline: "none",
                                    boxShadow: "none",
                                    height: "100%",
                                    fontSize: "1.2em"
                                })
                            },
                            valueContainer: function(e) {
                                return In(In({}, e), {}, {
                                    marginLeft: "2.8em"
                                })
                            },
                            indicatorSeparator: function(e) {
                                return In(In({}, e), {}, {
                                    display: "none"
                                })
                            },
                            dropdownIndicator: function(e) {
                                return In(In({}, e), {}, {
                                    display: "none"
                                })
                            },
                            loadingIndicator: function(e) {
                                return In(In({}, e), {}, {
                                    marginRight: 50
                                })
                            },
                            menu: function(e) {
                                return In(In({}, e), {}, {
                                    borderRadius: 0,
                                    marginTop: 0,
                                    marginBottom: 0
                                })
                            },
                            menuList: function(e) {
                                return In(In({}, e), {}, {
                                    paddingTop: 0,
                                    paddingBottom: 0
                                })
                            },
                            group: function(e) {
                                return In(In({}, e), {}, {
                                    paddingBottom: 0
                                })
                            },
                            option: function(e, t) {
                                return In(In(In({}, e), {}, {
                                    width: "auto",
                                    borderBottom: 1,
                                    borderBottomStyle: "solid",
                                    borderBottomColor: "#EEE"
                                }, t.isFocused ? Un : {}), t.isDisabled ? {} : {
                                    "&:hover": Un
                                })
                            },
                            placeholder: function(e) {
                                return In(In({}, e), {}, {
                                    color: "#A9A9A9"
                                })
                            }
                        },
                        noOptionsMessage: function() {
                            return null
                        },
                        formatOptionLabel: Zn,
                        components: {
                            Option: function(e) {
                                var t = e.children,
                                    n = e.innerProps,
                                    r = Mn(e, Dn);
                                return l.a.createElement(Sn.m.Option, Object.assign({
                                    innerProps: Object(hn.omit)(n, "onMouseOver", "onMouseMove")
                                }, r), t)
                            }
                        },
                        autoFocus: !0,
                        defaultMenuIsOpen: !0,
                        onKeyDown: function(e) {
                            "Escape" === e.key ? n() : "Enter" !== e.key && setTimeout(_, 0)
                        },
                        defaultOptions: $n(b(""), zn),
                        loadOptions: function(e, t) {
                            if (s.current) {
                                var n = b(e),
                                    r = $n(n, zn);
                                d ? (t([{
                                    label: Wn,
                                    options: r
                                }]), e.length >= 3 && n.length < zn && (s.current.setState({
                                    isLoading: !0,
                                    loadedOptions: [{
                                        label: Wn,
                                        options: n.length ? n : [Vn]
                                    }, {
                                        label: Yn,
                                        options: [Kn]
                                    }]
                                }), _(), v(e, (function(t, r) {
                                    t ? console.error('Error while search for "'.concat(e, '"'), t) : s.current && s.current.state.inputValue === e && (s.current.setState({
                                        isLoading: !1,
                                        loadedOptions: [{
                                            label: Wn,
                                            options: n.length ? n : [Vn]
                                        }, {
                                            label: Yn,
                                            options: r.length ? $n(r, zn - n.length, (function(e) {
                                                return "...and ".concat(e, " more result").concat(e > 1 ? "s" : "", " in the hub")
                                            })) : [Xn]
                                        }]
                                    }), _())
                                })))) : t(r)
                            }
                        },
                        onChange: function(e) {
                            if ("message" !== e._type)
                                if (e.action.id === Gn.id) o.clearSelectedNodes(), o.selectNode(e.id), n();
                                else if (e.action.id === Hn.id) {
                                var t = 2 * Math.random() * Math.PI,
                                    r = 60 * Math.random() + 40;
                                o.importExistingNode(e.raw, {
                                    x: r * Math.cos(t),
                                    y: r * Math.sin(t)
                                }), o.clearSelectedNodes(), o.selectNode(e.id), n()
                            }
                        },
                        inputValue: p,
                        onInputChange: f,
                        isOptionDisabled: function(e) {
                            return "node" !== e._type
                        }
                    }), l.a.createElement("span", {
                        className: "search-glass"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/search_icon.svg",
                        alt: "Search"
                    })), l.a.createElement("a", {
                        href: "#",
                        className: "close-search",
                        onClick: function(e) {
                            e.preventDefault(), n()
                        }
                    }, l.a.createElement("img", {
                        src: "/assets/icons/close_circle_icon.svg",
                        alt: "Close search"
                    })))
                };

            function er(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return tr(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return tr(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function tr(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var nr = 2 * Math.PI * 22,
                rr = function(e) {
                    var t = e.options,
                        n = Object(c.useContext)(B.a),
                        r = n.graphStore,
                        o = er(Object(c.useState)(!1), 2),
                        a = o[0],
                        i = (o[1], er(Object(c.useState)(!1), 2)),
                        s = i[0],
                        d = i[1],
                        u = r.get("user") && Object.keys(r.get("user")).length > 0 ? r.get("user") : void 0,
                        p = er(Object(En.b)(r, "recommendedCount"), 2),
                        h = p[0],
                        g = p[1],
                        m = er(Object(En.b)(r, "isUserRecommended"), 2),
                        y = m[0],
                        b = m[1],
                        v = er(Object(En.b)(r, "qualityScore"), 1)[0];
                    return l.a.createElement(l.a.Fragment, null, l.a.createElement("nav", {
                        className: Ke()("main", a && "not-shown")
                    }, l.a.createElement("header", {
                        className: "left graph-title flex-row",
                        style: {
                            maxWidth: "100%",
                            width: "auto"
                        }
                    }, l.a.createElement("a", {
                        href: "#",
                        className: "with-icon toggle-search",
                        onClick: function(e) {
                            e.preventDefault(), d(!0)
                        }
                    }, l.a.createElement("img", {
                        src: "/assets/icons/search_icon.svg",
                        alt: "Search"
                    })), t.graphEmbed ? l.a.createElement("a", {
                        href: "/graphs/".concat(r.get("id"), "?auto=true"),
                        target: "_blank"
                    }, l.a.createElement("span", {
                        id: "graph-name",
                        className: "ellipsis"
                    }, r.get("title"))) : t.isNew ? l.a.createElement("span", null, l.a.createElement("span", {
                        id: "graph-name",
                        className: "ellipsis"
                    }, "New graph")) : l.a.createElement(On, {
                        tag: "span",
                        className: "ellipsis",
                        portalTarget: document.body
                    }, l.a.createElement("span", {
                        id: "graph-name",
                        className: "ellipsis"
                    }, r.get("title")), l.a.createElement("ul", {
                        className: "context-menu show"
                    }, u && (u.is_admin || u.can_edit) && l.a.createElement(l.a.Fragment, null, l.a.createElement("li", null, l.a.createElement("a", {
                        href: "/graphs/".concat(r.get("id"), "/stats"),
                        target: "_blank"
                    }, l.a.createElement("span", {
                        className: "icon"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/timeline_white_icon.svg",
                        alt: ""
                    })), "Stats")), l.a.createElement("li", {
                        className: "divider"
                    })), l.a.createElement("li", null, l.a.createElement("a", {
                        href: "",
                        className: "map-controller toggle-graph-model",
                        id: "btn-toggle-graph-model",
                        title: "Graph Model"
                    }, l.a.createElement("span", {
                        className: "icon"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/graph_white_icon.svg",
                        alt: ""
                    })), "Graph Model")), l.a.createElement("li", null, l.a.createElement("a", {
                        href: "",
                        className: "map-controller toggle-spreadsheet",
                        id: "btn-toggle-spreadsheet",
                        title: "Data Table"
                    }, l.a.createElement("span", {
                        className: "icon"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/datatable_white_icon.svg",
                        alt: ""
                    })), "Data Table")), !t.isNew && !t.exploreOnly && l.a.createElement(l.a.Fragment, null, l.a.createElement("li", {
                        className: "divider"
                    }), l.a.createElement("li", null, l.a.createElement("a", {
                        href: "#",
                        className: "with-icon graph-export",
                        title: "Export graph data"
                    }, l.a.createElement("span", {
                        className: "icon"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/export_white_icon.svg",
                        alt: ""
                    })), "Export Data"))), u && (u.is_admin || u.can_edit) && l.a.createElement("li", null, l.a.createElement("a", {
                        href: "#",
                        className: "with-icon gc-pnl-duplicate",
                        title: "Make a copy of this graph"
                    }, l.a.createElement("span", {
                        className: "icon"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/duplicate_white_icon.svg",
                        alt: ""
                    })), "Duplicate")))), t.readOnly && l.a.createElement(On, null, l.a.createElement("a", {
                        href: "#",
                        className: "btnOpenReferences not-shown",
                        title: "Referenced graph",
                        style: {
                            marginLeft: "0.5em"
                        }
                    }, l.a.createElement("span", {
                        className: "icon inline-icon referenced"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/referenced_icon.svg",
                        alt: "Referenced"
                    }))), l.a.createElement("span", {
                        className: "context-menu show",
                        style: {
                            whiteSpace: "nowrap"
                        }
                    }, "Referenced graph")), t.graphEmbed && l.a.createElement("a", {
                        href: "#",
                        className: "open-graph-info in-topbar icon",
                        title: "View graph info",
                        style: {
                            marginLeft: "0.5em"
                        }
                    }, l.a.createElement("span", {
                        className: "icon"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/info_outline_icon.svg",
                        alt: ""
                    }))), !t.isNew && !t.readOnly && l.a.createElement(On, null, l.a.createElement("a", {
                        href: "#",
                        id: "btnOpenCheckList",
                        style: {
                            marginLeft: "0.5em"
                        }
                    }, l.a.createElement("div", {
                        className: "progress-meter"
                    }, l.a.createElement("svg", {
                        className: "progress",
                        width: "52",
                        height: "52",
                        viewBox: "0 0 52 52"
                    }, l.a.createElement("circle", {
                        className: "progress__meter",
                        cx: "26",
                        cy: "26",
                        r: "22",
                        strokeWidth: "4"
                    }), l.a.createElement("circle", {
                        className: "progress__value",
                        cx: "26",
                        cy: "26",
                        r: "22",
                        strokeWidth: "4",
                        strokeDasharray: nr,
                        strokeDashoffset: nr * (1 - v / 100)
                    }), l.a.createElement("text", {
                        className: "progress__text",
                        x: "50%",
                        y: "50%",
                        transform: "rotate(90 26,26)",
                        alignmentBaseline: "middle",
                        textAnchor: "middle",
                        dy: "3"
                    }, v + "%")))), l.a.createElement("span", {
                        className: "context-menu show",
                        style: {
                            whiteSpace: "nowrap",
                            lineHeight: "normal"
                        }
                    }, "Open graph checklist")), !t.isNew && !t.graphEmbed && l.a.createElement(On, {
                        className: Ke()(2 === t.graphStatus && "not-shown")
                    }, l.a.createElement("a", {
                        href: "#",
                        className: "in-topbar icon ".concat(u ? "" : "btnSignIn"),
                        onClick: function(e) {
                            if (e.preventDefault(), u) {
                                var t = h + (y ? -1 : 1),
                                    n = y ? f.unrecommend : f.recommend;
                                g(t), b(!y), n(r.get("id"), (function(e) {
                                    return g(parseInt(e.val))
                                }))
                            }
                        },
                        style: {
                            marginLeft: "0.5em"
                        }
                    }, l.a.createElement("span", {
                        style: {
                            whiteSpace: "nowrap"
                        }
                    }, y ? l.a.createElement("img", {
                        src: "/assets/icons/rec_icon_full.svg",
                        className: "icon reccomended",
                        alt: ""
                    }) : l.a.createElement("img", {
                        src: "/assets/icons/rec_icon.svg",
                        className: "icon reccomend",
                        alt: ""
                    }), " ", l.a.createElement("span", {
                        id: "recommend-count"
                    }, h > 0 ? h : ""))), l.a.createElement("a", {
                        href: "#",
                        className: "context-menu show recommend topbar",
                        style: {
                            whiteSpace: "nowrap",
                            lineHeight: "normal"
                        },
                        onClick: function(e) {
                            e.preventDefault(), h && Object(bt.recommendDialog)(n)
                        }
                    }, h ? 1 === h ? "One person recommends this graph" : "Recommended by " + h + " people" : "Be the first to recommend this graph!")), (t.exploreOnly || !t.readOnly) && l.a.createElement(l.a.Fragment, null, l.a.createElement("span", {
                        className: "graph-save",
                        style: {
                            marginLeft: "0.5em"
                        }
                    }, l.a.createElement("button", {
                        id: "btnSave",
                        className: "btn-save",
                        disabled: !0
                    })), l.a.createElement("span", {
                        className: "graph-autosave-notify",
                        style: {
                            marginLeft: "0.5em"
                        }
                    }))), l.a.createElement("ul", {
                        className: Ke()("right", t.graphEmbed && "embed")
                    }, t.nav.showInfo && l.a.createElement("li", null, l.a.createElement("a", {
                        href: "#",
                        className: "map-controller graph-info",
                        title: "Display graph info",
                        onClick: function(e) {
                            return e.preventDefault()
                        }
                    }, "Info")), t.nav.showFilter && l.a.createElement("li", null, l.a.createElement("a", {
                        href: "#",
                        className: Ke()("map-controller", "filter", t.readOnly && "filter-readonly"),
                        title: "Apply filters",
                        onClick: function(e) {
                            return e.preventDefault()
                        }
                    }, "Filter")), t.nav.showAnalyze && l.a.createElement("li", null, l.a.createElement("a", {
                        href: "#",
                        className: "graph-analyze",
                        title: "Apply network analysis",
                        onClick: function(e) {
                            return e.preventDefault()
                        }
                    }, "Analyze")), t.nav.showStories && l.a.createElement("li", null, l.a.createElement("a", {
                        href: "#",
                        className: "map-controller stories",
                        title: "Create slideshow stories"
                    }, "Stories")), t.nav.showComment && l.a.createElement("li", null, l.a.createElement("a", {
                        href: "#",
                        className: Ke()("graph-toggle-comments", t.hasUnreadComments && "with-notification")
                    }, "Comment", " ", !!t.commentsCount && l.a.createElement("span", {
                        id: "comment-count",
                        className: "parantheses"
                    }, t.commentsCount))), t.nav.showShare && l.a.createElement("li", null, 2 === t.graphStatus ? l.a.createElement("a", {
                        href: "#",
                        className: "share",
                        title: "Share (This graph is private)"
                    }, l.a.createElement("span", {
                        className: "status-title lock-icon"
                    }, "Share")) : 1 === t.graphStatus ? l.a.createElement("a", {
                        href: "#",
                        className: "share",
                        title: "Share (This graph is published)"
                    }, l.a.createElement("span", {
                        className: "status-title globe-icon"
                    }, "Share")) : 0 === t.graphStatus ? l.a.createElement("a", {
                        href: "#",
                        className: "share",
                        title: "Share (This graph is work in progress / public)"
                    }, l.a.createElement("span", {
                        className: "status-title wip-icon"
                    }, "Share")) : null), u && !t.graphEmbed && l.a.createElement(l.a.Fragment, null, l.a.createElement(On, {
                        tag: "li",
                        className: "btn-link",
                        mode: "right"
                    }, l.a.createElement("a", {
                        href: "/users/".concat(u.id),
                        className: "user",
                        onClick: function(e) {
                            return e.preventDefault()
                        }
                    }, l.a.createElement("span", {
                        className: "user-menu",
                        "data-qa": "user-menu"
                    }, l.a.createElement("img", {
                        src: u.image,
                        className: "avatar",
                        alt: "Avatar"
                    }), " ", l.a.createElement("img", {
                        src: "/assets/icons/arrdown_icon.svg",
                        className: "arrdown",
                        alt: ""
                    }))), l.a.createElement("ul", {
                        className: "context-menu show"
                    }, l.a.createElement("li", null, l.a.createElement("a", {
                        className: "start-graph-btn",
                        href: "/graphs/new"
                    }, "New graph")), l.a.createElement("li", {
                        className: "divider"
                    }), l.a.createElement("li", null, l.a.createElement("a", {
                        href: "/users/".concat(u.id)
                    }, "Profile")), l.a.createElement("li", null, l.a.createElement("a", {
                        href: "/me/edit"
                    }, "Settings")), l.a.createElement("li", {
                        className: Ke()("ctx-link-share", 2 !== t.graphStatus && "not-shown")
                    }, "Free" === u.plan ? l.a.createElement("a", {
                        href: "/plans"
                    }, "Upgrade Plan") : l.a.createElement("a", {
                        href: "/me/billing"
                    }, "Billing")), l.a.createElement("li", null, l.a.createElement("a", {
                        href: "/users/".concat(u.id, "/stats")
                    }, "Stats")), l.a.createElement("li", {
                        className: "divider"
                    }), l.a.createElement("li", null, l.a.createElement("a", {
                        href: "/"
                    }, "Home")), u.invites > 0 && l.a.createElement("li", null, l.a.createElement("a", {
                        href: "/invitations/new"
                    }, "Invite (", u.invites, " left)")), l.a.createElement("li", {
                        className: "divider"
                    }), l.a.createElement("li", null, l.a.createElement("a", {
                        href: "/help"
                    }, "Help")), l.a.createElement("li", null, l.a.createElement("a", {
                        rel: "nofollow",
                        href: "/users/sign_out",
                        "data-method": "delete"
                    }, "Sign out")))), l.a.createElement("li", {
                        className: "btn-link"
                    })), !u && !t.graphEmbed && l.a.createElement("li", {
                        className: "btn-link"
                    }, l.a.createElement("a", {
                        href: "#",
                        id: "btnSignIn",
                        className: "btn-link btnSignIn"
                    }, t.canSignUp ? l.a.createElement(l.a.Fragment, null, l.a.createElement("span", {
                        className: "signin-text"
                    }, "Sign in / "), "Sign up") : "Sign in")))), s && l.a.createElement(Qn, {
                        onClickClose: function() {
                            return d(!1)
                        }
                    }))
                },
                or = n(569);

            function ar(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || sr(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function ir(e) {
                return function(e) {
                    if (Array.isArray(e)) return cr(e)
                }(e) || function(e) {
                    if ("undefined" !== typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                }(e) || sr(e) || function() {
                    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function sr(e, t) {
                if (e) {
                    if ("string" === typeof e) return cr(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? cr(e, t) : void 0
                }
            }

            function cr(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }

            function lr(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function dr(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? lr(Object(n), !0).forEach((function(t) {
                        ur(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : lr(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function ur(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function pr(e, t) {
                var n = [],
                    r = {},
                    o = Object(hn.keyBy)(t.getNodes().concat(Object(hn.flatMap)(e, (function(e) {
                        return e.nodes
                    }))), "id");
                return e.forEach((function(e) {
                    e.edges.filter((function(e) {
                        return !t.getEdgeById(e.id)
                    })).forEach((function(a) {
                        var i = a.from !== e.id,
                            s = t.getEdgeTypeById(a.type_id || a.name_id),
                            c = o[e.id],
                            l = o[i ? a.from : a.to],
                            d = t.getNodeTypeById(c.type_id),
                            u = t.getNodeTypeById(l.type_id),
                            p = JSON.stringify([d.id, s.id, i ? "in" : "out", u.id]),
                            f = r[p];
                        if (f) f.edgeIDs.push(a.id), f.left.nodeIDs.includes(c.id) || (f.left = "nodeType" === f.left.type ? dr(dr({}, f.left), {}, {
                            nodeIDs: f.left.nodeIDs.concat([c.id])
                        }) : {
                            type: "nodeType",
                            label: d.name,
                            color: d.color,
                            nodeIDs: f.left.nodeIDs.concat([c.id]),
                            nodeTypeID: d.id,
                            nodeType: d
                        }), f.right.nodeIDs.includes(l.id) || (f.right = "nodeType" === f.right.type ? dr(dr({}, f.right), {}, {
                            nodeIDs: f.right.nodeIDs.concat([l.id])
                        }) : {
                            type: "nodeType",
                            label: u.name,
                            color: u.color,
                            nodeIDs: f.right.nodeIDs.concat([l.id]),
                            nodeTypeID: u.id,
                            nodeType: u
                        });
                        else {
                            var h = {
                                optionId: n.length + "",
                                direction: i ? "in" : "out",
                                checked: !1,
                                edgeIDs: [a.id],
                                edgeType: s,
                                left: {
                                    type: "node",
                                    label: c.name,
                                    color: d.color,
                                    typeChar: d.name[0].toUpperCase(),
                                    nodeTypeID: d.id,
                                    node: c,
                                    nodeIDs: [c.id]
                                },
                                right: {
                                    type: "node",
                                    label: l.name,
                                    color: u.color,
                                    typeChar: u.name[0].toUpperCase(),
                                    nodeTypeID: u.id,
                                    node: l,
                                    nodeIDs: [l.id]
                                }
                            };
                            n.push(h), r[p] = h
                        }
                    }))
                })), 1 === n.length && (n[0].checked = !0), [].concat(ir(Object(hn.sortBy)(n.filter((function(e) {
                    return e.left.nodeIDs.length > 1
                })), (function(e) {
                    return -e.left.nodeIDs.length
                }))), ir(n.filter((function(e) {
                    return e.left.nodeIDs.length <= 1
                }))))
            }
            var fr = function(e) {
                    var t = e.input,
                        n = e.setSelection,
                        r = e.setContext,
                        o = Object(c.useContext)(B.a),
                        a = o.graphStore,
                        i = o.GraphHistory,
                        s = ar(Object(c.useState)({
                            type: "initial"
                        }), 2),
                        d = s[0],
                        u = s[1];
                    return Object(c.useEffect)((function() {
                        "initial" === d.type ? (n([]), u({
                            type: "loading",
                            message: "Loading relations..."
                        }), "nodes" === t.type ? Object(or.a)(t.nodes.map((function(e) {
                            return function(t) {
                                return Object(f.getEdgesForNode)(e.id, (function(n) {
                                    return t(null, dr(dr({}, n), {}, {
                                        node: e
                                    }))
                                }), (function(e) {
                                    return t(e)
                                }))
                            }
                        })), 5, (function(e, t) {
                            e ? u({
                                type: "error",
                                message: "Something went wrong (".concat(e.message, ")")
                            }) : t && (u({
                                type: "options",
                                options: pr(t, i)
                            }), r({
                                discoveredNodes: Object(hn.keyBy)(Object(hn.flatMap)(t, (function(e) {
                                    return e.nodes
                                })), "id"),
                                discoveredEdges: Object(hn.keyBy)(Object(hn.flatMap)(t, (function(e) {
                                    return e.edges
                                })), "id")
                            }))
                        })) : "nodeTypes" === t.type && Object(f.getTypesGraphInHub)(a.get("hub").id, t.nodeTypes.map((function(e) {
                            return e.id
                        })), (function(e) {
                            var t = Object(hn.keyBy)(i.getNodes(), "id"),
                                n = {};
                            u({
                                type: "options",
                                options: e.rows.map((function(e, r) {
                                    var o = i.getNodeTypeById(e.left_node_type),
                                        a = i.getNodeTypeById(e.right_node_type),
                                        s = e.left_node_ids.filter((function(e) {
                                            return !t[e]
                                        })),
                                        c = e.right_node_ids.filter((function(e) {
                                            return !t[e]
                                        }));
                                    return e.edges.forEach((function(e) {
                                        n[e.id] = e
                                    })), s.length && c.length ? {
                                        optionId: r + "",
                                        direction: e.is_out ? "out" : "in",
                                        checked: !1,
                                        edgeType: i.getEdgeTypeById(e.edge_type),
                                        left: {
                                            type: "nodeType",
                                            color: o.color,
                                            label: o.name,
                                            nodeType: o,
                                            nodeTypeID: o.id,
                                            nodeIDs: s
                                        },
                                        right: {
                                            type: "nodeType",
                                            color: a.color,
                                            label: a.name,
                                            nodeType: a,
                                            nodeTypeID: a.id,
                                            nodeIDs: c
                                        },
                                        edgeIDs: e.edges.map((function(e) {
                                            return e.id
                                        }))
                                    } : null
                                })).filter((function(e) {
                                    return !!e
                                }))
                            }), r({
                                discoveredEdges: n,
                                discoveredNodes: {}
                            })
                        }), (function(e) {
                            return u({
                                type: "error",
                                message: "Something went wrong (".concat(e.message, ")")
                            })
                        }))) : "options" === d.type && n(d.options.filter((function(e) {
                            return e.checked
                        })))
                    }), [d]), l.a.createElement(l.a.Fragment, null, "loading" === d.type && l.a.createElement(l.a.Fragment, null, l.a.createElement("span", {
                        className: "lbl-wait-message"
                    }, d.message)), "options" === d.type && (d.options.length ? d.options.map((function(e) {
                        return l.a.createElement("div", {
                            className: "newedge-body node-expand-container",
                            key: e.optionId,
                            onClick: function() {
                                return u(dr(dr({}, d), {}, {
                                    options: d.options.map((function(t) {
                                        return t.optionId === e.optionId ? dr(dr({}, t), {}, {
                                            checked: !t.checked
                                        }) : t
                                    }))
                                }))
                            }
                        }, l.a.createElement("div", {
                            className: "newedge-body-item",
                            key: e.optionId
                        }, l.a.createElement("div", {
                            className: "gc-edge-check cell"
                        }, l.a.createElement("input", {
                            type: "checkbox",
                            checked: e.checked,
                            onChange: function() {}
                        })), l.a.createElement("div", {
                            className: "gc-edge-source cell"
                        }, l.a.createElement("div", {
                            className: "ellipsis"
                        }, l.a.createElement("span", {
                            className: "type-icon-small",
                            style: {
                                backgroundColor: e.left.color
                            }
                        }, "node" === e.left.type ? e.left.typeChar : e.left.nodeIDs.length), "node" === e.left.type ? l.a.createElement("span", {
                            className: "name"
                        }, e.left.label) : l.a.createElement("span", {
                            className: "type",
                            style: {
                                color: e.left.color
                            }
                        }, e.left.label))), l.a.createElement("div", {
                            className: "gc-edge-rel cell"
                        }, l.a.createElement("label", {
                            style: {
                                color: e.edgeType.color
                            }
                        }, "in" === e.direction ? l.a.createElement("span", {
                            className: "ss-gizmo ss-left bold"
                        }) : "\u2013", e.edgeType.name, "out" === e.direction ? l.a.createElement("span", {
                            className: "ss-gizmo ss-right bold"
                        }) : "\u2013")), l.a.createElement("div", {
                            className: "gc-edge-target cell"
                        }, l.a.createElement("div", {
                            className: "ellipsis"
                        }, l.a.createElement("ul", null, l.a.createElement("li", null, l.a.createElement("span", {
                            className: "type-icon-small",
                            style: {
                                backgroundColor: e.right.color
                            }
                        }, "node" === e.right.type ? e.right.typeChar : e.right.nodeIDs.length), "node" === e.right.type ? l.a.createElement("span", {
                            className: "name"
                        }, e.right.label) : l.a.createElement("span", {
                            className: "type",
                            style: {
                                color: e.right.color
                            }
                        }, e.right.label)))))))
                    })) : l.a.createElement("div", {
                        className: "placeholder"
                    }, "No option available")), "submitting" === d.type && l.a.createElement("span", {
                        className: "lbl-wait-message"
                    }, "Importing ", d.nodesCount, " Vertex", d.nodesCount > 1 && "s", " and ", d.edgesCount, " relation", d.edgesCount > 1 && "s", "..."))
                },
                hr = function(e) {
                    var t = e.selectedNodes,
                        n = e.onCloseButtonClick,
                        r = Object(c.useContext)(B.a),
                        o = r.graphStore,
                        a = r.GraphHistory,
                        i = ar(Object(c.useState)(!1), 2),
                        s = i[0],
                        d = i[1],
                        u = ar(Object(c.useState)([]), 2),
                        p = u[0],
                        h = u[1],
                        g = ar(Object(c.useState)({
                            discoveredEdges: {},
                            discoveredNodes: {}
                        }), 2),
                        m = g[0],
                        y = g[1],
                        b = (t.length, Object(c.useCallback)((function() {
                            p.length && (d(!0), function(e, t, n) {
                                var r = {},
                                    o = {},
                                    a = {};
                                Object(hn.flatMap)(e, (function(e) {
                                    return e.edgeIDs
                                })).forEach((function(e) {
                                    var n = t.discoveredEdges[e];
                                    o[n.id] = n, t.existingNodes[n.from] || (t.discoveredNodes[n.from] ? r[n.from] = t.discoveredNodes[n.from] : a[n.from] = !0), t.existingNodes[n.to] || (t.discoveredNodes[n.to] ? r[n.to] = t.discoveredNodes[n.to] : a[n.to] = !0)
                                }));
                                var i = Object.keys(a);
                                i.length ? Object(f.getNodes)(i, (function(e) {
                                    for (var t in e) r[t] = e[t];
                                    n(null, {
                                        nodes: r,
                                        edges: o
                                    })
                                }), (function(e) {
                                    n(e, null)
                                })) : n(null, {
                                    nodes: r,
                                    edges: o
                                })
                            }(p, dr(dr({}, m), {}, {
                                existingNodes: Object(hn.keyBy)(a.getNodes(), "id")
                            }), (function(e, r) {
                                var i = Object.keys(r.nodes);
                                Object(f.checkEdgesForNodesInHub)(o.get("hub").id, i, a.getNodes().map((function(e) {
                                    return e.id
                                })).concat(i), (function(e) {
                                    e.edges.forEach((function(e) {
                                        r.edges[e.id] || (r.edges[e.id] = e)
                                    }))
                                }), (function(e) {
                                    console.error("Error while checking for Vectors to add", e)
                                }), (function() {
                                    var e = Object.values(r.nodes),
                                        o = Object.values(r.edges),
                                        i = t.map((function(e) {
                                            return a.getNodePosition(e.id)
                                        })).filter((function(e) {
                                            return !!e
                                        })),
                                        s = Object(hn.mean)(i.map((function(e) {
                                            return e.x
                                        }))),
                                        c = Object(hn.mean)(i.map((function(e) {
                                            return e.y
                                        })));
                                    e.forEach((function(e) {
                                        var t = 2 * Math.random() * Math.PI,
                                            n = Math.floor(40 + 60 * Math.random());
                                        e.pos = {
                                            x: s + n * Math.cos(t),
                                            y: c + n * Math.sin(t)
                                        }
                                    })), a.importHubNodesAndEdges(e, o), n()
                                }))
                            })))
                        }), [m, p]));
                    return l.a.createElement(Ve, {
                        showFooter: !0,
                        width: 640,
                        maxWidth: "100%",
                        bodyStyle: {
                            maxHeight: "50vh",
                            overflowY: "auto"
                        },
                        title: "Expand relations",
                        onCloseButtonClick: n,
                        onSubmitButtonClick: b,
                        disableSubmit: !p.length || s,
                        labels: {
                            close: "Cancel",
                            submit: "ADD"
                        }
                    }, !s && l.a.createElement(fr, {
                        input: {
                            type: "nodes",
                            nodes: t
                        },
                        setSelection: h,
                        setContext: y
                    }), s && l.a.createElement("span", {
                        className: "lbl-wait-message"
                    }, "Loading more relations..."))
                };

            function gr(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function mr(e, t) {
                return (mr = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function yr(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = _r(e);
                    if (t) {
                        var o = _r(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return br(this, n)
                }
            }

            function br(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return vr(e)
            }

            function vr(e) {
                if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return e
            }

            function _r(e) {
                return (_r = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            var wr = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && mr(e, t)
                }(a, e);
                var t, n, r, o = yr(a);

                function a(e) {
                    var t;
                    ! function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, a), (t = o.call(this, e)).appContext = void 0, t.stateManager = void 0, t.coordinator = void 0, t.canvas = void 0, t.spreadsheet = void 0, t.spreadsheetSwitcher = void 0, t.browserView = void 0, t.hideDialog = t.hideDialog.bind(vr(t)), t.onSaveGraph = t.onSaveGraph.bind(vr(t)), t.showAddDialog = t.showAddDialog.bind(vr(t)), t.showExpandDialog = t.showExpandDialog.bind(vr(t)), t.handleNodeCreate = t.handleNodeCreate.bind(vr(t)), t.handleAddExistingNode = t.handleAddExistingNode.bind(vr(t)), t.handleAddPath = t.handleAddPath.bind(vr(t)), t.showCartographyPanel = t.showCartographyPanel.bind(vr(t)), t.onCartographyPreview = t.onCartographyPreview.bind(vr(t)), t.onCanvasReady = t.onCanvasReady.bind(vr(t)), t.subscribeToGraphHistory = t.subscribeToGraphHistory.bind(vr(t)), t.applySignal = t.applySignal.bind(vr(t)), t.tryUpdateSnapshot = t.tryUpdateSnapshot.bind(vr(t)), t.hideCartographyPanel = t.hideCartographyPanel.bind(vr(t));
                    var n = e.options.graph_options;
                    return t.appContext = Object(B.b)(e.options), t.appContext.dispatcher.bind("onExplorePanelOpened", t.showAddDialog), t.appContext.dispatcher.bind("openExpandPanel", t.showExpandDialog), t.appContext.GraphHistory.load({
                        graph: t.props.graphData
                    }, n), t.stateManager = new m.StateManager(t.appContext), t.state = {
                        canvasIsReady: !1,
                        showPanel: null
                    }, t
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        var e = this,
                            t = this.appContext.GraphHistory,
                            n = this.props.options.graph_options;
                        if (this.appContext.uiStore.get("readOnly")) this.appContext.dispatcher.emit("updateEditMode", Z.a.VIEW);
                        else {
                            var r = t.getNodes();
                            null == r || 0 == r.length || n.editOnLoad ? this.appContext.dispatcher.emit("updateEditMode", Z.a.EDIT) : n.for_hub || this.appContext.dispatcher.emit("updateEditMode", Z.a.VIEW)
                        }
                        requestAnimationFrame((function() {
                            e.coordinator.getInstance().setCanvas(e.canvas.getInstance()), e.spreadsheet && e.coordinator.getInstance().setDataTable(e.spreadsheet.getInstance()), e.spreadsheetSwitcher && e.coordinator.getInstance().setSwitcher(e.spreadsheetSwitcher.getInstance()), e.coordinator.getInstance().start(), e.setState({
                                canvasIsReady: !0
                            }), e.stateManager.loadState()
                        }))
                    }
                }, {
                    key: "componentDidUpdate",
                    value: function(e, t) {
                        t.canvasIsReady !== this.state.canvasIsReady && this.state.canvasIsReady && this.onCanvasReady()
                    }
                }, {
                    key: "onCanvasReady",
                    value: function() {
                        var e = this.props.options,
                            t = e.contains_geo_nodes;
                        e.openWithSnapshot ? this.canvas.getInstance().showSnapshot() : t && this.canvas.getInstance().placeFixedGeoPositions(), this.browserView.getInstance().graphLoaded && this.browserView.getInstance().graphLoaded(), this.props.options.isNew && (this.props.options.exploreOnly ? this.appContext.dispatcher.emit("updateEditMode", Z.a.EXPLORE) : this.appContext.dispatcher.emit("updateEditMode", Z.a.EDIT))
                    }
                }, {
                    key: "subscribeToGraphHistory",
                    value: function(e) {
                        this.appContext.dispatcher.bind("onSignal", e)
                    }
                }, {
                    key: "applySignal",
                    value: function(e) {
                        this.appContext.GraphHistory.push(e, !0)
                    }
                }, {
                    key: "tryUpdateSnapshot",
                    value: function(e) {
                        var t = e.zoom,
                            n = e.positions;
                        this.appContext.uiStore.get("editMode") === Z.a.EDIT && this.canvas.getInstance().updateSnapshot(n, t)
                    }
                }, {
                    key: "onSaveGraph",
                    value: function(e, t) {
                        this.props.onSaveGraph(e.takeSnapshot(), e, t)
                    }
                }, {
                    key: "showAddDialog",
                    value: function(e) {
                        this.setState({
                            showPanel: "add",
                            panelProps: {
                                initPosition: e || {
                                    x: 0,
                                    y: 0
                                }
                            }
                        })
                    }
                }, {
                    key: "showExpandDialog",
                    value: function(e) {
                        var t = e.nodes,
                            n = e.position;
                        this.setState({
                            showPanel: "expand",
                            panelProps: {
                                nodes: t,
                                position: n || {
                                    x: 0,
                                    y: 0
                                }
                            }
                        })
                    }
                }, {
                    key: "showCartographyPanel",
                    value: function() {
                        var e = {
                            nodeTypes: JSON.parse(JSON.stringify(this.appContext.GraphHistory.getNodeTypes())),
                            edgeTypes: this.appContext.GraphHistory.getEdgeTypes()
                        };
                        this.setState({
                            showPanel: "cartography",
                            panelProps: {
                                initialCartographyState: e,
                                isCartoPanelDirty: !0
                            }
                        })
                    }
                }, {
                    key: "hideDialog",
                    value: function() {
                        this.setState({
                            showPanel: null,
                            panelProps: null
                        })
                    }
                }, {
                    key: "hideCartographyPanel",
                    value: function() {
                        var e = this;
                        this.hideDialog();
                        var t = this.state.panelProps,
                            n = t.isCartoPanelDirty,
                            r = t.initialCartographyState;
                        if (this.appContext.dispatcher.emit("updateEditMode", Z.a.EDIT), n) {
                            var o = r.nodeTypes,
                                a = r.edgeTypes;
                            o.forEach((function(t) {
                                var n = e.appContext.GraphHistory.getNodeTypes().find((function(e) {
                                    return e.id === t.id
                                }));
                                Object.assign(n, t)
                            })), a.forEach((function(t) {
                                var n = e.appContext.GraphHistory.getEdgeTypes().find((function(e) {
                                    return e.id === t.id
                                }));
                                Object.assign(n, t)
                            })), this.onCartographyPreview()
                        }
                    }
                }, {
                    key: "handleNodeCreate",
                    value: function(e) {
                        var t = this,
                            n = e.nodeName,
                            r = e.nodeType,
                            o = this.state.panelProps.initPosition;
                        this.appContext.GraphHistory.createNode({
                            name: n,
                            type: r
                        }, o, (function(e, n, r) {
                            t.hideDialog(), e ? Object(bt.displayMessage)(t.appContext.GraphHistory, "Error", "Unable to add this node.<br/>" + e.message) : n && (r ? Object(bt.displayMessage)(t.appContext.GraphHistory, "Private Node", "This node is private, it will be published when you save this graph.") : Object(bt.displayMessage)(t.appContext.GraphHistory, "Existing Node", "Adding an existing node in the Hub, with all existing properties."))
                        }))
                    }
                }, {
                    key: "handleAddExistingNode",
                    value: function(e) {
                        var t = e.data,
                            n = e.nodeType,
                            r = this.state.panelProps.initPosition,
                            o = this.appContext.graphStore;
                        this.hideDialog(), n && (o.get("belongsToHub") ? this.appContext.GraphHistory.importExistingNode(t, r) : this.appContext.GraphHistory.importNode(t, n), o.get("belongsToHub") && 1 == o.get("status") && t && 2 == t.status && Object(bt.displayMessage)(this.appContext.GraphHistory, "Private Node", "This node is private, it will be published when you save this graph."))
                    }
                }, {
                    key: "handleAddPath",
                    value: function(e, t) {
                        var n = this,
                            r = this.state.panelProps.initPosition,
                            o = this.state.isLoading,
                            a = this.appContext.GraphHistory;
                        e && t && !o && (this.setState({
                            isLoading: !0
                        }), Object(f.getPathsInHub)(this.props.options.graphHub.id, e.id, t.id, (function(o) {
                            if (n.setState({
                                    isLoading: !1
                                }), o.paths && 0 !== o.paths.length) {
                                var i = o.nodes,
                                    s = o.edges,
                                    c = 0;
                                for (var l in i) Object.prototype.hasOwnProperty.call(i, l) && (c += 30, a.importExistingNode(i[l], {
                                    x: r.x + c,
                                    y: r.y + c
                                }));
                                for (var d in s) Object.prototype.hasOwnProperty.call(s, d) && a.importHubEdge(s[d]);
                                n.hideDialog()
                            } else Object(bt.confirm)(a, "No Paths Found", "We couldn't find a path between these two nodes.<br/>Do you want to add them to the graph as two isolated nodes?", (function() {
                                a.importHubNode(e), a.importHubNode(t), n.hideDialog()
                            }), (function() {}), null, null, "ADD")
                        }), (function(e) {
                            console.error(e), n.hideDialog()
                        })))
                    }
                }, {
                    key: "onCartographyPreview",
                    value: function() {
                        this.canvas.getInstance().preview()
                    }
                }, {
                    key: "render",
                    value: function() {
                        var e = this,
                            t = this.props,
                            n = t.authenticatedUser,
                            r = t.options,
                            o = r.isWebGL,
                            a = r.openWithSnapshot,
                            i = r.graph_options,
                            s = this.state,
                            d = s.canvasIsReady,
                            u = s.showPanel,
                            p = s.panelProps,
                            f = s.isLoading,
                            h = i.for_hub;
                        return l.a.createElement(B.a.Provider, {
                            value: this.appContext
                        }, l.a.createElement(rr, {
                            options: r
                        }), l.a.createElement(K, {
                            ref: function(t) {
                                return e.coordinator = t
                            },
                            showSpreadsheet: !0,
                            onAnalysisCustomizeToggle: function() {
                                "analysis" !== u ? e.setState({
                                    showPanel: "analysis"
                                }) : e.hideDialog()
                            },
                            options: this.props.options
                        }), o ? l.a.createElement(ue, {
                            ref: function(t) {
                                return e.canvas = t
                            },
                            openWithSnapshot: a
                        }) : l.a.createElement(oe, {
                            ref: function(t) {
                                return e.canvas = t
                            },
                            openWithSnapshot: a,
                            onCreateNewNode: function(t) {
                                return e.showAddDialog(t)
                            }
                        }), h && l.a.createElement(c.Fragment, null, l.a.createElement(Be, {
                            ref: function(t) {
                                return e.spreadsheet = t
                            }
                        }), l.a.createElement(Ye, {
                            ref: function(t) {
                                return e.spreadsheetSwitcher = t
                            }
                        })), d && l.a.createElement(c.Fragment, null, h ? l.a.createElement(Se, {
                            ref: function(t) {
                                return e.browserView = t
                            },
                            canvas: this.canvas.getInstance(),
                            spreadsheet: this.spreadsheet && this.spreadsheet.getInstance(),
                            options: this.props.options
                        }) : l.a.createElement(be, {
                            ref: function(t) {
                                return e.browserView = t
                            },
                            canvas: this.canvas.getInstance(),
                            viewCoordinator: this.coordinator.getInstance(),
                            onSaveGraph: this.onSaveGraph,
                            onShowCartographyPanel: this.showCartographyPanel,
                            onHideCartographyPanel: this.hideCartographyPanel,
                            options: this.props.options
                        }), l.a.createElement(Pe, null)), "add" === u && l.a.createElement(jt, {
                            authenticatedUser: n,
                            initPosition: p.initPosition,
                            hub: this.props.options.graphHub,
                            isNewGraph: this.props.options.isNew,
                            onCloseButtonClick: this.hideDialog,
                            onNodeCreate: this.handleNodeCreate,
                            onAddExistingNode: this.handleAddExistingNode,
                            onAddPath: this.handleAddPath,
                            isLoading: !!f
                        }), "expand" === u && l.a.createElement(hr, {
                            selectedNodes: p.nodes,
                            onCloseButtonClick: this.hideDialog
                        }), "cartography" === u && l.a.createElement(en, {
                            onPreview: this.onCartographyPreview,
                            onCloseButtonClick: this.hideCartographyPanel,
                            onSave: function() {
                                e.canvas.getInstance().preview(), e.appContext.dispatcher.emit("updateEditMode", Z.a.EDIT), e.hideDialog()
                            }
                        }), "analysis" === u && l.a.createElement(pn, {
                            onToggle: this.hideDialog
                        }))
                    }
                }]) && gr(t.prototype, n), r && gr(t, r), a
            }(l.a.Component);

            function Or(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function Er(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function jr(e, t) {
                return (jr = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function Sr(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = kr(e);
                    if (t) {
                        var o = kr(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return xr(this, n)
                }
            }

            function xr(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function kr(e) {
                return (kr = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            var Cr = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && jr(e, t)
                }(a, e);
                var t, n, r, o = Sr(a);

                function a() {
                    return Or(this, a), o.apply(this, arguments)
                }
                return t = a, (n = [{
                    key: "getLicenseText",
                    value: function() {
                        var e = this.props.options.license;
                        return ["Graph License: Creative Commons", " ", e.license_cc_by && "Attribution", e.license_cc_nc && "-NonCommercial", e.license_cc_sa && "-ShareAlike", e.license_cc_nd && "-NoDerivatives", " ", "4.0 International"].filter(Boolean).join("")
                    }
                }, {
                    key: "getLicenseSymbols",
                    value: function() {
                        var e = this.props.options.license,
                            t = e.license_cc_by,
                            n = e.license_cc_nc,
                            r = e.license_cc_sa,
                            o = e.license_cc_nd,
                            a = this.props.options.graphHasImage ? "_white" : "",
                            i = [t && "/assets/license_cc_by".concat(a, ".svg"), r && "/assets/license_cc_sa".concat(a, ".svg"), o && "/assets/license_cc_nd".concat(a, ".svg"), n && "/assets/license_cc_nc".concat(a, ".svg")].filter(Boolean);
                        return l.a.createElement(l.a.Fragment, null, l.a.createElement("img", {
                            src: "/assets/license_cc_white.svg",
                            className: "cc-icon-small"
                        }), i.map((function(e, t) {
                            return l.a.createElement("img", {
                                key: t,
                                src: e,
                                className: "cc-icon-small"
                            })
                        })))
                    }
                }, {
                    key: "render",
                    value: function() {
                        var e, t = this.props,
                            n = t.isLoading,
                            r = t.options,
                            o = r.graphImageURL,
                            a = r.graphHasImage,
                            i = r.graphHub,
                            s = r.graphEmbed,
                            c = r.modelName,
                            d = r.graphSubTitle,
                            u = r.nodesCount,
                            p = r.graphStatus,
                            f = r.isCommunity,
                            h = r.imageRef,
                            g = r.imageRefURL,
                            m = r.showStories,
                            y = r.coverStories,
                            b = function(e) {
                                var t = {};
                                for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n.replace(/(_\w)/g, (function(e) {
                                    return e[1].toUpperCase()
                                }))] = e[n]);
                                return t
                            }(r.graph_options).graphUsers;
                        if (i && i.linkTo) {
                            var v = i.linkTo.match(/<a .*href="([^"]+)">/);
                            e = v ? v[1] : i.linkTo
                        }
                        return l.a.createElement("div", {
                            className: "graph-cover",
                            style: {
                                backgroundImage: "url(".concat(o, ")")
                            }
                        }, l.a.createElement("div", {
                            className: Ke()("inner", {
                                scrim: a
                            })
                        }, l.a.createElement("div", {
                            className: "row"
                        }, l.a.createElement("div", {
                            className: Ke()("cover-top", {
                                "scrim-top": a
                            })
                        }, i && l.a.createElement("div", {
                            className: "hub"
                        }, s ? i.name : l.a.createElement("a", {
                            href: e
                        }, i.name))), l.a.createElement("div", {
                            className: "cover-body large-12"
                        }, l.a.createElement("h1", {
                            className: "shadow"
                        }, c), l.a.createElement("div", {
                            className: "lead shadow"
                        }, d), l.a.createElement("div", {
                            className: "users"
                        }, b.map((function(e) {
                            var t = e.id,
                                n = e.display_name,
                                r = e.img_path;
                            return s ? l.a.createElement("img", {
                                key: t,
                                src: r,
                                alt: n,
                                className: "avatar tipped-avatar"
                            }) : l.a.createElement("a", {
                                key: t,
                                href: "/users/".concat(t),
                                target: "_blank"
                            }, l.a.createElement("img", {
                                src: r,
                                alt: n,
                                className: "avatar tipped-avatar"
                            }))
                        }))), n ? l.a.createElement("a", {
                            className: "button show-graph"
                        }, "Loading ", u, " vertex...") : l.a.createElement("a", {
                            href: "#",
                            onClick: this.props.onShowGraphClick,
                            className: "button show-graph"
                        }, "View Graph"), l.a.createElement("p", {
                            className: "info"
                        }, {
                            0: "WORK IN PROGRESS",
                            1: "",
                            2: "PRIVATE"
                        }[p]), l.a.createElement("p", {
                            className: "mobile-notice"
                        }, l.a.createElement("em", null, "Best experienced on a large screen device.")), f && l.a.createElement("p", {
                            className: "info"
                        }, "Community Graph"))), l.a.createElement("div", {
                            className: "logo-canvas"
                        }, s ? "OntoGraph" : l.a.createElement("a", {
                            href: "/",
                            target: "_blank"
                        }, "OntoGraph")), l.a.createElement("div", {
                            className: "license-block"
                        }, h && g && l.a.createElement("span", {
                            className: "image-credit"
                        }, "Photo by", " ", l.a.createElement("a", {
                            target: "_blank",
                            href: g
                        }, h)), l.a.createElement("span", {
                            className: "license",
                            title: this.getLicenseText()
                        }, this.getLicenseSymbols())), m && y && y.length && l.a.createElement("div", {
                            title: "Featured stories from this graph"
                        }, l.a.createElement("ul", {
                            className: "cover-stories"
                        }, y.map((function(e) {
                            var t = e.id,
                                n = e.image,
                                r = e.title;
                            return l.a.createElement("li", {
                                className: "cover-story",
                                "data-id": t
                            }, l.a.createElement("a", {
                                href: "/stories/".concat(t)
                            }, l.a.createElement("img", {
                                src: n
                            })), l.a.createElement("h5", {
                                className: "title"
                            }, r))
                        }))))))
                    }
                }]) && Er(t.prototype, n), r && Er(t, r), a
            }(l.a.Component);

            function Nr(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function Tr(e, t) {
                return (Tr = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function Lr(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = Dr(e);
                    if (t) {
                        var o = Dr(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return Pr(this, n)
                }
            }

            function Pr(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return Ar(e)
            }

            function Ar(e) {
                if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                return e
            }

            function Dr(e) {
                return (Dr = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }
            var Mr = function(e) {
                ! function(e, t) {
                    if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                    e.prototype = Object.create(t && t.prototype, {
                        constructor: {
                            value: e,
                            writable: !0,
                            configurable: !0
                        }
                    }), t && Tr(e, t)
                }(a, e);
                var t, n, r, o = Lr(a);

                function a(e) {
                    var t;
                    return function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }(this, a), (t = o.call(this, e)).graph = void 0, t.state = {
                        isLoading: !0,
                        showGraph: !1,
                        showCover: !e.options.isNew,
                        error: null,
                        graphData: {
                            nodeTypes: [],
                            edgeTypes: []
                        },
                        connectedUsers: []
                    }, t.handleSuccess = t.handleSuccess.bind(Ar(t)), t.handleFail = t.handleFail.bind(Ar(t)), t.handleShowGraphClick = t.handleShowGraphClick.bind(Ar(t)), t.connectToLiveServer = t.connectToLiveServer.bind(Ar(t)), t.handleOnSignal = t.handleOnSignal.bind(Ar(t)), t.handleLiveMessage = t.handleLiveMessage.bind(Ar(t)), t.handleSaveGraph = t.handleSaveGraph.bind(Ar(t)), t.fetchGraphData = t.fetchGraphData.bind(Ar(t)), t
                }
                return t = a, (n = [{
                    key: "componentDidMount",
                    value: function() {
                        if (this.props.options.isNew) Object(f.getEmptyGraph)(window.location.search, this.handleSuccess, this.handleFail);
                        else {
                            var e = this.props.options.s3URL;
                            e ? $.getJSON(e, this.handleSuccess, this.handleFail) : this.fetchGraphData(this.handleSuccess, this.handleFail)
                        }
                    }
                }, {
                    key: "fetchGraphData",
                    value: function(e, t) {
                        ! function(e, t) {
                            var n = window.location.pathname.replace(/\/graphs\//, "").replace(/\/embed/, ""),
                                r = [];
                            location.search ? (r.push(location.search), r.push("&")) : r.push("?"), r.push("fromgraph=true"), Object(f.getGraph)(n, r.join(""), e, t)
                        }(e, t)
                    }
                }, {
                    key: "handleSuccess",
                    value: function(e) {
                        var t = this,
                            n = e.graph;
                        this.setState({
                            graphData: n,
                            isLoading: !1
                        }, (function() {
                            ("true" === new URLSearchParams(window.location.search).get("auto") || t.props.options.isNew) && t.showGraph()
                        }))
                    }
                }, {
                    key: "handleFail",
                    value: function() {
                        this.setState({
                            isLoading: !1,
                            error: !0
                        })
                    }
                }, {
                    key: "handleShowGraphClick",
                    value: function(e) {
                        e.preventDefault(), this.showGraph()
                    }
                }, {
                    key: "showGraph",
                    value: function() {
                        var e = this;
                        this.setState({
                            showGraph: !0,
                            showCover: !1
                        }), this.props.options.isNew || (this.connectToLiveServer(), requestAnimationFrame((function() {
                            e.graph.subscribeToGraphHistory(e.handleOnSignal)
                        })))
                    }
                }, {
                    key: "getAuthenticatedUser",
                    value: function() {
                        return this.props.options.graph_options.user
                    }
                }, {
                    key: "connectToLiveServer",
                    value: function() {
                        var e = w.a.get("gc_verification_token"),
                            t = this.getAuthenticatedUser(),
                            n = this.state.graphData.id;
                        t && q({
                            user: t,
                            verificationToken: e,
                            channel: n,
                            onMessage: this.handleLiveMessage
                        })
                    }
                }, {
                    key: "handleLiveMessage",
                    value: function(e) {
                        var t = this,
                            n = e.type,
                            r = e.message;
                        switch (n) {
                            case "signal":
                                var o = r,
                                    a = o.signals,
                                    i = o.snapshot;
                                a.forEach((function(e) {
                                    t.graph.applySignal(e)
                                })), i && this.graph.tryUpdateSnapshot(i);
                                break;
                            case "activeUsers":
                                this.setState({
                                    connectedUsers: r
                                })
                        }
                    }
                }, {
                    key: "handleOnSignal",
                    value: function(e) {
                        I(e)
                    }
                }, {
                    key: "handleSaveGraph",
                    value: function(e) {
                        var t = e.graph;
                        t.layout && I({
                            snapshot: {
                                zoom: t.layout.zoom,
                                positions: t.positions
                            },
                            signals: []
                        })
                    }
                }, {
                    key: "render",
                    value: function() {
                        var e = this,
                            t = this.state,
                            n = t.isLoading,
                            r = t.graphData,
                            o = t.showCover,
                            a = t.showGraph,
                            i = t.connectedUsers,
                            s = this.getAuthenticatedUser();
                        return l.a.createElement("div", null, o && l.a.createElement(Cr, {
                            isLoading: n,
                            onShowGraphClick: this.handleShowGraphClick,
                            options: this.props.options
                        }), i.length > 1 && l.a.createElement(R, {
                            authenticatedUser: s,
                            users: i
                        }), !n && a && l.a.createElement(wr, {
                            onSaveGraph: function(t, n, r) {
                                return e.handleSaveGraph(r)
                            },
                            authenticatedUser: s,
                            ref: function(t) {
                                return e.graph = t
                            },
                            graphData: r,
                            options: this.props.options
                        }))
                    }
                }]) && Nr(t.prototype, n), r && Nr(t, r), a
            }(l.a.Component);

            function qr(e) {
                return new Date(1e3 * e).toLocaleDateString("en-US", {
                    year: "numeric",
                    month: "short",
                    day: "numeric"
                })
            }
            var Ir = {
                    graph: function(e) {
                        var t, n, r, o, a = e.data,
                            i = e.hubID;
                        return l.a.createElement("div", {
                            className: "search-result graph"
                        }, l.a.createElement("div", {
                            className: "icon"
                        }, l.a.createElement("img", {
                            src: "/assets/icons/graph_icon2.svg",
                            alt: "Graph icon",
                            className: "no-radius"
                        })), l.a.createElement("div", {
                            className: "content"
                        }, l.a.createElement("a", {
                            className: "title ellipsis",
                            href: "/graphs/".concat(a.id),
                            dangerouslySetInnerHTML: {
                                __html: a.title
                            }
                        }), l.a.createElement("div", null, a.image && l.a.createElement("img", {
                            className: "image",
                            src: a.image,
                            alt: ""
                        }), l.a.createElement("div", null, a.subtitle && l.a.createElement("div", {
                            className: "subtitle ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: a.subtitle
                            }
                        }), a.description && l.a.createElement("div", {
                            className: "description ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: a.description
                            }
                        }), l.a.createElement("ul", {
                            className: "metadata"
                        }, null !== a && void 0 !== a && null !== (t = a.hub) && void 0 !== t && t.name && !i ? l.a.createElement("li", null, "In ", null === (n = a.hub) || void 0 === n ? void 0 : n.name) : null !== a && void 0 !== a && null !== (r = a.user) && void 0 !== r && r.name ? l.a.createElement("li", null, "Graph by ", null === (o = a.user) || void 0 === o ? void 0 : o.name) : null, l.a.createElement("li", null, qr(+a.created_at)))))))
                    },
                    hub: function(e) {
                        var t = e.data;
                        return l.a.createElement("div", {
                            className: "search-result hub"
                        }, l.a.createElement("div", {
                            className: "icon"
                        }, l.a.createElement("img", {
                            src: "/assets/icons/hub_icon.svg",
                            alt: "Hub icon",
                            className: "no-radius"
                        })), l.a.createElement("div", {
                            className: "content"
                        }, l.a.createElement("a", {
                            className: "title ellipsis",
                            href: "/hubs/".concat(t.id),
                            dangerouslySetInnerHTML: {
                                __html: t.title
                            }
                        }), l.a.createElement("div", null, t.image && l.a.createElement("img", {
                            className: "image",
                            src: t.image,
                            alt: ""
                        }), l.a.createElement("div", null, t.subtitle && l.a.createElement("div", {
                            className: "subtitle ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: t.subtitle
                            }
                        }), t.description && l.a.createElement("div", {
                            className: "description ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: t.description
                            }
                        }), l.a.createElement("ul", {
                            className: "metadata"
                        }, l.a.createElement("li", null, qr(+t.created_at)))))))
                    },
                    node: function(e) {
                        var t = e.data,
                            n = e.hubID;
                        return l.a.createElement("div", {
                            className: "search-result node"
                        }, l.a.createElement("div", {
                            className: "icon"
                        }, l.a.createElement("span", {
                            className: "type-icon",
                            style: {
                                backgroundColor: t.type.color || "#ddd"
                            }
                        }, (t.type.name[0] || "").toUpperCase())), l.a.createElement("div", {
                            className: " content"
                        }, l.a.createElement("a", {
                            className: "title ellipsis",
                            href: "/nodes/".concat(t.id),
                            dangerouslySetInnerHTML: {
                                __html: t.title
                            }
                        }), l.a.createElement("div", null, t.image && l.a.createElement("img", {
                            className: "image",
                            src: t.image,
                            alt: ""
                        }), l.a.createElement("div", null, t.description && l.a.createElement("div", {
                            className: "description ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: t.description
                            }
                        }), l.a.createElement("ul", {
                            className: "metadata"
                        }, l.a.createElement("li", null, t.type.name, !n && (!!t.hub || t.graph.length > 0) && l.a.createElement(l.a.Fragment, null, " in ", t.hub ? t.hub.name : t.graph[0].name)), l.a.createElement("li", null, qr(+t.created_at)))))))
                    },
                    story: function(e) {
                        var t = e.data;
                        return l.a.createElement("div", {
                            className: "search-result story"
                        }, l.a.createElement("div", {
                            className: "icon"
                        }, l.a.createElement("img", {
                            src: "/assets/icons/story_icon.svg",
                            alt: "Story icon"
                        })), l.a.createElement("div", {
                            className: "content"
                        }, l.a.createElement("a", {
                            className: "title ellipsis",
                            href: "/stories/".concat(t.id),
                            dangerouslySetInnerHTML: {
                                __html: t.title
                            }
                        }), l.a.createElement("div", null, t.image && l.a.createElement("img", {
                            className: "image",
                            src: t.image,
                            alt: ""
                        }), l.a.createElement("div", null, t.subtitle && l.a.createElement("div", {
                            className: "subtitle ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: t.subtitle
                            }
                        }), t.description && l.a.createElement("div", {
                            className: "description ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: t.description
                            }
                        }), l.a.createElement("ul", {
                            className: " metadata"
                        }, l.a.createElement("li", null, "Story by ", t.user.name, " in ", t.graph.name), l.a.createElement("li", null, qr(+t.created_at)))))))
                    },
                    user: function(e) {
                        var t = e.data;
                        return l.a.createElement("div", {
                            className: "search-result user"
                        }, l.a.createElement("div", {
                            className: "icon"
                        }, l.a.createElement("img", {
                            src: "/assets/icons/user_icon.svg",
                            alt: "User icon"
                        })), l.a.createElement("div", {
                            className: "content"
                        }, l.a.createElement("a", {
                            className: "title ellipsis",
                            href: "/users/".concat(t.id),
                            dangerouslySetInnerHTML: {
                                __html: t.title
                            }
                        }), l.a.createElement("div", null, t.image && l.a.createElement("img", {
                            className: "image",
                            src: t.image,
                            alt: ""
                        }), l.a.createElement("div", null, t.subtitle && l.a.createElement("div", {
                            className: "subtitle ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: t.subtitle
                            }
                        }), t.description && l.a.createElement("div", {
                            className: "description ellipsis",
                            dangerouslySetInnerHTML: {
                                __html: t.description
                            }
                        }), l.a.createElement("ul", {
                            className: "metadata"
                        }, l.a.createElement("li", null, qr(+t.created_at)))))))
                    }
                },
                Rr = function(e) {
                    var t = e.data,
                        n = e.hubID,
                        r = Ir[t.obj.toLowerCase()];
                    return r ? l.a.createElement(r, {
                        data: t,
                        hubID: n
                    }) : null
                };

            function Br(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return Fr(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Fr(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function Fr(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var Gr = function(e, t) {
                var n = Br(Object(c.useState)(e), 2),
                    r = n[0],
                    o = n[1];
                return Object(c.useEffect)((function() {
                    var n = setTimeout((function() {
                        e !== r && o(e)
                    }), t);
                    return function() {
                        clearTimeout(n)
                    }
                }), [e, t]), [r, o]
            };

            function Hr(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Ur(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Hr(Object(n), !0).forEach((function(t) {
                        zr(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Hr(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function zr(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function Wr(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return Yr(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Yr(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function Yr(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }
            var Vr = 25;

            function Xr(e) {
                var t, n = {
                        q: e.query,
                        in: e.types,
                        nt: e.nodeTypes,
                        l: e.json ? e.limit : null,
                        skip: e.json ? e.skip : null,
                        h: e.hub ? e.hub.id : null
                    },
                    r = (t = n, Object(hn.flatMap)(t, (function(e, t) {
                        return Array.isArray(e) ? e.map((function(e) {
                            return ["".concat(t, "[]"), e]
                        })) : "string" === typeof e && e.length ? [
                            [t, e]
                        ] : "number" === typeof e ? [
                            [t, e + ""]
                        ] : []
                    })).map((function(e) {
                        return e.map((function(e) {
                            return encodeURIComponent(e + "")
                        })).join("=")
                    })).join("&"));
                return (e.json ? "/search.json" : window.location.pathname) + (r ? "?" + r : "")
            }
            var Kr = function(e) {
                    var t, n = e.initialQuery,
                        r = e.initialTypes,
                        o = e.initialNodeTypes,
                        a = e.hub,
                        i = a ? ["Graph", "Node"] : ["Graph", "Node", "Hub", "User", "Story"],
                        s = Wr(Object(c.useState)(n), 2),
                        d = s[0],
                        u = s[1],
                        p = Wr(Gr(d, 500), 2),
                        f = p[0],
                        h = p[1],
                        g = Wr(Object(c.useState)(r && r.length > 0 ? r : i), 2),
                        m = g[0],
                        y = g[1],
                        b = Wr(Object(c.useState)(o || []), 2),
                        v = b[0],
                        _ = b[1],
                        w = Object(c.useRef)(null),
                        O = Wr(Object(c.useState)(!0), 2),
                        E = O[0],
                        j = O[1],
                        S = Wr(Object(c.useState)({
                            type: "ok"
                        }), 2),
                        x = S[0],
                        k = S[1],
                        C = Wr(Object(c.useState)(null), 2),
                        N = C[0],
                        T = C[1],
                        L = i.filter((function(e) {
                            var t;
                            return (null === N || void 0 === N || null === (t = N.aggregations["@labels"].buckets.find((function(t) {
                                return t.key === e
                            }))) || void 0 === t ? void 0 : t.doc_count) || 0
                        })),
                        P = Object(c.useCallback)((function(e, t, n) {
                            "loading" === x.type && x.abort();
                            var r = e.trim();
                            if (window.history.pushState(history.state, document.title, Xr({
                                    query: e,
                                    types: t,
                                    nodeTypes: n
                                })), r.length) {
                                var o = An(Xr({
                                        limit: 26,
                                        query: e,
                                        types: t,
                                        nodeTypes: n,
                                        json: !0,
                                        hub: a
                                    })),
                                    i = o.abort,
                                    s = o.promise;
                                k({
                                    type: "loading",
                                    abort: i
                                }), s.then((function(e) {
                                    return e.json()
                                })).then((function(e) {
                                    k({
                                        type: "ok"
                                    }), j(e.hits.length <= Vr), T(Ur(Ur({}, e), {}, {
                                        hits: e.hits.slice(0, Vr)
                                    }))
                                })).catch((function(e) {
                                    "AbortError" !== e.name && k({
                                        type: "error",
                                        message: e.message
                                    })
                                }))
                            } else T(null)
                        }), [f, m, v, a]);

                    function A() {
                        var e = document.getElementById("root");
                        if (window.scrollY + window.innerHeight > e.offsetHeight - 800 && N && "loading" !== x.type && !E) {
                            var t = An(Xr({
                                    limit: 26,
                                    query: d,
                                    types: m,
                                    hub: a,
                                    nodeTypes: v,
                                    skip: N.hits.length,
                                    json: !0
                                })),
                                n = t.abort,
                                r = t.promise;
                            k({
                                type: "loading",
                                abort: n,
                                paginating: !0
                            }), r.then((function(e) {
                                return e.json()
                            })).then((function(e) {
                                k({
                                    type: "ok"
                                }), T(Ur(Ur({}, N), {}, {
                                    hits: N.hits.concat(e.hits.slice(0, Vr))
                                })), j(e.hits.length <= Vr)
                            })).catch((function(e) {
                                "AbortError" !== e.name && k({
                                    type: "error",
                                    message: e.message
                                })
                            }))
                        }
                    }
                    return Object(c.useEffect)((function() {
                        y(i), _([])
                    }), [f]), Object(c.useEffect)((function() {
                        P(f, m, v)
                    }), [f, m, v]), Object(c.useEffect)((function() {
                        !m.includes("Node") && v.length && _([])
                    }), [m]), Object(c.useEffect)((function() {
                        return window.addEventListener("scroll", A),
                            function() {
                                window.removeEventListener("scroll", A)
                            }
                    })), Object(c.useEffect)((function() {
                        w.current && w.current.focus()
                    }), [w.current]), Object(c.useEffect)((function() {
                        A()
                    }), [N]), l.a.createElement("section", {
                        className: "row"
                    }, l.a.createElement("header", null, l.a.createElement("form", {
                        method: "GET",
                        action: "",
                        onSubmit: function(e) {
                            e.preventDefault(), d !== f ? h(d) : P(f, m, v)
                        }
                    }, l.a.createElement("span", {
                        className: "search-wrapper"
                    }, l.a.createElement("img", {
                        src: "/assets/icons/search_icon2.svg",
                        alt: "Search"
                    }), l.a.createElement("input", {
                        ref: w,
                        type: "text",
                        name: "q",
                        placeholder: "Search OntoGraph",
                        value: d,
                        onChange: function(e) {
                            u(e.target.value)
                        }
                    })), L.length > 1 && l.a.createElement("div", {
                        className: "types"
                    }, L.map((function(e) {
                        return l.a.createElement("div", {
                            key: e,
                            className: "switch"
                        }, l.a.createElement("input", {
                            type: "checkbox",
                            className: "toggable",
                            id: "label-".concat(e),
                            checked: m.includes(e),
                            onChange: function() {
                                1 === m.length && m[0] === e ? y(i) : L.length <= m.length || !m.length ? y([e]) : m.includes(e) ? y(m.filter((function(t) {
                                    return t !== e
                                }))) : y(m.concat(e))
                            }
                        }), l.a.createElement("label", {
                            htmlFor: "label-".concat(e)
                        }, e))
                    }))))), l.a.createElement("main", null, l.a.createElement("section", {
                        className: "search-module columns large-9"
                    }, N && N.hits && (N.hits.length ? l.a.createElement("div", {
                        className: "results"
                    }, N.hits.map((function(e, t) {
                        return l.a.createElement(Rr, {
                            key: t,
                            data: e,
                            hubID: null === a || void 0 === a ? void 0 : a.id
                        })
                    }))) : l.a.createElement("span", null, "No result")), "loading" === x.type && (x.paginating ? l.a.createElement("div", {
                        className: "spinner"
                    }, l.a.createElement("img", {
                        src: "/assets/spinner.gif",
                        alt: "Spinner"
                    }), " Loading more results...") : l.a.createElement("div", {
                        className: "loader"
                    }, l.a.createElement("div", {
                        className: "spinner"
                    }, l.a.createElement("img", {
                        src: "/assets/spinner.gif",
                        alt: "Spinner"
                    }), " Searching for results...")))), N && (null === (t = N.hits) || void 0 === t ? void 0 : t.length) > 0 && N.aggregations && m.includes("Node") && l.a.createElement("aside", {
                        className: "search-aggs columns large-3"
                    }, N.aggregations.type.name && !!N.aggregations.type.name.buckets.length && l.a.createElement("section", null, l.a.createElement("h4", null, "Node types", l.a.createElement(On, {
                        tag: "span"
                    }, l.a.createElement("span", {
                        className: "ss-gizmo ss-info"
                    }), l.a.createElement("div", null, "Counts indicate the max number of results"))), N.aggregations.type.name.buckets.map((function(e) {
                        return l.a.createElement("div", {
                            key: e.key
                        }, l.a.createElement("input", {
                            type: "checkbox",
                            id: "bucket-".concat(e.key),
                            checked: v.includes(e.key),
                            onChange: function() {
                                y(["Node"]), v.includes(e.key) ? _(v.filter((function(t) {
                                    return t !== e.key
                                }))) : _(v.concat(e.key))
                            }
                        }), l.a.createElement("label", {
                            htmlFor: "bucket-".concat(e.key)
                        }, e.key, " (", e.doc_count, ")"))
                    }))))))
                },
                $r = n(10),
                Zr = n(72);

            function Jr(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Qr(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Jr(Object(n), !0).forEach((function(t) {
                        eo(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Jr(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function eo(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function to(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return no(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return no(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function no(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }

            function ro(e) {
                var t = document.createElement("div");
                return t.innerHTML = e, t.innerText
            }
            var oo = function(e) {
                    var t = e.node,
                        n = e.type,
                        r = e.onDelete;
                    return l.a.createElement("div", {
                        className: "node"
                    }, l.a.createElement("span", {
                        className: "icon",
                        style: {
                            background: n.color
                        }
                    }, (t.type || "?")[0].toUpperCase()), l.a.createElement("div", {
                        className: "text"
                    }, l.a.createElement("span", {
                        className: "name"
                    }, t.name), l.a.createElement("span", {
                        className: "type"
                    }, t.type)), r && l.a.createElement("span", {
                        className: "ss-gizmo ss-trash delete-edge-button",
                        onClick: function() {
                            return r()
                        }
                    }))
                },
                ao = function(e) {
                    var t = e.type,
                        n = e.edges,
                        r = e.nodeId,
                        o = e.hubId,
                        a = e.nodesIndex,
                        i = e.nodeTypesIndex,
                        s = e.availableNodeTypes,
                        d = e.onAddEdge,
                        u = e.onRemoveEdge,
                        p = e.isNodeUser,
                        f = e.isHubAdmin,
                        h = to(Object(c.useState)(null), 2),
                        g = h[0],
                        m = h[1],
                        y = Object(c.useMemo)((function() {
                            return !!g && !!g.extremity
                        }), [g]),
                        b = Object(c.useMemo)((function() {
                            return a[r]
                        }), [r, a]),
                        v = to(Object(c.useState)(!1), 2),
                        _ = v[0],
                        w = v[1],
                        O = to(Object(c.useState)(null), 2),
                        E = O[0],
                        j = O[1],
                        S = p && t.self_connect || f,
                        x = !!s.length,
                        k = Object(c.useMemo)((function() {
                            return Object(hn.keyBy)(n.map((function(e) {
                                return e.from === r ? e.to : e.from
                            })))
                        }), [n]);
                    return S && x || n.length ? l.a.createElement("div", {
                        key: t.id,
                        className: "edge-group"
                    }, l.a.createElement("div", {
                        className: "edge-type"
                    }, t.name.toUpperCase()), n.map((function(e) {
                        var t = e.from === r ? a[e.to] : a[e.from];
                        return l.a.createElement(oo, {
                            key: e.id,
                            node: t,
                            type: i[t.type_id],
                            onDelete: S ? function() {
                                return j(e)
                            } : void 0
                        })
                    })), S && l.a.createElement("button", {
                        className: "gc-btn btn-outline",
                        onClick: function() {
                            m({
                                properties: {}
                            })
                        }
                    }, "Add"), l.a.createElement("br", null), !!E && l.a.createElement(Ve, {
                        width: "40%",
                        showFooter: !0,
                        disableClose: _,
                        disableSubmit: _,
                        onCloseButtonClick: function() {
                            return !_ && j(null)
                        },
                        onSubmitButtonClick: function() {
                            Object($r.x)(o, r, {
                                sourceId: E.from,
                                targetId: E.to,
                                edgeTypeId: t.id
                            }, (function() {
                                u(E), w(!1), j(null)
                            })), w(!0)
                        },
                        labels: {
                            submit: "CONFIRM",
                            close: "Cancel"
                        }
                    }, l.a.createElement("h4", null, "Delete a relationship"), l.a.createElement("br", null), l.a.createElement("p", null, "Are you sure you want to delete this relationship?"), _ && l.a.createElement("div", {
                        style: {
                            position: "absolute",
                            inset: 0,
                            background: "#ffffffcc",
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "center"
                        }
                    }, l.a.createElement("span", {
                        className: "loading",
                        style: {
                            width: "1em",
                            height: "1em",
                            display: "inline-block",
                            marginRight: "0.3em"
                        }
                    }), " ", "Deleting the relationship...")), g && l.a.createElement(Ve, {
                        width: "40%",
                        showFooter: !0,
                        disableClose: _,
                        disableSubmit: !y || _,
                        onCloseButtonClick: function() {
                            return !_ && m(null)
                        },
                        onSubmitButtonClick: function() {
                            Object($r.s)(o, r, {
                                sourceId: g.reverted ? g.extremity.value : r,
                                targetId: g.reverted ? r : g.extremity.value,
                                edgeTypeId: t.id
                            }, (function(e) {
                                d(e), w(!1), m(null)
                            })), w(!0)
                        },
                        labels: {
                            submit: "ADD",
                            close: "Cancel"
                        }
                    }, l.a.createElement("h4", null, "Add a relationship"), l.a.createElement("br", null), l.a.createElement(oo, {
                        node: b,
                        type: i[b.type_id]
                    }), l.a.createElement("div", {
                        className: "edge"
                    }, l.a.createElement("div", {
                        className: "arrow"
                    }, !!t.directed && !!g.reverted && l.a.createElement("div", {
                        className: "top-head",
                        style: {
                            borderBottomColor: t.color
                        }
                    }), l.a.createElement("div", {
                        className: "body",
                        style: {
                            background: t.color
                        }
                    }), !!t.directed && !g.reverted && l.a.createElement("div", {
                        className: "bottom-head",
                        style: {
                            borderTopColor: t.color
                        }
                    })), l.a.createElement("div", {
                        className: "type"
                    }, t.name, !!t.directed && l.a.createElement("a", {
                        className: "action",
                        href: "#",
                        onClick: function(e) {
                            e.preventDefault(), m(Qr(Qr({}, g), {}, {
                                reverted: !g.reverted
                            }))
                        }
                    }, "Toggle direction"))), l.a.createElement(jn.a, {
                        isClearable: !0,
                        value: g.extremity,
                        onChange: function(e) {
                            return m(Qr(Qr({}, g), {}, {
                                extremity: e
                            }))
                        },
                        loadOptions: function(e, t) {
                            Object($r.Cb)(e, s.map((function(e) {
                                return i[e].name
                            })), o, (function(e) {
                                return t(e.hits.filter((function(e) {
                                    return !k[e.id]
                                })).map((function(e) {
                                    return {
                                        value: e.id,
                                        label: "".concat(ro(e.title), " (").concat(ro(e.type.name), ")")
                                    }
                                })))
                            }))
                        },
                        placeholder: "Enter a node name"
                    }), _ && l.a.createElement("div", {
                        style: {
                            position: "absolute",
                            inset: 0,
                            background: "#ffffffcc",
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "center"
                        }
                    }, l.a.createElement("span", {
                        className: "loading",
                        style: {
                            width: "1em",
                            height: "1em",
                            display: "inline-block",
                            marginRight: "0.3em"
                        }
                    }), " ", "Adding the relationship..."))) : null
                },
                io = function(e) {
                    var t = e.hubId,
                        n = e.nodeId,
                        r = e.isHubAdmin,
                        o = e.user.user,
                        a = to(Object(c.useState)(null), 2),
                        i = a[0],
                        s = a[1],
                        d = to(Object(c.useState)(null), 2),
                        u = d[0],
                        p = d[1],
                        h = to(Object(c.useState)(null), 2),
                        g = h[0],
                        m = h[1],
                        y = to(Object(c.useState)(null), 2),
                        b = y[0],
                        v = y[1],
                        _ = to(Object(c.useState)(null), 2),
                        w = _[0],
                        O = _[1],
                        E = to(Object(c.useState)(null), 2),
                        j = E[0],
                        S = E[1],
                        x = to(Object(c.useState)(null), 2),
                        k = x[0],
                        C = x[1],
                        N = Object(c.useMemo)((function() {
                            return i && b ? Object(hn.groupBy)(i.edges.filter((function(e) {
                                return e.from === n || e.to === n
                            })), "type_id") : {}
                        }), [i, b]),
                        T = Object(c.useMemo)((function() {
                            return i ? Object(hn.keyBy)(i.nodes, "id") : {}
                        }), [i]),
                        L = Object(c.useMemo)((function() {
                            return i ? Object(hn.keyBy)(i.nodeTypes, "id") : {}
                        }), [i]),
                        P = Object(c.useMemo)((function() {
                            return w && w.properties.find((function(e) {
                                return e.name_alias === Zr.a
                            }))
                        }), [w]),
                        A = Object(c.useMemo)((function() {
                            return !!b && !!o && !!P && o.email === b.properties[P.name]
                        }), [b, o, P]),
                        D = Object(c.useMemo)((function() {
                            return !!i && !!b && !!w && !!u
                        }), [i, b, w, u]),
                        M = Object(c.useMemo)((function() {
                            return !Object(hn.isEqual)(b, g)
                        }), [b, g]),
                        q = to(Object(c.useState)(!1), 2),
                        I = q[0],
                        R = q[1];
                    return Object(c.useEffect)((function() {
                        t && Object(f.getHub)(t, (function(e) {
                            return e.hub ? s(e.hub) : S("Hub with id ".concat(t, " not found"))
                        }), (function(e) {
                            return S(e.message || "An error occurred loading the hub data.")
                        }))
                    }), [t]), Object(c.useEffect)((function() {
                        t && w && !u && Object($r.N)(t, (function(e) {
                            return e ? p(e.filter((function(e) {
                                var t = e.sourceId,
                                    n = e.targetId;
                                return t === w.id || n === w.id
                            })).reduce((function(e, t) {
                                var n = t.sourceId,
                                    r = t.targetId,
                                    o = t.relId;
                                return Qr(Qr({}, e), {}, eo({}, o, (e[o] || []).concat(n === w.id ? r : n)))
                            }), {})) : S("An error occurred loading the hub schema.")
                        }), (function(e) {
                            return S(e.message || "An error occurred loading the hub schema.")
                        }))
                    }), [t, w, u]), Object(c.useEffect)((function() {
                        if (n && i) {
                            var e = i.nodes.find((function(e) {
                                return e.id === n
                            }));
                            if (e) {
                                var t = i.nodeTypes.find((function(t) {
                                    return t.id === e.type_id
                                }));
                                t ? (v(e), m(e), O(t)) : S("Node with id ".concat(n, " not found in hub"))
                            } else S("Node with id ".concat(n, " not found in hub"))
                        }
                    }), [i, n]), j ? l.a.createElement("section", {
                        className: "row hubs-node-page"
                    }, l.a.createElement("main", null, l.a.createElement("section", {
                        className: "columns"
                    }, l.a.createElement("div", {
                        className: "message error-message"
                    }, l.a.createElement("span", null, j))))) : D ? l.a.createElement("section", {
                        className: "row hubs-node-page"
                    }, l.a.createElement("div", {
                        className: "node-meta"
                    }, l.a.createElement("a", {
                        href: "/hubs/".concat(i.id)
                    }, i.name), " / ", b.type), l.a.createElement("main", null, l.a.createElement("section", {
                        className: "columns large-8"
                    }, l.a.createElement("div", {
                        style: {
                            position: "relative"
                        }
                    }, l.a.createElement("div", null, l.a.createElement("input", {
                        id: "node-name",
                        type: "text",
                        value: b.name || "",
                        onChange: function(e) {
                            return v(Qr(Qr({}, b), {}, {
                                name: e.target.value || ""
                            }))
                        },
                        disabled: !(A || r)
                    })), l.a.createElement("div", null, l.a.createElement("label", {
                        htmlFor: "node-description"
                    }, "Description"), l.a.createElement("input", {
                        id: "node-description",
                        type: "text",
                        value: b.description || "",
                        onChange: function(e) {
                            return v(Qr(Qr({}, b), {}, {
                                description: e.target.value || ""
                            }))
                        },
                        disabled: !(A || r)
                    })), l.a.createElement("div", null, l.a.createElement("label", {
                        htmlFor: "node-description"
                    }, "Reference"), l.a.createElement("input", {
                        id: "node-reference",
                        type: "text",
                        value: b.reference || "",
                        onChange: function(e) {
                            return v(Qr(Qr({}, b), {}, {
                                reference: e.target.value || ""
                            }))
                        },
                        disabled: !(A || r)
                    })), l.a.createElement("br", null), l.a.createElement("h5", null, "Properties"), l.a.createElement("br", null), w.properties.map((function(e, t) {
                        var n = r || A && e.self_editable;
                        return l.a.createElement("div", {
                            key: t
                        }, l.a.createElement("label", {
                            htmlFor: "property-".concat(t, "-").concat(e.name)
                        }, e.name), l.a.createElement("input", {
                            id: "property-".concat(t, "-").concat(e.name),
                            type: "text",
                            value: ((null === b || void 0 === b ? void 0 : b.properties[e.name]) || "") + "",
                            onChange: function(t) {
                                return v(Qr(Qr({}, b), {}, {
                                    properties: t.target.value ? Qr(Qr({}, null === b || void 0 === b ? void 0 : b.properties), {}, eo({}, e.name, t.target.value)) : Object(hn.omit)(null === b || void 0 === b ? void 0 : b.properties, e.name)
                                }))
                            },
                            disabled: !n || e.name_alias === Zr.a
                        }))
                    })), (A || r) && l.a.createElement("div", {
                        className: "text-right properties-footer"
                    }, k && l.a.createElement("span", {
                        className: "success-message"
                    }, l.a.createElement("a", {
                        href: "#",
                        className: "close",
                        onClick: function(e) {
                            e.preventDefault(), C(null)
                        }
                    }, l.a.createElement("span", {
                        className: "ss-gizmo ss-check"
                    })), " ", k), l.a.createElement("button", {
                        className: "gc-btn gc-dlg-save btn-outline",
                        onClick: function() {
                            M && !I && (R(!0), Object(f.saveHubNode)(t, n, b, (function() {
                                R(!1), m(b), C("Changes saved successfully")
                            }), (function() {
                                return R(!1)
                            })))
                        },
                        disabled: !M || I
                    }, "Save")), I && l.a.createElement("div", {
                        style: {
                            position: "absolute",
                            inset: 0,
                            background: "#ffffffcc",
                            display: "flex",
                            alignItems: "end",
                            justifyContent: "center"
                        }
                    }, l.a.createElement("span", {
                        className: "loading",
                        style: {
                            width: "1em",
                            height: "1em",
                            display: "inline-block",
                            marginRight: "0.3em"
                        }
                    }), " ", "Saving...")), l.a.createElement("h5", null, "Relationships"), l.a.createElement("br", null), l.a.createElement("div", {
                        className: "edge-types"
                    }, i.edgeTypes.map((function(e) {
                        return l.a.createElement(ao, {
                            key: e.id,
                            type: e,
                            edges: N[e.id] || [],
                            nodeId: n,
                            hubId: t,
                            nodesIndex: T,
                            nodeTypesIndex: L,
                            availableNodeTypes: u[e.id] || [],
                            onAddEdge: function(e) {
                                return s(Qr(Qr({}, i), {}, {
                                    edges: i.edges.concat([e])
                                }))
                            },
                            onRemoveEdge: function(e) {
                                return s(Qr(Qr({}, i), {}, {
                                    edges: i.edges.filter((function(t) {
                                        return t.id !== e.id
                                    }))
                                }))
                            },
                            isNodeUser: A
                        })
                    })))), l.a.createElement("section", {
                        className: "columns large-4 upload-container"
                    }, b.image && l.a.createElement("div", {
                        className: "image-container"
                    }, l.a.createElement("img", {
                        src: b.image,
                        alt: ""
                    })), l.a.createElement("div", null, A && l.a.createElement(l.a.Fragment, null, l.a.createElement("input", {
                        type: "file",
                        id: "file",
                        onChange: function(e) {
                            var r = Array.from(e.target.files),
                                o = new FormData;
                            r.forEach((function(e) {
                                o.append("file", e)
                            })), fetch("/hubs/".concat(t, "/nodes/").concat(n, "/image"), {
                                method: "POST",
                                body: o,
                                headers: {
                                    "X-CSRF-Token": $('meta[name="csrf-token"]').attr("content")
                                }
                            }).then((function(e) {
                                return e.json()
                            })).then((function(e) {
                                v(Qr(Qr({}, b), {}, {
                                    image: e.url
                                }))
                            }))
                        }
                    }), l.a.createElement("label", {
                        htmlFor: "file"
                    }, "+ Add image")))))) : l.a.createElement("section", {
                        className: "row hubs-node-page"
                    }, l.a.createElement("main", null, l.a.createElement("section", {
                        className: "columns"
                    }, l.a.createElement("div", {
                        className: "message"
                    }, l.a.createElement("span", null, "Loading...")))))
                },
                so = n(570);

            function co(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            n.n(so).a.start();
            var lo = window.GraphCommons;

            function uo(e) {
                return e && "object" === typeof e && !Array.isArray(e) && (!e.constructor || e.constructor === Object)
            }

            function po(e) {
                for (var t = arguments.length, n = new Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++) n[r - 1] = arguments[r];
                if (!n.length) return e;
                var o = n.shift();
                if (uo(e) && uo(o))
                    for (var a in o) uo(o[a]) ? (e[a] || Object.assign(e, co({}, a, {})), po(e[a], o[a])) : Object.assign(e, co({}, a, o[a]));
                return po.apply(void 0, [e].concat(n))
            }
            lo.History = po(lo.History, History), lo.API = po(lo.API, f), lo.App = po(lo.App, h), lo.UI = po(lo.UI, g), lo.Utils = po(lo.Utils, m), lo.View = po(lo.View, y), lo.Components = {
                GraphPage: Mr,
                SearchPage: Kr,
                HubsNodePage: io
            };
            var fo = function() {
                    (window.location.pathname.includes("/stories") || window.location.search.includes("show=stories")) && Promise.resolve().then(n.bind(null, 55))
                },
                ho = document.location.href;
            window.addEventListener("DOMContentLoaded", (function() {
                fo();
                var e = document.querySelector("body");
                new MutationObserver((function(e) {
                    e.forEach((function() {
                        ho != document.location.href && (ho = document.location.href, fo())
                    }))
                })).observe(e, {
                    childList: !0,
                    subtree: !0
                })
            })), window.klaro = v, window.klaroConfig = b, v.setup(b), Object(r.a)(document).ready((function() {
                Object(r.a)("nav.main a.search").on("click", (function(e) {
                    Object(r.a)("div.page.search").fadeIn((function() {
                        Object(r.a)("input.query").focus()
                    })), e.preventDefault()
                })), Object(r.a)("nav.main a.about").on("click", (function(e) {
                    Object(r.a)("div.page.about").fadeIn((function() {})), e.preventDefault()
                })), Object(r.a)(document).keyup((function(e) {
                    27 === e.keyCode && Object(r.a)("div.page:visible").fadeOut()
                })), Object(r.a)("a.close-page").on("click", (function(e) {
                    Object(r.a)("div.page:visible").fadeOut(), e.preventDefault()
                }))
            }))
        },
        101: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return p
            }));
            var r = n(16),
                o = n(12),
                a = n.n(o),
                i = n(4),
                s = n(9),
                c = n(45),
                l = n(3),
                d = n(7),
                u = n(0),
                p = function(e, t, n) {
                    var o, p, f, h = e.uiStore,
                        g = e.graphStore,
                        m = e.GraphHistory,
                        y = e.dispatcher,
                        b = n || {},
                        v = "string" === typeof t ? document.querySelector(t) : t,
                        _ = 0,
                        w = [],
                        O = !1,
                        E = !1,
                        j = function(e) {
                            O || 27 === e.keyCode && m.clearSelectedNodes()
                        },
                        S = function() {
                            f.querySelector("button.gc-btn-close").addEventListener("click", (function() {
                                m.clearSelectedNodes()
                            }))
                        },
                        x = function() {
                            for (; f.firstChild;) f.removeChild(f.firstChild);
                            if (_ > 0) {
                                var t = !1;
                                if (g.get("isEmbed")) "false" === Object(u.L)("topbar") && (t = !0);
                                1 === _ ? function(t) {
                                    var n = w[0],
                                        r = !h.get("readOnly"),
                                        o = !h.get("readOnly") && (g.get("user").is_admin || g.get("user").can_edit),
                                        c = m.isNodeSaved(n) && 2 !== m.getNodeStatus(n),
                                        d = g.get("isHubGraph"),
                                        p = m.isNodeSaved(n),
                                        v = h.get("editMode") === s.a.EDIT,
                                        _ = m.getRenderingController().isLocked(n),
                                        O = {
                                            id: n,
                                            editable: r,
                                            canEdit: o,
                                            allowShare: c,
                                            isHubGraph: d,
                                            isNodeSaved: p,
                                            hideFooterLinks: t,
                                            showLockButton: v,
                                            isLocked: _
                                        },
                                        E = l.a["graphs/node_card_footer"](O);
                                    f.appendChild(E.trim().toDOM()), Object(i.a)("a.node-actions-menu-icon").click((function(e) {
                                        e.preventDefault()
                                    })), a.a.create("a.node-actions-menu-icon", {
                                        size: "large",
                                        hideOnClickOutside: !0
                                    });
                                    var j = f.querySelector('a[data-action="expand"]');
                                    j && o && d && j.addEventListener("click", (function(e) {
                                        e.preventDefault(), y.emit("openExpandPanel", {
                                            nodes: [m.getNodeById(n)],
                                            position: {
                                                x: 0,
                                                y: 0
                                            }
                                        })
                                    }));
                                    var S = f.querySelector('a[data-action="new-graph"]');
                                    S && d && S.addEventListener("click", (function(e) {
                                        e.preventDefault();
                                        var t = (g.get("hub") || {}).id;
                                        t && window.open("/graphs/new?hub=".concat(t, "&n=").concat(n), "_blank").focus()
                                    }));
                                    var x = f.querySelector('a[data-action="delete"]');
                                    x && o && x.addEventListener("click", (function(e) {
                                        e.preventDefault(), m.buildDeleteSignals([n], null, (function(e, t) {
                                            if (!e) {
                                                for (var n = 0; n < t.length; n += 1) m.notify(t[n]);
                                                m.clearSelectedNodes()
                                            }
                                        }))
                                    }));
                                    var k = f.querySelector('a[data-action="share"]');
                                    k && !O.hideFooterLinks && O.allowShare && ("function" === typeof b.onShareRequested ? k.addEventListener("click", (function(e) {
                                        e.preventDefault(), b.onShareRequested([n])
                                    })) : Object(u.V)(e, [n], {
                                        parent: k,
                                        tipped: f.querySelector("ul#node-share-menu-" + O.id),
                                        position: "top"
                                    }));
                                    var C = f.querySelector('a[data-action="toggle-lock"]');
                                    C && v && C.addEventListener("click", (function(e) {
                                        e.preventDefault(), m.getRenderingController().toggleNodeLock(n), C.classList.toggle("locked")
                                    }))
                                }(t) : _ > 1 && function(t) {
                                    var n = g.get("isHubGraph"),
                                        r = !g.get("id"),
                                        o = !h.get("readOnly") && (r || g.get("user").is_admin || g.get("user").can_edit),
                                        a = w.every((function(e) {
                                            return m.isNodeSaved(e) && 2 !== m.getNodeStatus(e)
                                        })),
                                        i = {
                                            id: Object(u.M)(),
                                            canEdit: o,
                                            allowShare: a,
                                            isHubGraph: n,
                                            hideFooterLinks: t
                                        },
                                        s = l.a["graphs/node_stack_footer"](i);
                                    f.appendChild(s.trim().toDOM());
                                    var c = f.querySelector('a[data-action="expand"]');
                                    c && o && n && c.addEventListener("click", (function(e) {
                                        e.preventDefault(), y.emit("openExpandPanel", {
                                            nodes: m.getSelectedNodes().map(m.getNodeById),
                                            position: {
                                                x: 0,
                                                y: 0
                                            }
                                        })
                                    }));
                                    var d = f.querySelector('a[data-action="new-graph"]');
                                    d && n && d.addEventListener("click", (function(e) {
                                        e.preventDefault();
                                        var t = (g.get("hub") || {}).id,
                                            n = m.getSelectedNodes().join(",");
                                        t && n && window.open("/graphs/new?hub=".concat(t, "&n=").concat(n), "_blank").focus()
                                    }));
                                    var p = f.querySelector('a[data-action="delete"]');
                                    p && o && p.addEventListener("click", (function(e) {
                                        e.preventDefault(), m.buildDeleteSignals(m.getSelectedNodes(), null, (function(e, t) {
                                            if (!e) {
                                                for (var n = 0; n < t.length; n += 1) m.notify(t[n]);
                                                m.clearSelectedNodes()
                                            }
                                        }))
                                    }));
                                    var v = f.querySelector('a[data-action="share"]');
                                    v && !i.hideFooterLinks && i.allowShare && ("function" === typeof b.onShareRequested ? v.addEventListener("click", (function(e) {
                                        e.preventDefault(), b.onShareRequested(m.getSelectedNodes())
                                    })) : Object(u.V)(e, w, {
                                        parent: v,
                                        tipped: f.querySelector("ul#node-share-menu-" + i.id),
                                        position: "top"
                                    }))
                                }(t), S()
                            }
                        },
                        k = function(t) {
                            if (_ > 0) {
                                var n = v.querySelector(".gc-card-focused");
                                n && n.classList.remove("gc-card-focused")
                            }
                            for (var o = (t = Object(r.flattenDeep)(Array.isArray(t) ? t : [t])).length + _ > 1, a = function(n) {
                                    var r = t[n];
                                    if (w.indexOf(r) >= 0) return N(r), "continue";
                                    var a = m.getNodeById(r);
                                    if (!a) return "continue";
                                    var i = m.getNodeTypeById(a.type_id),
                                        s = m.getLinksForNode(r);
                                    Object(c.nodeCard)(e, p, g.get("id"), g.get("title"), a, i, s, (function() {
                                        var e = this.getAttribute("data-to");
                                        m.clearSelectedNodes(), m.selectNode(e)
                                    }), null, (function() {
                                        O = !0, Object(d.editNodePanel)(e, a.id, (function() {
                                            L(), O = !1
                                        }))
                                    }), o, (function() {
                                        O = !0, Object(d.buildExpandedNodeCard)(e, a, b.onShareRequested, (function() {
                                            O = !1
                                        }))
                                    }), b.onShareRequested), _ += 1, w.push(r)
                                }, i = t.length - 1; i >= 0; i -= 1) a(i);
                            x()
                        },
                        C = function(t) {
                            if (_ > 0) {
                                var n = v.querySelector(".gc-card-focused");
                                n && n.classList.remove("gc-card-focused")
                            }
                            for (var r = (t = Array.isArray(t) ? t : [t]).length - 1; r >= 0; r -= 1) {
                                var o = t[r];
                                Object(c.edgeCard)(e, p, o, 0 !== r), _ += 1, w.push(o)
                            }! function() {
                                for (; f.firstChild;) f.removeChild(f.firstChild);
                                if (_ > 0) {
                                    var e = {
                                        ids: w.join(",")
                                    };
                                    g.get("belongsToHub") && (e.hub_id = g.get("hub").id), e.allow_share = w.every((function(e) {
                                        return m.isNodeSaved(e) && 2 !== m.getNodeStatus(e)
                                    }));
                                    var t = l.a["graphs/edge_card_footer"](e);
                                    f.appendChild(t.trim().toDOM()), S()
                                }
                            }()
                        };

                    function N(e) {
                        if (w.indexOf(e) >= 0) {
                            var t, n = p.querySelector(".gc-card-focused");
                            n && n.classList.remove("gc-card-focused");
                            for (var r = p.querySelectorAll("li > div"), o = 0; o < r.length; o += 1)
                                if ((t = r[0]).getAttribute("card-id") === e) {
                                    t.classList.add("gc-card-focused");
                                    break
                                }
                        }
                    }
                    var T = function() {
                        if (_ > 0) {
                            for (; p.firstChild;) p.removeChild(p.firstChild);
                            _ = 0, w = [], x()
                        }
                    };

                    function L() {
                        var e = w.slice(0);
                        e.length > 0 && (T(), k(e))
                    }
                    return function() {
                        var e = l.a["graphs/cardholder_bar"]({});
                        v.appendChild(e.trim().toDOM());
                        var t = v.lastElementChild;
                        document.addEventListener("keydown", j), o = t.querySelector("div.bar-content__body"), f = t.querySelector("div.bar-content__footer"), Object(i.a)(o).addClass("gc-custom-scrollbar"), p = t.querySelector("ul.bar-content__blocks-holder"), o.parentNode.addEventListener("mouseenter", (function() {
                            E = !0
                        })), o.parentNode.addEventListener("mouseleave", (function() {
                            E = !1
                        }))
                    }(), y.bind("editModeUpdated", (function() {
                        return x()
                    })), {
                        addCard: k,
                        addEdgeCard: C,
                        removeCard: function(e) {
                            var t = !1;
                            if (w.indexOf(e) < 0) console.log("Node is not displayed");
                            else {
                                var n = p.querySelectorAll("li > div");
                                if (n)
                                    for (var r = 0; r < n.length; r += 1) {
                                        var o = n[0];
                                        if (o.getAttribute("card-id") === e) {
                                            p.removeChild(o.parentNode), _ -= 1, w.splice(w.indexOf(e), 1), t = !0;
                                            break
                                        }
                                    }
                                if (t && _ > 0) {
                                    var a = p.querySelector("li > div");
                                    a && Object(u.h)(a, "gc-card-focused")
                                }
                                x()
                            }
                        },
                        focusCard: N,
                        isCardDisplayed: function(e) {
                            return w.indexOf(e) >= 0
                        },
                        clearCards: T,
                        updateEdgeCards: function() {
                            var e = w.slice(0);
                            e.length > 0 && (T(), C(e))
                        },
                        updateNodeCards: L,
                        hasMouseFocus: function() {
                            return E
                        },
                        close: function() {
                            document.removeEventListener("keydown", j), Object(i.a)(o).removeClass("gc-custom-scrollbar")
                        }
                    }
                }
        },
        120: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return h
            }));
            var r = n(4),
                o = n(6),
                a = n.n(o),
                i = n(3),
                s = n(2),
                c = n(5),
                l = n(21),
                d = n(7),
                u = n(65),
                p = n(61),
                f = n(62),
                h = function(e, t) {
                    var n, o, h, g, m, y, b, v = t.storyId,
                        _ = t.onRequestEdit,
                        w = t.onClose,
                        O = t.parent,
                        E = t.onGraphRequested,
                        j = !1,
                        S = function() {
                            Object(s.showAuthentication)(e, {
                                for_story: !0
                            })
                        },
                        x = function() {
                            T > 0 && L(n.slides[T - 1].id)
                        },
                        k = function() {
                            T < n.slides.length - 1 && L(n.slides[T + 1].id)
                        },
                        C = function(e) {
                            if ((37 == e.keyCode || 39 == e.keyCode) && !Object(s.isInputFieldActive)(document.activeElement)) switch (e.keyCode) {
                                case 37:
                                    x();
                                    break;
                                case 39:
                                    k()
                            }
                        },
                        N = function(e) {
                            27 == e.keyCode && I()
                        },
                        T = 0;

                    function L(e) {
                        P(n.slides.find((function(t) {
                            return t.id === e
                        })))
                    }

                    function P(e, r) {
                        var o = B();
                        o && (o.selected = !1), e.selected = !0, T = e.order, g.setSlideData(e, {
                            noAnimation: r || o && o.image
                        }), e.image || e.is_back_cover ? (b.hide(), y.hideSVG()) : (b.show(), y.showSVG()), t.standalone && (e.is_back_cover || e.is_cover ? history.replaceState(n.id, n.id, "/stories/" + n.id) : history.replaceState(n.id + "-" + e.order, n.id, "/stories/" + n.id + "/slides/" + e.order)), e.is_back_cover && !n.session_completed && function(e) {
                            var t = Number((Date.now() / 1e3 - e.session_started).toFixed(2));
                            Object(c.notifyStoryCompleted)(e.id, {
                                s: e.session,
                                sc: e.session_count,
                                d: t
                            })
                        }(n)
                    }
                    var A = function() {
                        var e = o.getBoundingClientRect();
                        if (e.width <= 640) return j = !0, void
                        function(e) {
                            D(e, e.width, 0, o.querySelector(".user-profile").getBoundingClientRect().bottom), g.resize(e, !0)
                        }(e);
                        var t = e.width - 380,
                            n = e.height - 80;
                        n *= .8;
                        var r = Math.min(t, n);
                        D(e, r, Math.round((e.width - r - 380) / 2), 60 + Math.round((e.height - 60 - r) / 2)), g.resize(e, !0), j = !1
                    };

                    function D(e, t, r, o) {
                        var a = t / n.original_rect_size,
                            i = n.original_rect_offset_left - r,
                            s = n.original_rect_offset_top - o,
                            c = n.original_rect_offset_left / n.original_width,
                            l = n.original_width * a * c - n.original_rect_offset_left,
                            d = n.original_rect_offset_top / n.original_height,
                            u = (i + l) / a,
                            p = (s + (n.original_height * a * d - n.original_rect_offset_top)) / a,
                            f = e.width / a,
                            h = e.height / a;
                        y.setSvgSize(e.width, e.height), y.setViewBox(u, p, f, h)
                    }

                    function M() {
                        window.removeEventListener("resize", A), window.removeEventListener("keydown", C), window.removeEventListener("keydown", N), o.parentNode.removeChild(o), y.destroy(), t.updateUrl && history.replaceState(n.graph.id, n.graph.id, "/graphs/" + n.graph.id + "?show=stories")
                    }
                    var q = function() {
                        M(), E()
                    };

                    function I() {
                        M(), w()
                    }
                    var R = function() {
                        M(), _(v, T)
                    };

                    function B() {
                        return n.slides.find((function(e) {
                            return e.selected
                        }))
                    }
                    var F = function(e) {
                        e.session = Object(s.guid)(), e.session_count = (e.session_count || 0) + 1, e.session_completed = !1, e.session_started = Date.now() / 1e3, Object(c.notifyStoryStarted)(e.id, {
                            s: e.session,
                            sc: e.session_count
                        })
                    };
                    var G = function(e) {
                            n.recommends_count = e, n.recommends_count_str = n.recommends_count > 0 ? n.recommends_count : "", g.updateRecommendCount(n.recommends_count_str)
                        },
                        H = function() {
                            l.a.getUser() ? n.user_recommended ? (n.user_recommended = !1, g.setRecommended(!1), Object(c.unrecommendStory)(n.id, (function(e) {
                                G(e.story.count), s.notify.info("Your recommendation is removed")
                            }), (function() {
                                console.log("unable to update story")
                            }))) : (n.user_recommended = !0, g.setRecommended(!0), Object(c.recommendStory)(n.id, (function(e) {
                                G(e.story.count), s.notify.info("You recommended this story")
                            }), (function() {
                                console.log("unable to update story")
                            }))) : S()
                        },
                        U = function(t) {
                            var r = {
                                    url: n.url,
                                    text: n.title
                                },
                                o = B();
                            switch (o.is_cover || o.is_back_cover || (r.url += "/slides/" + o.order), t) {
                                case "twitter":
                                    Object(s.shareOnTwitter)(r);
                                    break;
                                case "facebook":
                                    Object(s.shareOnFacebook)(r);
                                    break;
                                case "link":
                                    Object(s.copyLinkToClipboard)(e, r.url)
                            }
                        },
                        z = function() {
                            Object(d.submitEmailDialog)(null, (function(e) {
                                Object(c.emailStoryLink)(n.id, e, (function() {
                                    s.notify.info("Check your email from your desktop!")
                                }), (function() {
                                    s.notify.info("Please try again!")
                                }))
                            }))
                        },
                        W = function(r, o) {
                            n.status = r, h.setPublishStatus(n.status), t.onPublishChanged && t.onPublishChanged(n.id, n.status), 1 === n.status ? Object(d.showStorySharePanel)(e, {
                                onShareRequested: U
                            }) : s.notify.info(o)
                        },
                        Y = function() {
                            n.allow_edit && n.hub && (0 == n.status ? Object(c.publishStory)(n.id, null, (function(t) {
                                if (t.success) W(1, "Your story is now published");
                                else {
                                    var r = {
                                        onForcePublishRequested: function() {
                                            Object(c.publishStory)(n.id, {
                                                force: !0
                                            }), W(1, "Your story is now published")
                                        },
                                        onEditRequested: function() {
                                            R()
                                        },
                                        allow_publish: !0
                                    };
                                    Object(d.showStoryQualityPanel)(e, t, r)
                                }
                            }), (function() {
                                Object(d.displayMessage)(e, "Error", "Unable to publish story. Try again later.")
                            })) : (Object(c.unpublishStory)(n.id), W(0, "Your story is now set as a draft")))
                        },
                        V = function(e) {
                            r.a.ajax({
                                url: n.svg,
                                dataType: "text",
                                xhrFields: {
                                    withCredentials: !1
                                }
                            }).done((function(r) {
                                var c;
                                if (!(c = 0 === r.indexOf("<html") ? (r = r.substring(48)).substring(0, r.length - 14) : r)) return console.log("unable to access background svg file"), void I();
                                var v, _ = null != l.a.getUser(),
                                    w = i.a["stories/readonly_story_view"]({
                                        user: n.user,
                                        created_at: n.created_at_formatted,
                                        graph_name: n.graph.name,
                                        graph_id: n.graph.id,
                                        graph_image_url: n.graph.image,
                                        graph_node_types: (v = n.graph.node_types.slice(0, 3).map((function(e) {
                                            return e.count + " " + e.name
                                        })).join(", "), n.graph.node_types.length > 3 && (v += " and more..."), v),
                                        show_edit_button: n.allow_edit,
                                        show_save_notification: !1,
                                        show_upload_image: !1,
                                        hub_url: n.hub ? "/hubs/" + n.hub.id : "",
                                        hub_name: n.hub ? n.hub.name : "",
                                        show_upload_remove: !1,
                                        related_stories: n.related_stories.map((function(e) {
                                            var r = Object(s.cloneObj)(e);
                                            return r.created_at = a()(r.created_at).fromNow(), r.slides_count = Object(s.buildNumericText)(r.slides_count, "Slide", "Slides"), r.graph_id = n.graph.id, r.url = t.standalone ? "/stories/" + r.id : "/graphs/" + r.graph.id + "/stories/" + r.id + "?auto=true&webgl=false", r
                                        })),
                                        disable_close: t.disableClose,
                                        user_signed_in: _,
                                        user_recommended: n.user_recommended,
                                        recommends_count_str: n.recommends_count > 0 ? n.recommends_count : "",
                                        last_slide_footer_text: n.slides.length - 2 + "/" + (n.slides.length - 2),
                                        show_sign_up: null == l.a.getUser(),
                                        show_publish_button: n.allow_edit && !!n.hub,
                                        is_published: 1 == n.status
                                    });
                                O.appendChild(w.trim().toDOM()), o = O.querySelector(".story-view"), y = Object(u.a)(null, {
                                    svg: c,
                                    transform: n.original_transform,
                                    hide_borders: !0,
                                    pointerEvents: "auto",
                                    skipTransform: !0,
                                    onSVGReset: function() {
                                        g.setSlideData(B(), {
                                            noAnimation: !0
                                        })
                                    }
                                }), b = y.getControllerButtons(), h = Object(p.a)({
                                    isEditMode: !1,
                                    show_edit_button: n.allow_edit,
                                    show_save_notification: !1,
                                    show_upload_image: !1,
                                    rootEl: o,
                                    onStoryViewClosed: I,
                                    onEditRequested: R,
                                    disableClose: t.disableClose,
                                    onGraphRequested: q,
                                    show_publish_button: n.allow_edit && !!n.hub,
                                    onPublishRequested: Y
                                }), g = Object(f.a)({
                                    root: o,
                                    captureController: y,
                                    onNextSlideRequested: k,
                                    onPreviousSlideRequested: x,
                                    noThumbnailStrip: !0,
                                    readOnly: !0,
                                    show_upload_remove: !1,
                                    onRestartStory: function() {
                                        F(n), P(n.slides[0])
                                    },
                                    onViewGraphRequested: q,
                                    onRecommendRequested: H,
                                    onStoryShareRequested: U,
                                    onEmailRequested: z
                                }), t.standalone || Array.from(o.querySelectorAll("ul.related-stories li")).forEach((function(e) {
                                    var r = e.getAttribute("data-id"),
                                        o = n.related_stories.find((function(e) {
                                            return e.id === r
                                        }));
                                    o && o.graph.id === n.graph.id && e.querySelector("a").addEventListener("click", (function(e) {
                                        return e.preventDefault(),
                                            function(e) {
                                                M();
                                                var r = n.related_stories.find((function(t) {
                                                    return t.id === e
                                                }));
                                                t.onRelatedStoryRequested(e, r)
                                            }(r), !1
                                    }))
                                })), m = o.querySelector(".logo-canvas"), Object(s.removeClass)(m, "not-shown"), A(), window.addEventListener("resize", A), window.addEventListener("keydown", C), t.disableClose || window.addEventListener("keydown", N), t.updateUrl && history.replaceState(n.id, n.title, "/graphs/" + n.graph.id + "/stories/" + n.id), _ || o.querySelector("a.btn-sign-up").addEventListener("click", (function(e) {
                                    return e.preventDefault(), S(), !1
                                })), F(n);
                                var E = Number(t.selected_order) || 0;
                                E >= n.slides.length && (E = 0), P(n.slides[E], !0), Array.from(o.querySelectorAll(".sign-up")).forEach((function(e) {
                                    e.addEventListener("click", (function(e) {
                                        return e.preventDefault(), S(), !1
                                    }))
                                })), Array.from(o.querySelectorAll(".show-home-panel")).forEach((function(e) {
                                    e.addEventListener("click", (function(e) {
                                        e.preventDefault();
                                        var t = {
                                            onAuthenticationRequested: function() {
                                                S()
                                            }
                                        };
                                        return Object(d.showSiteAboutPanel)(null, t), !1
                                    }))
                                })), Array.from(o.querySelectorAll(".show-user-panel")).forEach((function(e) {
                                    e.addEventListener("click", (function(e) {
                                        if (e.preventDefault(), j) {
                                            var t = {
                                                obj: n.hub ? n.hub : n.user,
                                                is_hub: n.hub,
                                                onAuthenticationRequested: function() {
                                                    S()
                                                }
                                            };
                                            Object(d.showUserPanel)(null, t)
                                        } else Object(s.redirectTo)(this.href);
                                        return !1
                                    }))
                                })), e()
                            })).fail((function(e) {
                                console.log(e), console.log("unable to access background svg file"), I()
                            }))
                        };
                    Object(d.loaderThreePoints)(e, "Retrieving Story", (function(e) {
                        Object(c.getStory)(v, (function(t) {
                            (n = t).slides.forEach((function(e) {
                                e.thumbnail_image = e.image || e.svg_capture_image
                            })), n.slides[n.slides.length - 1].is_last = !1, n.slides.push({
                                is_last: !0,
                                is_back_cover: !0,
                                order: n.slides.length
                            }), V(e)
                        }), (function() {
                            e()
                        }))
                    }))
                }
        },
        121: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return m
            }));
            var r = n(4),
                o = n(6),
                a = n.n(o),
                i = n(7),
                s = n(21),
                c = n(2),
                l = n(5),
                d = n(65),
                u = n(61),
                p = n(62),
                f = n(76),
                h = n(3),
                g = n(33),
                m = function(e, t) {
                    var n = e.graphStore,
                        o = t || {},
                        m = o.storyId,
                        y = o.onClose,
                        b = !1,
                        v = o.readOnly,
                        _ = null,
                        w = function(e) {
                            27 === e.keyCode && b && I()
                        },
                        O = function() {
                            Object(i.displayMessage)(e, "Error occurred", "Please refresh the page", (function() {
                                location.reload()
                            }))
                        };
                    if (o.readOnly && !m) return Object(i.displayMessage)(e, "Error", "Story id is required"), void(y && y());
                    var E = {
                            user: {
                                id: s.a.getUser().id,
                                username: s.a.getUser().username,
                                img_path: s.a.getUser().image
                            },
                            title: "",
                            subtitle: "",
                            created_at: new Date,
                            svg_key: "",
                            svg: "",
                            svg_data: o.svg_data,
                            slides: [{
                                is_cover: !0,
                                id: Object(c.guid)(),
                                order: 0,
                                footer: "",
                                title: "",
                                subtitle: "",
                                selected: !0
                            }],
                            svg_index: 0,
                            zoomScale: 1,
                            allow_edit: !0,
                            status: 0
                        },
                        j = {},
                        S = function() {
                            var e = b ? 0 : 124,
                                t = Y.getBoundingClientRect(),
                                n = t.width - 380,
                                r = t.height - 80 - e;
                            b && (r *= .8);
                            var o = Math.min(n, r);
                            $.resize(t, b), Z.resize(Object(c.getScreenDimensions)(), b);
                            var a = o,
                                i = Math.round((t.width - o - 380) / 2),
                                s = 60 + Math.round((t.height - 60 - o - e) / 2);
                            j.rect_size = o, j.rect_offset_left = i, j.rect_offset_top = s,
                                function(e, t, n, r) {
                                    var o = t / E.original_rect_size,
                                        a = E.original_rect_offset_left - n,
                                        i = E.original_rect_offset_top - r,
                                        s = E.original_rect_offset_left / E.original_width,
                                        c = E.original_width * o * s - E.original_rect_offset_left,
                                        l = E.original_rect_offset_top / E.original_height,
                                        d = E.original_height * o * l - E.original_rect_offset_top,
                                        u = (a + c) / o,
                                        p = (i + d) / o,
                                        f = e.width / o,
                                        h = e.height / o;
                                    V.setSvgSize(e.width, e.height), V.setViewBox(u, p, f, h)
                                }(t, a, i, s)
                        };
                    var x = null,
                        k = function() {
                            x && clearTimeout(x), x = setTimeout((function() {
                                S(), x = null
                            }), 500)
                        },
                        C = function(e, t, n, r) {
                            var o = !1,
                                a = function() {
                                    o && (K.notifyStorySaved(), i && Z.notifyStorySaved(e)), n && n()
                                },
                                i = !1;
                            if (e.image || r || (i = !e.svg_capture_image || t.captureRegionUpdated) && (e.zoom = t.zoom, e.pan = {
                                    x: t.pan.x,
                                    y: t.pan.y
                                }, e.transform = t.transform), e.is_cover) {
                                var s = !1,
                                    c = !1;
                                e.title != t.title && (s = !0, E.title = t.title, e.title = t.title), e.subtitle != t.subtitle && (c = !0, E.subtitle = t.subtitle, e.subtitle = t.subtitle), s || c || i ? (o = !0, K.notifySaveStart(), i && Z.notifySaveStart(e), function(e, t, n, r, o, a) {
                                    o ? F(t, !1, o, (function() {
                                        n || r ? B(e, a) : a()
                                    })) : n || r ? B(e, a) : a()
                                }(E, e, s, c, i, a)) : a()
                            } else {
                                var l = !1;
                                e.text !== t.text && (l = !0, e.text = t.text), l || i ? (o = !0, K.notifySaveStart(), i && Z.notifySaveStart(e), F(e, l, i, a)) : a()
                            }
                        },
                        N = function(e, t) {
                            $.setSlideData(e, {
                                noAnimation: t
                            }), Z.setSelectedSlide(e), K.setSelectedSlide(e), e.image ? X.hide() : X.show(), he(e)
                        },
                        T = function(e, t) {
                            var n = E.slides.find((function(e) {
                                return e.selected
                            }));
                            n && (n.selected = !1, Z.unsetSelectedSlide(n), b || C(n, $.getSlideData())), e.selected = !0, N(e, n && n.image), t && t()
                        },
                        L = function(e) {
                            var t = E.slides.find((function(t) {
                                return t.id == e
                            }));
                            T(t)
                        },
                        P = function() {
                            var t, n = {
                                id: Object(c.guid)(),
                                order: E.slides.length,
                                text: "",
                                is_last: !0,
                                svg_capture_image: q().svg_capture_image,
                                thumbnail_image: q().svg_capture_image,
                                selected: !0
                            };
                            E.slides[E.slides.length - 1].is_last = !1, E.slides.push(n), E.slides.slice(1).forEach((function(e) {
                                e.footer = e.order + "/" + (E.slides.length - 1)
                            })), E.slides[0].footer = [E.slides.length - 1, "slides"].join(" "), n.dom = Z.addNewSlide(n), t = n, Object(i.showWaitMessage)(e, "Preparing New Slide", "Capturing the image of the graph...", (function(e) {
                                Object(c.chain)(t, [H, T], (function(n) {
                                    e(), n ? (console.log(n), O()) : (console.log("created the slide"), $.focus(t), 2 == E.slides.length && (K.setReviewButtonVisibility(!0), K.setPublishButtonVisibility(!0)))
                                }))
                            }))
                        };
                    var A = function() {
                            E.slides.slice(1).forEach((function(e, t) {
                                e.order = t + 1, e.footer = e.order + "/" + (E.slides.length - 1)
                            })), E.slides.length > 1 && (Z.refreshThumbnails(E.slides), $.updateFooter(q()))
                        },
                        D = function(t) {
                            var n = E.slides.find((function(e) {
                                return e.id === t
                            }));
                            n && (n.remote_id ? Object(i.confirm)(e, "Delete slide", "Are you sure to delete this slide?", (function() {
                                Z.removeSlide(n), E.slides.splice(n.order, 1), n.order == E.slides.length && (E.slides[E.slides.length - 1].is_last = !0), E.slides[0].footer = [E.slides.length - 1, "slides"].join(" "), n.selected && (E.slides.length > n.order ? E.slides[n.order].selected = !0 : E.slides[n.order - 1].selected = !0), A(), n.selected && N(q()), Object(l.deleteSlideFromStory)(E.id, n.remote_id, (function() {
                                    console.log("success")
                                }), (function(e) {
                                    console.log("error"), O()
                                }))
                            })) : Z.removeSlide(n))
                        },
                        M = function() {
                            Object(i.showWaitMessage)(e, "Please wait", "Saving latest changes", (function(e) {
                                C(q(), $.getSlideData(), (function() {
                                    b = !0;
                                    var t = q();
                                    t && (t.selected = !1, Z.unsetSelectedSlide(t)), E.slides[0].selected = !0, K.enterPresentationMode(), $.enterPresentationMode(), Z.enterPresentationMode(), Object(c.removeClass)(J, "not-shown"), N(E.slides[0], !0), S(), e()
                                }))
                            }))
                        };

                    function q() {
                        return E.slides.find((function(e) {
                            return e.selected
                        }))
                    }

                    function I() {
                        b = !1;
                        var e = q();
                        K.exitPresentationMode(), $.exitPresentationMode(e), Z.exitPresentationMode(), Z.setSelectedSlide(e), Object(c.addClass)(J, "not-shown"), S()
                    }
                    var R = function(e, t, r) {
                            var o = Object(c.exportSVG2)(V.getSvgEl(), $.getViewBox());
                            Object(l.uploadScreenshot)(n.get("id"), o, (function(n) {
                                e.svg_key = n.key, e.svg = n.svg, "function" === typeof t && t(e)
                            }), (function() {
                                "function" === typeof r && r("Failed to upload screenshot")
                            }))
                        },
                        B = function(e, t) {
                            var n, r, o, a, i, s;
                            r = function(e) {
                                return t(null, e)
                            }, o = function(e) {
                                O(), t()
                            }, a = function() {
                                r(n)
                            }, i = function() {
                                o("Failed to update story")
                            }, s = {
                                title: (n = e).title,
                                subtitle: n.subtitle
                            }, Object(l.updateStory)(n.id, s, a, i)
                        };

                    function F(e, t, n, r) {
                        var o = [];
                        o.push(e.remote_id ? U : H), n && (o.push(G), o.push(z)), Object(c.chain)(e, o, (function(t) {
                            t ? (console.log(t), O()) : (n && e.svg_capture_image && (e.dom.querySelector("div.preview").style.backgroundImage = "url(" + e.svg_capture_image + ")", e.is_cover && (E.image = e.svg_capture_image)), console.log("updated slide data")), r()
                        }))
                    }

                    function G(e, t, n) {
                        if (E.svg_key) {
                            var r = $.getViewBox();
                            Object(g.getPNGDataURL)(Object(c.exportSVG2)(V.getSvgEl(), r, !0), r).then((function(n) {
                                e.svg_capture_image = n, e.image || (e.thumbnail_image = e.svg_capture_image), e.image_updated = !0, t(e)
                            })).catch((function(e) {
                                n(e)
                            }))
                        } else "function" === typeof n && n("key is not defined")
                    }

                    function H(e, t, n) {
                        Object(l.appendSlide)(E.id, {
                            zoom: e.zoom,
                            pan_x: e.pan ? e.pan.x : null,
                            pan_y: e.pan ? e.pan.y : null,
                            text: e.text,
                            transform: e.transform
                        }, (function(n) {
                            e.remote_id = n.id, t(e)
                        }), (function() {
                            n("Unable to save slide")
                        }))
                    }

                    function U(e, t, n) {
                        Object(l.updateSlide)(e.remote_id, {
                            text: e.text,
                            title: e.title,
                            subtitle: e.subtitle,
                            zoom: e.zoom,
                            pan_x: e.pan ? e.pan.x : null,
                            pan_y: e.pan ? e.pan.y : null,
                            transform: e.transform
                        }, (function() {
                            t(e)
                        }), (function() {
                            n("Unable to save slide")
                        }))
                    }

                    function z(e, t, n) {
                        Object(l.updateSlide)(e.remote_id, {
                            slide: {
                                svg_capture_image: e.svg_capture_image
                            }
                        }, (function() {
                            t(e)
                        }), (function() {
                            n("Unable to save slide")
                        }))
                    }
                    var W = function(e, t, r) {
                        var o = {
                            svg: e.svg,
                            original_transform: e.original_transform,
                            original_width: e.original_width,
                            original_height: e.original_height,
                            original_rect_offset_top: e.original_rect_offset_top,
                            original_rect_offset_left: e.original_rect_offset_left,
                            original_rect_size: e.original_rect_size
                        };
                        Object(l.createStory)(n.get("id"), o, (function(n) {
                            e.id = n.id, e.created_at = n.created_at, e.slides[0].remote_id = n.slides[0].remote_id, e.slides[0].is_last = !0, e.user = n.user, e.hub = n.hub, t(e)
                        }), (function() {
                            r("Failed to initialize story")
                        }))
                    };
                    var Y, V, X, K, $, Z, J, Q = !0,
                        ee = function() {
                            return !E.slides.find((function(e) {
                                return e.is_cover ? !!e.title || !!e.subtitle : !!e.text
                            }))
                        },
                        te = function(e) {
                            Z.destroy(), Y.parentNode.removeChild(Y), V.destroy(), pe && Object(r.a)("#fileupload").fileupload("destroy");
                            var t = !Q;
                            Q && (t = !ee() || (Object(l.deleteStory)(E.id), !1)), window.removeEventListener("keydown", w), history.replaceState(n.get("id"), n.get("id"), "/graphs/" + n.get("id") + "?show=stories"), e(), "function" === typeof y && (E.title || (E.title = "Untitled Story"), y(t ? E : null)), _ && _.close()
                        },
                        ne = function() {
                            var t = E.slides.find((function(e) {
                                return e.selected
                            }));
                            Object(i.showWaitMessage)(e, "Cleaning up story view", "Please wait...", (function(e) {
                                var n = $.getSlideData();
                                ee() && !(n.title || n.subtitle || n.text) ? te(e) : C(t, $.getSlideData(), (function() {
                                    te(e)
                                }))
                            }))
                        },
                        re = function(t, n) {
                            E.status = t, K.setPublishStatus(E.status), o.onPublishChanged && o.onPublishChanged(E.id, E.status), 1 === E.status ? Object(i.showStorySharePanel)(e, {
                                onShareRequested: ue
                            }) : c.notify.info(n)
                        },
                        oe = function() {
                            Object(i.showWaitMessage)(e, "Please wait", "Saving latest changes", (function(t) {
                                C(q(), $.getSlideData(), (function() {
                                    Object(l.checkStoryQuality)(E.id, (function(n) {
                                        t(), Object(i.showStoryQualityPanel)(e, n, {
                                            allow_publish: !1
                                        })
                                    }), (function() {}))
                                }))
                            }))
                        },
                        ae = function() {
                            Object(i.showWaitMessage)(e, "Please wait", "Saving latest changes", (function(t) {
                                C(q(), $.getSlideData(), (function() {
                                    0 == E.status ? Object(l.publishStory)(E.id, null, (function(t) {
                                        if (t.success) re(1, "Your story is now published");
                                        else {
                                            var n = {
                                                onForcePublishRequested: function() {
                                                    Object(l.publishStory)(E.id, {
                                                        force: !0
                                                    }), re(1, "Your story is now published")
                                                },
                                                allow_publish: !0
                                            };
                                            Object(i.showStoryQualityPanel)(e, t, n)
                                        }
                                    }), (function() {
                                        Object(i.displayMessage)(e, "Error", "Unable to publish story. Try again later.")
                                    })) : (Object(l.unpublishStory)(E.id), re(0, "Your story is now set as draft."), E.status = 0), t()
                                }))
                            }))
                        },
                        ie = function() {
                            var e = E.slides.find((function(e) {
                                return e.selected
                            }));
                            e && (e.order + 1 < E.slides.length ? L(E.slides[e.order + 1].id) : b || P())
                        },
                        se = function() {
                            var e = E.slides.find((function(e) {
                                return e.selected
                            }));
                            e && 0 !== e.order && L(E.slides[e.order - 1].id)
                        },
                        ce = function() {
                            var e, t, n, r = q();
                            r.image && (r.image = null, e = r, t = function() {}, n = function() {}, Object(l.updateSlide)(e.remote_id, {
                                slide: {
                                    image: null
                                }
                            }, (function() {
                                t(e)
                            }), (function() {
                                n("Unable to save slide")
                            })), r.is_cover && (E.image = null), r.thumbnail_image = r.svg_capture_image, Z.refreshSlide(r), $.updateImage(r), $.hideRemoveImageButton())
                        },
                        le = function(e, t) {
                            console.log(["moved", e, "to", t].join(" "));
                            var n = E.slides.splice(e, 1);
                            E.slides.splice(t, 0, n[0]), A(),
                                function(e, t, n, r) {
                                    var o = function() {
                                        K.notifyStorySaved(), r && r()
                                    };
                                    K.notifySaveStart();
                                    var a = e.slides.map((function(e) {
                                        return e.remote_id
                                    }));
                                    Object(l.reorderSlide)(e.id, a, (function() {
                                        o()
                                    }), (function(e) {
                                        O(), o()
                                    }))
                                }(E, n[0].remote_id)
                        },
                        de = function(e) {
                            q().remote_id === e && C(q(), $.getSlideData(), null, !0)
                        };

                    function ue(t) {
                        var n = {
                                url: E.url,
                                text: E.title
                            },
                            r = q();
                        switch (r.is_cover || r.is_back_cover || (n.url += "/slides/" + r.order), t) {
                            case "twitter":
                                Object(c.shareOnTwitter)(n);
                                break;
                            case "facebook":
                                Object(c.shareOnFacebook)(n);
                                break;
                            case "link":
                                Object(c.copyLinkToClipboard)(e, n.url)
                        }
                    }
                    var pe, fe = function() {
                        V = Object(d.a)(e, {
                            svg: E.svg_data,
                            transform: E.original_transform,
                            skipTransform: !Q,
                            hide_borders: !0,
                            onSVGReset: function() {
                                if (b) $.setSlideData(q(), {
                                    noAnimation: !0
                                });
                                else {
                                    var e = V.getSVGDimensions(),
                                        t = Math.max(e.width, e.height) + 30,
                                        n = j.rect_size / t;
                                    V.zoom(V.getZoom() * n), setTimeout((function() {
                                        var e = V.getSVGDimensions(),
                                            t = V.getPan();
                                        V.pan({
                                            x: t.x + (j.rect_offset_left - e.left + .5 * (j.rect_size - e.width)),
                                            y: t.y + (j.rect_offset_top - e.top + .5 * (j.rect_size - e.height))
                                        })
                                    }), 10)
                                }
                            }
                        }), X = V.getControllerButtons();
                        var t, r, i, s, l, g, m, y = h.a["stories/story_view"]({
                            user: E.user,
                            name: n.get("title"),
                            created_at: a()(E.created_at).format("MMM d, YYYY"),
                            slides: E.slides,
                            edit_mode: !0,
                            show_edit_button: !0,
                            show_save_notification: !0,
                            show_help_button: !0,
                            show_upload_image: !0,
                            show_publish_button: o.belongs_to_hub,
                            show_quality_check_button: !o.belongs_to_hub,
                            link: E.hub ? "/hubs/" + E.hub.id : "/",
                            link_text: "OntoGraph" + (E.hub ? " - " + E.hub.name : ""),
                            show_upload_remove: !0,
                            user_signed_in: !0,
                            is_published: 1 == E.status
                        });
                        document.body.appendChild(y.trim().toDOM()), Y = document.body.lastElementChild, K = Object(u.a)({
                            rootEl: Y,
                            isEditMode: !0,
                            show_edit_button: !0,
                            show_save_notification: !0,
                            show_help_button: !0,
                            show_publish_button: o.belongs_to_hub,
                            show_quality_check_button: !o.belongs_to_hub,
                            onStoryViewClosed: ne,
                            onEditRequested: I,
                            onHelpRequested: function() {
                                me()
                            },
                            onPublishRequested: ae,
                            onQualityCheckRequested: oe
                        }), $ = Object(p.a)({
                            root: Y,
                            captureController: V,
                            onNextSlideRequested: ie,
                            onPreviousSlideRequested: se,
                            onRemoveImageRequested: ce,
                            onTextChanged: de,
                            show_upload_remove: !0,
                            show_upload_image: !0
                        }), Z = Object(f.a)({
                            root: Y,
                            slideData: E.slides,
                            onNewSlideRequested: P,
                            onPresentationModeRequested: M,
                            onSwitchSlideRequested: function(e, t) {
                                var n = q();
                                n && n.id === e || (L(e), t && $.focus(q()))
                            },
                            onSlideDeleteRequested: D,
                            onSlideReorderRequested: le
                        }), J = Y.querySelector(".logo-canvas"), Q ? (t = b ? 0 : 124, r = Y.getBoundingClientRect(), i = r.width - 380, s = r.height - 80 - t, l = Math.min(i, s), g = Math.round((r.width - l - 380) / 2), m = 60 + Math.round((r.height - 60 - l - t) / 2), E.original_width = r.width, E.original_height = r.height, E.original_rect_size = l, E.original_rect_offset_left = g, E.original_rect_offset_top = m, j.rect_size = l, j.rect_offset_left = g, j.rect_offset_top = m, $.resize(r, b), Z.resize(Object(c.getScreenDimensions)(), b)) : S(), v || window.addEventListener("keydown", w), window.addEventListener("resize", k)
                    };

                    function he(e) {
                        pe && Object(r.a)("#fileupload").fileupload("destroy");
                        var t = function() {
                                $.notifyDragOverEnd(), n = null
                            },
                            n = null;
                        pe = Object(r.a)("#fileupload").fileupload({
                            add: function(e, t) {
                                var n = [];
                                t.originalFiles[0].type.length && !/^image\/(gif|jpe?g|png)$/i.test(t.originalFiles[0].type) && n.push("Not an accepted file type."), t.originalFiles[0].size && t.originalFiles[0].size > 2e6 && n.push("Filesize is too big."), n.length > 0 ? (n.push("Please try another file."), Object(i.displayMessage)(null, "Upload Error", n.join("<br/>"))) : t.submit()
                            },
                            dataType: "json",
                            url: "/slides/" + e.remote_id,
                            paramName: "slide[image]",
                            type: "PUT",
                            headers: {
                                "X-CSRF-Token": Object(r.a)('meta[name="csrf-token"]').attr("content")
                            },
                            submit: function() {
                                if (Object(r.a)(this).fileupload("option", "url") !== "/slides/" + q().remote_id) return !1
                            },
                            start: function() {
                                K.notifySaveStart(), Z.notifySaveStart(e), $.setLoading(!0)
                            },
                            done: function(t, n) {
                                var r = n.result;
                                e.image = r.image, e.thumbnail_image = e.image, e.is_cover && (E.image = e.image), Z.refreshSlide(e), $.updateImage(e), $.showRemoveImageButton(), K.notifyStorySaved(), $.setLoading(!1), Z.notifyStorySaved(e)
                            },
                            drop: function() {
                                console.log("dropped it"), $.notifyDragOverEnd(), n = !1
                            },
                            dragover: function() {
                                $.notifyDragOver(), clearTimeout(n)
                            },
                            dragleave: function() {
                                n = setTimeout(t, 500)
                            }
                        })
                    }
                    var ge = function() {
                        var e = q();
                        $.updateImage(e), e.image && X.hide()
                    };

                    function me() {
                        Object(l.notifyStoryTourStarted)(E.id), $.updateImage({}), X.show(), Object(c.HelpDisplaySequence)([{
                            target: "div.story-view .text-content",
                            position: "left",
                            title: "Write your story",
                            message: "Add text accompanying your graph"
                        }, {
                            target: "div#svg-capture button.map-controller.reset",
                            position: "top-right",
                            title: "Adjust the view",
                            message: "Drag and zoom this view like a camera on your graph"
                        }, {
                            target: "div.story-view div.story-slide div.svg-area span.upload-image",
                            position: "right",
                            title: "Upload image",
                            message: "Click here or drag a file into this area"
                        }, {
                            target: "section.thumbnail.action-slide.left.new-slide .map-controller",
                            position: "top",
                            title: "Add new slides",
                            message: "The shortcut is CTRL+M"
                        }, {
                            target: "section.thumbnail.selected",
                            position: "top",
                            title: "Edit and reorder slides",
                            message: "Slides line up here, drag to change their order"
                        }, {
                            target: "section.thumbnail.action-slide.right.present-mode .map-controller",
                            position: "top-right",
                            title: "Preview your story",
                            message: "See how it looks for your visitors"
                        }, {
                            target: "nav.story a.close-story-view span",
                            position: "bottom-right",
                            title: "Leave story editor",
                            message: "Everything is automatically saved"
                        }], (function() {
                            Object(i.displayMessage)(null, "Congratulations!", "Now you are ready to create compelling stories. <br><br><strong>Tip:</strong> To highlight a certain area on your graph, first select nodes on the graph (do shift+click for multiple selections), then create a story while the selections are on."), Object(l.notifyStoryTourCompleted)(E.id), ge()
                        }), (function() {
                            Object(l.notifyStoryTourCancelled)(E.id), ge(), _ = Object(c.HelpDisplay)({
                                target: "nav.story a#btnShowStoryHelp span",
                                position: "bottom-right",
                                title: "Before you go",
                                message: "You can replay the help tutorial whenever you need it.",
                                confirm: !0,
                                onConfirm: function() {},
                                onSkip: function() {},
                                next_text: "OK",
                                hide_skip: !0
                            }, (function() {
                                _ = null
                            }))
                        }))
                    }
                    if (m) {
                        Q = !1;
                        var ye = function(e) {
                            history.replaceState(E.id, E.id, "/graphs/" + E.graph.id + "/stories/" + E.id + "?webgl=false&edit=true"), fe();
                            var t = 0;
                            o.selectedSlide && o.selectedSlide < E.slides.length && (t = o.selectedSlide), T(E.slides[t]), E.svg_key ? e() : function(e) {
                                R(E, (function(t) {
                                    return e(null, t)
                                }), (function(t) {
                                    e(), O()
                                }))
                            }(e)
                        };
                        Object(i.loaderThreePoints)(e, "Loading story editor... ", (function(e) {
                            Object(l.getStoryForEdit)(m, (function(t) {
                                (E = t).svg_index = 0, E.slides.forEach((function(e) {
                                    e.thumbnail_image = e.image || e.svg_capture_image
                                })), r.a.ajax({
                                    url: E.svg,
                                    dataType: "text",
                                    xhrFields: {
                                        withCredentials: !1
                                    }
                                }).done((function(t) {
                                    var n;
                                    if (!(n = 0 === t.indexOf("<html") ? (t = t.substring(48)).substring(0, t.length - 14) : t)) return console.log("unable to access background svg file"), void ne();
                                    E.svg_data = n, ye(e)
                                }))
                            }), (function() {
                                e()
                            }))
                        }))
                    } else Q = !0, E.original_transform = o.transform, E.svg_data = o.svg_data, E.allow_edit = !0, Object(i.loaderThreePoints)(e, "Please wait, loading slide awesomeness...", (function(e) {
                        history.replaceState("newStory", "newStory", "/graphs/" + n.get("id") + "?webgl=false&show=stories&new=true"), fe(),
                            function(e) {
                                Object(c.chain)(E, [R, W], (function(t) {
                                    $.setSlideHeader(E), $.setSlideData(E.slides[0]), $.focus(E.slides[0]), K.setReviewButtonVisibility(!1), K.setPublishButtonVisibility(!1), he(E.slides[0]), e(), Y.setAttribute("data-ready", !0), t ? (console.log(t), O()) : console.log("created the story")
                                }))
                            }((function() {
                                o.start_with_help && me(), e()
                            }))
                    }))
                }
        },
        13: function(e, t, n) {
            (function(t) {
                e.exports = function e(t, n, r) {
                    function o(i, s) {
                        if (!n[i]) {
                            if (!t[i]) {
                                if (a) return a(i, !0);
                                var c = new Error("Cannot find module '" + i + "'");
                                throw c.code = "MODULE_NOT_FOUND", c
                            }
                            var l = n[i] = {
                                exports: {}
                            };
                            t[i][0].call(l.exports, (function(e) {
                                var n = t[i][1][e];
                                return o(n || e)
                            }), l, l.exports, e, t, n, r)
                        }
                        return n[i].exports
                    }
                    for (var a = !1, i = 0; i < r.length; i++) o(r[i]);
                    return o
                }({
                    1: [function(e, t, n) {
                        var r = e("ngraph.random"),
                            o = {
                                lazyExtend: function() {
                                    return e("ngraph.merge").apply(this, arguments)
                                },
                                randomIterator: function() {
                                    return r.randomIterator.apply(r, arguments)
                                },
                                random: function() {
                                    return r.random.apply(r, arguments)
                                },
                                events: e("ngraph.events")
                            };
                        o.Graph = {
                            version: e("./version.js"),
                            graph: e("ngraph.graph"),
                            serializer: function() {
                                return {
                                    loadFromJSON: e("ngraph.fromjson"),
                                    storeToJSON: e("ngraph.tojson")
                                }
                            },
                            centrality: e("./Algorithms/centrality.js"),
                            operations: e("./Algorithms/operations.js"),
                            geom: function() {
                                return {
                                    intersect: e("gintersect"),
                                    intersectRect: e("./Utils/intersectRect.js")
                                }
                            },
                            webgl: e("./WebGL/webgl.js"),
                            webglInputEvents: e("./WebGL/webglInputEvents.js"),
                            generator: function() {
                                return e("ngraph.generators")
                            },
                            Input: {
                                domInputManager: e("./Input/domInputManager.js"),
                                webglInputManager: e("./Input/webglInputManager.js")
                            },
                            Utils: {
                                dragndrop: e("./Input/dragndrop.js"),
                                findElementPosition: e("./Utils/findElementPosition.js"),
                                timer: e("./Utils/timer.js"),
                                getDimension: e("./Utils/getDimensions.js"),
                                events: e("./Utils/backwardCompatibleEvents.js")
                            },
                            Layout: {
                                forceDirected: e("ngraph.forcelayout"),
                                constant: e("./Layout/constant.js")
                            },
                            View: {
                                Texture: e("./WebGL/texture.js"),
                                webglAtlas: e("./WebGL/webglAtlas.js"),
                                webglImageNodeProgram: e("./WebGL/webglImageNodeProgram.js"),
                                webglLinkProgram: e("./WebGL/webglLinkProgram.js"),
                                webglNodeProgram: e("./WebGL/webglNodeProgram.js"),
                                webglLine: e("./WebGL/webglLine.js"),
                                webglSquare: e("./WebGL/webglSquare.js"),
                                webglImage: e("./WebGL/webglImage.js"),
                                webglGraphics: e("./View/webglGraphics.js"),
                                _webglUtil: {
                                    parseColor: e("./WebGL/parseColor.js")
                                },
                                svgGraphics: e("./View/svgGraphics.js"),
                                renderer: e("./View/renderer.js"),
                                cssGraphics: function() {
                                    throw new Error("cssGraphics is deprecated. Please use older version of vivagraph (< 0.7) if you need it")
                                },
                                svgNodeFactory: function() {
                                    throw new Error("svgNodeFactory is deprecated. Please use older version of vivagraph (< 0.7) if you need it")
                                },
                                community: function() {
                                    throw new Error("community is deprecated. Please use vivagraph < 0.7 if you need it, or `https://github.com/anvaka/ngraph.slpa` module")
                                }
                            },
                            Rect: e("./Utils/rect.js"),
                            svg: e("simplesvg"),
                            BrowserInfo: e("./Utils/browserInfo.js")
                        }, t.exports = o
                    }, {
                        "./Algorithms/centrality.js": 32,
                        "./Algorithms/operations.js": 33,
                        "./Input/domInputManager.js": 34,
                        "./Input/dragndrop.js": 35,
                        "./Input/webglInputManager.js": 36,
                        "./Layout/constant.js": 37,
                        "./Utils/backwardCompatibleEvents.js": 38,
                        "./Utils/browserInfo.js": 39,
                        "./Utils/findElementPosition.js": 41,
                        "./Utils/getDimensions.js": 42,
                        "./Utils/intersectRect.js": 43,
                        "./Utils/rect.js": 45,
                        "./Utils/timer.js": 46,
                        "./View/renderer.js": 48,
                        "./View/svgGraphics.js": 49,
                        "./View/webglGraphics.js": 50,
                        "./WebGL/parseColor.js": 51,
                        "./WebGL/texture.js": 52,
                        "./WebGL/webgl.js": 53,
                        "./WebGL/webglAtlas.js": 54,
                        "./WebGL/webglImage.js": 55,
                        "./WebGL/webglImageNodeProgram.js": 56,
                        "./WebGL/webglInputEvents.js": 57,
                        "./WebGL/webglLine.js": 58,
                        "./WebGL/webglLinkProgram.js": 59,
                        "./WebGL/webglNodeProgram.js": 60,
                        "./WebGL/webglSquare.js": 61,
                        "./version.js": 62,
                        gintersect: 2,
                        "ngraph.events": 6,
                        "ngraph.forcelayout": 7,
                        "ngraph.fromjson": 21,
                        "ngraph.generators": 22,
                        "ngraph.graph": 23,
                        "ngraph.merge": 24,
                        "ngraph.random": 25,
                        "ngraph.tojson": 26,
                        simplesvg: 27
                    }],
                    2: [function(e, t, n) {
                        function r(e, t, n, r, o, a, i, s) {
                            var c, l, d, u, p, f, h, g, m, y, b, v, _, w = {
                                x: 0,
                                y: 0
                            };
                            return y = (c = r - t) * i + (d = e - n) * s + (p = n * t - e * r), 0 !== (m = c * o + d * a + p) && 0 !== y && m >= 0 === y >= 4 ? null : (g = (l = s - a) * n + (u = o - i) * r + (f = i * a - o * s), 0 !== (h = l * e + u * t + f) && 0 !== g && h >= 0 === g >= 0 || 0 === (b = c * u - l * d) ? null : (v = b < 0 ? -b / 2 : b / 2, v = 0, _ = d * f - u * p, w.x = (_ < 0 ? _ - v : _ + v) / b, _ = l * p - c * f, w.y = (_ < 0 ? _ - v : _ + v) / b, w))
                        }
                        t.exports = r
                    }, {}],
                    3: [function(e, t, n) {
                        t.exports.degree = e("./src/degree.js"), t.exports.betweenness = e("./src/betweenness.js")
                    }, {
                        "./src/betweenness.js": 4,
                        "./src/degree.js": 5
                    }],
                    4: [function(e, t, n) {
                        function r(e, t) {
                            var n, r = [],
                                o = [],
                                a = Object.create(null),
                                i = Object.create(null),
                                s = Object.create(null),
                                c = Object.create(null),
                                l = Object.create(null);
                            return e.forEachNode(u), e.forEachNode(p), t || Object.keys(l).forEach(d), l;

                            function d(e) {
                                l[e] /= 2
                            }

                            function u(e) {
                                l[e.id] = 0
                            }

                            function p(e) {
                                g(n = e.id), f()
                            }

                            function f() {
                                for (e.forEachNode(h); o.length;) {
                                    for (var t = o.pop(), r = (1 + c[t]) / s[t], i = a[t], d = 0; d < i.length; ++d) {
                                        var u = i[d];
                                        c[u] += s[u] * r
                                    }
                                    t !== n && (l[t] += c[t])
                                }
                            }

                            function h(e) {
                                c[e.id] = 0
                            }

                            function g(n) {
                                for (e.forEachNode(d), i[n] = 0, s[n] = 1, r.push(n); r.length;) {
                                    var c = r.shift();
                                    Object.create(null), o.push(c), e.forEachLinkedNode(c, l, t)
                                }

                                function l(e) {
                                    u(e.id)
                                }

                                function d(e) {
                                    var t = e.id;
                                    a[t] = [], i[t] = -1, s[t] = 0
                                }

                                function u(e) {
                                    -1 === i[e] && (i[e] = i[c] + 1, r.push(e)), i[e] === i[c] + 1 && (s[e] += s[c], a[e].push(c))
                                }
                            }
                        }
                        t.exports = r
                    }, {}],
                    5: [function(e, t, n) {
                        function r(e, t) {
                            var n, r = Object.create(null);
                            if ("both" === (t = (t || "both").toLowerCase()) || "inout" === t) n = i;
                            else if ("in" === t) n = o;
                            else {
                                if ("out" !== t) throw new Error("Expected centrality degree kind is: in, out or both");
                                n = a
                            }
                            return e.forEachNode(s), r;

                            function s(t) {
                                var o = e.getLinks(t.id);
                                r[t.id] = n(o, t.id)
                            }
                        }

                        function o(e, t) {
                            for (var n = 0, r = 0; r < e.length; r += 1) n += e[r].toId === t ? 1 : 0;
                            return n
                        }

                        function a(e, t) {
                            for (var n = 0, r = 0; r < e.length; r += 1) n += e[r].fromId === t ? 1 : 0;
                            return n
                        }

                        function i(e) {
                            return e.length
                        }
                        t.exports = r
                    }, {}],
                    6: [function(e, t, n) {
                        function r(e) {
                            var t = Object.create(null);
                            return {
                                on: function(n, r, o) {
                                    if ("function" !== typeof r) throw new Error("callback is expected to be a function");
                                    var a = t[n];
                                    return a || (a = t[n] = []), a.push({
                                        callback: r,
                                        ctx: o
                                    }), e
                                },
                                off: function(n, r) {
                                    if ("undefined" === typeof n) return t = Object.create(null), e;
                                    if (t[n])
                                        if ("function" !== typeof r) delete t[n];
                                        else
                                            for (var o = t[n], a = 0; a < o.length; ++a) o[a].callback === r && o.splice(a, 1);
                                    return e
                                },
                                fire: function(n) {
                                    var r, o = t[n];
                                    if (!o) return e;
                                    arguments.length > 1 && (r = Array.prototype.splice.call(arguments, 1));
                                    for (var a = 0; a < o.length; ++a) {
                                        var i = o[a];
                                        i.callback.apply(i.ctx, r)
                                    }
                                    return e
                                }
                            }
                        }

                        function o(e) {
                            if (!e) throw new Error("Eventify cannot use falsy object as events subject");
                            for (var t = ["on", "fire", "off"], n = 0; n < t.length; ++n)
                                if (e.hasOwnProperty(t[n])) throw new Error("Subject cannot be eventified, since it already has property '" + t[n] + "'")
                        }
                        t.exports = function(e) {
                            o(e);
                            var t = r(e);
                            return e.on = t.on, e.off = t.off, e.fire = t.fire, e
                        }
                    }, {}],
                    7: [function(e, t, n) {
                        function r(t, n) {
                            if (!t) throw new Error("Graph structure cannot be undefined");
                            var r = e("ngraph.physics.simulator")(n),
                                a = "function" === typeof Object.create ? Object.create(null) : {},
                                i = {},
                                s = r.settings.springTransform || o;
                            return p(), d(), {
                                step: function() {
                                    return r.step()
                                },
                                getNodePosition: function(e) {
                                    return _(e).pos
                                },
                                setNodePosition: function(e) {
                                    var t = _(e);
                                    t.setPosition.apply(t, Array.prototype.slice.call(arguments, 1))
                                },
                                getLinkPosition: function(e) {
                                    var t = i[e];
                                    if (t) return {
                                        from: t.from.pos,
                                        to: t.to.pos
                                    }
                                },
                                getGraphRect: function() {
                                    return r.getBBox()
                                },
                                pinNode: function(e, t) {
                                    _(e.id).isPinned = !!t
                                },
                                isNodePinned: function(e) {
                                    return _(e.id).isPinned
                                },
                                dispose: function() {
                                    t.off("changed", u)
                                },
                                getBody: l,
                                getSpring: c,
                                simulator: r
                            };

                            function c(e, n) {
                                var r;
                                if (void 0 === n) r = "string" === typeof e ? e : e.id;
                                else {
                                    var o = t.hasLink(e, n);
                                    if (!o) return;
                                    r = o.id
                                }
                                return i[r]
                            }

                            function l(e) {
                                return a[e]
                            }

                            function d() {
                                t.on("changed", u)
                            }

                            function u(e) {
                                for (var t = 0; t < e.length; ++t) {
                                    var n = e[t];
                                    "add" === n.changeType ? (n.node && f(n.node.id), n.link && g(n.link)) : "remove" === n.changeType && (n.node && h(n.node), n.link && m(n.link))
                                }
                            }

                            function p() {
                                t.forEachNode((function(e) {
                                    f(e.id)
                                })), t.forEachLink(g)
                            }

                            function f(e) {
                                var n = a[e];
                                if (!n) {
                                    var o = t.getNode(e);
                                    if (!o) throw new Error("initBody() was called with unknown node id");
                                    var i = o.position;
                                    if (!i) {
                                        var s = y(o);
                                        i = r.getBestNewBodyPosition(s)
                                    }
                                    n = r.addBodyAt(i), a[e] = n, b(e), v(o) && (n.isPinned = !0)
                                }
                            }

                            function h(e) {
                                var t = e.id,
                                    n = a[t];
                                n && (a[t] = null, delete a[t], r.removeBody(n))
                            }

                            function g(e) {
                                b(e.fromId), b(e.toId);
                                var t = a[e.fromId],
                                    n = a[e.toId],
                                    o = r.addSpring(t, n, e.length);
                                s(e, o), i[e.id] = o
                            }

                            function m(e) {
                                var n = i[e.id];
                                if (n) {
                                    var o = t.getNode(e.fromId),
                                        a = t.getNode(e.toId);
                                    o && b(o.id), a && b(a.id), delete i[e.id], r.removeSpring(n)
                                }
                            }

                            function y(e) {
                                var t = [];
                                if (!e.links) return t;
                                for (var n = Math.min(e.links.length, 2), r = 0; r < n; ++r) {
                                    var o = e.links[r],
                                        i = o.fromId !== e.id ? a[o.fromId] : a[o.toId];
                                    i && i.pos && t.push(i)
                                }
                                return t
                            }

                            function b(e) {
                                a[e].mass = w(e)
                            }

                            function v(e) {
                                return e && (e.isPinned || e.data && e.data.isPinned)
                            }

                            function _(e) {
                                var t = a[e];
                                return t || (f(e), t = a[e]), t
                            }

                            function w(e) {
                                return 1 + t.getLinks(e).length / 3
                            }
                        }

                        function o() {}
                        t.exports = r, t.exports.simulator = e("ngraph.physics.simulator")
                    }, {
                        "ngraph.physics.simulator": 8
                    }],
                    8: [function(e, t, n) {
                        function r(t) {
                            var n = e("./lib/spring"),
                                r = e("ngraph.expose"),
                                o = e("ngraph.merge"),
                                a = (t = o(t, {
                                    springLength: 30,
                                    springCoeff: 8e-4,
                                    gravity: -1.2,
                                    theta: .8,
                                    dragCoeff: .02,
                                    timeStep: 20,
                                    stableThreshold: .009
                                })).createQuadTree || e("ngraph.quadtreebh"),
                                i = t.createBounds || e("./lib/bounds"),
                                s = t.createDragForce || e("./lib/dragForce"),
                                c = t.createSpringForce || e("./lib/springForce"),
                                l = t.integrator || e("./lib/eulerIntegrator"),
                                d = t.createBody || e("./lib/createBody"),
                                u = [],
                                p = [],
                                f = a(t),
                                h = i(u, t),
                                g = c(t),
                                m = s(t),
                                y = {
                                    bodies: u,
                                    springs: p,
                                    settings: t,
                                    step: function() {
                                        b();
                                        var e = l(u, t.timeStep);
                                        return h.update(), e < t.stableThreshold
                                    },
                                    addBody: function(e) {
                                        if (!e) throw new Error("Body is required");
                                        return u.push(e), e
                                    },
                                    addBodyAt: function(e) {
                                        if (!e) throw new Error("Body position is required");
                                        var t = d(e);
                                        return u.push(t), t
                                    },
                                    removeBody: function(e) {
                                        if (e) {
                                            var t = u.indexOf(e);
                                            if (!(t < 0)) return u.splice(t, 1), 0 === u.length && h.reset(), !0
                                        }
                                    },
                                    addSpring: function(e, t, r, o, a) {
                                        if (!e || !t) throw new Error("Cannot add null spring to force simulator");
                                        "number" !== typeof r && (r = -1);
                                        var i = new n(e, t, r, a >= 0 ? a : -1, o);
                                        return p.push(i), i
                                    },
                                    removeSpring: function(e) {
                                        if (e) {
                                            var t = p.indexOf(e);
                                            return t > -1 ? (p.splice(t, 1), !0) : void 0
                                        }
                                    },
                                    getBestNewBodyPosition: function(e) {
                                        return h.getBestNewPosition(e)
                                    },
                                    getBBox: function() {
                                        return h.box
                                    },
                                    gravity: function(e) {
                                        return void 0 !== e ? (t.gravity = e, f.options({
                                            gravity: e
                                        }), this) : t.gravity
                                    },
                                    theta: function(e) {
                                        return void 0 !== e ? (t.theta = e, f.options({
                                            theta: e
                                        }), this) : t.theta
                                    }
                                };
                            return r(t, y), y;

                            function b() {
                                var e, t = u.length;
                                if (t)
                                    for (f.insertBodies(u); t--;)(e = u[t]).isPinned || (e.force.reset(), f.updateBodyForce(e), m.update(e));
                                for (t = p.length; t--;) g.update(p[t])
                            }
                        }
                        t.exports = r
                    }, {
                        "./lib/bounds": 9,
                        "./lib/createBody": 10,
                        "./lib/dragForce": 11,
                        "./lib/eulerIntegrator": 12,
                        "./lib/spring": 13,
                        "./lib/springForce": 14,
                        "ngraph.expose": 15,
                        "ngraph.merge": 24,
                        "ngraph.quadtreebh": 17
                    }],
                    9: [function(e, t, n) {
                        t.exports = function(t, n) {
                            var r = e("ngraph.random").random(42),
                                o = {
                                    x1: 0,
                                    y1: 0,
                                    x2: 0,
                                    y2: 0
                                };
                            return {
                                box: o,
                                update: a,
                                reset: function() {
                                    o.x1 = o.y1 = 0, o.x2 = o.y2 = 0
                                },
                                getBestNewPosition: function(e) {
                                    var t = o,
                                        a = 0,
                                        i = 0;
                                    if (e.length) {
                                        for (var s = 0; s < e.length; ++s) a += e[s].pos.x, i += e[s].pos.y;
                                        a /= e.length, i /= e.length
                                    } else a = (t.x1 + t.x2) / 2, i = (t.y1 + t.y2) / 2;
                                    var c = n.springLength;
                                    return {
                                        x: a + r.next(c) - c / 2,
                                        y: i + r.next(c) - c / 2
                                    }
                                }
                            };

                            function a() {
                                var e = t.length;
                                if (0 !== e) {
                                    for (var n = Number.MAX_VALUE, r = Number.MAX_VALUE, a = Number.MIN_VALUE, i = Number.MIN_VALUE; e--;) {
                                        var s = t[e];
                                        s.isPinned ? (s.pos.x = s.prevPos.x, s.pos.y = s.prevPos.y) : (s.prevPos.x = s.pos.x, s.prevPos.y = s.pos.y), s.pos.x < n && (n = s.pos.x), s.pos.x > a && (a = s.pos.x), s.pos.y < r && (r = s.pos.y), s.pos.y > i && (i = s.pos.y)
                                    }
                                    o.x1 = n, o.x2 = a, o.y1 = r, o.y2 = i
                                }
                            }
                        }
                    }, {
                        "ngraph.random": 25
                    }],
                    10: [function(e, t, n) {
                        var r = e("ngraph.physics.primitives");
                        t.exports = function(e) {
                            return new r.Body(e)
                        }
                    }, {
                        "ngraph.physics.primitives": 16
                    }],
                    11: [function(e, t, n) {
                        t.exports = function(t) {
                            var n = e("ngraph.merge"),
                                r = {
                                    update: function(e) {
                                        e.force.x -= t.dragCoeff * e.velocity.x, e.force.y -= t.dragCoeff * e.velocity.y
                                    }
                                };
                            return e("ngraph.expose")(t = n(t, {
                                dragCoeff: .02
                            }), r, ["dragCoeff"]), r
                        }
                    }, {
                        "ngraph.expose": 15,
                        "ngraph.merge": 24
                    }],
                    12: [function(e, t, n) {
                        function r(e, t) {
                            var n, r = 0,
                                o = 0,
                                a = 0,
                                i = 0,
                                s = e.length;
                            for (n = 0; n < s; ++n) {
                                var c = e[n],
                                    l = t / c.mass;
                                c.velocity.x += l * c.force.x, c.velocity.y += l * c.force.y;
                                var d = c.velocity.x,
                                    u = c.velocity.y,
                                    p = Math.sqrt(d * d + u * u);
                                p > 1 && (c.velocity.x = d / p, c.velocity.y = u / p), r = t * c.velocity.x, a = t * c.velocity.y, c.pos.x += r, c.pos.y += a, o += Math.abs(r), i += Math.abs(a)
                            }
                            return (o * o + i * i) / e.length
                        }
                        t.exports = r
                    }, {}],
                    13: [function(e, t, n) {
                        function r(e, t, n, r, o) {
                            this.from = e, this.to = t, this.length = n, this.coeff = r, this.weight = "number" === typeof o ? o : 1
                        }
                        t.exports = r
                    }, {}],
                    14: [function(e, t, n) {
                        t.exports = function(t) {
                            var n = e("ngraph.merge"),
                                r = e("ngraph.random").random(42),
                                o = {
                                    update: function(e) {
                                        var n = e.from,
                                            o = e.to,
                                            a = e.length < 0 ? t.springLength : e.length,
                                            i = o.pos.x - n.pos.x,
                                            s = o.pos.y - n.pos.y,
                                            c = Math.sqrt(i * i + s * s);
                                        0 === c && (i = (r.nextDouble() - .5) / 50, s = (r.nextDouble() - .5) / 50, c = Math.sqrt(i * i + s * s));
                                        var l = c - a,
                                            d = (!e.coeff || e.coeff < 0 ? t.springCoeff : e.coeff) * l / c * e.weight;
                                        n.force.x += d * i, n.force.y += d * s, o.force.x -= d * i, o.force.y -= d * s
                                    }
                                };
                            return e("ngraph.expose")(t = n(t, {
                                springCoeff: 2e-4,
                                springLength: 80
                            }), o, ["springCoeff", "springLength"]), o
                        }
                    }, {
                        "ngraph.expose": 15,
                        "ngraph.merge": 24,
                        "ngraph.random": 25
                    }],
                    15: [function(e, t, n) {
                        function r(e, t, n) {
                            if ("[object Array]" === Object.prototype.toString.call(n))
                                for (var r = 0; r < n.length; ++r) o(e, t, n[r]);
                            else
                                for (var a in e) o(e, t, a)
                        }

                        function o(e, t, n) {
                            if (e.hasOwnProperty(n)) {
                                if ("function" === typeof t[n]) return;
                                t[n] = function(r) {
                                    return void 0 !== r ? (e[n] = r, t) : e[n]
                                }
                            }
                        }
                        t.exports = r
                    }, {}],
                    16: [function(e, t, n) {
                        function r(e, t) {
                            this.pos = new o(e, t), this.prevPos = new o(e, t), this.force = new o, this.velocity = new o, this.mass = 1
                        }

                        function o(e, t) {
                            e && "number" !== typeof e ? (this.x = "number" === typeof e.x ? e.x : 0, this.y = "number" === typeof e.y ? e.y : 0) : (this.x = "number" === typeof e ? e : 0, this.y = "number" === typeof t ? t : 0)
                        }

                        function a(e, t, n) {
                            this.pos = new i(e, t, n), this.prevPos = new i(e, t, n), this.force = new i, this.velocity = new i, this.mass = 1
                        }

                        function i(e, t, n) {
                            e && "number" !== typeof e ? (this.x = "number" === typeof e.x ? e.x : 0, this.y = "number" === typeof e.y ? e.y : 0, this.z = "number" === typeof e.z ? e.z : 0) : (this.x = "number" === typeof e ? e : 0, this.y = "number" === typeof t ? t : 0, this.z = "number" === typeof n ? n : 0)
                        }
                        t.exports = {
                            Body: r,
                            Vector2d: o,
                            Body3d: a,
                            Vector3d: i
                        }, r.prototype.setPosition = function(e, t) {
                            this.prevPos.x = this.pos.x = e, this.prevPos.y = this.pos.y = t
                        }, o.prototype.reset = function() {
                            this.x = this.y = 0
                        }, a.prototype.setPosition = function(e, t, n) {
                            this.prevPos.x = this.pos.x = e, this.prevPos.y = this.pos.y = t, this.prevPos.z = this.pos.z = n
                        }, i.prototype.reset = function() {
                            this.x = this.y = this.z = 0
                        }
                    }, {}],
                    17: [function(e, t, n) {
                        function r(e, t) {
                            return 0 === t ? e.quad0 : 1 === t ? e.quad1 : 2 === t ? e.quad2 : 3 === t ? e.quad3 : null
                        }

                        function o(e, t, n) {
                            0 === t ? e.quad0 = n : 1 === t ? e.quad1 = n : 2 === t ? e.quad2 = n : 3 === t && (e.quad3 = n)
                        }
                        t.exports = function(t) {
                            (t = t || {}).gravity = "number" === typeof t.gravity ? t.gravity : -1, t.theta = "number" === typeof t.theta ? t.theta : .8;
                            var n = e("ngraph.random").random(1984),
                                a = e("./node"),
                                i = e("./insertStack"),
                                s = e("./isSamePosition"),
                                c = t.gravity,
                                l = [],
                                d = new i,
                                u = t.theta,
                                p = [],
                                f = 0,
                                h = function() {
                                    var e = p[f];
                                    return e ? (e.quad0 = null, e.quad1 = null, e.quad2 = null, e.quad3 = null, e.body = null, e.mass = e.massX = e.massY = 0, e.left = e.right = e.top = e.bottom = 0) : (e = new a, p[f] = e), ++f, e
                                },
                                g = h(),
                                m = function(e) {
                                    for (d.reset(), d.push(g, e); !d.isEmpty();) {
                                        var t = d.pop(),
                                            a = t.node,
                                            i = t.body;
                                        if (a.body) {
                                            var c = a.body;
                                            if (a.body = null, s(c.pos, i.pos)) {
                                                var l = 3;
                                                do {
                                                    var u = n.nextDouble(),
                                                        p = (a.right - a.left) * u,
                                                        f = (a.bottom - a.top) * u;
                                                    c.pos.x = a.left + p, c.pos.y = a.top + f, l -= 1
                                                } while (l > 0 && s(c.pos, i.pos));
                                                if (0 === l && s(c.pos, i.pos)) return
                                            }
                                            d.push(a, c), d.push(a, i)
                                        } else {
                                            var m = i.pos.x,
                                                y = i.pos.y;
                                            a.mass = a.mass + i.mass, a.massX = a.massX + i.mass * m, a.massY = a.massY + i.mass * y;
                                            var b = 0,
                                                v = a.left,
                                                _ = (a.right + v) / 2,
                                                w = a.top,
                                                O = (a.bottom + w) / 2;
                                            if (m > _) {
                                                b += 1;
                                                var E = v;
                                                v = _, _ += _ - E
                                            }
                                            if (y > O) {
                                                b += 2;
                                                var j = w;
                                                w = O, O += O - j
                                            }
                                            var S = r(a, b);
                                            S ? d.push(S, i) : ((S = h()).left = v, S.top = w, S.right = _, S.bottom = O, S.body = i, o(a, b, S))
                                        }
                                    }
                                };
                            return {
                                insertBodies: function(e) {
                                    var t, n = Number.MAX_VALUE,
                                        r = Number.MAX_VALUE,
                                        o = Number.MIN_VALUE,
                                        a = Number.MIN_VALUE,
                                        i = e.length;
                                    for (t = i; t--;) {
                                        var s = e[t].pos.x,
                                            c = e[t].pos.y;
                                        s < n && (n = s), s > o && (o = s), c < r && (r = c), c > a && (a = c)
                                    }
                                    var l = o - n,
                                        d = a - r;
                                    for (l > d ? a = r + l : o = n + d, f = 0, (g = h()).left = n, g.right = o, g.top = r, g.bottom = a, (t = i - 1) > 0 && (g.body = e[t]); t--;) m(e[t], g)
                                },
                                updateBodyForce: function(e) {
                                    var t, r, o, a, i = l,
                                        s = 0,
                                        d = 0,
                                        p = 1,
                                        f = 0,
                                        h = 1;
                                    for (i[0] = g; p;) {
                                        var m = i[f],
                                            y = m.body;
                                        p -= 1, f += 1;
                                        var b = y !== e;
                                        y && b ? (r = y.pos.x - e.pos.x, o = y.pos.y - e.pos.y, 0 === (a = Math.sqrt(r * r + o * o)) && (r = (n.nextDouble() - .5) / 50, o = (n.nextDouble() - .5) / 50, a = Math.sqrt(r * r + o * o)), s += (t = c * y.mass * e.mass / (a * a * a)) * r, d += t * o) : b && (r = m.massX / m.mass - e.pos.x, o = m.massY / m.mass - e.pos.y, 0 === (a = Math.sqrt(r * r + o * o)) && (r = (n.nextDouble() - .5) / 50, o = (n.nextDouble() - .5) / 50, a = Math.sqrt(r * r + o * o)), (m.right - m.left) / a < u ? (s += (t = c * m.mass * e.mass / (a * a * a)) * r, d += t * o) : (m.quad0 && (i[h] = m.quad0, p += 1, h += 1), m.quad1 && (i[h] = m.quad1, p += 1, h += 1), m.quad2 && (i[h] = m.quad2, p += 1, h += 1), m.quad3 && (i[h] = m.quad3, p += 1, h += 1)))
                                    }
                                    e.force.x += s, e.force.y += d
                                },
                                options: function(e) {
                                    return e ? ("number" === typeof e.gravity && (c = e.gravity), "number" === typeof e.theta && (u = e.theta), this) : {
                                        gravity: c,
                                        theta: u
                                    }
                                }
                            }
                        }
                    }, {
                        "./insertStack": 18,
                        "./isSamePosition": 19,
                        "./node": 20,
                        "ngraph.random": 25
                    }],
                    18: [function(e, t, n) {
                        function r() {
                            this.stack = [], this.popIdx = 0
                        }

                        function o(e, t) {
                            this.node = e, this.body = t
                        }
                        t.exports = r, r.prototype = {
                            isEmpty: function() {
                                return 0 === this.popIdx
                            },
                            push: function(e, t) {
                                var n = this.stack[this.popIdx];
                                n ? (n.node = e, n.body = t) : this.stack[this.popIdx] = new o(e, t), ++this.popIdx
                            },
                            pop: function() {
                                if (this.popIdx > 0) return this.stack[--this.popIdx]
                            },
                            reset: function() {
                                this.popIdx = 0
                            }
                        }
                    }, {}],
                    19: [function(e, t, n) {
                        t.exports = function(e, t) {
                            var n = Math.abs(e.x - t.x),
                                r = Math.abs(e.y - t.y);
                            return n < 1e-8 && r < 1e-8
                        }
                    }, {}],
                    20: [function(e, t, n) {
                        t.exports = function() {
                            this.body = null, this.quad0 = null, this.quad1 = null, this.quad2 = null, this.quad3 = null, this.mass = 0, this.massX = 0, this.massY = 0, this.left = 0, this.top = 0, this.bottom = 0, this.right = 0
                        }
                    }, {}],
                    21: [function(e, t, n) {
                        t.exports = o;
                        var r = e("ngraph.graph");

                        function o(e, t, n) {
                            var o;
                            t = t || a, n = n || a, o = "string" === typeof e ? JSON.parse(e) : e;
                            var i, s = r();
                            if (void 0 === o.links || void 0 === o.nodes) throw new Error("Cannot load graph without links and nodes");
                            for (i = 0; i < o.nodes.length; ++i) {
                                var c = t(o.nodes[i]);
                                if (!c.hasOwnProperty("id")) throw new Error("Graph node format is invalid: Node id is missing");
                                s.addNode(c.id, c.data)
                            }
                            for (i = 0; i < o.links.length; ++i) {
                                var l = n(o.links[i]);
                                if (!l.hasOwnProperty("fromId") || !l.hasOwnProperty("toId")) throw new Error("Graph link format is invalid. Both fromId and toId are required");
                                s.addLink(l.fromId, l.toId, l.data)
                            }
                            return s
                        }

                        function a(e) {
                            return e
                        }
                    }, {
                        "ngraph.graph": 23
                    }],
                    22: [function(e, t, n) {
                        t.exports = {
                            ladder: o,
                            complete: i,
                            completeBipartite: s,
                            balancedBinTree: u,
                            path: c,
                            circularLadder: a,
                            grid: l,
                            grid3: d,
                            noLinks: p,
                            wattsStrogatz: f
                        };
                        var r = e("ngraph.graph");

                        function o(e) {
                            if (!e || e < 0) throw new Error("Invalid number of nodes");
                            var t, n = r();
                            for (t = 0; t < e - 1; ++t) n.addLink(t, t + 1), n.addLink(e + t, e + t + 1), n.addLink(t, e + t);
                            return n.addLink(e - 1, 2 * e - 1), n
                        }

                        function a(e) {
                            if (!e || e < 0) throw new Error("Invalid number of nodes");
                            var t = o(e);
                            return t.addLink(0, e - 1), t.addLink(e, 2 * e - 1), t
                        }

                        function i(e) {
                            if (!e || e < 1) throw new Error("At least two nodes are expected for complete graph");
                            var t, n, o = r();
                            for (t = 0; t < e; ++t)
                                for (n = t + 1; n < e; ++n) t !== n && o.addLink(t, n);
                            return o
                        }

                        function s(e, t) {
                            if (!e || !t || e < 0 || t < 0) throw new Error("Graph dimensions are invalid. Number of nodes in each partition should be greater than 0");
                            var n, o, a = r();
                            for (n = 0; n < e; ++n)
                                for (o = e; o < e + t; ++o) a.addLink(n, o);
                            return a
                        }

                        function c(e) {
                            if (!e || e < 0) throw new Error("Invalid number of nodes");
                            var t, n = r();
                            for (n.addNode(0), t = 1; t < e; ++t) n.addLink(t - 1, t);
                            return n
                        }

                        function l(e, t) {
                            if (e < 1 || t < 1) throw new Error("Invalid number of nodes in grid graph");
                            var n, o, a = r();
                            if (1 === e && 1 === t) return a.addNode(0), a;
                            for (n = 0; n < e; ++n)
                                for (o = 0; o < t; ++o) {
                                    var i = n + o * e;
                                    n > 0 && a.addLink(i, n - 1 + o * e), o > 0 && a.addLink(i, n + (o - 1) * e)
                                }
                            return a
                        }

                        function d(e, t, n) {
                            if (e < 1 || t < 1 || n < 1) throw new Error("Invalid number of nodes in grid3 graph");
                            var o, a, i, s = r();
                            if (1 === e && 1 === t && 1 === n) return s.addNode(0), s;
                            for (i = 0; i < n; ++i)
                                for (o = 0; o < e; ++o)
                                    for (a = 0; a < t; ++a) {
                                        var c = i * e * t,
                                            l = o + a * e + c;
                                        o > 0 && s.addLink(l, o - 1 + a * e + c), a > 0 && s.addLink(l, o + (a - 1) * e + c), i > 0 && s.addLink(l, o + a * e + (i - 1) * e * t)
                                    }
                            return s
                        }

                        function u(e) {
                            if (e < 0) throw new Error("Invalid number of nodes in balanced tree");
                            var t, n = r(),
                                o = Math.pow(2, e);
                            for (0 === e && n.addNode(1), t = 1; t < o; ++t) {
                                var a = t,
                                    i = 2 * a,
                                    s = 2 * a + 1;
                                n.addLink(a, i), n.addLink(a, s)
                            }
                            return n
                        }

                        function p(e) {
                            if (e < 0) throw new Error("Number of nodes shoul be >= 0");
                            var t, n = r();
                            for (t = 0; t < e; ++t) n.addNode(t);
                            return n
                        }

                        function f(t, n, o, a) {
                            if (n >= t) throw new Error("Choose smaller `k`. It cannot be larger than number of nodes `n`");
                            var i, s, c = e("ngraph.random").random(a || 42),
                                l = r();
                            for (i = 0; i < t; ++i) l.addNode(i);
                            for (var d = Math.floor(n / 2 + 1), u = 1; u < d; ++u)
                                for (i = 0; i < t; ++i) s = (u + i) % t, l.addLink(i, s);
                            for (u = 1; u < d; ++u)
                                for (i = 0; i < t; ++i)
                                    if (c.nextDouble() < o) {
                                        var p = i;
                                        s = (u + i) % t;
                                        var f = c.next(t),
                                            h = f === p || l.hasLink(p, f);
                                        if (h && l.getLinks(p).length === t - 1) continue;
                                        for (; h;) h = (f = c.next(t)) === p || l.hasLink(p, f);
                                        var g = l.hasLink(p, s);
                                        l.removeLink(g), l.addLink(p, f)
                                    }
                            return l
                        }
                    }, {
                        "ngraph.graph": 23,
                        "ngraph.random": 25
                    }],
                    23: [function(e, t, n) {
                        t.exports = o;
                        var r = e("ngraph.events");

                        function o(e) {
                            void 0 === (e = e || {}).uniqueLinkId && (e.uniqueLinkId = !0);
                            var t = "function" === typeof Object.create ? Object.create(null) : {},
                                n = [],
                                o = {},
                                c = 0,
                                l = 0,
                                d = R(),
                                u = e.uniqueLinkId ? x : S,
                                p = [],
                                f = M,
                                h = M,
                                g = M,
                                m = M,
                                y = {
                                    addNode: w,
                                    addLink: j,
                                    removeLink: C,
                                    removeNode: E,
                                    getNode: O,
                                    getNodesCount: function() {
                                        return c
                                    },
                                    getLinksCount: function() {
                                        return n.length
                                    },
                                    getLinks: k,
                                    forEachNode: d,
                                    forEachLinkedNode: P,
                                    forEachLink: L,
                                    beginUpdate: g,
                                    endUpdate: m,
                                    clear: T,
                                    hasLink: N,
                                    getLink: N
                                };
                            return r(y), b(), y;

                            function b() {
                                var e = y.on;

                                function t() {
                                    return y.beginUpdate = g = q, y.endUpdate = m = I, f = v, h = _, y.on = e, e.apply(y, arguments)
                                }
                                y.on = t
                            }

                            function v(e, t) {
                                p.push({
                                    link: e,
                                    changeType: t
                                })
                            }

                            function _(e, t) {
                                p.push({
                                    node: e,
                                    changeType: t
                                })
                            }

                            function w(e, n) {
                                if (void 0 === e) throw new Error("Invalid node identifier");
                                g();
                                var r = O(e);
                                return r ? h(r, "update") : (r = new i(e), c++, h(r, "add")), r.data = n, t[e] = r, m(), r
                            }

                            function O(e) {
                                return t[e]
                            }

                            function E(e) {
                                var n = O(e);
                                if (!n) return !1;
                                for (g(); n.links.length;) C(n.links[0]);
                                return delete t[e], c--, h(n, "remove"), m(), !0
                            }

                            function j(e, t, r) {
                                g();
                                var o = O(e) || w(e),
                                    a = O(t) || w(t),
                                    i = u(e, t, r);
                                return n.push(i), o.links.push(i), e !== t && a.links.push(i), f(i, "add"), m(), i
                            }

                            function S(e, t, n) {
                                var r = e.toString() + t.toString();
                                return new s(e, t, n, r)
                            }

                            function x(e, t, n) {
                                var r = e.toString() + "\ud83d\udc49 " + t.toString(),
                                    a = o.hasOwnProperty(r);
                                return (a || N(e, t)) && (a || (o[r] = 0), r += "@" + ++o[r]), new s(e, t, n, r)
                            }

                            function k(e) {
                                var t = O(e);
                                return t ? t.links : null
                            }

                            function C(e) {
                                if (!e) return !1;
                                var t = a(e, n);
                                if (t < 0) return !1;
                                g(), n.splice(t, 1);
                                var r = O(e.fromId),
                                    o = O(e.toId);
                                return r && (t = a(e, r.links)) >= 0 && r.links.splice(t, 1), o && (t = a(e, o.links)) >= 0 && o.links.splice(t, 1), f(e, "remove"), m(), !0
                            }

                            function N(e, t) {
                                var n, r = O(e);
                                if (!r) return null;
                                for (n = 0; n < r.links.length; ++n) {
                                    var o = r.links[n];
                                    if (o.fromId === e && o.toId === t) return o
                                }
                                return null
                            }

                            function T() {
                                g(), d((function(e) {
                                    E(e.id)
                                })), m()
                            }

                            function L(e) {
                                var t, r;
                                if ("function" === typeof e)
                                    for (t = 0, r = n.length; t < r; ++t) e(n[t])
                            }

                            function P(e, t, n) {
                                var r = O(e);
                                if (r && r.links && "function" === typeof t) return n ? D(r.links, e, t) : A(r.links, e, t)
                            }

                            function A(e, n, r) {
                                for (var o = 0; o < e.length; ++o) {
                                    var a = e[o],
                                        i = a.fromId === n ? a.toId : a.fromId;
                                    if (r(t[i], a)) return !0
                                }
                            }

                            function D(e, n, r) {
                                for (var o = 0; o < e.length; ++o) {
                                    var a = e[o];
                                    if (a.fromId === n && r(t[a.toId], a)) return !0
                                }
                            }

                            function M() {}

                            function q() {
                                l += 1
                            }

                            function I() {
                                0 === (l -= 1) && p.length > 0 && (y.fire("changed", p), p.length = 0)
                            }

                            function R() {
                                return Object.keys ? B : F
                            }

                            function B(e) {
                                if ("function" === typeof e)
                                    for (var n = Object.keys(t), r = 0; r < n.length; ++r)
                                        if (e(t[n[r]])) return !0
                            }

                            function F(e) {
                                var n;
                                if ("function" === typeof e)
                                    for (n in t)
                                        if (e(t[n])) return !0
                            }
                        }

                        function a(e, t) {
                            if (t.indexOf) return t.indexOf(e);
                            var n, r = t.length;
                            for (n = 0; n < r; n += 1)
                                if (t[n] === e) return n;
                            return -1
                        }

                        function i(e) {
                            this.id = e, this.links = [], this.data = null
                        }

                        function s(e, t, n, r) {
                            this.fromId = e, this.toId = t, this.data = n, this.id = r
                        }
                    }, {
                        "ngraph.events": 6
                    }],
                    24: [function(e, t, n) {
                        function r(e, t) {
                            var n;
                            if (e || (e = {}), t)
                                for (n in t)
                                    if (t.hasOwnProperty(n)) {
                                        var o = e.hasOwnProperty(n),
                                            a = typeof t[n];
                                        o && typeof e[n] === a ? "object" === a && (e[n] = r(e[n], t[n])) : e[n] = t[n]
                                    }
                            return e
                        }
                        t.exports = r
                    }, {}],
                    25: [function(e, t, n) {
                        function r(e) {
                            var t = "number" === typeof e ? e : +new Date,
                                n = function() {
                                    return (268435455 & (t = 4294967295 & (3042594569 ^ (t = 4251993797 + (t = 4294967295 & (3550635116 + (t = 374761393 + (t = 4294967295 & (3345072700 ^ (t = t + 2127912214 + (t << 12) & 4294967295) ^ t >>> 19)) + (t << 5) & 4294967295) ^ t << 9)) + (t << 3) & 4294967295) ^ t >>> 16))) / 268435456
                                };
                            return {
                                next: function(e) {
                                    return Math.floor(n() * e)
                                },
                                nextDouble: function() {
                                    return n()
                                }
                            }
                        }

                        function o(e, t) {
                            var n = t || r();
                            if ("function" !== typeof n.next) throw new Error("customRandom does not match expected API: next() function is missing");
                            return {
                                forEach: function(t) {
                                    var r, o, a;
                                    for (r = e.length - 1; r > 0; --r) o = n.next(r + 1), a = e[o], e[o] = e[r], e[r] = a, t(a);
                                    e.length && t(e[0])
                                },
                                shuffle: function() {
                                    var t, r, o;
                                    for (t = e.length - 1; t > 0; --t) r = n.next(t + 1), o = e[r], e[r] = e[t], e[t] = o;
                                    return e
                                }
                            }
                        }
                        t.exports = {
                            random: r,
                            randomIterator: o
                        }
                    }, {}],
                    26: [function(e, t, n) {
                        function r(e, t, n) {
                            var r = {
                                    nodes: [],
                                    links: []
                                },
                                o = t || c,
                                a = n || l;
                            return e.forEachNode(i), e.forEachLink(s), JSON.stringify(r);

                            function i(e) {
                                r.nodes.push(o(e))
                            }

                            function s(e) {
                                r.links.push(a(e))
                            }

                            function c(e) {
                                var t = {
                                    id: e.id
                                };
                                return void 0 !== e.data && (t.data = e.data), t
                            }

                            function l(e) {
                                var t = {
                                    fromId: e.fromId,
                                    toId: e.toId
                                };
                                return void 0 !== e.data && (t.data = e.data), t
                            }
                        }
                        t.exports = r
                    }, {}],
                    27: [function(e, t, n) {
                        t.exports = s, s.compile = e("./lib/compile");
                        var r = s.compileTemplate = e("./lib/compile_template"),
                            o = e("add-event-listener"),
                            a = "http://www.w3.org/2000/svg",
                            i = "http://www.w3.org/1999/xlink";

                        function s(e, t) {
                            var n = c(e);
                            if (void 0 === t) return n;
                            for (var r = Object.keys(t), o = 0; o < r.length; ++o) {
                                var a = r[o],
                                    i = t[a];
                                "link" === a ? n.link(i) : n.attr(a, i)
                            }
                            return n
                        }

                        function c(e) {
                            var t, n = e;
                            if ("string" === typeof e) n = window.document.createElementNS(a, e);
                            else if (e.simplesvg) return e;
                            return n.simplesvg = !0, n.attr = p, n.append = u, n.link = f, n.text = h, n.on = l, n.off = d, n.dataSource = c, n;

                            function c(e) {
                                return t || (t = r(n)), t.link(e), n
                            }

                            function l(e, t, r) {
                                return o.addEventListener(n, e, t, r), n
                            }

                            function d(e, t, r) {
                                return o.removeEventListener(n, e, t, r), n
                            }

                            function u(e) {
                                var t = s(e);
                                return n.appendChild(t), t
                            }

                            function p(e, t) {
                                return 2 === arguments.length ? (null !== t ? n.setAttributeNS(null, e, t) : n.removeAttributeNS(null, e), n) : n.getAttributeNS(null, e)
                            }

                            function f(e) {
                                return arguments.length ? (n.setAttributeNS(i, "xlink:href", e), n) : n.getAttributeNS(i, "xlink:href")
                            }

                            function h(e) {
                                return void 0 !== e ? (n.textContent = e, n) : n.textContent
                            }
                        }
                    }, {
                        "./lib/compile": 28,
                        "./lib/compile_template": 29,
                        "add-event-listener": 31
                    }],
                    28: [function(e, t, n) {
                        var r = e("./domparser.js"),
                            o = e("../");

                        function a(e) {
                            try {
                                return e = i(e), o(r.parseFromString(e, "text/xml").documentElement)
                            } catch (t) {
                                throw t
                            }
                        }

                        function i(e) {
                            if (e) {
                                var t = 'xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"',
                                    n = e.match(/^<\w+/);
                                if (n) {
                                    var r = n[0].length;
                                    return e.substr(0, r) + " " + t + " " + e.substr(r)
                                }
                                throw new Error("Cannot parse input text: invalid xml?")
                            }
                        }
                        t.exports = a
                    }, {
                        "../": 27,
                        "./domparser.js": 30
                    }],
                    29: [function(e, t, n) {
                        t.exports = o;
                        var r = /{{(.+?)}}/;

                        function o(e) {
                            var t = Object.create(null);
                            return a(e, t), {
                                link: function(e) {
                                    function n(t) {
                                        t(e)
                                    }
                                    Object.keys(t).forEach((function(e) {
                                        t[e].forEach(n)
                                    }))
                                }
                            }
                        }

                        function a(e, t) {
                            var n = e.nodeType;
                            if (1 === n || 3 === n) {
                                var r;
                                if (e.hasChildNodes()) {
                                    var o = e.childNodes;
                                    for (r = 0; r < o.length; ++r) a(o[r], t)
                                }
                                if (3 === n && s(e, t), e.attributes) {
                                    var c = e.attributes;
                                    for (r = 0; r < c.length; ++r) i(c[r], e, t)
                                }
                            }
                        }

                        function i(e, t, n) {
                            var o = e.value;
                            if (o) {
                                var a = o.match(r);
                                if (a) {
                                    var i = e.localName,
                                        s = a[1];
                                    if (!(s.indexOf(".") < 0)) throw new Error("simplesvg currently does not support nested bindings");
                                    var c = n[s];
                                    c ? c.push(l) : c = n[s] = [l]
                                }
                            }

                            function l(e) {
                                t.setAttributeNS(null, i, e[s])
                            }
                        }

                        function s(e, t) {
                            var n = e.nodeValue;
                            if (n) {
                                var o = n.match(r);
                                if (o) {
                                    var a = o[1],
                                        i = (a.indexOf("."), t[a]);
                                    i ? i.push(s) : i = t[a] = [s]
                                }
                            }

                            function s(t) {
                                e.nodeValue = t[a]
                            }
                        }
                    }, {}],
                    30: [function(e, t, n) {
                        function r() {
                            return "undefined" === typeof DOMParser ? {
                                parseFromString: o
                            } : new DOMParser
                        }

                        function o() {
                            throw new Error("DOMParser is not supported by this platform. Please open issue here https://github.com/anvaka/simplesvg")
                        }
                        t.exports = r()
                    }, {}],
                    31: [function(e, t, n) {
                        o.removeEventListener = a, o.addEventListener = o, t.exports = o;
                        var r = null;

                        function o(e, t, n, o) {
                            return (r = r || (document.addEventListener ? {
                                add: i,
                                rm: s
                            } : {
                                add: c,
                                rm: l
                            })).add(e, t, n, o)
                        }

                        function a(e, t, n, o) {
                            return (r = r || (document.addEventListener ? {
                                add: i,
                                rm: s
                            } : {
                                add: c,
                                rm: l
                            })).rm(e, t, n, o)
                        }

                        function i(e, t, n, r) {
                            e.addEventListener(t, n, r)
                        }

                        function s(e, t, n, r) {
                            e.removeEventListener(t, n, r)
                        }

                        function c(e, t, n, r) {
                            if (r) throw new Error("cannot useCapture in oldIE");
                            e.attachEvent("on" + t, n)
                        }

                        function l(e, t, n, r) {
                            e.detachEvent("on" + t, n)
                        }
                    }, {}],
                    32: [function(e, t, n) {
                        var r = e("ngraph.centrality");

                        function o() {
                            return {
                                betweennessCentrality: a,
                                degreeCentrality: i
                            }
                        }

                        function a(e) {
                            return s(r.betweenness(e))
                        }

                        function i(e, t) {
                            return s(r.degree(e, t))
                        }

                        function s(e) {
                            return Object.keys(e).sort(t).map(n);

                            function t(t, n) {
                                return e[n] - e[t]
                            }

                            function n(t) {
                                return {
                                    key: t,
                                    value: e[t]
                                }
                            }
                        }
                        t.exports = o
                    }, {
                        "ngraph.centrality": 3
                    }],
                    33: [function(e, t, n) {
                        function r() {
                            return {
                                density: function(e, t) {
                                    var n = e.getNodesCount();
                                    return 0 === n ? NaN : t ? e.getLinksCount() / (n * (n - 1)) : 2 * e.getLinksCount() / (n * (n - 1))
                                }
                            }
                        }
                        t.exports = r
                    }, {}],
                    34: [function(e, t, n) {
                        t.exports = o;
                        var r = e("./dragndrop.js");

                        function o(e, t) {
                            var n = {};
                            return {
                                bindDragNDrop: o
                            };

                            function o(e, o) {
                                var a;
                                if (o) {
                                    var i = t.getNodeUI(e.id);
                                    a = r(i), "function" === typeof o.onStart && a.onStart(o.onStart), "function" === typeof o.onDrag && a.onDrag(o.onDrag), "function" === typeof o.onStop && a.onStop(o.onStop), n[e.id] = a
                                } else(a = n[e.id]) && (a.release(), delete n[e.id])
                            }
                        }
                    }, {
                        "./dragndrop.js": 35
                    }],
                    35: [function(e, t, n) {
                        t.exports = i;
                        var r = e("../Utils/documentEvents.js"),
                            o = e("../Utils/browserInfo.js"),
                            a = e("../Utils/findElementPosition.js");

                        function i(e) {
                            var t, n, i, s, c, l, d, u = 0,
                                p = 0,
                                f = !1,
                                h = 0,
                                g = function(e) {
                                    var t = 0,
                                        n = 0;
                                    return (e = e || window.event).pageX || e.pageY ? (t = e.pageX, n = e.pageY) : (e.clientX || e.clientY) && (t = e.clientX + window.document.body.scrollLeft + window.document.documentElement.scrollLeft, n = e.clientY + window.document.body.scrollTop + window.document.documentElement.scrollTop), [t, n]
                                },
                                m = function(e, t, r) {
                                    n && n(e, {
                                        x: t - u,
                                        y: r - p
                                    }), u = t, p = r
                                },
                                y = function(e) {
                                    e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0
                                },
                                b = function(e) {
                                    e.preventDefault && e.preventDefault()
                                },
                                v = function(e) {
                                    return y(e), !1
                                },
                                _ = function(e) {
                                    e = e || window.event, m(e, e.clientX, e.clientY)
                                },
                                w = function(e) {
                                    return e = e || window.event, f ? (y(e), !1) : 1 === e.button && null !== window.event || 0 === e.button ? (u = e.clientX, p = e.clientY, d = e.target || e.srcElement, t && t(e, {
                                        x: u,
                                        y: p
                                    }), r.on("mousemove", _), r.on("mouseup", O), y(e), c = window.document.onselectstart, l = window.document.ondragstart, window.document.onselectstart = v, d.ondragstart = v, !1) : void 0
                                },
                                O = function e(t) {
                                    t = t || window.event, r.off("mousemove", _), r.off("mouseup", e), window.document.onselectstart = c, d.ondragstart = l, d = null, i && i(t)
                                },
                                E = function(t) {
                                    if ("function" === typeof s) {
                                        (t = t || window.event).preventDefault && t.preventDefault(), t.returnValue = !1;
                                        var n, r = g(t),
                                            o = a(e),
                                            i = {
                                                x: r[0] - o[0],
                                                y: r[1] - o[1]
                                            };
                                        n = t.wheelDelta ? t.wheelDelta / 360 : t.detail / -9, s(t, n, i)
                                    }
                                },
                                j = function(t) {
                                    !s && t ? "webkit" === o.browser ? e.addEventListener("mousewheel", E, !1) : e.addEventListener("DOMMouseScroll", E, !1) : s && !t && ("webkit" === o.browser ? e.removeEventListener("mousewheel", E, !1) : e.removeEventListener("DOMMouseScroll", E, !1)), s = t
                                },
                                S = function(e, t) {
                                    return (e.clientX - t.clientX) * (e.clientX - t.clientX) + (e.clientY - t.clientY) * (e.clientY - t.clientY)
                                },
                                x = function(e) {
                                    if (1 === e.touches.length) {
                                        y(e);
                                        var t = e.touches[0];
                                        m(e, t.clientX, t.clientY)
                                    } else if (2 === e.touches.length) {
                                        var n = S(e.touches[0], e.touches[1]),
                                            r = 0;
                                        n < h ? r = -1 : n > h && (r = 1), s(e, r, {
                                            x: e.touches[0].clientX,
                                            y: e.touches[0].clientY
                                        }), h = n, y(e), b(e)
                                    }
                                },
                                k = function e(t) {
                                    f = !1, r.off("touchmove", x), r.off("touchend", e), r.off("touchcancel", e), d = null, i && i(t)
                                },
                                C = function(e, n) {
                                    y(e), b(e), u = n.clientX, p = n.clientY, d = e.target || e.srcElement, t && t(e, {
                                        x: u,
                                        y: p
                                    }), f || (f = !0, r.on("touchmove", x), r.on("touchend", k), r.on("touchcancel", k))
                                },
                                N = function(e) {
                                    if (1 === e.touches.length) return C(e, e.touches[0]);
                                    2 === e.touches.length && (y(e), b(e), h = S(e.touches[0], e.touches[1]))
                                };
                            return e.addEventListener("mousedown", w), e.addEventListener("touchstart", N), {
                                onStart: function(e) {
                                    return t = e, this
                                },
                                onDrag: function(e) {
                                    return n = e, this
                                },
                                onStop: function(e) {
                                    return i = e, this
                                },
                                onScroll: function(e) {
                                    return j(e), this
                                },
                                release: function() {
                                    e.removeEventListener("mousedown", w), e.removeEventListener("touchstart", N), r.off("mousemove", _), r.off("mouseup", O), r.off("touchmove", x), r.off("touchend", k), r.off("touchcancel", k), j(null)
                                }
                            }
                        }
                    }, {
                        "../Utils/browserInfo.js": 39,
                        "../Utils/documentEvents.js": 40,
                        "../Utils/findElementPosition.js": 41
                    }],
                    36: [function(e, t, n) {
                        t.exports = o;
                        var r = e("../WebGL/webglInputEvents.js");

                        function o(e, t) {
                            var n = r(t),
                                o = null,
                                a = {},
                                i = {
                                    x: 0,
                                    y: 0
                                };
                            return n.mouseDown((function(e, t) {
                                o = e, i.x = t.clientX, i.y = t.clientY, n.mouseCapture(o);
                                var r = a[e.id];
                                return r && r.onStart && r.onStart(t, i), !0
                            })).mouseUp((function(e) {
                                n.releaseMouseCapture(o), o = null;
                                var t = a[e.id];
                                return t && t.onStop && t.onStop(), !0
                            })).mouseMove((function(e, t) {
                                if (o) {
                                    var n = a[o.id];
                                    return n && n.onDrag && n.onDrag(t, {
                                        x: t.clientX - i.x,
                                        y: t.clientY - i.y
                                    }), i.x = t.clientX, i.y = t.clientY, !0
                                }
                            })), {
                                bindDragNDrop: function(e, t) {
                                    a[e.id] = t, t || delete a[e.id]
                                }
                            }
                        }
                    }, {
                        "../WebGL/webglInputEvents.js": 57
                    }],
                    37: [function(e, t, n) {
                        t.exports = i;
                        var r = e("ngraph.merge"),
                            o = e("ngraph.random").random,
                            a = e("../Utils/rect.js");

                        function i(e, t) {
                            t = r(t, {
                                maxX: 1024,
                                maxY: 1024,
                                seed: "Deterministic randomness made me do this"
                            });
                            var n = o(t.seed),
                                i = new a(Number.MAX_VALUE, Number.MAX_VALUE, Number.MIN_VALUE, Number.MIN_VALUE),
                                s = {},
                                c = function(e) {
                                    return {
                                        x: n.next(t.maxX),
                                        y: n.next(t.maxY)
                                    }
                                },
                                l = function(e, t) {
                                    e.x < t.x1 && (t.x1 = e.x), e.x > t.x2 && (t.x2 = e.x), e.y < t.y1 && (t.y1 = e.y), e.y > t.y2 && (t.y2 = e.y)
                                },
                                d = "function" === typeof Object.create ? Object.create(null) : {},
                                u = function(e) {
                                    d[e.id] = c(e), l(d[e.id], i)
                                },
                                p = function() {
                                    0 !== e.getNodesCount() && (i.x1 = Number.MAX_VALUE, i.y1 = Number.MAX_VALUE, i.x2 = Number.MIN_VALUE, i.y2 = Number.MIN_VALUE, e.forEachNode(u))
                                },
                                f = function(e) {
                                    s[e.id] = e
                                },
                                h = function(e) {
                                    for (var t = 0; t < e.length; ++t) {
                                        var n = e[t];
                                        n.node && ("add" === n.changeType ? u(n.node) : delete d[n.node.id]), n.link && ("add" === n.changeType ? f(n.link) : delete s[n.link.id])
                                    }
                                };
                            return e.forEachNode(u), e.forEachLink(f), e.on("changed", h), {
                                run: function(e) {
                                    this.step()
                                },
                                step: function() {
                                    return p(), !0
                                },
                                getGraphRect: function() {
                                    return i
                                },
                                dispose: function() {
                                    e.off("change", h)
                                },
                                isNodePinned: function(e) {
                                    return !0
                                },
                                pinNode: function(e, t) {},
                                getNodePosition: g,
                                getLinkPosition: function(e) {
                                    var t = s[e];
                                    return {
                                        from: g(t.fromId),
                                        to: g(t.toId)
                                    }
                                },
                                setNodePosition: function(e, t, n) {
                                    var r = d[e];
                                    r && (r.x = t, r.y = n)
                                },
                                placeNode: function(e) {
                                    return "function" === typeof e ? (c = e, p(), this) : c(e)
                                }
                            };

                            function g(e) {
                                return d[e]
                            }
                        }
                    }, {
                        "../Utils/rect.js": 45,
                        "ngraph.merge": 24,
                        "ngraph.random": 25
                    }],
                    38: [function(e, t, n) {
                        var r = e("ngraph.events");

                        function o(e) {
                            return console.log("This method is deprecated. Please use Viva.events() instead"), e ? void 0 !== e.on || void 0 !== e.off || void 0 !== e.fire ? {
                                extend: function() {
                                    return e
                                },
                                on: e.on,
                                stop: e.off
                            } : {
                                extend: t,
                                on: e.on,
                                stop: e.off
                            } : e;

                            function t() {
                                var t = r(e);
                                return t.addEventListener = t.on, t
                            }
                        }
                        t.exports = o
                    }, {
                        "ngraph.events": 6
                    }],
                    39: [function(e, t, n) {
                        function r() {
                            if ("undefined" === typeof window || !window.hasOwnProperty("navigator")) return {
                                browser: "",
                                version: "0"
                            };
                            var e = window.navigator.userAgent.toLowerCase(),
                                t = /(opera)(?:.*version)?[ \/]([\w.]+)/,
                                n = /(msie) ([\w.]+)/,
                                r = /(mozilla)(?:.*? rv:([\w.]+))?/,
                                o = /(webkit)[ \/]([\w.]+)/.exec(e) || t.exec(e) || n.exec(e) || e.indexOf("compatible") < 0 && r.exec(e) || [];
                            return {
                                browser: o[1] || "",
                                version: o[2] || "0"
                            }
                        }
                        t.exports = r()
                    }, {}],
                    40: [function(e, t, n) {
                        var r = e("./nullEvents.js");

                        function o() {
                            return void 0 === typeof document ? r : {
                                on: a,
                                off: i
                            }
                        }

                        function a(e, t) {
                            document.addEventListener(e, t)
                        }

                        function i(e, t) {
                            document.removeEventListener(e, t)
                        }
                        t.exports = o()
                    }, {
                        "./nullEvents.js": 44
                    }],
                    41: [function(e, t, n) {
                        function r(e) {
                            var t = 0,
                                n = 0;
                            if (e.offsetParent)
                                do {
                                    t += e.offsetLeft, n += e.offsetTop
                                } while (null !== (e = e.offsetParent));
                            return [t, n]
                        }
                        t.exports = r
                    }, {}],
                    42: [function(e, t, n) {
                        function r(e) {
                            if (!e) throw {
                                message: "Cannot get dimensions of undefined container"
                            };
                            return {
                                left: 0,
                                top: 0,
                                width: e.clientWidth,
                                height: e.clientHeight
                            }
                        }
                        t.exports = r
                    }, {}],
                    43: [function(e, t, n) {
                        var r = e("gintersect");

                        function o(e, t, n, o, a, i, s, c) {
                            return r(e, t, e, o, a, i, s, c) || r(e, o, n, o, a, i, s, c) || r(n, o, n, t, a, i, s, c) || r(n, t, e, t, a, i, s, c)
                        }
                        t.exports = o
                    }, {
                        gintersect: 2
                    }],
                    44: [function(e, t, n) {
                        function r() {
                            return {
                                on: o,
                                off: o,
                                stop: o
                            }
                        }

                        function o() {}
                        t.exports = r()
                    }, {}],
                    45: [function(e, t, n) {
                        function r(e, t, n, r) {
                            this.x1 = e || 0, this.y1 = t || 0, this.x2 = n || 0, this.y2 = r || 0
                        }
                        t.exports = r
                    }, {}],
                    46: [function(e, n, r) {
                        (function(e) {
                            function t() {
                                var t, n, o = 0,
                                    a = ["ms", "moz", "webkit", "o"];
                                for (n = "undefined" !== typeof window ? window : "undefined" !== typeof e ? e : {
                                        setTimeout: r,
                                        clearTimeout: r
                                    }, t = 0; t < a.length && !n.requestAnimationFrame; ++t) {
                                    var i = a[t];
                                    n.requestAnimationFrame = n[i + "RequestAnimationFrame"], n.cancelAnimationFrame = n[i + "CancelAnimationFrame"] || n[i + "CancelRequestAnimationFrame"]
                                }
                                return n.requestAnimationFrame || (n.requestAnimationFrame = c), n.cancelAnimationFrame || (n.cancelAnimationFrame = l), s;

                                function s(e) {
                                    var t;
                                    return r(), {
                                        stop: o,
                                        restart: a
                                    };

                                    function r() {
                                        t = n.requestAnimationFrame(r), e() || o()
                                    }

                                    function o() {
                                        n.cancelAnimationFrame(t), t = 0
                                    }

                                    function a() {
                                        t || r()
                                    }
                                }

                                function c(e) {
                                    var t = (new Date).getTime(),
                                        r = Math.max(0, 16 - (t - o)),
                                        a = n.setTimeout((function() {
                                            e(t + r)
                                        }), r);
                                    return o = t + r, a
                                }

                                function l(e) {
                                    n.clearTimeout(e)
                                }
                            }

                            function r() {}
                            n.exports = t()
                        }).call(this, "undefined" !== typeof t ? t : "undefined" !== typeof self ? self : "undefined" !== typeof window ? window : {})
                    }, {}],
                    47: [function(e, t, n) {
                        var r = e("./nullEvents.js");

                        function o() {
                            return void 0 === typeof window ? r : {
                                on: a,
                                off: i
                            }
                        }

                        function a(e, t) {
                            window.addEventListener(e, t)
                        }

                        function i(e, t) {
                            window.removeEventListener(e, t)
                        }
                        t.exports = o()
                    }, {
                        "./nullEvents.js": 44
                    }],
                    48: [function(e, t, n) {
                        t.exports = u;
                        var r = e("ngraph.events"),
                            o = e("ngraph.forcelayout"),
                            a = e("./svgGraphics.js"),
                            i = e("../Utils/windowEvents.js"),
                            s = e("../Input/domInputManager.js"),
                            c = e("../Utils/timer.js"),
                            l = e("../Utils/getDimensions.js"),
                            d = e("../Input/dragndrop.js");

                        function u(e, t) {
                            var n, u, p, f = 30,
                                h = (t = t || {}).layout,
                                g = t.graphics,
                                m = t.container,
                                y = void 0 === t.interactive || t.interactive,
                                b = !1,
                                v = !0,
                                _ = !1,
                                w = !1,
                                O = !1,
                                E = !1,
                                j = {
                                    offsetX: 0,
                                    offsetY: 0,
                                    scale: 1
                                },
                                S = r({});
                            return {
                                run: function(e) {
                                    return b || (k(), P(), F(), A(), $(), b = !0), T(e), this
                                },
                                reset: function() {
                                    g.resetScale(), A(), j.scale = 1
                                },
                                pause: function() {
                                    O = !0, u.stop()
                                },
                                resume: function() {
                                    O = !1, u.restart()
                                },
                                rerender: function() {
                                    return C(), this
                                },
                                zoomOut: function() {
                                    return X(!0)
                                },
                                zoomIn: function() {
                                    return X(!1)
                                },
                                zoomTo: Z,
                                getZoom: J,
                                moveTo: function(e, t) {
                                    g.graphCenterChanged(j.offsetX - e * j.scale, j.offsetY - t * j.scale), C()
                                },
                                getGraphics: function() {
                                    return g
                                },
                                dispose: function() {
                                    Q()
                                },
                                on: function(e, t) {
                                    return S.on(e, t), this
                                },
                                off: function(e, t) {
                                    return S.off(e, t), this
                                },
                                pinGraph: function(e) {
                                    E = e
                                },
                                getPaused: function() {
                                    return O
                                },
                                setTransform: function(e, t, n) {
                                    j.scale = n, j.x = e, j.y = t, C()
                                }
                            };

                            function x(e) {
                                return "string" === typeof y ? y.indexOf(e) >= 0 : "boolean" !== typeof y || y
                            }

                            function k() {
                                m = m || window.document.body, h = h || o(e, {
                                    springLength: 80,
                                    springCoeff: 2e-4
                                }), g = g || a(e, {
                                    container: m
                                }), t.hasOwnProperty("renderLinks") || (t.renderLinks = !0), t.prerender = t.prerender || 0, n = (g.inputManager || s)(e, g)
                            }

                            function C() {
                                g.beginRender(), t.renderLinks && g.renderLinks(), g.renderNodes(), g.endRender(), S.fire("render")
                            }

                            function N() {
                                return _ = h.step() && !w, C(), !_
                            }

                            function T(e) {
                                u || (u = c(e ? function() {
                                    return N()
                                } : N, f))
                            }

                            function L() {
                                O || (_ = !1, u.restart())
                            }

                            function P() {
                                if ("number" === typeof t.prerender && t.prerender > 0)
                                    for (var e = 0; e < t.prerender; e += 1) h.step()
                            }

                            function A() {
                                var e = h.getGraphRect(),
                                    t = l(m),
                                    n = (e.x2 + e.x1) / 2,
                                    r = (e.y2 + e.y1) / 2;
                                j.offsetX = t.width / 2 - (n * j.scale - n), j.offsetY = t.height / 2 - (r * j.scale - r), g.graphCenterChanged(j.offsetX, j.offsetY), v = !1
                            }

                            function D(e) {
                                var t = h.getNodePosition(e.id);
                                g.addNode(e, t)
                            }

                            function M(e) {
                                g.releaseNode(e)
                            }

                            function q(e) {
                                var t = h.getLinkPosition(e.id);
                                g.addLink(e, t)
                            }

                            function I(e) {
                                g.releaseLink(e)
                            }

                            function R(e) {
                                if (x("node")) {
                                    var t = !1;
                                    n.bindDragNDrop(e, {
                                        onStart: function() {
                                            t = h.isNodePinned(e), h.pinNode(e, !0), w = !0, L()
                                        },
                                        onDrag: function(t, n) {
                                            if (!e.data.disable_drag) {
                                                S.fire("drag", e.id, {
                                                    x: n.x / j.scale,
                                                    y: n.y / j.scale
                                                });
                                                var r = h.getNodePosition(e.id);
                                                h.setNodePosition(e.id, r.x + n.x / j.scale, r.y + n.y / j.scale), w = !0, C()
                                            }
                                        },
                                        onStop: function() {
                                            h.pinNode(e, t), w = !1
                                        }
                                    })
                                }
                            }

                            function B(e) {
                                n.bindDragNDrop(e, null)
                            }

                            function F() {
                                g.init(m), e.forEachNode(D), t.renderLinks && e.forEachLink(q)
                            }

                            function G() {
                                g.release(m)
                            }

                            function H(t) {
                                var n = t.node;
                                "add" === t.changeType ? (D(n), R(n), v && A()) : "remove" === t.changeType ? (B(n), M(n), 0 === e.getNodesCount() && (v = !0)) : "update" === t.changeType && (B(n), M(n), D(n), R(n))
                            }

                            function U(e) {
                                var n = e.link;
                                if ("add" === e.changeType) t.renderLinks && q(n);
                                else if ("remove" === e.changeType) t.renderLinks && I(n);
                                else if ("update" === e.changeType) throw "Update type is not implemented. TODO: Implement me!"
                            }

                            function z(e) {
                                var t, n;
                                for (t = 0; t < e.length; t += 1)(n = e[t]).node ? H(n) : n.link && U(n);
                                L()
                            }

                            function W() {
                                O || (A(), N())
                            }

                            function Y() {
                                p && (p.release(), p = null)
                            }

                            function V() {
                                e.off("changed", z)
                            }

                            function X(e, t) {
                                if (!t) {
                                    var n = l(m);
                                    t = {
                                        x: n.width / 2,
                                        y: n.height / 2
                                    }
                                }
                                var r = Math.pow(1.4, e ? -.2 : .2);
                                return j.scale = g.scale(r, t), C(), S.fire("scale", j.scale), j.scale
                            }

                            function K(e, t) {
                                if (!t) {
                                    var n = l(m);
                                    t = {
                                        x: n.width / 2,
                                        y: n.height / 2
                                    }
                                }
                                var r = e / j.scale;
                                return j.scale = g.scale(r, t), C(), S.fire("scale", j.scale), j.scale
                            }

                            function $() {
                                i.on("resize", W), Y(), x("drag") && ((p = d(m)).onDrag((function(e, t) {
                                    S.fire("container-drag", !0, t), E || (g.translateRel(t.x, t.y), C())
                                })), p.onStop((function(e, t) {
                                    S.fire("container-drag", !1)
                                }))), x("scroll") && (p || (p = d(m)), p.onScroll((function(e, t, n) {
                                    X(t < 0, n)
                                }))), e.forEachNode(R), V(), e.on("changed", z)
                            }

                            function Z(e) {
                                return K(e), e
                            }

                            function J() {
                                return j.scale
                            }

                            function Q() {
                                b = !1, V(), Y(), i.off("resize", W), S.off(), u.stop(), e.forEachLink((function(e) {
                                    t.renderLinks && I(e)
                                })), e.forEachNode((function(e) {
                                    B(e), M(e)
                                })), h.dispose(), G()
                            }
                        }
                    }, {
                        "../Input/domInputManager.js": 34,
                        "../Input/dragndrop.js": 35,
                        "../Utils/getDimensions.js": 42,
                        "../Utils/timer.js": 46,
                        "../Utils/windowEvents.js": 47,
                        "./svgGraphics.js": 49,
                        "ngraph.events": 6,
                        "ngraph.forcelayout": 7
                    }],
                    49: [function(e, t, n) {
                        t.exports = i;
                        var r = e("simplesvg"),
                            o = e("ngraph.events"),
                            a = e("../Input/domInputManager.js");

                        function i() {
                            var e, t, n, i = 0,
                                s = 0,
                                c = 1,
                                l = {},
                                d = {},
                                u = function(e) {
                                    return r("rect").attr("width", 10).attr("height", 10).attr("fill", "#00a2e8")
                                },
                                p = function(e, t) {
                                    e.attr("x", t.x - 5).attr("y", t.y - 5)
                                },
                                f = function(e) {
                                    return r("line").attr("stroke", "#999")
                                },
                                h = function(e, t, n) {
                                    e.attr("x1", t.x).attr("y1", t.y).attr("x2", n.x).attr("y2", n.y)
                                },
                                g = function(e) {
                                    e.fire("rescaled")
                                },
                                m = {
                                    x: 0,
                                    y: 0
                                },
                                y = {
                                    x: 0,
                                    y: 0
                                },
                                b = {
                                    x: 0,
                                    y: 0
                                },
                                v = function() {
                                    if (e) {
                                        var t = "matrix(" + c + ", 0, 0," + c + "," + i + "," + s + ")";
                                        e.attr("transform", t)
                                    }
                                };
                            t = w();
                            var _ = {
                                getNodeUI: function(e) {
                                    return l[e]
                                },
                                getLinkUI: function(e) {
                                    return d[e]
                                },
                                node: function(e) {
                                    if ("function" === typeof e) return u = e, this
                                },
                                link: function(e) {
                                    if ("function" === typeof e) return f = e, this
                                },
                                placeNode: function(e) {
                                    return p = e, this
                                },
                                placeLink: function(e) {
                                    return h = e, this
                                },
                                beginRender: function() {},
                                endRender: function() {},
                                graphCenterChanged: function(e, t) {
                                    i = e, s = t, v()
                                },
                                inputManager: a,
                                translateRel: function(n, r) {
                                    var o = t.createSVGPoint(),
                                        a = e.getCTM(),
                                        i = t.createSVGPoint().matrixTransform(a.inverse());
                                    o.x = n, o.y = r, (o = o.matrixTransform(a.inverse())).x = (o.x - i.x) * a.a, o.y = (o.y - i.y) * a.d, a.e += o.x, a.f += o.y;
                                    var s = "matrix(" + a.a + ", 0, 0," + a.d + "," + a.e + "," + a.f + ")";
                                    e.attr("transform", s)
                                },
                                scale: function(n, r) {
                                    var o = t.createSVGPoint();
                                    o.x = r.x, o.y = r.y, o = o.matrixTransform(e.getCTM().inverse());
                                    var a = t.createSVGMatrix().translate(o.x, o.y).scale(n).translate(-o.x, -o.y),
                                        l = e.getCTM().multiply(a);
                                    c = l.a, i = l.e, s = l.f;
                                    var d = "matrix(" + l.a + ", 0, 0," + l.d + "," + l.e + "," + l.f + ")";
                                    return e.attr("transform", d), g(this), c
                                },
                                resetScale: function() {
                                    c = 1;
                                    var t = "matrix(1, 0, 0, 1, 0, 0)";
                                    return e.attr("transform", t), g(this), this
                                },
                                init: function(e) {
                                    e.appendChild(t), v(), "function" === typeof n && n(t)
                                },
                                release: function(e) {
                                    t && e && e.removeChild(t)
                                },
                                addLink: function(t, n) {
                                    var r = f(t);
                                    if (r) return r.position = n, r.link = t, d[t.id] = r, e.childElementCount > 0 ? e.insertBefore(r, e.firstChild) : e.appendChild(r), r
                                },
                                releaseLink: function(t) {
                                    var n = d[t.id];
                                    n && (e.removeChild(n), delete d[t.id])
                                },
                                addNode: function(t, n) {
                                    var r = u(t);
                                    if (r) return r.position = n, r.node = t, l[t.id] = r, e.appendChild(r), r
                                },
                                releaseNode: function(t) {
                                    var n = l[t.id];
                                    n && (e.removeChild(n), delete l[t.id])
                                },
                                renderNodes: function() {
                                    for (var e in l)
                                        if (l.hasOwnProperty(e)) {
                                            var t = l[e];
                                            m.x = t.position.x, m.y = t.position.y, p(t, m, t.node)
                                        }
                                },
                                renderLinks: function() {
                                    for (var e in d)
                                        if (d.hasOwnProperty(e)) {
                                            var t = d[e];
                                            y.x = t.position.from.x, y.y = t.position.from.y, b.x = t.position.to.x, b.y = t.position.to.y, h(t, y, b, t.link)
                                        }
                                },
                                renderLink: function(e) {
                                    if (d.hasOwnProperty(e)) {
                                        var t = d[e];
                                        y.x = t.position.from.x, y.y = t.position.from.y, b.x = t.position.to.x, b.y = t.position.to.y, h(t, y, b, t.link)
                                    }
                                },
                                getGraphicsRoot: function(e) {
                                    return "function" === typeof e && (t ? e(t) : n = e), t
                                },
                                getSvgRoot: function() {
                                    return t
                                },
                                getTransform: function() {
                                    return e.attr("transform")
                                },
                                setTransform: function(t) {
                                    e.attr("transform", t)
                                }
                            };
                            return o(_), _;

                            function w() {
                                var t = r("svg");
                                return e = r("g").attr("buffered-rendering", "dynamic"), t.appendChild(e), t
                            }
                        }
                    }, {
                        "../Input/domInputManager.js": 34,
                        "ngraph.events": 6,
                        simplesvg: 27
                    }],
                    50: [function(e, t, n) {
                        t.exports = d;
                        var r = e("../Input/webglInputManager.js"),
                            o = e("../WebGL/webglLinkProgram.js"),
                            a = e("../WebGL/webglNodeProgram.js"),
                            i = e("../WebGL/webglSquare.js"),
                            s = e("../WebGL/webglLine.js"),
                            c = e("ngraph.events"),
                            l = e("ngraph.merge");

                        function d(e) {
                            e = l(e, {
                                enableBlending: !0,
                                preserveDrawingBuffer: !1,
                                clearColor: !1,
                                clearColorValue: {
                                    r: 1,
                                    g: 1,
                                    b: 1,
                                    a: 1
                                }
                            });
                            var t, n, d, u, p, f, h, g, m = 0,
                                y = 0,
                                b = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
                                v = [],
                                _ = [],
                                w = {},
                                O = {},
                                E = o(),
                                j = a(),
                                S = function(e) {
                                    return i()
                                },
                                x = function(e) {
                                    return s(3014898687)
                                },
                                k = function() {
                                    E.updateTransform(b), j.updateTransform(b)
                                },
                                C = function() {
                                    b = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]
                                },
                                N = function() {
                                    t && n && (u = n.width = Math.max(t.offsetWidth, 1), p = n.height = Math.max(t.offsetHeight, 1), d && d.viewport(0, 0, u, p), E && E.updateSize(u / 2, p / 2), j && j.updateSize(u / 2, p / 2))
                                },
                                T = function(e) {
                                    e.fire("rescaled")
                                };
                            n = window.document.createElement("canvas");
                            var L = {
                                getLinkUI: function(e) {
                                    return O[e]
                                },
                                getNodeUI: function(e) {
                                    return w[e]
                                },
                                node: function(e) {
                                    if ("function" === typeof e) return S = e, this
                                },
                                link: function(e) {
                                    if ("function" === typeof e) return x = e, this
                                },
                                placeNode: function(e) {
                                    return f = e, this
                                },
                                placeLink: function(e) {
                                    return h = e, this
                                },
                                inputManager: r,
                                beginRender: function() {},
                                endRender: function() {
                                    y > 0 && E.render(), m > 0 && j.render()
                                },
                                bringLinkToFront: function(e) {
                                    var t, n, r = E.getFrontLinkId();
                                    E.bringToFront(e), r > e.id && (t = e.id, n = _[r], _[r] = _[t], _[r].id = r, _[t] = n, _[t].id = t)
                                },
                                graphCenterChanged: function(e, t) {
                                    b[12] = 2 * e / u - 1, b[13] = 1 - 2 * t / p, k()
                                },
                                addLink: function(e, t) {
                                    var n = y++,
                                        r = x(e);
                                    return r.id = n, r.pos = t, E.createLink(r), _[n] = r, O[e.id] = r, r
                                },
                                addNode: function(e, t) {
                                    var n = m++,
                                        r = S(e);
                                    return r.id = n, r.position = t, r.node = e, j.createNode(r), v[n] = r, w[e.id] = r, r
                                },
                                translateRel: function(e, t) {
                                    b[12] += 2 * b[0] * e / u / b[0], b[13] -= 2 * b[5] * t / p / b[5], k()
                                },
                                scale: function(e, t) {
                                    var n = 2 * t.x / u - 1,
                                        r = 1 - 2 * t.y / p;
                                    return n -= b[12], r -= b[13], b[12] += n * (1 - e), b[13] += r * (1 - e), b[0] *= e, b[5] *= e, k(), T(this), b[0]
                                },
                                resetScale: function() {
                                    return C(), d && (N(), k()), this
                                },
                                init: function(r) {
                                    var o = {};
                                    if (e.preserveDrawingBuffer && (o.preserveDrawingBuffer = !0), t = r, N(), C(), t.appendChild(n), !(d = n.getContext("experimental-webgl", o))) {
                                        var a = "Could not initialize WebGL. Seems like the browser doesn't support it.";
                                        throw window.alert(a), a
                                    }
                                    if (e.enableBlending && (d.blendFunc(d.SRC_ALPHA, d.ONE_MINUS_SRC_ALPHA), d.enable(d.BLEND)), e.clearColor) {
                                        var i = e.clearColorValue;
                                        d.clearColor(i.r, i.g, i.b, i.a), this.beginRender = function() {
                                            d.clear(d.COLOR_BUFFER_BIT)
                                        }
                                    }
                                    E.load(d), E.updateSize(u / 2, p / 2), j.load(d), j.updateSize(u / 2, p / 2), k(), "function" === typeof g && g(n)
                                },
                                release: function(e) {
                                    n && e && e.removeChild(n)
                                },
                                isSupported: function() {
                                    var e = window.document.createElement("canvas");
                                    return e && e.getContext && e.getContext("experimental-webgl")
                                },
                                releaseLink: function(e) {
                                    y > 0 && (y -= 1);
                                    var t = O[e.id];
                                    delete O[e.id], E.removeLink(t);
                                    var n = t.id;
                                    if (n < y) {
                                        if (0 === y || y === n) return;
                                        var r = _[y];
                                        _[n] = r, r.id = n
                                    }
                                },
                                releaseNode: function(e) {
                                    m > 0 && (m -= 1);
                                    var t = w[e.id];
                                    delete w[e.id], j.removeNode(t);
                                    var n = t.id;
                                    if (n < m) {
                                        if (0 === m || m === n) return;
                                        var r = v[m];
                                        v[n] = r, r.id = n, j.replaceProperties(t, r)
                                    }
                                },
                                renderNodes: function() {
                                    for (var e = {
                                            x: 0,
                                            y: 0
                                        }, t = 0; t < m; ++t) {
                                        var n = v[t];
                                        e.x = n.position.x, e.y = n.position.y, f && f(n, e), j.position(n, e)
                                    }
                                },
                                renderLinks: function() {
                                    if (!this.omitLinksRendering)
                                        for (var e = {
                                                x: 0,
                                                y: 0
                                            }, t = {
                                                x: 0,
                                                y: 0
                                            }, n = 0; n < y; ++n) {
                                            var r = _[n],
                                                o = r.pos.from;
                                            t.x = o.x, t.y = -o.y, o = r.pos.to, e.x = o.x, e.y = -o.y, h && h(r, t, e), E.position(r, t, e)
                                        }
                                },
                                getGraphicsRoot: function(e) {
                                    return "function" === typeof e && (n ? e(n) : g = e), n
                                },
                                setNodeProgram: function(e) {
                                    if (!d && e) j = e;
                                    else if (e) throw "Not implemented. Cannot swap shader on the fly... Yet."
                                },
                                setLinkProgram: function(e) {
                                    if (!d && e) E = e;
                                    else if (e) throw "Not implemented. Cannot swap shader on the fly... Yet."
                                },
                                transformClientToGraphCoordinates: function(e) {
                                    return e.x = 2 * e.x / u - 1, e.y = 1 - 2 * e.y / p, e.x = (e.x - b[12]) / b[0], e.y = (e.y - b[13]) / b[5], e.x = e.x * (u / 2), e.y = e.y * (-p / 2), e
                                },
                                transformGraphToClientCoordinates: function(e) {
                                    return e.x = e.x / (u / 2), e.y = e.y / (-p / 2), e.x = e.x * b[0] + b[12], e.y = e.y * b[5] + b[13], e.x = (e.x + 1) * u / 2, e.y = (1 - e.y) * p / 2, e
                                },
                                getNodeAtClientPos: function(e, t) {
                                    if ("function" !== typeof t) return null;
                                    this.transformClientToGraphCoordinates(e);
                                    for (var n = 0; n < m; ++n)
                                        if (t(v[n], e.x, e.y)) return v[n].node;
                                    return null
                                },
                                getTransform: function() {
                                    return b
                                },
                                setTransform: function(e) {
                                    b = e, k()
                                }
                            };
                            return c(L), L
                        }
                    }, {
                        "../Input/webglInputManager.js": 36,
                        "../WebGL/webglLine.js": 58,
                        "../WebGL/webglLinkProgram.js": 59,
                        "../WebGL/webglNodeProgram.js": 60,
                        "../WebGL/webglSquare.js": 61,
                        "ngraph.events": 6,
                        "ngraph.merge": 24
                    }],
                    51: [function(e, t, n) {
                        function r(e) {
                            var t = 10414335;
                            if ("string" === typeof e && e)
                                if (4 === e.length && (e = e.replace(/([^#])/g, "$1$1")), 9 === e.length) t = parseInt(e.substr(1), 16);
                                else {
                                    if (7 !== e.length) throw 'Color expected in hex format with preceding "#". E.g. #00ff00. Got value: ' + e;
                                    t = parseInt(e.substr(1), 16) << 8 | 255
                                }
                            else "number" === typeof e && (t = e);
                            return t
                        }
                        t.exports = r
                    }, {}],
                    52: [function(e, t, n) {
                        function r(e) {
                            this.canvas = window.document.createElement("canvas"), this.ctx = this.canvas.getContext("2d"), this.isDirty = !1, this.canvas.width = this.canvas.height = e
                        }
                        t.exports = r
                    }, {}],
                    53: [function(e, t, n) {
                        function r(e) {
                            return {
                                createProgram: n,
                                extendArray: r,
                                copyArrayPart: o,
                                swapArrayPart: a,
                                getLocations: i,
                                context: e
                            };

                            function t(t, n) {
                                var r = e.createShader(n);
                                if (e.shaderSource(r, t), e.compileShader(r), !e.getShaderParameter(r, e.COMPILE_STATUS)) {
                                    var o = e.getShaderInfoLog(r);
                                    throw window.alert(o), o
                                }
                                return r
                            }

                            function n(n, r) {
                                var o = e.createProgram(),
                                    a = t(n, e.VERTEX_SHADER),
                                    i = t(r, e.FRAGMENT_SHADER);
                                if (e.attachShader(o, a), e.attachShader(o, i), e.linkProgram(o), !e.getProgramParameter(o, e.LINK_STATUS)) {
                                    var s = e.getShaderInfoLog(o);
                                    throw window.alert(s), s
                                }
                                return o
                            }

                            function r(e, t, n) {
                                if ((t + 1) * n > e.length) {
                                    var r = new Float32Array(e.length * n * 2);
                                    return r.set(e), r
                                }
                                return e
                            }

                            function i(t, n) {
                                for (var r = {}, o = 0; o < n.length; ++o) {
                                    var a = n[o],
                                        i = -1;
                                    if ("a" === a[0] && "_" === a[1]) {
                                        if (-1 === (i = e.getAttribLocation(t, a))) throw new Error("Program doesn't have required attribute: " + a);
                                        r[a.slice(2)] = i
                                    } else {
                                        if ("u" !== a[0] || "_" !== a[1]) throw new Error("Couldn't figure out your intent. All uniforms should start with 'u_' prefix, and attributes with 'a_'");
                                        if (null === (i = e.getUniformLocation(t, a))) throw new Error("Program doesn't have required uniform: " + a);
                                        r[a.slice(2)] = i
                                    }
                                }
                                return r
                            }
                        }

                        function o(e, t, n, r) {
                            for (var o = 0; o < r; ++o) e[t + o] = e[n + o]
                        }

                        function a(e, t, n, r) {
                            for (var o = 0; o < r; ++o) {
                                var a = e[t + o];
                                e[t + o] = e[n + o], e[n + o] = a
                            }
                        }
                        t.exports = r
                    }, {}],
                    54: [function(e, t, n) {
                        var r = e("./texture.js");

                        function o(e) {
                            var t, n = Math.sqrt(e || 1024) << 0,
                                o = n,
                                i = 1,
                                s = {},
                                c = 0,
                                l = [],
                                d = [];
                            if (!a(e)) throw "Tiles per texture should be power of two.";
                            var u = {
                                isDirty: !1,
                                clearDirty: p,
                                remove: f,
                                getTextures: h,
                                getCoordinates: g,
                                load: m
                            };
                            return u;

                            function p() {
                                var e;
                                for (u.isDirty = !1, e = 0; e < l.length; ++e) l[e].isDirty = !1
                            }

                            function f(e) {
                                var t = s[e];
                                if (!t) return !1;
                                if (delete s[e], (i -= 1) === t.offset) return !0;
                                var n = v(t.offset);
                                return O(v(i), n), s[d[i]].offset = t.offset, d[t.offset] = d[i], w(), !0
                            }

                            function h() {
                                return l
                            }

                            function g(e) {
                                return s[e]
                            }

                            function m(e, t) {
                                if (s.hasOwnProperty(e)) t(s[e]);
                                else {
                                    var n = new window.Image,
                                        r = i;
                                    i += 1, n.crossOrigin = "anonymous", n.onload = function() {
                                        w(), b(r, n, t)
                                    }, n.src = e
                                }
                            }

                            function y() {
                                var e = new r(n * o);
                                l.push(e)
                            }

                            function b(e, t, n) {
                                var r = v(e),
                                    a = {
                                        offset: e
                                    };
                                r.textureNumber >= l.length && y();
                                var i = l[r.textureNumber];
                                i.ctx.drawImage(t, r.col * o, r.row * o, o, o), d[e] = t.src, s[t.src] = a, i.isDirty = !0, n(a)
                            }

                            function v(t) {
                                var r = t % e;
                                return {
                                    textureNumber: t / e << 0,
                                    row: r / n << 0,
                                    col: r % n
                                }
                            }

                            function _() {
                                u.isDirty = !0, c = 0, t = null
                            }

                            function w() {
                                t && (window.clearTimeout(t), c += 1, t = null), c > 10 ? _() : t = window.setTimeout(_, 400)
                            }

                            function O(e, t) {
                                var n = l[e.textureNumber].canvas,
                                    r = l[t.textureNumber].ctx,
                                    a = t.col * o,
                                    i = t.row * o;
                                r.drawImage(n, e.col * o, e.row * o, o, o, a, i, o, o), l[e.textureNumber].isDirty = !0, l[t.textureNumber].isDirty = !0
                            }
                        }

                        function a(e) {
                            return 0 === (e & e - 1)
                        }
                        t.exports = o
                    }, {
                        "./texture.js": 52
                    }],
                    55: [function(e, t, n) {
                        function r(e, t) {
                            return {
                                _texture: 0,
                                _offset: 0,
                                size: "number" === typeof e ? e : 32,
                                src: t
                            }
                        }
                        t.exports = r
                    }, {}],
                    56: [function(e, t, n) {
                        var r = e("./webglAtlas.js"),
                            o = e("./webgl.js");

                        function a() {
                            var e, t, n, a, c, l, d, u, p, f, h = 18,
                                g = i(),
                                m = s(),
                                y = 1024,
                                b = 0,
                                v = new Float32Array(64);
                            return {
                                load: O,
                                position: E,
                                createNode: j,
                                removeNode: S,
                                replaceProperties: x,
                                updateTransform: k,
                                updateSize: C,
                                render: N
                            };

                            function _(e, t) {
                                e.nativeObject && n.deleteTexture(e.nativeObject);
                                var r = n.createTexture();
                                n.activeTexture(n["TEXTURE" + t]), n.bindTexture(n.TEXTURE_2D, r), n.texImage2D(n.TEXTURE_2D, 0, n.RGBA, n.RGBA, n.UNSIGNED_BYTE, e.canvas), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, n.LINEAR), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, n.LINEAR_MIPMAP_NEAREST), n.generateMipmap(n.TEXTURE_2D), n.uniform1i(l["sampler" + t], t), e.nativeObject = r
                            }

                            function w() {
                                if (e.isDirty) {
                                    var t, n = e.getTextures();
                                    for (t = 0; t < n.length; ++t) !n[t].isDirty && n[t].nativeObject || _(n[t], t);
                                    e.clearDirty()
                                }
                            }

                            function O(i) {
                                n = i, c = o(i), e = new r(y), t = c.createProgram(m, g), n.useProgram(t), l = c.getLocations(t, ["a_vertexPos", "a_customAttributes", "u_screenSize", "u_transform", "u_sampler0", "u_sampler1", "u_sampler2", "u_sampler3", "u_tilesPerTexture"]), n.uniform1f(l.tilesPerTexture, y), n.enableVertexAttribArray(l.vertexPos), n.enableVertexAttribArray(l.customAttributes), a = n.createBuffer()
                            }

                            function E(e, t) {
                                var n = e.id * h;
                                v[n] = t.x - e.size, v[n + 1] = t.y - e.size, v[n + 2] = 4 * e._offset, v[n + 3] = t.x + e.size, v[n + 4] = t.y - e.size, v[n + 5] = 4 * e._offset + 1, v[n + 6] = t.x - e.size, v[n + 7] = t.y + e.size, v[n + 8] = 4 * e._offset + 2, v[n + 9] = t.x - e.size, v[n + 10] = t.y + e.size, v[n + 11] = 4 * e._offset + 2, v[n + 12] = t.x + e.size, v[n + 13] = t.y - e.size, v[n + 14] = 4 * e._offset + 1, v[n + 15] = t.x + e.size, v[n + 16] = t.y + e.size, v[n + 17] = 4 * e._offset + 3
                            }

                            function j(t) {
                                v = c.extendArray(v, b, h), b += 1;
                                var n = e.getCoordinates(t.src);
                                n ? t._offset = n.offset : (t._offset = 0, e.load(t.src, (function(e) {
                                    t._offset = e.offset
                                })))
                            }

                            function S(t) {
                                b > 0 && (b -= 1), t.id < b && b > 0 && (t.src && e.remove(t.src), c.copyArrayPart(v, t.id * h, b * h, h))
                            }

                            function x(e, t) {
                                t._offset = e._offset
                            }

                            function k(e) {
                                f = !0, p = e
                            }

                            function C(e, t) {
                                d = e, u = t, f = !0
                            }

                            function N() {
                                n.useProgram(t), n.bindBuffer(n.ARRAY_BUFFER, a), n.bufferData(n.ARRAY_BUFFER, v, n.DYNAMIC_DRAW), f && (f = !1, n.uniformMatrix4fv(l.transform, !1, p), n.uniform2f(l.screenSize, d, u)), n.vertexAttribPointer(l.vertexPos, 2, n.FLOAT, !1, 3 * Float32Array.BYTES_PER_ELEMENT, 0), n.vertexAttribPointer(l.customAttributes, 1, n.FLOAT, !1, 3 * Float32Array.BYTES_PER_ELEMENT, 8), w(), n.drawArrays(n.TRIANGLES, 0, 6 * b)
                            }
                        }

                        function i() {
                            return ["precision mediump float;", "varying vec4 color;", "varying vec3 vTextureCoord;", "uniform sampler2D u_sampler0;", "uniform sampler2D u_sampler1;", "uniform sampler2D u_sampler2;", "uniform sampler2D u_sampler3;", "void main(void) {", "   if (vTextureCoord.z == 0.) {", "     gl_FragColor = texture2D(u_sampler0, vTextureCoord.xy);", "   } else if (vTextureCoord.z == 1.) {", "     gl_FragColor = texture2D(u_sampler1, vTextureCoord.xy);", "   } else if (vTextureCoord.z == 2.) {", "     gl_FragColor = texture2D(u_sampler2, vTextureCoord.xy);", "   } else if (vTextureCoord.z == 3.) {", "     gl_FragColor = texture2D(u_sampler3, vTextureCoord.xy);", "   } else { gl_FragColor = vec4(0, 1, 0, 1); }", "}"].join("\n")
                        }

                        function s() {
                            return ["attribute vec2 a_vertexPos;", "attribute float a_customAttributes;", "uniform vec2 u_screenSize;", "uniform mat4 u_transform;", "uniform float u_tilesPerTexture;", "varying vec3 vTextureCoord;", "void main(void) {", "   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0, 1);", "float corner = mod(a_customAttributes, 4.);", "float tileIndex = mod(floor(a_customAttributes / 4.), u_tilesPerTexture);", "float tilesPerRow = sqrt(u_tilesPerTexture);", "float tileSize = 1./tilesPerRow;", "float tileColumn = mod(tileIndex, tilesPerRow);", "float tileRow = floor(tileIndex/tilesPerRow);", "if(corner == 0.0) {", "  vTextureCoord.xy = vec2(0, 1);", "} else if(corner == 1.0) {", "  vTextureCoord.xy = vec2(1, 1);", "} else if(corner == 2.0) {", "  vTextureCoord.xy = vec2(0, 0);", "} else {", "  vTextureCoord.xy = vec2(1, 0);", "}", "vTextureCoord *= tileSize;", "vTextureCoord.x += tileColumn * tileSize;", "vTextureCoord.y += tileRow * tileSize;", "vTextureCoord.z = floor(floor(a_customAttributes / 4.)/u_tilesPerTexture);", "}"].join("\n")
                        }
                        t.exports = a
                    }, {
                        "./webgl.js": 53,
                        "./webglAtlas.js": 54
                    }],
                    57: [function(e, t, n) {
                        var r = e("../Utils/documentEvents.js");

                        function o(e) {
                            if (e.webglInputEvents) return e.webglInputEvents;
                            var t, n, o = null,
                                a = [],
                                i = [],
                                s = [],
                                c = [],
                                l = [],
                                d = [],
                                u = [],
                                p = [],
                                f = [];
                            L(e.getGraphicsRoot());
                            var h = {
                                mouseEnter: E,
                                mouseLeave: O,
                                mouseDown: w,
                                mouseUp: _,
                                mouseMove: v,
                                click: b,
                                dblClick: y,
                                mouseCapture: m,
                                releaseMouseCapture: g,
                                canvasMouseDown: j,
                                canvasMouseUp: S
                            };
                            return e.webglInputEvents = h, h;

                            function g() {
                                o = null
                            }

                            function m(e) {
                                o = e
                            }

                            function y(e) {
                                return "function" === typeof e && u.push(e), h
                            }

                            function b(e) {
                                return "function" === typeof e && d.push(e), h
                            }

                            function v(e) {
                                return "function" === typeof e && l.push(e), h
                            }

                            function _(e) {
                                return "function" === typeof e && c.push(e), h
                            }

                            function w(e) {
                                return "function" === typeof e && s.push(e), h
                            }

                            function O(e) {
                                return "function" === typeof e && i.push(e), h
                            }

                            function E(e) {
                                return "function" === typeof e && a.push(e), h
                            }

                            function j(e) {
                                return "function" === typeof e && p.push(e), h
                            }

                            function S(e) {
                                return "function" === typeof e && f.push(e), h
                            }

                            function x(e, t, n) {
                                if (e && e.size) {
                                    var r = e.position,
                                        o = e.size;
                                    return r.x - o < t && t < r.x + o && r.y - o < n && n < r.y + o
                                }
                                return !0
                            }

                            function k(t) {
                                return e.getNodeAtClientPos(t, x)
                            }

                            function C(e) {
                                e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0
                            }

                            function N(e) {
                                return C(e), !1
                            }

                            function T(e, t) {
                                var n;
                                for (n = 0; n < e.length; n += 1)
                                    if (e[n].apply(void 0, t)) return !0
                            }

                            function L(e) {
                                var h = {
                                        x: 0,
                                        y: 0
                                    },
                                    g = null,
                                    m = 1,
                                    y = +new Date,
                                    b = function(e) {
                                        T(l, [g, e]), h.x = e.clientX, h.y = e.clientY
                                    },
                                    v = function e() {
                                        r.off("mousemove", b), r.off("mouseup", e)
                                    },
                                    _ = function() {
                                        n = e.getBoundingClientRect()
                                    };
                                window.addEventListener("resize", _), _(), e.addEventListener("mousemove", (function(e) {
                                    if (!o) {
                                        m++ % 7 === 0 && (_(), m = 1);
                                        var t, r = !1;
                                        h.x = e.clientX - n.left, h.y = e.clientY - n.top, (t = k(h)) && g !== t ? (g = t, r = r || T(a, [g])) : null === t && g !== t && (r = r || T(i, [g]), g = null), r && C(e)
                                    }
                                })), e.addEventListener("mousedown", (function(e) {
                                    var o, a = !1;
                                    _(), h.x = e.clientX - n.left, h.y = e.clientY - n.top, (o = [k(h), e])[0] ? (a = T(s, o), r.on("mousemove", b), r.on("mouseup", v), t = window.document.onselectstart, window.document.onselectstart = N, g = o[0]) : (g = null, a = T(p, [o[1]])), a && C(e)
                                })), e.addEventListener("mouseup", (function(e) {
                                    var r, o = +new Date;
                                    h.x = e.clientX - n.left, h.y = e.clientY - n.top, (r = [k(h), e])[0] ? (window.document.onselectstart = t, o - y < 400 && r[0] === g ? T(u, r) : T(d, r), y = o, T(c, r) && C(e)) : T(f, [r[1]]) && C(e)
                                }))
                            }
                        }
                        t.exports = o
                    }, {
                        "../Utils/documentEvents.js": 40
                    }],
                    58: [function(e, t, n) {
                        var r = e("./parseColor.js");

                        function o(e) {
                            return {
                                color: r(e)
                            }
                        }
                        t.exports = o
                    }, {
                        "./parseColor.js": 51
                    }],
                    59: [function(e, t, n) {
                        var r = e("./webgl.js");

                        function o() {
                            var e, t, n, o, a, i, s, c, l, d, u = 6,
                                p = 2 * (2 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT),
                                f = ["precision mediump float;", "varying vec4 color;", "void main(void) {", "   gl_FragColor = color;", "}"].join("\n"),
                                h = ["attribute vec2 a_vertexPos;", "attribute vec4 a_color;", "uniform vec2 u_screenSize;", "uniform mat4 u_transform;", "varying vec4 color;", "void main(void) {", "   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);", "   color = a_color.abgr;", "}"].join("\n"),
                                g = 0,
                                m = new ArrayBuffer(16 * p),
                                y = new Float32Array(m),
                                b = new Uint32Array(m),
                                v = function() {
                                    if ((g + 1) * p > m.byteLength) {
                                        var e = new ArrayBuffer(2 * m.byteLength),
                                            t = new Float32Array(e),
                                            n = new Uint32Array(e);
                                        n.set(b), y = t, b = n, m = e
                                    }
                                };
                            return {
                                load: function(i) {
                                    t = i, o = r(i), e = o.createProgram(h, f), t.useProgram(e), a = o.getLocations(e, ["a_vertexPos", "a_color", "u_screenSize", "u_transform"]), t.enableVertexAttribArray(a.vertexPos), t.enableVertexAttribArray(a.color), n = t.createBuffer()
                                },
                                position: function(e, t, n) {
                                    var r = e.id * u;
                                    y[r] = t.x, y[r + 1] = t.y, b[r + 2] = e.color, y[r + 3] = n.x, y[r + 4] = n.y, b[r + 5] = e.color
                                },
                                createLink: function(e) {
                                    v(), g += 1, i = e.id
                                },
                                removeLink: function(e) {
                                    g > 0 && (g -= 1), e.id < g && g > 0 && o.copyArrayPart(b, e.id * u, g * u, u)
                                },
                                updateTransform: function(e) {
                                    d = !0, l = e
                                },
                                updateSize: function(e, t) {
                                    s = e, c = t, d = !0
                                },
                                render: function() {
                                    t.useProgram(e), t.bindBuffer(t.ARRAY_BUFFER, n), t.bufferData(t.ARRAY_BUFFER, m, t.DYNAMIC_DRAW), d && (d = !1, t.uniformMatrix4fv(a.transform, !1, l), t.uniform2f(a.screenSize, s, c)), t.vertexAttribPointer(a.vertexPos, 2, t.FLOAT, !1, 3 * Float32Array.BYTES_PER_ELEMENT, 0), t.vertexAttribPointer(a.color, 4, t.UNSIGNED_BYTE, !0, 3 * Float32Array.BYTES_PER_ELEMENT, 8), t.drawArrays(t.LINES, 0, 2 * g), i = g - 1
                                },
                                bringToFront: function(e) {
                                    i > e.id && o.swapArrayPart(y, e.id * u, i * u, u), i > 0 && (i -= 1)
                                },
                                getFrontLinkId: function() {
                                    return i
                                }
                            }
                        }
                        t.exports = o
                    }, {
                        "./webgl.js": 53
                    }],
                    60: [function(e, t, n) {
                        var r = e("./webgl.js");

                        function o() {
                            var e, t, n, o, a, i, s, c, l, d = 4,
                                u = 3 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT,
                                p = ["precision mediump float;", "varying vec4 color;", "void main(void) {", "   gl_FragColor = color;", "}"].join("\n"),
                                f = ["attribute vec3 a_vertexPos;", "attribute vec4 a_color;", "uniform vec2 u_screenSize;", "uniform mat4 u_transform;", "varying vec4 color;", "void main(void) {", "   gl_Position = u_transform * vec4(a_vertexPos.xy/u_screenSize, 0, 1);", "   gl_PointSize = a_vertexPos.z * u_transform[0][0];", "   color = a_color.abgr;", "}"].join("\n"),
                                h = new ArrayBuffer(16 * u),
                                g = new Float32Array(h),
                                m = new Uint32Array(h),
                                y = 0;
                            return {
                                load: v,
                                position: _,
                                updateTransform: w,
                                updateSize: O,
                                removeNode: E,
                                createNode: j,
                                replaceProperties: S,
                                render: x
                            };

                            function b() {
                                if ((y + 1) * u >= h.byteLength) {
                                    var e = new ArrayBuffer(2 * h.byteLength),
                                        t = new Float32Array(e),
                                        n = new Uint32Array(e);
                                    n.set(m), g = t, m = n, h = e
                                }
                            }

                            function v(i) {
                                t = i, a = r(i), e = a.createProgram(f, p), t.useProgram(e), o = a.getLocations(e, ["a_vertexPos", "a_color", "u_screenSize", "u_transform"]), t.enableVertexAttribArray(o.vertexPos), t.enableVertexAttribArray(o.color), n = t.createBuffer()
                            }

                            function _(e, t) {
                                var n = e.id;
                                g[n * d] = t.x, g[n * d + 1] = -t.y, g[n * d + 2] = e.size, m[n * d + 3] = e.color
                            }

                            function w(e) {
                                l = !0, c = e
                            }

                            function O(e, t) {
                                i = e, s = t, l = !0
                            }

                            function E(e) {
                                y > 0 && (y -= 1), e.id < y && y > 0 && a.copyArrayPart(m, e.id * d, y * d, d)
                            }

                            function j() {
                                b(), y += 1
                            }

                            function S() {}

                            function x() {
                                t.useProgram(e), t.bindBuffer(t.ARRAY_BUFFER, n), t.bufferData(t.ARRAY_BUFFER, h, t.DYNAMIC_DRAW), l && (l = !1, t.uniformMatrix4fv(o.transform, !1, c), t.uniform2f(o.screenSize, i, s)), t.vertexAttribPointer(o.vertexPos, 3, t.FLOAT, !1, d * Float32Array.BYTES_PER_ELEMENT, 0), t.vertexAttribPointer(o.color, 4, t.UNSIGNED_BYTE, !0, d * Float32Array.BYTES_PER_ELEMENT, 12), t.drawArrays(t.POINTS, 0, y)
                            }
                        }
                        t.exports = o
                    }, {
                        "./webgl.js": 53
                    }],
                    61: [function(e, t, n) {
                        var r = e("./parseColor.js");

                        function o(e, t) {
                            return {
                                size: "number" === typeof e ? e : 10,
                                color: r(t)
                            }
                        }
                        t.exports = o
                    }, {
                        "./parseColor.js": 51
                    }],
                    62: [function(e, t, n) {
                        t.exports = "0.8.1"
                    }, {}]
                }, {}, [1])(1)
            }).call(this, n(39))
        },
        2: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "BarChart", (function() {
                return i
            })), n.d(t, "CommentEntry", (function() {
                return m
            })), n.d(t, "CommentTextArea", (function() {
                return g
            })), n.d(t, "D3BarChart", (function() {
                return a
            })), n.d(t, "DefaultPrivateLinkBuilder", (function() {
                return y
            })), n.d(t, "ExplorePanelDataHelper", (function() {
                return b
            })), n.d(t, "GraphBot", (function() {
                return v
            })), n.d(t, "HelpDisplay", (function() {
                return _
            })), n.d(t, "HelpDisplaySequence", (function() {
                return w
            })), n.d(t, "PrivateCommentLinkBuilder", (function() {
                return O
            })), n.d(t, "PrivateSelectionLinkBuilder", (function() {
                return E
            })), n.d(t, "StateManager", (function() {
                return j
            })), n.d(t, "TimelineChart", (function() {
                return T
            })), n.d(t, "Touch", (function() {
                return L
            })), n.d(t, "initialize", (function() {
                return q
            })), n.d(t, "initializeActivityFeed", (function() {
                return z
            })), n.d(t, "initiateBilling", (function() {
                return Y
            })), n.d(t, "initiateCardManagement", (function() {
                return V
            })), n.d(t, "initiateCoupon", (function() {
                return X
            })), n.d(t, "normalizeChars", (function() {
                return $
            })), n.d(t, "notify", (function() {
                return Z.a
            })), n.d(t, "prepareGraphReferencePanelData", (function() {
                return J
            })), n.d(t, "storeInSession", (function() {
                return ee
            })), n.d(t, "getFromSession", (function() {
                return te
            })), n.d(t, "storeInLocalStorage", (function() {
                return ne
            })), n.d(t, "getFromLocalStorage", (function() {
                return re
            })), n.d(t, "switchInputSpan", (function() {
                return ae
            })), n.d(t, "transformMarkdown", (function() {
                return H
            })), n.d(t, "transformCommentBody", (function() {
                return U
            })), n.d(t, "randomColor", (function() {
                return u.kb
            })), n.d(t, "initGraphBlockActions", (function() {
                return u.R
            })), n.d(t, "moreorlessify2", (function() {
                return u.db
            })), n.d(t, "keyModifiers", (function() {
                return u.Y
            })), n.d(t, "initSiteSearch", (function() {
                return u.S
            })), n.d(t, "initBloodhound", (function() {
                return u.Q
            })), n.d(t, "modalize", (function() {
                return u.bb
            })), n.d(t, "buildFilterTypeSummaries", (function() {
                return u.j
            })), n.d(t, "createTypeOptionsForTypeahead", (function() {
                return u.v
            })), n.d(t, "linkify", (function() {
                return u.Z
            })), n.d(t, "linkifyDOM", (function() {
                return u.ab
            })), n.d(t, "moreorlessify", (function() {
                return u.cb
            })), n.d(t, "guid", (function() {
                return u.M
            })), n.d(t, "getMouse", (function() {
                return u.G
            })), n.d(t, "getScreenDimensions", (function() {
                return u.I
            })), n.d(t, "openPopupWindow", (function() {
                return u.hb
            })), n.d(t, "parseUrlParam", (function() {
                return u.ib
            })), n.d(t, "getURLParamsHash", (function() {
                return u.K
            })), n.d(t, "getFilterRulesFromUrl", (function() {
                return u.F
            })), n.d(t, "buildUrlParams", (function() {
                return u.l
            })), n.d(t, "updateUrlParam", (function() {
                return u.yb
            })), n.d(t, "getUrlParamValue", (function() {
                return u.L
            })), n.d(t, "Marquee", (function() {
                return u.d
            })), n.d(t, "hasFlash", (function() {
                return u.O
            })), n.d(t, "registerFullscreen", (function() {
                return u.mb
            })), n.d(t, "a2o", (function() {
                return u.g
            })), n.d(t, "o2a", (function() {
                return u.gb
            })), n.d(t, "checkArraysEqual", (function() {
                return u.n
            })), n.d(t, "cloneObj", (function() {
                return u.p
            })), n.d(t, "cloneArray", (function() {
                return u.o
            })), n.d(t, "shallowCopyArray", (function() {
                return u.sb
            })), n.d(t, "displayKeys", (function() {
                return u.x
            })), n.d(t, "cropCanvasImage", (function() {
                return u.w
            })), n.d(t, "getDateString", (function() {
                return u.E
            })), n.d(t, "renderHandlebars", (function() {
                return u.pb
            })), n.d(t, "setCursor", (function() {
                return u.rb
            })), n.d(t, "redirectTo", (function() {
                return u.lb
            })), n.d(t, "updateUrl", (function() {
                return u.xb
            })), n.d(t, "getBaseURL", (function() {
                return u.B
            })), n.d(t, "getURLParams", (function() {
                return u.J
            })), n.d(t, "getCookie", (function() {
                return u.D
            })), n.d(t, "addClass", (function() {
                return u.h
            })), n.d(t, "removeClass", (function() {
                return u.nb
            })), n.d(t, "hasClass", (function() {
                return u.N
            })), n.d(t, "initUserSearchBloodhound", (function() {
                return u.T
            })), n.d(t, "DEFAULT_TYPEAHEAD_CONFIG", (function() {
                return u.b
            })), n.d(t, "hideTipped", (function() {
                return u.P
            })), n.d(t, "buildNumericText", (function() {
                return u.k
            })), n.d(t, "replaceUserIdWithUserName", (function() {
                return u.qb
            })), n.d(t, "initializeShareForNode", (function() {
                return u.U
            })), n.d(t, "shareOnTwitter", (function() {
                return u.ub
            })), n.d(t, "shareOnFacebook", (function() {
                return u.tb
            })), n.d(t, "initializeShareForNodeStack", (function() {
                return u.V
            })), n.d(t, "moveScrollTop", (function() {
                return u.eb
            })), n.d(t, "removeScreenshotArtifact", (function() {
                return u.ob
            })), n.d(t, "exportSVG2", (function() {
                return u.A
            })), n.d(t, "getSVGData", (function() {
                return u.H
            })), n.d(t, "downloadSVG", (function() {
                return u.z
            })), n.d(t, "downloadCSV", (function() {
                return u.y
            })), n.d(t, "createPNGImage2", (function() {
                return u.u
            })), n.d(t, "createPNGImage", (function() {
                return u.t
            })), n.d(t, "_isNaN", (function() {
                return u.f
            })), n.d(t, "correctFilterIds", (function() {
                return u.s
            })), n.d(t, "BuildLayoutSettings", (function() {
                return u.a
            })), n.d(t, "ToggleMoreLess", (function() {
                return u.e
            })), n.d(t, "showAuthentication", (function() {
                return u.vb
            })), n.d(t, "numRounder", (function() {
                return u.fb
            })), n.d(t, "copyToClipboard", (function() {
                return u.r
            })), n.d(t, "isInputFieldActive", (function() {
                return u.W
            })), n.d(t, "chain", (function() {
                return u.m
            })), n.d(t, "copyLinkToClipboard", (function() {
                return u.q
            })), n.d(t, "placeCaretAtEnd", (function() {
                return u.jb
            })), n.d(t, "getCSRFToken", (function() {
                return u.C
            })), n.d(t, "uniqueStringArray", (function() {
                return u.wb
            })), n.d(t, "isSmallScreen", (function() {
                return u.X
            })), n.d(t, "breakStringIntoLines", (function() {
                return u.i
            })), n.d(t, "CommentHelper", (function() {
                return ie
            })), n.d(t, "DatatablePreview", (function() {
                return se
            })), n.d(t, "TimelineHelpers", (function() {
                return N
            })), n.d(t, "Exports", (function() {
                return ce
            }));
            var r = n(17),
                o = n.n(r),
                a = function(e, t, n) {
                    var r = function() {
                        var e, t;
                        n.onRangeChanged && (n.enforceInteger ? (e = o.a.round(E), t = o.a.round(j)) : (e = E, t = j), n.onRangeChanged(e, t))
                    };

                    function a(e) {
                        switch (e.which) {
                            case 39:
                                t = P.end - P.start, n = Math.min(P.end + t, C), o = n - t, P.start = o, P.end = n, E = i(P.start), j = i(P.end), d(), l(), c(), r();
                                break;
                            case 37:
                                ! function() {
                                    var e = P.end - P.start,
                                        t = Math.max(P.start - e, k),
                                        n = t + e;
                                    P.start = t, P.end = n, E = i(P.start), j = i(P.end), d(), l(), c(), r()
                                }()
                        }
                        var t, n, o
                    }

                    function i(e) {
                        return (e - k) / (C - k) * (w - _) + _
                    }
                    var s = function() {
                        S.selectAll(".bar").attr("y", (function(e) {
                            var t = T(e.value);
                            return isNaN(t) && (t = v), t
                        })).attr("height", (function(e) {
                            var t = T(e.value);
                            return isNaN(t) && (t = v), v - t
                        }))
                    };

                    function c() {
                        var e = [_, w];
                        E !== _ && e.push(E), j !== w && e.push(j), L.tickValues(e), S.select(".x.axis").call(L).selectAll("text").attr("class", (function(e) {
                                return e === E ? "selected selected-min" : e === j ? "selected selected-max" : ""
                            })),
                            function() {
                                var e = S.select(".x.axis"),
                                    t = e.select(".selected-min"),
                                    n = e.select(".selected-max");
                                if (n.node()) {
                                    var r = t.node().getBoundingClientRect(),
                                        o = n.node().getBoundingClientRect();
                                    o.left - o.width - (r.left + r.width) < u ? (t.style("text-anchor", "end"), n.style("text-anchor", "start")) : (t.style("text-anchor", "start"), n.style("text-anchor", "end"))
                                }
                            }()
                    }

                    function l() {
                        q.attr("x", P.start), q.attr("width", P.end - P.start), D[0].x = P.start
                    }

                    function d() {
                        R[0].x = P.start - p, R[1].x = P.end - p, S.select(".handle-min").attr("x", R[0].x), S.select(".handle-max").attr("x", R[1].x)
                    }
                    var u = 6,
                        p = 6,
                        f = e.getBoundingClientRect(),
                        h = 9,
                        g = 6,
                        m = 20,
                        y = 0,
                        b = f.width - y - g,
                        v = f.height - h - m,
                        _ = t[0].key,
                        w = void 0 !== n.maxKey ? n.maxKey : t[t.length - 1].key,
                        O = o.a.max(t, (function(e) {
                            return e.value
                        })),
                        E = _,
                        j = w,
                        S = o.a.select(e).append("g").attr("transform", "translate(" + y + "," + h + ")"),
                        x = o.a.scale.ordinal().rangeBands([p, b], .05);
                    x.domain(t.map((function(e) {
                        return e.key
                    })));
                    var k = x(t[0].key),
                        C = x(t[t.length - 1].key) + x.rangeBand(),
                        N = o.a.scale.linear().range([k, C]);
                    N.domain([_, w]);
                    var T = o.a.scale.linear().range([v, 0]);
                    T.domain([0, O]), S.append("text").attr("x", k).attr("class", "max-y").text([O, n.maxValText].join(" ")), S.append("text").attr("data-mode", "lin").attr("class", "switch-height-mode").attr("x", C).style("text-anchor", "end").text("Linear").on("click", (function() {
                        "lin" === this.getAttribute("data-mode") ? (this.textContent = "Logarithmic", this.setAttribute("data-mode", "log"), B()) : (this.textContent = "Linear", this.setAttribute("data-mode", "lin"), F())
                    }));
                    var L = o.a.svg.axis().scale(N).orient("bottom").tickValues([_, w]).tickFormat((function(e) {
                        return n.enforceInteger ? o.a.round(e) : o.a.round(e, 2)
                    }));
                    S.append("g").attr("class", "x axis").attr("transform", "translate(0," + v + ")").call(L), S.append("g").attr("transform", "translate(0, 6)").selectAll("bar").data(t).enter().append("rect").attr("class", "bar").style("fill", n.color).attr("x", (function(e) {
                        return x(e.key)
                    })).attr("width", x.rangeBand()).attr("y", (function(e) {
                        var t = T(e.value);
                        return isNaN(t) && (t = v), t
                    })).attr("height", (function(e) {
                        var t = T(e.value);
                        return isNaN(t) && (t = v), v - t
                    })).on("dblclick", (function(e, n) {
                        E = e.key, j = n == t.length - 1 ? w : t[n + 1].key, P.start = E === _ ? k : x(E), P.end = j === w ? C : x(j), d(), l(), c(), r()
                    }));
                    var P = {
                            start: k,
                            end: C
                        },
                        A = S.append("g").attr("transform", "translate(0, 6)"),
                        D = [{
                            x: k
                        }],
                        M = o.a.behavior.drag().origin((function(e) {
                            return e
                        })).on("drag", (function(e) {
                            var t = P.end - P.start,
                                n = Math.min(Math.max(o.a.event.x, k), C - t);
                            e.x !== n && (P.start = n, P.end = n + t, l(), d(), E = i(P.start), j = i(P.end), c())
                        })).on("dragend", (function() {
                            r()
                        })),
                        q = A.selectAll(".range-selection").data(D).enter().append("rect").attr("class", "range-selection grabbable active-opacity").attr("fill", "#444").attr("width", C - k).attr("x", k).attr("y", 0).attr("height", v).call(M),
                        I = o.a.behavior.drag().origin((function(e) {
                            return e
                        })).on("dragstart", (function() {
                            q.classed("force-opacity", !0)
                        })).on("drag", (function(e) {
                            e.onMove.call(this, e) && (l(), E = i(P.start), j = i(P.end), c())
                        })).on("dragend", (function() {
                            q.classed("force-opacity", !1), r()
                        })),
                        R = [{
                            x: k - p,
                            class: "handle handle-min",
                            onMove: function(e) {
                                var t = Math.max(k - p, Math.min(o.a.event.x, P.end - p));
                                if (t !== e.x) return e.x = t, o.a.select(this).attr("x", e.x), P.start = e.x + p, !0
                            }
                        }, {
                            x: C - p,
                            class: "handle handle-max",
                            onMove: function(e) {
                                var t = Math.max(P.start - p, Math.min(C - p, o.a.event.x));
                                if (t !== e.x) return e.x = t, o.a.select(this).attr("x", e.x), P.end = e.x + p, !0
                            }
                        }];

                    function B() {
                        (T = o.a.scale.log().range([v, 0])).domain([.5, O]), s()
                    }

                    function F() {
                        (T = o.a.scale.linear().range([v, 0])).domain([0, O]), s()
                    }
                    return A.selectAll(".handle").data(R).enter().append("rect").attr("fill", "#333").attr("width", 12).attr("height", 24).attr("y", .5 * (v - 24)).attr("x", (function(e) {
                        return e.x
                    })).attr("class", (function(e) {
                        return e.class
                    })).on("mouseover", (function() {
                        this.style.cursor = "ew-resize"
                    })).call(I), n.enableKeyEvents && document.addEventListener("keyup", a), c(), {
                        setRange: function(e, t) {
                            if (j = t, (E = e) === _) P.start = k;
                            else {
                                var n = N(E) - p;
                                P.start = n + p
                            }
                            if (j === w) P.end = C;
                            else {
                                var r = N(j) - p;
                                P.end = r - p
                            }
                            d(), l(), c()
                        },
                        getMin: function() {
                            return n.enforceInteger ? o.a.round(E) : E
                        },
                        getMax: function() {
                            return n.enforceInteger ? o.a.round(j) : j
                        },
                        useLogHeight: B,
                        useLinearHeight: F,
                        destroy: function() {
                            n.enableKeyEvents && document.removeEventListener("keyup", a)
                        }
                    }
                },
                i = function(e, t) {
                    var n = e.GraphHistory;

                    function r(e) {
                        for (var t = e.length - 1; t >= 0; t -= 1)
                            if (e[t] % 1 !== 0) return !1;
                        return !0
                    }
                    var o = t.expanded ? 100 : 40,
                        i = t.container,
                        s = t.filter,
                        c = function(e) {
                            switch (e.type) {
                                case "nt_prop":
                                case "nt_centrality":
                                    return "nt_all" === e.id ? "rgba(0, 0, 0, 0.4)" : n.getNodeTypeById(e.id).color;
                                case "et_prop":
                                    return n.getEdgeTypeById(e.id).color;
                                case "et_weight":
                                    return "et_all" === e.id ? "rgba(0, 0, 0, 0.4)" : n.getEdgeTypeById(e.id).color;
                                default:
                                    return "rgba(0, 0, 0, 0.4)"
                            }
                        }(s),
                        l = function(e) {
                            var t, a, i = n.getFilterManager();
                            if ("nt_centrality" === e.type) {
                                var s = i.getCentralities();
                                if ("nt_all" === e.id) t = n.getNodes(), a = function(t) {
                                    return s[t.type_id][t.id][e.centrality]
                                };
                                else {
                                    var c = s[e.id];
                                    t = n.getNodesByTypeId(e.id), a = function(t) {
                                        return c[t.id][e.centrality]
                                    }
                                }
                            } else "et_weight" === e.type ? (t = "et_all" === e.id ? n.getLinks() : n.getEdgesByTypeId(e.id), a = function(e) {
                                return e.weight || 1
                            }) : "et_prop" === e.type ? (t = (t = n.getEdgesByTypeId(e.id)).filter((function(t) {
                                return Object.prototype.hasOwnProperty.call(t, "properties") && void 0 !== t.properties[e.prop] && null !== t.properties[e.prop] && "" !== t.properties[e.prop] && !isNaN(Number(t.properties[e.prop]))
                            })), a = function(t) {
                                return Number(t.properties[e.prop])
                            }) : "nt_prop" === e.type && (t = (t = "nt_all" === e.id ? n.getNodes() : n.getNodesByTypeId(e.id)).filter((function(t) {
                                return Object.prototype.hasOwnProperty.call(t, "properties") && void 0 !== t.properties[e.prop] && null !== t.properties[e.prop] && "" !== t.properties[e.prop] && !isNaN(Number(t.properties[e.prop]))
                            })), a = function(t) {
                                return Number(t.properties[e.prop])
                            });
                            var l = t.map(a),
                                d = {},
                                u = [];
                            l.forEach((function(e) {
                                d[e] ? d[e] += 1 : (u.push(e), d[e] = 1)
                            }));
                            for (var p, f, h, g, m = u.sort((function(e, t) {
                                    return e - t
                                })), y = {
                                    min: m[0],
                                    max: m[m.length - 1]
                                }, b = [], v = (h = (p = m)[0], g = p[p.length - 1] - h, f = r(p) ? Math.min(o, g) : Math.min(o, p.length), parseFloat((g / f).toFixed(2))), _ = function(e) {
                                    var t = m.filter((function(t) {
                                        return t >= e && t < e + v
                                    })).reduce((function(e, t) {
                                        return e + d[t]
                                    }), 0);
                                    b.push({
                                        key: e,
                                        value: t
                                    })
                                }, w = y.min; w <= y.max; w += v) _(w);
                            return {
                                values: b,
                                range: y,
                                enforceInteger: r(m)
                            }
                        }(s);
                    return a(i, l.values, {
                        color: c,
                        onRangeChanged: t.onRangeChanged,
                        maxKey: l.range.max,
                        maxValText: "et_" === s.type.substring(0, 3) ? "Edges Max" : "Nodes Max",
                        enforceInteger: l.enforceInteger,
                        enableKeyEvents: t.expanded
                    })
                },
                s = n(12),
                c = n.n(s),
                l = n(4),
                d = n(3),
                u = n(0);

            function p(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function f(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? p(Object(n), !0).forEach((function(t) {
                        h(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : p(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function h(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var g = function(e, t) {
                    var n = e.graphStore,
                        r = e.GraphHistory,
                        o = {
                            FREE: 0,
                            USER_MENTION: 1,
                            NODE_REFERENCE: 2
                        },
                        a = o.FREE,
                        i = 0,
                        s = function() {
                            var e = t.selectionStart;
                            c[a].call(null, e)
                        },
                        c = [];

                    function p(e, t) {
                        var n = a;
                        i = t, h[a].call(null, e), m[a = e].call(null, n)
                    }
                    c[o.FREE] = function(e) {
                        var t = w(e);
                        "@" === t && E(e) && p(o.USER_MENTION, e), "#" === t && E(e) && p(o.NODE_REFERENCE, e)
                    }, c[o.USER_MENTION] = function(e) {
                        var t = w(e);
                        if (void 0 === t || !O(t) || e < i || j(i, e)) p(o.FREE, e);
                        else {
                            var n = S(i);
                            C.eq(0).val(n).trigger("input")
                        }
                    }, c[o.NODE_REFERENCE] = function(e) {
                        var t = w(e);
                        if (void 0 === t || !O(t) || e < i || j(i, e)) p(o.FREE, e);
                        else {
                            var n = S(i);
                            C.eq(0).val(n).trigger("input")
                        }
                    };
                    var h = [];
                    h[o.FREE] = function() {}, h[o.USER_MENTION] = function() {
                        ! function() {
                            g && (g.clear(), g = null);
                            C.off("typeahead:selected", y), C.typeahead("destroy")
                        }(), k.classList.add("not-shown"), t.removeEventListener("keydown", _)
                    }, h[o.NODE_REFERENCE] = function() {
                        C.off("typeahead:selected", b), C.off("typeahead:cursorchanged", v), C.typeahead("destroy"), k.classList.add("not-shown"), t.removeEventListener("keydown", _)
                    };
                    var g, m = [];
                    m[o.FREE] = function() {}, m[o.USER_MENTION] = function() {
                        k.classList.remove("not-shown"),
                            function() {
                                g = Object(u.T)([]);
                                var e = function(e, t, r) {
                                    var o = [];
                                    "" === e ? t(n.get("users").map((function(e) {
                                        return e.image = e.img_path, e
                                    })).concat([{
                                        username: "editors",
                                        reserved: !0
                                    }])) : (new RegExp(e, "i").test("editors") && o.push({
                                        username: "editors",
                                        reserved: !0
                                    }), g.search(e, null, (function(e) {
                                        0 === (o = e.concat(o)).length && o.push({
                                            empty: !0
                                        }), r(o)
                                    })))
                                };
                                C.typeahead(f(f({}, u.b), {}, {
                                    autoselect: !0
                                }), f(f({}, u.c), {}, {
                                    name: "user-mentions",
                                    displayKey: "username",
                                    source: e,
                                    templates: {
                                        header: d.a["comments/user_suggestion_header"],
                                        suggestion: d.a["comments/user_suggestion"],
                                        notFound: "<div>not found</div>",
                                        pending: "<div>pending</div>"
                                    }
                                })).on("typeahead:selected", y)
                            }(), x(""), t.addEventListener("keydown", _)
                    }, m[o.NODE_REFERENCE] = function() {
                        var e, n;
                        k.classList.remove("not-shown"), e = 25, n = function(t, n) {
                            var o = r.getNodes(),
                                a = {};
                            r.getNodeTypes().forEach((function(e) {
                                a[e.id] = e.color
                            }));
                            var i, s = [];
                            "" === t ? o.every((function(t) {
                                return s.length !== e && (s.push(t), !0)
                            })) : (i = new RegExp(t, "i"), o.every((function(t) {
                                return s.length !== e && (i.test(t.name) && s.push(t), !0)
                            }))), 0 === (s = s.map((function(e) {
                                return {
                                    name: e.name,
                                    type: e.type,
                                    typeFirstChar: e.type.charAt(0).toUpperCase(),
                                    id: e.id,
                                    color: a[e.type_id]
                                }
                            }))).length && s.push({
                                empty: !0
                            }), n(s)
                        }, C.typeahead(f(f({}, u.b), {}, {
                            autoselect: !0
                        }), f(f({}, u.c), {}, {
                            name: "node-reference",
                            displayKey: "name",
                            source: n,
                            templates: {
                                header: d.a["comments/node_reference_header"],
                                suggestion: d.a["comments/node_reference"],
                                notFound: "<div>not found</div>",
                                pending: "<div>pending</div>"
                            }
                        })).on("typeahead:selected", b).on("typeahead:cursorchanged", v), x(""), t.addEventListener("keydown", _)
                    };
                    var y = function(e, n) {
                        if (n.empty) t.value += " ";
                        else {
                            var r = n.username,
                                a = t.value,
                                s = a.substring(0, i) + r,
                                c = a.substring(i).replace(/[\w]*/, "");
                            t.value = s + (0 === c.length ? " " : "") + c, t.selectionStart = s.length + 1, t.selectionEnd = s.length + 1
                        }
                        setTimeout((function() {
                            p(o.FREE, 0)
                        }), 200)
                    };
                    var b = function(e, n) {
                            if (n.empty) t.value += " ";
                            else {
                                var a, s = n.name,
                                    c = n.id,
                                    l = r.getNodes().filter((function(e) {
                                        return e.name.trim() === s
                                    })).length > 1,
                                    d = t.value;
                                a = l ? d.substring(0, i - 1) + "[#" + s + "](" + c + ")" : d.substring(0, i - 1) + "[#" + s + "]";
                                var u = d.substring(i).replace(/[\w]*/, "");
                                t.value = a + (0 === u.length ? " " : "") + u, t.selectionStart = a.length + 1, t.selectionEnd = a.length + 1
                            }
                            setTimeout((function() {
                                p(o.FREE, 0)
                            }), 200)
                        },
                        v = function(e, t) {
                            t.id && r.focusNode(t.id)
                        };

                    function _(e) {
                        if (37 == e.keyCode || 39 == e.keyCode) {
                            var t = this.selectionStart;
                            c[a].call(null, t)
                        } else {
                            if (38 === e.keyCode || 40 === e.keyCode) return a !== o.FREE && (38 === e.keyCode ? (n = C.data("ttTypeahead")) && n.moveCursor(-1) : function() {
                                var e = C.data("ttTypeahead");
                                e && e.moveCursor(1)
                            }()), e.preventDefault(), e.stopPropagation(), !1;
                            if (13 === e.keyCode || 9 === e.keyCode) return function(e) {
                                var t = C.data("ttTypeahead");
                                t && t._onEnterKeyed("", e)
                            }(e), e.preventDefault(), e.stopPropagation(), !1
                        }
                        var n
                    }

                    function w(e) {
                        return t.value[e - 1]
                    }

                    function O(e) {
                        return null !== e.match(/[0-9\S]/)
                    }

                    function E(e) {
                        return !(e - 2 >= 0) || null === t.value[e - 2].match(/[0-9\S]/)
                    }

                    function j(e, n) {
                        return null !== t.value.substring(e, n).match(/[^0-9A-Za-z\u00C0-\u017F]/)
                    }

                    function S(e) {
                        var n = t.value.substring(e).match(/[0-9A-Za-z\u00C0-\u017F]+/);
                        return n ? n[0] : ""
                    }

                    function x(e) {
                        var t = C.data("ttTypeahead");
                        t && t._onQueryChanged(null, e)
                    }
                    var k = document.querySelector("div.comment-suggester"),
                        C = Object(l.a)(k.querySelector("input"));
                    return t.addEventListener("input", s), t.addEventListener("click", s), {
                        getCurrentState: function() {
                            return a
                        },
                        isFreeTextState: function() {
                            return a === o.FREE
                        },
                        states: o
                    }
                },
                m = function(e, t) {
                    var n, r, o = t.root,
                        a = o.querySelector("textarea"),
                        i = o.querySelector("a.submit-comment"),
                        s = g(e, a),
                        l = t.onSubmit || function() {},
                        d = t.onCaptureRequested || function() {},
                        p = t.onTextUpdated || function() {},
                        f = function() {
                            return a.value.trim()
                        },
                        h = function() {
                            "" === f() ? (Object(u.h)(i, "text-muted"), i.setAttribute("disabled", !0)) : (Object(u.nb)(i, "text-muted"), i.removeAttribute("disabled"))
                        };
                    return a.addEventListener("keyup", (function() {
                        h(), p()
                    })), a.addEventListener("keydown", (function(e) {
                        if (13 === e.keyCode) {
                            if (!s.isFreeTextState()) return e.preventDefault(), !1;
                            if (!e.ctrlKey && !e.shiftKey) {
                                e.preventDefault();
                                var t = f();
                                return t && l(t), !1
                            }
                        } else if (9 === e.keyCode && !s.isFreeTextState()) return e.preventDefault(), !1
                    })), i.addEventListener("click", (function(e) {
                        e.preventDefault();
                        var t = f();
                        return t && l(t), !1
                    })), t.initial_text && (a.value = t.initial_text), h(), n = o.querySelector(".toggle-tip"), c.a.create(n, {
                        position: "bottom",
                        hideOnClickOutside: !0
                    }), (r = o.querySelector(".comment-with-image")) && r.addEventListener("click", (function(e) {
                        return e.preventDefault(), d(f()), !1
                    })), {
                        focus: function() {
                            a.focus()
                        },
                        clear: function() {
                            a.value = "", h()
                        },
                        getText: f,
                        destroy: function() {}
                    }
                },
                y = function(e) {
                    return function(t) {
                        return [Object(u.B)(), "/graphs/", t, e, Object(u.J)()].join("")
                    }
                },
                b = function(e) {
                    return {
                        setPropertyInputOptions: function(t) {
                            var n, r = t.is_nt ? e.nodeTypes : e.edgeTypes;
                            if ("All Node Types" === t.name || "All Vector Orders" === t.name) {
                                var o = {};
                                r.forEach((function(e) {
                                    Array.isArray(e.properties) && e.properties.forEach((function(t) {
                                        (t.empty || 0) < e.count && (Object.prototype.hasOwnProperty.call(o, t.name) ? o[t.name] += 1 : o[t.name] = 1)
                                    }))
                                })), n = Object.keys(o)
                            } else {
                                var a = r.find((function(e) {
                                    return e.name === t.name
                                }));
                                n = Array.isArray(a.properties) ? a.properties.filter((function(e) {
                                    return (e.empty || 0) < a.count
                                })).map((function(e) {
                                    return e.name
                                })) : []
                            }
                            return (n = n.sort((function(e, t) {
                                return e < t ? -1 : t > e ? 1 : 0
                            }))).unshift("All"), n
                        },
                        setValueInputOptions: function(t, n) {
                            var r, o = t.is_nt ? e.nodeTypes : e.edgeTypes;
                            if ("All" === t.type_id) {
                                var a = {};
                                o.forEach((function(e) {
                                    if (Array.isArray(e.properties)) {
                                        var t = e.properties.find((function(e) {
                                            return e.name == n.name && Object.prototype.hasOwnProperty.call(e, "nominal")
                                        }));
                                        if (t) Object.keys(t.nominal).forEach((function(e) {
                                            Object.prototype.hasOwnProperty.call(a, e) ? a[e] += 1 : a[e] = 1
                                        }))
                                    }
                                })), r = Object.keys(a)
                            } else {
                                var i = o.find((function(e) {
                                    return e.id === t.type_id
                                })).properties.find((function(e) {
                                    return e.name === n.name
                                }));
                                r = Object.keys(i.nominal)
                            }
                            return r
                        },
                        isSelectedPropertyNominal: function(t, n) {
                            var r = t.is_nt ? e.nodeTypes : e.edgeTypes,
                                o = !1;
                            if ("All" === t.type_id)
                                for (var a = 0; a < r.length; a += 1) {
                                    var i = r[a];
                                    if (Array.isArray(i.properties)) {
                                        var s = i.properties.find((function(e) {
                                            return e.name === n.name
                                        }));
                                        if (s && Object.prototype.hasOwnProperty.call(s, "nominal")) {
                                            o = !0;
                                            break
                                        }
                                    }
                                } else {
                                    var c = r.find((function(e) {
                                        return e.name == t.type_name
                                    }));
                                    if (Array.isArray(c.properties)) {
                                        var l = c.properties.find((function(e) {
                                            return e.name == n.name
                                        }));
                                        o = Object.prototype.hasOwnProperty.call(l, "nominal")
                                    }
                                }
                            return o
                        }
                    }
                },
                v = function() {
                    var e = [];
                    return {
                        run: function(t) {
                            var n;
                            e && (e.forEach((function(e) {
                                e.parentNode.removeChild(e)
                            })), e = []), Array.isArray(t) || (t = [t]);
                            var r = function() {
                                var r = t[n],
                                    o = {
                                        title: r.title,
                                        message: r.message
                                    };
                                r.onConfirm && (o.confirm = !0);
                                var a = d.a["graphs/onboard_message_template"](o);
                                document.body.appendChild(a.trim().toDOM());
                                var i = document.body.lastElementChild;
                                if (r.onConfirm && (i.querySelector("button.gc-onboard-confirm").addEventListener("click", (function() {
                                        r.onConfirm()
                                    })), r.onSkip && i.querySelector("button.gc-onboard-cancel").addEventListener("click", (function() {
                                        r.onSkip()
                                    }))), r.target) {
                                    var s = ("string" === typeof r.target ? document.querySelector(r.target) : r.target).getBoundingClientRect(),
                                        c = i.getBoundingClientRect(),
                                        l = i.querySelector("span.gc-onboard-pointer");
                                    switch (r.position) {
                                        case "bottom":
                                            i.style.top = s.bottom + 18 + "px", i.style.left = s.left - 8 + "px", l.className += " gc-onboard-pointer-top";
                                            break;
                                        case "bottom-center":
                                            i.style.top = s.bottom + 18 + "px", i.style.left = Math.floor((s.left + s.right) / 2 - Math.floor(c.width / 2)) + "px", l.className += " gc-onboard-pointer-top", l.style.left = Math.floor(c.width / 2 - 8) + "px";
                                            break;
                                        case "bottom-right":
                                            i.style.top = s.bottom + 18 + "px", i.style.right = window.innerWidth - s.right + 8 + "px", l.className += " gc-onboard-pointer-top", l.style.right = "8px", l.style.left = "inherit";
                                            break;
                                        case "top":
                                            i.style.bottom = window.innerHeight - s.top + 11 + "px", i.style.left = s.left - 8 + "px", l.className += " gc-onboard-pointer-bottom";
                                            break;
                                        case "top-center":
                                            i.style.bottom = window.innerHeight - s.top + 11 + "px", i.style.left = Math.floor((s.left + s.right) / 2 - Math.floor(c.width / 2)) + "px", l.style.left = Math.floor(c.width / 2 - 8) + "px", l.className += " gc-onboard-pointer-bottom";
                                            break;
                                        case "right":
                                            i.style.top = s.top + "px", i.style.left = s.right + 18 + "px", l.className += " gc-onboard-pointer-left";
                                            break;
                                        default:
                                            i.style.top = s.top + "px", i.style.right = window.innerWidth - s.left + 11 + "px", l.className += " gc-onboard-pointer-right"
                                    }
                                } else i.style.top = "100px", i.style.right = "25px", i.querySelector("span.gc-onboard-pointer").className += " hidden";
                                e.push(i)
                            };
                            for (n = 0; n < t.length; n += 1) r()
                        },
                        clear: function() {
                            e && (e.forEach((function(e) {
                                e.parentNode.removeChild(e)
                            })), e = [])
                        }
                    }
                },
                _ = function(e, t) {
                    return function(e) {
                        var n = e,
                            r = d.a["graphs/onboard_message_template"](n);
                        document.body.appendChild(r.trim().toDOM());
                        var o = document.body.lastElementChild;
                        if (e.target) {
                            var a = ("string" === typeof e.target ? document.querySelector(e.target) : e.target).getBoundingClientRect(),
                                i = o.getBoundingClientRect(),
                                s = o.querySelector("span.gc-onboard-pointer");
                            switch (e.position) {
                                case "bottom":
                                    o.style.top = a.bottom + 18 + "px", o.style.left = a.left - 8 + "px", s.className += " gc-onboard-pointer-top";
                                    break;
                                case "bottom-center":
                                    o.style.top = a.bottom + 18 + "px", o.style.left = Math.floor((a.left + a.right) / 2 - Math.floor(i.width / 2)) + "px", s.className += " gc-onboard-pointer-top", s.style.left = Math.floor(i.width / 2 - 8) + "px";
                                    break;
                                case "bottom-right":
                                    o.style.top = a.bottom + 18 + "px", o.style.right = window.innerWidth - a.right + 8 + "px", s.className += " gc-onboard-pointer-top", s.style.right = "8px", s.style.left = "inherit";
                                    break;
                                case "top":
                                    o.style.bottom = window.innerHeight - a.top + 11 + "px", o.style.left = a.left - 8 + "px", s.className += " gc-onboard-pointer-bottom";
                                    break;
                                case "top-center":
                                    o.style.bottom = window.innerHeight - a.top + 11 + "px", o.style.left = Math.floor((a.left + a.right) / 2 - Math.floor(i.width / 2)) + "px", s.style.left = Math.floor(i.width / 2 - 8) + "px", s.className += " gc-onboard-pointer-bottom";
                                    break;
                                case "top-right":
                                    o.style.bottom = window.innerHeight - a.top + 11 + "px", o.style.right = window.innerWidth - a.right + 8 + "px", s.style.left = "inherit", s.style.right = "8px", s.className += " gc-onboard-pointer-bottom";
                                    break;
                                case "right":
                                    o.style.top = a.top + "px", o.style.left = a.right + 18 + "px", s.className += " gc-onboard-pointer-left";
                                    break;
                                default:
                                    o.style.top = a.top + "px", o.style.right = window.innerWidth - a.left + 11 + "px", s.className += " gc-onboard-pointer-right"
                            }
                        } else o.style.top = "100px", o.style.right = "25px", o.querySelector("span.gc-onboard-pointer").className += " hidden";
                        e.onConfirm && (o.querySelector("button.gc-onboard-confirm").addEventListener("click", (function() {
                            l(), e.onConfirm()
                        })), o.querySelector("button.gc-onboard-cancel").addEventListener("click", (function() {
                            l(), e.onSkip && e.onSkip()
                        })));
                        var c = !1;

                        function l() {
                            document.body.removeEventListener("click", p), document.body.removeEventListener("keydown", u), document.body.removeChild(o), t && t()
                        }

                        function u(t) {
                            27 === t.keyCode && (l(), setTimeout((function() {
                                e.onSkip && e.onSkip()
                            }), 1))
                        }

                        function p() {
                            c ? c = !1 : (l(), e.onSkip && e.onSkip())
                        }
                        return setTimeout((function() {
                            o.addEventListener("click", (function() {
                                c = !0
                            })), document.body.addEventListener("click", p), document.body.addEventListener("keydown", u)
                        }), 1), {
                            close: l
                        }
                    }(e)
                },
                w = function(e, t, n) {
                    var r = e.length - 1;
                    e.forEach((function(o, a) {
                        o.confirm = !0, a !== r ? (o.onConfirm = function() {
                            _(e[a + 1])
                        }, o.onSkip = function() {
                            n && n()
                        }, o.next_text = "NEXT", o.skip_text = "Close") : (o.onConfirm = function() {
                            t && t()
                        }, o.onSkip = function() {
                            t && t()
                        }, o.next_text = "DONE", o.hide_skip = !0)
                    })), _(e[0])
                },
                O = function(e) {
                    return function(t) {
                        return [Object(u.B)(), "/graphs/", t, "/comments/", e.id, "?auto=true"].join("")
                    }
                },
                E = function(e) {
                    return function(t) {
                        return [Object(u.B)(), "/graphs/", t, "?sel=", e.id, "&auto=true"].join("")
                    }
                },
                j = function(e) {
                    var t = this,
                        n = e.dispatcher,
                        r = e.GraphHistory,
                        o = "/selection/",
                        a = function() {
                            return location.origin ? location.origin : location.protocol + "//" + location.hostname + (location.port ? ":" + location.port : "")
                        },
                        i = function() {
                            return location.pathname.match(/^\/graphs\/new/)
                        };
                    this.route = function() {
                        if (!i()) {
                            var e = r.getSelectedNodes();
                            history.replaceState(e, t.getTitle(), t.getUrl())
                        }
                    }, n.bind("onNodeFocused", (function(e) {
                        if (!i()) {
                            var n = location.pathname.replace(/\/selection\/.*/, "").replace(/\/$/, ""),
                                r = a(),
                                s = location.search,
                                c = r + n + ((e = Array.isArray(e) ? e : [e]) ? o + e.join(",") : "") + s;
                            history.replaceState(e, t.getTitle(), c)
                        }
                    }), this), n.bind("onEdgeFocused", (function(e) {
                        if (!i()) {
                            for (var n = location.pathname.replace(/\/selection\/.*/, "").replace(/\/$/, ""), s = a(), c = location.search, l = r.getSelectedNodes(), d = 0; d < e.length; d += 1) l.indexOf(e[d].from) < 0 && l.push(e[d].from), l.indexOf(e[d].to) < 0 && l.push(e[d].to);
                            history.replaceState(l, t.getTitle(), s + n + (l.length ? o + l.join(",") : "") + c)
                        }
                    }), this), n.bind("onNodeSelected", this.route, this), n.bind("onNodeUnselected", this.route, this), n.bind("onNodesReleased", this.route, this), this.getUrl = function() {
                        var e = r.getSelectedNodes(),
                            t = a(),
                            n = location.pathname.replace(/\/selection\/.*/, "").replace(/\/$/, ""),
                            i = location.search,
                            s = e.join(",");
                        return s ? t + n + (e.length ? o + s : "") + i : t + n + i
                    }, this.getTitle = function() {
                        return "Selection"
                    }, this.loadState = function() {
                        var e, t = this;
                        (location.pathname.match(/\/selection\//) && (e = location.pathname.replace(/^.*\/selection\//, "").replace(/\/$/, "")), e && e.length) && e.split(",").forEach((function(e) {
                            r.addToSelectedNodes(e, t)
                        }))
                    }
                },
                S = n(6),
                x = n.n(S),
                k = (n(487), n(108)),
                C = n.n(k),
                N = n(57),
                T = function(e) {
                    var t, n, r, a, i, s, c, d, u, p, f, h, g, m, y, b, v, _, w, O, E, j = !1,
                        S = !1,
                        k = !1,
                        T = null,
                        L = 24,
                        P = "string" === typeof e.elemCalendar ? document.querySelector(e.elemCalendar) : e.elemCalendar,
                        A = !1,
                        D = e.initialDate,
                        M = e.container,
                        q = e.onTimeMarkChanged || function() {},
                        I = e.onRangeChanged || function() {},
                        R = e.height || 150,
                        B = e.onDateRangePickerClosed || function() {},
                        F = e.onDateRangePickerOpened || function() {},
                        G = e.onTimeComparisonSelected || function() {},
                        H = e.onTimeComparisonRemoved || function() {},
                        U = e.yAxisHandler || N.DefaultYAxisHandler,
                        z = e.totalRange;
                    z && (_ = z.max - z.min);
                    var W = !1,
                        Y = function() {
                            w && (w.text("Play"), O = !1, clearInterval(E))
                        },
                        V = function() {
                            if (P)
                                for (h && (h.data("dateRangePicker").destroy(), h = null, f = null), g && (g.data("dateRangePicker") && g.data("dateRangePicker").destroy(), g = null); P.firstChild;) P.removeChild(P.firstChild)
                        },
                        X = function(e, t) {
                            return [x.a.tz(e, b.timezone).format(b.momentTimeFormat), "-", x.a.tz(t, b.timezone).format(b.momentTimeFormat)].join(" ")
                        },
                        K = function() {
                            document.body.removeChild(m)
                        },
                        $ = function() {
                            (m = document.createElement("div")).className = "calendar-fullscreen-backdrop", document.body.appendChild(m)
                        },
                        Z = function() {
                            V(), (f = document.createElement("span")).setAttribute("class", "calendar dropdown"), y[0].length > 1 ? f.innerHTML = X(y[0][1], y[0][y[0].length - 1]) : f.innerHTML = X(b.time_range.min, b.time_range.max), P.appendChild(f), (h = Object(l.a)(f)).dateRangePicker({
                                showShortcuts: !0,
                                shortcuts: null,
                                customValueLabel: "Select",
                                customShortcuts: [{
                                    name: "Previous Month",
                                    dates: function() {
                                        var e = x()(v.max).startOf("month").subtract(1, "month").toDate();
                                        return [e, x()(e).endOf("month").toDate()]
                                    }
                                }, {
                                    name: "Current Month",
                                    dates: function() {
                                        var e = new Date,
                                            t = e.getFullYear(),
                                            n = e.getMonth() + 1;
                                        n < 10 && (n = "0" + n);
                                        var r = e.getDate();
                                        return r < 10 && (r = "0" + r), [x()(t + "-" + n + "-01").toDate(), x()(t + "-" + n + "-" + r).toDate()]
                                    }
                                }, {
                                    name: "Next Month",
                                    dates: function() {
                                        var e = x()(v.max).add(1, "month").startOf("month").toDate(),
                                            t = x()(e).endOf("month").toDate();
                                        return e.getTime() > z.max && (e = x()().startOf("month").toDate()), t.getTime() > z.max && (t = x()().toDate()), [e, t]
                                    }
                                }],
                                startDate: x()(z.min).format("YYYY-MM-DD"),
                                endDate: x()(z.max).format("YYYY-MM-DD"),
                                customOpenAnimation: function(e) {
                                    Object(l.a)(this).fadeIn(100, e)
                                },
                                customCloseAnimation: function(e) {
                                    Object(l.a)(this).fadeOut(100, e)
                                },
                                autoClose: !0
                            }).bind("datepicker-open", (function() {
                                Object(l.a)(".date-picker-wrapper").css({
                                    position: "absolute",
                                    top: Math.floor(h.offset().top + h.height() + 20) + "px",
                                    left: "inherit",
                                    right: "100px",
                                    zIndex: 4e4
                                })
                            })).bind("datepicker-change", (function(e, t) {
                                var n = t.date1.getFullYear(),
                                    r = t.date1.getMonth() + 1;
                                r < 10 && (r = "0" + r);
                                var o = t.date1.getDate();
                                o < 10 && (o = "0" + o);
                                var a = x.a.tz(n + "-" + r + "-" + o, b.timezone).toDate().getTime(),
                                    i = t.date2.getFullYear(),
                                    s = t.date2.getMonth() + 1;
                                s < 10 && (s = "0" + s);
                                var c = t.date2.getDate();
                                c < 10 && (c = "0" + c);
                                var l = x.a.tz(i + "-" + s + "-" + c, b.timezone).add(1, "day").subtract(1, "millisecond").toDate().getTime();
                                I.call(null, a, l)
                            })).bind("datepicker-closed", (function() {
                                K(), document.removeEventListener("keyup", J), B.call(null)
                            })).bind("datepicker-opened", (function() {
                                $(), document.addEventListener("keyup", J), F.call(null)
                            })), h.data("dateRangePicker").setDateRange(x.a.tz(v.min, b.timezone).format("YYYY-MM-DD"), x.a.tz(v.max, b.timezone).format("YYYY-MM-DD"), !0), e.noCalendarCompare || function() {
                                var e = document.createElement("button");
                                if (e.setAttribute("class", "text btn-calendar"), e.style.opacity = .5, e.innerHTML = A ? "Compare" : "Compare *", P.insertBefore(e, P.firstChild), g = Object(l.a)(e), b.compare_time_range) {
                                    var t = document.createElement("button");
                                    t.setAttribute("class", "text btn-remove"), t.innerHTML = '<img src="/assets/icons/close_icon.svg">', t.addEventListener("click", (function() {
                                        H.call()
                                    })), P.insertBefore(t, e)
                                }
                                if (A) {
                                    var n, r, o = x()(b.time_range.min).startOf("day").toDate().getTime(),
                                        a = x()(b.time_range.max).add(1, "day").startOf("day").toDate().getTime();
                                    if (a === x()(o).add(1, "year").toDate().getTime() ? (n = "year", r = "Click any day in a year", g[0].title = "Select a year to compare with the current interval") : a === x()(o).add(1, "month").toDate().getTime() ? (n = "month", r = "Click any day in a month", g[0].title = "Select a month to compare with the current interval") : a === x()(o).add(1, "week").toDate().getTime() ? (n = "week", r = "Click any day in a week", g[0].title = "Select a week to compare with the current interval") : a === x()(o).add(1, "day").toDate().getTime() ? (n = "day", r = "Click any day", g[0].title = "Select a day to compare with the current interval") : (g[0].innerHTML = "Compare *", g[0].title = "Select a proper day, week or month"), n) {
                                        g[0].style.opacity = 1;
                                        var i = {
                                            singleMonth: !0,
                                            extraClass: "batch-" + n,
                                            customTopBar: r,
                                            startDate: x()(z.min).format("YYYY-MM-DD"),
                                            endDate: x()(z.max).format("YYYY-MM-DD"),
                                            customOpenAnimation: function(e) {
                                                Object(l.a)(this).fadeIn(100, e)
                                            },
                                            customCloseAnimation: function(e) {
                                                Object(l.a)(this).fadeOut(100, e)
                                            },
                                            autoClose: !0,
                                            showShortcuts: !0,
                                            shortcuts: null,
                                            customValueLabel: "Select",
                                            customShortcuts: [{
                                                name: "Prev Year",
                                                dates: function() {
                                                    var e = b.compare_time_range ? b.compare_time_range.min : v.min,
                                                        t = x()(e).subtract(1, "year").toDate();
                                                    return [t, t]
                                                }
                                            }, {
                                                name: "Next Year",
                                                dates: function() {
                                                    var e = b.compare_time_range ? b.compare_time_range.min : v.min,
                                                        t = x()(e).add(1, "year").toDate();
                                                    return [t, t]
                                                }
                                            }]
                                        };
                                        switch (n) {
                                            case "month":
                                                i.batchMode = n;
                                                break;
                                            case "week":
                                                i.minDays = 7, i.maxDays = 7;
                                                break;
                                            case "day":
                                                i.singleDate = !0;
                                                break;
                                            case "year":
                                                i.singleDate = !0, i.extraClass = "batch-month"
                                        }
                                        g.dateRangePicker(i).bind("datepicker-open", (function() {
                                            Object(l.a)(".date-picker-wrapper").css({
                                                position: "absolute",
                                                top: h.offset().top - 245 + "px",
                                                left: "inherit",
                                                right: "100px",
                                                zIndex: 4e4
                                            })
                                        })).bind("datepicker-change", (function(e, t) {
                                            var r = x()(t.date1).startOf(n).toDate().getTime(),
                                                o = x()(r).add(1, n).subtract(1, "millisecond").toDate().getTime();
                                            G.call(null, r, o)
                                        })).bind("datepicker-closed", (function() {
                                            K(), document.removeEventListener("keyup", J), B.call(null)
                                        })).bind("datepicker-opened", (function() {
                                            $(), document.addEventListener("keyup", J), F.call(null)
                                        })), b.compare_time_range ? g.data("dateRangePicker").setDateRange(x()(b.compare_time_range.min).format("YYYY-MM-DD"), x()(b.compare_time_range.max).format("YYYY-MM-DD"), !0) : g.data("dateRangePicker").setDateRange(x()(v.min).format("YYYY-MM-DD"), x()(v.max).format("YYYY-MM-DD"), !0)
                                    }
                                } else g[0].title = "Select a single node to activate"
                            }()
                        };

                    function J(e) {
                        27 === e.keyCode && (h.data("dateRangePicker").close(), g && g.data("dateRangePicker") && g.data("dateRangePicker").close())
                    }
                    var Q = function(e) {
                            return Math.floor(d * (e - z.min) / _)
                        },
                        ee = function() {
                            p && (D ? (p.attr("x", Q(D)), p.style("opacity", 1)) : p.style("opacity", 0))
                        },
                        te = function() {
                            if (!e.skipDragComponent) {
                                var t = document.createElement("div");
                                t.setAttribute("class", "c3-timeline__slider"), M.appendChild(t);
                                var n = function(e, t) {
                                        var n = Math.floor(z.min + e / d * _),
                                            r = Math.floor(z.min + t / d * _);
                                        I.call(null, n, r)
                                    },
                                    r = function() {
                                        var e = Math.floor(z.min + s / d * _),
                                            t = Math.floor(z.min + l / d * _);
                                        N.attr("x", s), N.text(x()(e).format(b.momentTimeFormat)), P.attr("x", l), P.text(x()(t).format(b.momentTimeFormat));
                                        var n = k.node().getBoundingClientRect(),
                                            r = C.node().getBoundingClientRect();
                                        s < u ? N.style("text-anchor", "start") : N.style("text-anchor", "end"), n.right < s + u ? k.attr("opacity", 1) : k.attr("opacity", 0), r.left > l + u ? (C.attr("opacity", 1), P.style("text-anchor", "start")) : (C.attr("opacity", 0), P.style("text-anchor", "end"))
                                    },
                                    a = t.querySelector("svg.range-component");
                                if (a)
                                    for (; a.firstChild;) a.removeChild(a.firstChild);
                                else(a = document.createElementNS("http://www.w3.org/2000/svg", "svg")).setAttribute("class", "range-component"), a.setAttribute("width", c), a.setAttribute("height", L), t.appendChild(a);
                                e.animationDisabled || (w = o.a.select(a).append("text").attr("class", "clickable").attr("x", u - 8).attr("y", 16).style("text-anchor", "end").style("font-size", "0.85rem").style("font-family", '"Apercu Regular Pro", Helvetica, Arial, sans-serif').text("Play").on("click", (function() {
                                    O ? Y() : (w.text("Stop"), O = !0, null == T && (T = -1), E = setInterval((function() {
                                        de()
                                    }), 1e3))
                                })));
                                var i = o.a.select(a).append("g").attr("class", "c3-chart-range-container").attr("transform", "translate(" + u + ", 0)");
                                z || (z = {
                                    max: v.max,
                                    min: v.min
                                });
                                var s = Q(v.min),
                                    l = Q(v.max),
                                    f = l - s;
                                i.append("rect").attr("x", 0).attr("width", d).attr("height", L).style("fill", "#D0D0D0").on("dblclick", (function() {
                                    var e = o.a.mouse(this),
                                        t = Math.min(Math.max(e[0], 0), d - f);
                                    if (t < s) {
                                        var n = v.max - v.min,
                                            r = v.min - n,
                                            a = r + n;
                                        I.call(null, r, a)
                                    } else if (t > l) {
                                        var i = v.max - v.min,
                                            c = v.max + i,
                                            u = c - i;
                                        I.call(null, u, c)
                                    }
                                }));
                                var g = [{
                                        x: s
                                    }],
                                    m = o.a.behavior.drag().origin((function(e) {
                                        return e
                                    })).on("drag", (function(e) {
                                        var t = Math.min(Math.max(o.a.event.x, 0), d - f);
                                        e.x = t, y.attr("x", t), l = (s = t) + f, S[0].x = s - 5, S[1].x = l - 5, i.select(".handle-min").attr("x", S[0].x), i.select(".handle-max").attr("x", S[1].x), r()
                                    })).on("dragend", (function() {
                                        n(s, l)
                                    })),
                                    y = i.selectAll(".range-selection").data(g).enter().append("rect").attr("class", "range-selection grabbable active-opacity").attr("x", s).attr("height", L).attr("width", f).style("fill", "#E0E0E0").call(m),
                                    j = o.a.behavior.drag().origin((function(e) {
                                        return e
                                    })).on("dragstart", (function() {})).on("drag", (function(e) {
                                        e.onMove.call(this, e) && (y.attr("x", s), y.attr("width", f), g[0].x = s, r())
                                    })).on("dragend", (function() {
                                        n(s, l)
                                    })),
                                    S = [{
                                        x: s - 5,
                                        class: "handle handle-min",
                                        onMove: function(e) {
                                            var t = Math.max(-5, Math.min(o.a.event.x, l - 5));
                                            if (t !== e.x) return e.x = t, o.a.select(this).attr("x", e.x), s = e.x + 5, f = l - s, !0
                                        }
                                    }, {
                                        x: l - 5,
                                        class: "handle handle-max",
                                        onMove: function(e) {
                                            var t = Math.max(s - 5, Math.min(d - 5, o.a.event.x));
                                            if (t !== e.x) return e.x = t, o.a.select(this).attr("x", e.x), l = e.x + 5, f = l - s, !0
                                        }
                                    }];
                                p = i.append("rect").attr("class", "current-date").attr("y", 0).attr("width", 1).attr("height", L).style("fill", "black"), i.selectAll(".handle").data(S).enter().append("rect").attr("fill", "#333").attr("width", 10).attr("height", 14).attr("y", 5).attr("x", (function(e) {
                                    return e.x
                                })).attr("class", (function(e) {
                                    return e.class
                                })).on("mouseover", (function() {
                                    this.style.cursor = "ew-resize"
                                })).call(j);
                                var k = i.append("text").attr("class", "max-range min").text(x()(z.min).format(b.momentTimeFormat)).attr("x", 0).attr("y", 28).style("dominant-baseline", "hanging"),
                                    C = i.append("text").attr("class", "max-range max").text(x()(z.max).format(b.momentTimeFormat)).attr("x", d).attr("y", 28).style("dominant-baseline", "hanging").style("text-anchor", "end"),
                                    N = i.append("text").attr("class", "selected-range min").attr("y", 28).attr("filter", "url(#solid)").style("dominant-baseline", "hanging"),
                                    P = i.append("text").attr("class", "selected-range max").attr("y", 28).attr("filter", "url(#solid)").style("dominant-baseline", "hanging");
                                ee(), h.data("dateRangePicker").setDateRange(x()(v.min).format("YYYY-MM-DD"), x()(v.max).format("YYYY-MM-DD"), !0)
                            }
                        },
                        ne = function(e) {
                            var t = y[0].indexOf(e);
                            if (!(t > 0)) return i.setAttribute("opacity", 0), s.setAttribute("opacity", 0), void(T = null);
                            re(e, t -= 1)
                        };

                    function re(e, t) {
                        var n = function(e) {
                                var t = "g.c3-chart-lines g.c3-shapes.c3-shapes-data1.c3-circles.c3-circles-data1 circle.c3-circle-" + e,
                                    n = le.querySelector(t);
                                if (n) return Number(n.getAttribute("cx"))
                            }(t),
                            r = 1;
                        if (0 != t && t != y[0].length - 2 || (n -= 1, r = 3), i.setAttribute("x", n), i.setAttribute("width", r), i.setAttribute("opacity", .8), n < .5 * d ? (s.setAttribute("x", n + (r + 2)), s.style.textAnchor = "start") : (s.setAttribute("x", n - (r + 2)), s.style.textAnchor = "end"), s.setAttribute("opacity", 1), s.style.dominantBaseline = "ideographic", s.innerHTML = x.a.tz(Number(e), b.timezone).format(b.momentTimeFormat), !W) {
                            if (T) {
                                var o = T;
                                T = null, ae(o)
                            }
                            oe(t)
                        }
                        T = t, ee()
                    }

                    function oe(e) {
                        if (e !== T)
                            for (var t = y.length - 1; t >= 1; t -= 1) {
                                var n = "g.c3-chart-lines circle.c3-circle-" + e,
                                    r = le.querySelector(n);
                                r && (r.style.opacity = 1)
                            }
                    }

                    function ae(e) {
                        if (e !== T)
                            for (var t = y.length - 1; t >= 1; t -= 1) {
                                var n = "g.c3-chart-lines circle.c3-circle-" + e,
                                    r = le.querySelector(n);
                                r && (r.style.opacity = 0)
                            }
                    }
                    var ie = function(e, n) {
                        O && Y(), y = e, b = n, v = {
                            min: n.time_range.min,
                            max: n.time_range.max
                        };
                        var r = {};
                        n.colors ? n.colors.forEach((function(e, t) {
                            r["data" + (t + 1)] = e
                        })) : r = {
                            data1: "blue",
                            data2: "green"
                        };
                        var o = {
                                data1: "y",
                                data2: "y2"
                            },
                            a = !n.withY2 || b.nodes && b.nodes.length > 1 || b.compare_time_range;
                        a && (a = !0, o = {}, e.forEach((function(e, t) {
                            0 != t && (o[e[0]] = "y")
                        }))), S = !0, W = y && y[0].length < 45;
                        var i = {
                                legend: {
                                    show: !1
                                },
                                grid: {
                                    x: {
                                        show: !1
                                    },
                                    y: {
                                        show: !0
                                    }
                                },
                                tooltip: {
                                    show: !0,
                                    contents: n.tooltip,
                                    position: function(e, t, n, r) {
                                        var o;
                                        o = e.length > 1 ? parseInt(r.getAttribute("y")) + parseInt(r.getAttribute("height")) / 2 - n / 2 : parseFloat(document.querySelector("g.c3-shapes circle.c3-circle-" + e[0].index).getAttribute("cy"));
                                        var a = parseInt(r.getAttribute("x")) + parseInt(r.getAttribute("width")) / 2;
                                        return {
                                            top: o,
                                            left: a + 400 < c ? a + u + 24 : a + u - t - 12
                                        }
                                    }
                                },
                                point: {
                                    show: W,
                                    r: W ? 3.5 : 3
                                },
                                axis: {
                                    x: {
                                        tick: {
                                            format: function(e) {
                                                return x.a.tz(e, b.timezone).format(b.momentTimeFormat)
                                            },
                                            culling: !0,
                                            outer: !1
                                        },
                                        padding: {
                                            left: 0,
                                            right: 0
                                        }
                                    }
                                },
                                size: {
                                    height: R
                                },
                                bindto: le,
                                onrendered: function() {
                                    S && ce(), k && (se(), ne(D), Z(), te(), k = !1), j || (n.onInitialized && n.onInitialized(), j = !0)
                                },
                                onresized: function() {
                                    k = !0
                                }
                            },
                            s = a ? y.slice(1) : [y[1]];
                        i.axis.y = U(s), a || (i.axis.y2 = U([y[2]])), b.compare_time_range ? (i.data = {
                            columns: y.slice(1),
                            colors: r,
                            type: "area",
                            axes: o
                        }, i.axis.x.tick.count = void 0, i.axis.x.tick.format = function(e) {
                            return 0 === e || e + 2 === y[0].length ? x.a.tz(y[0][e + 1], b.timezone).format(b.momentTimeFormat) : ""
                        }) : (i.data = {
                            x: "ts",
                            columns: y,
                            colors: r,
                            type: "area",
                            axes: o
                        }, i.axis.x.type = "timeseries", i.axis.x.tick.values = []), t && t.destroy(), t = C.a.generate(i)
                    };

                    function se() {
                        Array.from(le.querySelectorAll("rect.c3-event-rect")).forEach((function(t, n) {
                            W || (t.addEventListener("mouseover", (function() {
                                oe(n)
                            })), t.addEventListener("mouseout", (function() {
                                ae(n)
                            }))), e.disableChartClick || t.addEventListener("click", (function() {
                                re(D = y[0][n + 1], n), q && q(D)
                            }))
                        }))
                    }

                    function ce() {
                        var t, o;
                        le.querySelector("g.c3-chart") && (! function() {
                            var e = le.querySelector("svg");
                            c = Number(e.getAttribute("width"));
                            var t = e.getBoundingClientRect().left;
                            n = e.querySelector(".c3-chart");
                            var o = e.querySelector("g.c3-grid").getBoundingClientRect();
                            r = o.height, d = o.width, u = o.left - t
                        }(), function() {
                            if (a) {
                                for (; a.firstChild;) a.removeChild(a.firstChild);
                                a.parentNode.removeChild(a)
                            }(a = document.createElementNS("http://www.w3.org/2000/svg", "g")).setAttribute("class", "c3-chart-time-indicator"), n.parentNode.insertBefore(a, n)
                        }(), function() {
                            var e = le.querySelector("svg").querySelector("defs"),
                                t = e.querySelector("filter#solid");
                            t && e.removeChild(t);
                            var n = document.createElementNS("http://www.w3.org/2000/svg", "filter");
                            n.setAttribute("x", 0), n.setAttribute("y", 0), n.setAttribute("width", 1), n.setAttribute("height", 1), n.setAttribute("id", "solid");
                            var r = document.createElementNS("http://www.w3.org/2000/svg", "feFlood");
                            r.setAttribute("class", "text-bg-filter");
                            var o = document.createElementNS("http://www.w3.org/2000/svg", "feComposite");
                            o.setAttribute("in", "SourceGraphic"), n.appendChild(r), n.appendChild(o), e.appendChild(n)
                        }(), t = Array.from(document.querySelectorAll("g.c3-shapes circle")), o = null, t.forEach((function(e, t) {
                            var n = Number(e.getAttribute("cx"));
                            if (!(null != o && n < o + 150)) {
                                var i = document.createElementNS("http://www.w3.org/2000/svg", "text");
                                i.innerHTML = x.a.tz(y[0][t + 1], b.timezone).format(b.momentTimeFormat), i.setAttribute("class", "block-range"), i.setAttribute("y", r + 20), i.style.dominantBaseline = "ideographic", a.appendChild(i), i.setAttribute("x", n), 0 === t ? i.style.textAnchor = "start" : t == y[0].length - 2 ? i.style.textAnchor = "end" : i.style.textAnchor = "middle", o = n
                            }
                        })), function() {
                            var e = a.querySelector("rect.selected-mark");
                            e && a.removeChild(e);
                            var t = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                            t.setAttribute("class", "selected-mark"), t.setAttribute("fill", "black"), t.setAttribute("x", 0), t.setAttribute("width", 4), t.setAttribute("y", 0), t.setAttribute("height", r), t.setAttribute("opacity", 0), a.appendChild(t), i = t
                        }(), function() {
                            var e = a.querySelector("text-selected-label");
                            e && a.removeChild(e);
                            var t = document.createElementNS("http://www.w3.org/2000/svg", "text");
                            t.setAttribute("class", "selected-label"), t.setAttribute("y", r - 1), t.setAttribute("filter", "url(#solid)"), t.style.fill = "black", t.style.fontWeight = "bold", t.opactiy = "1", a.appendChild(t), s = t
                        }(), se(), b.timestamp && (ne(b.timestamp), D = b.timestamp), b.compare_time_range && Array.from(le.querySelector("g.c3-axis.c3-axis-x").querySelectorAll("g.tick")).forEach((function(e) {
                            var t = e.getAttribute("transform"),
                                n = Array.from(e.querySelectorAll("text tspan"));
                            n.length > 1 && n.slice(1).forEach((function(e) {
                                e.parentNode.removeChild(e)
                            }));
                            var r = n[0];
                            if ("" !== r.innerHTML.trim()) {
                                var o, a;
                                r.innerHTML = "", "translate(0, 0)" === t ? (o = b.time_range.min, a = b.compare_time_range.min) : (o = b.time_range.max, a = b.compare_time_range.max, r.parentNode.style.display = "");
                                var i = document.createElementNS("http://www.w3.org/2000/svg", "tspan");
                                i.style.fill = b.colors[0], i.textContent = x()(o).format(b.momentTimeFormat), r.appendChild(i), r.appendChild(document.createTextNode(" vs "));
                                var s = document.createElementNS("http://www.w3.org/2000/svg", "tspan");
                                s.style.fill = b.colors[1], s.textContent = x()(a).format(b.momentTimeFormat), r.appendChild(s)
                            } else e.parentNode.removeChild(e)
                        })), e.onDataLoaded && e.onDataLoaded()), S = !1, Z(), te()
                    }
                    var le = document.createElement("div");
                    le.setAttribute("class", "c3-timeline__chart"), M.appendChild(le);

                    function de() {
                        if (null != T) {
                            var e = T + 1;
                            e < y[0].length - 1 && (re(D = y[0][e + 1], e), q && q(D))
                        }
                    }
                    var ue = function(e) {
                        switch (e.keyCode) {
                            case 39:
                                de();
                                break;
                            case 37:
                                ! function() {
                                    if (null != T) {
                                        var e = T - 1;
                                        e >= 0 && (re(D = y[0][e + 1], e), q && q(D))
                                    }
                                }()
                        }
                    };
                    return e.initialData && ie(e.initialData), document.addEventListener("keyup", ue), {
                        refresh: function() {
                            k = !0, S = !0, t.flush()
                        },
                        updateData: function(e, t) {
                            t.globalTemporalRange && (z = t.globalTemporalRange, _ = z.max - z.min), ie(e, t)
                        },
                        emptyData: function() {
                            t && t.unload()
                        },
                        destroy: function() {
                            O && Y(), document.removeEventListener("keyup", ue), V()
                        },
                        setCurrentTime: function(e) {
                            D = e
                        },
                        allowTimeComparison: function(e) {
                            A = e
                        },
                        selectNextTime: function() {
                            de()
                        }
                    }
                },
                L = function() {
                    var e = function(e) {
                        var t, n, r, o, a = {
                                x: 0,
                                y: 0
                            },
                            i = this,
                            s = function(e, t) {
                                var n;
                                if (Object.prototype.hasOwnProperty.call(i.events, e))
                                    for (n = 0; n < i.events[e].length; n += 1) i.events[e][n].call(i.el, t)
                            };
                        this.el = e, this.events = {
                            down: [],
                            up: [],
                            tap: [],
                            dbltap: [],
                            longpress: []
                        }, this.el.addEventListener("touchstart", (function(e) {
                            a = {
                                x: e.clientX,
                                y: e.clientY
                            }, r ? (clearTimeout(r), r = null, o = setTimeout((function() {
                                o = null
                            }), 200)) : t = setTimeout((function() {
                                t = null
                            }), 200), n && clearTimeout(n), n = setTimeout((function() {
                                n = null, s("longpress", {
                                    x: e.changedTouches[0].clientX,
                                    y: e.changedTouches[0].clientY
                                })
                            }), 600), s("down")
                        }), !1), this.el.addEventListener("touchend", (function(e) {
                            return t && (r = setTimeout((function() {
                                o = null, r = null, s("tap", {
                                    x: e.changedTouches[0].clientX,
                                    y: e.changedTouches[0].clientY
                                })
                            }), 200)), o && (o = null, r && (clearTimeout(r), r = null), s("dbltap", {
                                x: e.changedTouches[0].clientX,
                                y: e.changedTouches[0].clientY
                            })), n && (clearTimeout(n), n = null), s("up"), e.preventDefault(), !1
                        }), !1), e.addEventListener("touchmove", (function(e) {
                            (Math.abs(a.x - e.clientX) > 5 || Math.abs(a.y - e.clientY) > 5) && n && (clearTimeout(n), n = null)
                        }), !1)
                    };
                    e.prototype.on = function(e, t) {
                        return Object.prototype.hasOwnProperty.call(this.events, e) && this.events[e].push(t), this
                    }, e.prototype.off = function(e, t) {
                        return Object.prototype.hasOwnProperty.call(this.events, e) && this.events[e].remove(t), this
                    };
                    return {
                        bind: function(t) {
                            return new e(t)
                        },
                        isTouchEnabled: function() {
                            return "ontouchstart" in document.documentElement
                        }
                    }
                }(),
                P = n(22),
                A = n(5),
                D = n(28),
                M = n(9),
                q = function(e) {
                    var t = Object(D.b)(e),
                        n = t.GraphHistory,
                        r = Object(l.a)("#btnGraphLoading");
                    if (e.id) {
                        var o = function(r) {
                                n.load(r, e.graph_options), I(t, e)
                            },
                            a = function() {
                                console.log("request failed"), r.text("Please Reload The Page").css("color", "red"), I(t, e, !0)
                            };
                        if (e.s3_url) l.a.getJSON(e.s3_url, o, a);
                        else {
                            var i = e.download_id || window.location.pathname.replace(/\/graphs\//, "").replace(/\/embed/, "");
                            e.graph_options.download_id = i;
                            var s = [];
                            location.search ? (s.push(location.search), s.push("&")) : s.push("?"), s.push("fromgraph=true"), Object(A.getGraph)(i, s.join(""), o, a)
                        }
                    } else if (Object(u.L)("hub")) Object(A.getEmptyGraph)(window.location.search, (function(r) {
                        n.load(r, e.graph_options), I(t, e)
                    }), (function() {
                        console.log("request failed"), r.text("Please Reload The Page").css("color", "red"), I(t, e, !0)
                    }));
                    else {
                        n.load({
                            graph: {
                                nodeTypes: [],
                                edgeTypes: []
                            }
                        }, e.graph_options), I(t, e)
                    }
                };

            function I(e, t, n) {
                var r, o, a, i, s, c, d = e.dispatcher,
                    u = e.uiStore,
                    p = e.GraphHistory,
                    f = t.showCanvas,
                    h = t.showSearch;
                if (a = t.for_hub ? new P.HubDataCoordinator(e) : new P.Coordinator(e, {
                        allowSpreadsheet: t.showSpreadsheet
                    }), f && (r = t.isWebGL ? new P.WebGLCanvas("#map", e, M.a.VIEW, t.openWithSnapshot) : new P.Canvas("#map", e, M.a.VIEW, t.openWithSnapshot)), t.for_hub && (o = new P.Spreadsheet("#ssLinks", e, M.a.VIEW), (i = new P.SpreadsheetSwitcher(".spreadsheet-switcher", e, M.a.VIEW)).selectFirstType()), h && new P.SearchBox(e, M.a.VIEW), s = t.for_hub ? new P.HubBrowserView(l.a, e, r, o, t) : new P.BrowserView(l.a, e, r, o, a, t), a.setCanvas(r), a.setDataTable(o), a.setSwitcher(i), a.start(), u.get("readOnly")) d.emit("updateEditMode", M.a.VIEW);
                else {
                    var g = p.getNodes();
                    null == g || 0 == g.length || t.editOnLoad ? d.emit("updateEditMode", M.a.EDIT) : t.for_hub || d.emit("updateEditMode", M.a.VIEW)
                }
                t.openWithSnapshot ? r.showSnapshot() : t.contains_geo_nodes && r.placeFixedGeoPositions(), s.graphLoaded && s.graphLoaded(), c = new j(e), n || c.loadState()
            }
            var R = n(109),
                B = function(e) {
                    var t = '<a class="user-mention" href="' + Object(u.B)() + '/users/$1" target="_blank">@$1</a>';
                    return "\uff20" === e[0] || "@" === e[0] ? e.substring(1).replace(/([\w]+)/, t) : e
                },
                F = new(n.n(R).a.Converter);
            F.setOption("literalMidWordUnderscores", !0), F.setOption("strikethrough", !0);
            var G, H = function(e) {
                    var t = e || "";
                    return t = (t = (t = t.trim()).replace(/\n/gi, "<br/>")).split(" ").map(B).join(" "), F.makeHtml(t)
                },
                U = (G = function(e) {
                    var t = '<a class="user-mention" href="' + Object(u.B)() + '/users/$1" target="_blank">@$1</a>';
                    return "\uff20" === e[0] || "@" === e[0] ? e.match(/editors|owner|commentors/) ? e.substring(1).replace(/([\w]+)/, '<span class="user-mention clickable">@$1</span>') : e.substring(1).replace(/([\w]+)/, t) : e
                }, function(e) {
                    var t = e || "";
                    return t = function(e) {
                        return e.replace(/\[[#]([^\]]+)\]\((\w{8}-\w{4}-\w{4}-\w{4}-\w{12})\)/gi, '<a href="/nodes/$2" target="_blank"><span class="node-reference" data-id="$2">#$1</span></a>')
                    }(t = (t = (t = t.trim()).replace(/\n/gi, "<br/>")).split(" ").map(G).join(" ")), F.makeHtml(t)
                }),
                z = function(e, t, n) {
                    var r = 0,
                        o = !1,
                        a = function() {
                            o = !0, Object(u.h)(t, "not-shown"), Object(u.nb)(n, "not-shown"), Object(A.retrieveActivityFeed)(r, i, s)
                        };

                    function i(a) {
                        console.log(a);
                        var i = function() {
                                Z.a.info("Graph tag is updated")
                            },
                            s = function() {
                                Z.a.error("Failed to update the tag")
                            };
                        a.forEach((function(t) {
                            var n = document.createElement("div");
                            n.className = "row", e.appendChild(n), n.innerHTML = t.view_html, t.dom = n
                        })), a.filter((function(e) {
                            return "story_updated" !== e.action && e.graph && "story_recommended" !== e.action
                        })).forEach((function(e) {
                            var t = e.dom,
                                n = e.graph.id,
                                r = t.querySelector("select");
                            r && r.addEventListener("change", (function() {
                                if (0 === this.selectedIndex) Object(A.setGraphTag)(n, null, i, s);
                                else {
                                    var e = this.options[this.selectedIndex].text;
                                    Object(A.setGraphTag)(n, e, i, s)
                                }
                            }));
                            var o = t.querySelector('input[type="checkbox"].featured');
                            o && o.addEventListener("change", (function() {
                                var e = this.checked;
                                Object(A.featureGraph)(n, e, (function() {
                                    e ? Z.a.info("Graph is featured now") : Z.a.info("Graph is unfeatured")
                                }), (function() {
                                    Z.a.error("Please try again")
                                }))
                            }));
                            var a = t.querySelector("a.graph-recommend");
                            a && !a.getAttribute("actionAdded") && (a.setAttribute("actionAdded", !0), a.addEventListener("click", (function(e) {
                                if (e.preventDefault(), "1" == a.getAttribute("data-recommended")) {
                                    Object(A.unrecommend)(n), a.setAttribute("data-recommended", "0"), Object(u.nb)(a, "recommended");
                                    var t = a.querySelector("span.count-value"),
                                        r = Number(t.innerHTML);
                                    t.innerHTML = 1 == r ? "" : r - 1
                                } else {
                                    Object(A.recommend)(n), a.setAttribute("data-recommended", "1"), Object(u.h)(a, "recommended");
                                    var o = a.querySelector("span.count-value"),
                                        i = Number(o.innerHTML);
                                    o.innerHTML = i + 1
                                }
                                return !1
                            })))
                        })), a.filter((function(e) {
                            return "story_updated" === e.action || "story_recommended" === e.action
                        })).forEach((function(e) {
                            var t = e.dom,
                                n = e.story.id;
                            t.querySelector("a.story-recommend").addEventListener("click", (function(e) {
                                e.preventDefault();
                                var t = this.querySelector(".count-value");
                                Object(u.N)(this, "recommended") ? (Object(u.nb)(this, "recommended"), Object(A.unrecommendStory)(n, (function(e) {
                                    t.innerHTML = e.story.count > 0 ? e.story.count : ""
                                }))) : (Object(u.h)(this, "recommended"), Object(A.recommendStory)(n, (function(e) {
                                    t.innerHTML = e.story.count > 0 ? e.story.count : ""
                                })))
                            }))
                        })), a.filter((function(e) {
                            return "comment_created" === e.action
                        })).forEach((function(e) {
                            var t = e.dom;
                            Array.from(t.querySelectorAll(".comment-content")).forEach((function(e) {
                                e.innerHTML = U(e.innerHTML.trim())
                            }))
                        })), r += 1, o = !1, Object(u.nb)(t, "not-shown"), Object(u.h)(n, "not-shown"), Z.a.info("Loaded " + a.length + " results")
                    }

                    function s() {
                        Z.a.error("Failed to receive latest feed. Try again"), o = !1, Object(u.nb)(t, "not-shown"), Object(u.h)(n, "not-shown")
                    }
                    t.addEventListener("click", (function(e) {
                        if (e.preventDefault(), !o) return a(), !1
                    })), a()
                },
                W = n(7),
                Y = function(e, t, n) {
                    var r = "Upgrade to {{plan}}",
                        o = "Downgrade to {{plan}}",
                        a = "You will be upgraded to the <strong>{{plan}}</strong> plan. Your monthly bill will be <strong>{{amount}}</strong>.{{prorate_text}}<br/><br/>Plan changes are immediate.",
                        i = "You will be downgraded to the <strong>{{plan}}</strong> plan. From now on, your monthly bill will be <strong>{{amount}}</strong>. ";
                    i += "{{prorate_text}}</br><br /><span class='warning'>You will no longer be able to access some of your private data or create more than {{data_limit}} private nodes.</span><br /><br />Plan changes are immediate.";
                    var s, c, d = "<br/><br/>You will be refunded <strong>${{amount}}</strong> for this downgrade to componsate your unused time.",
                        u = function(e) {
                            var t, r;
                            if (s.indexOf("UPGRADE") >= 0) {
                                t = "\u2713 Plan upgraged to " + n + " plan", r = "Congratulations! You have upgraded your plan to <strong> " + n + "</strong>. Thank you! <br/><br/>Go ahead <strong><a href='/graphs/new?onboard=true'>create a new graph in private</a></strong>.";
                                var o = e.card && Array.isArray(e.card) && e.card.length > 0,
                                    a = -1;
                                if (e.next_invoice && (a = e.next_invoice.amount), !o && a > 0) {
                                    return r += "<br/><br/>Please note that you will have to register a credit card by {{date}} to continue to use your plan.".replace("{{date}}", e.next_invoice.date), void Object(W.confirm)(null, t, r, (function() {
                                        Object(W.showWaitMessage)(null, "Updating Settings...", "", (function() {
                                            window.location = "/me/billing#cards", window.location.reload()
                                        }))
                                    }), (function() {
                                        Object(W.showWaitMessage)(null, "Updating Settings...", "", (function() {
                                            window.location.reload()
                                        }))
                                    }), null, null, "UPDATE PAYMENT METHOD")
                                }
                            } else t = "Plan downgraded", r = "You have downgraded your plan.";
                            Object(W.displayMessage)(null, t, r, (function() {
                                Object(W.showWaitMessage)(null, "Updating Settings...", "", (function() {
                                    window.location = "/me/billing"
                                }))
                            }))
                        },
                        p = function() {
                            Object(W.showWaitMessage)(null, "Please wait...", "", (function(r) {
                                Object(A.updatePlan)(n, c, (function(e) {
                                    r(), u(e)
                                }), (function(o) {
                                    var a;
                                    r(), o.responseJSON && o.responseJSON.msg && (a = o.responseJSON.msg), "NEED_CARD" === a ? function(n, r) {
                                        Object(W.creditCardPanel)({}, e, t[n], (function(e) {
                                            e ? Object(W.showWaitMessage)(null, "Please wait...", "Processing credit card", (function(t) {
                                                Object(A.addCreditCard)(e, n, r, (function(e) {
                                                    t(), u(e)
                                                }), (function(e) {
                                                    var n;
                                                    console.log(e), e.responseJSON && e.responseJSON.msg && (n = "<br />" + e.responseJSON.msg), Object(W.displayMessage)(null, "Unable to process your payment", "Please check your card info and try again: " + n), t()
                                                }))
                                            })) : Object(W.displayMessage)(null, "ERROR", "Failed to obtain a token for the credit card")
                                        }))
                                    }(n, c) : a.toLowerCase().indexOf("card") < 0 && a.toLowerCase().indexOf("no attached payment source") < 0 ? Object(W.displayMessage)(null, "Unable change plan", "We were unable to change your plan.<br />" + a) : Object(W.displayMessage)(null, "Unable change plan", "We were unable to change your plan.<br />" + a, (function() {
                                        Object(l.a)("#cards_link").click()
                                    }), "UPDATE PAYMENT METHOD")
                                }))
                            }))
                        };
                    Object(W.showWaitMessage)(null, "Please wait...", "Calculating charges", (function(e) {
                        Object(A.calculateProration)(n, (function(l) {
                            e(), s = l.action, c = l.proration_date;
                            var u = function(e) {
                                var s = {
                                        title: "",
                                        message: "",
                                        confirm_text: ""
                                    },
                                    c = "You";
                                e.card && (c = "Your <strong>" + e.card.brand + "</strong> card ending with <strong>" + e.card.last4 + "</strong>");
                                var l = "";
                                e.discount && (l = "Your coupon " + e.discount + " will be applied.<br><br>");
                                var u = "";
                                switch (e.action) {
                                    case "UPGRADE_FROM_FREE":
                                        s.title = r.replace("{{plan}}", n), u = e.proration > 0 ? "<br/><br/>{{discount}}{{card_text}} will be charged <strong>${{amount}}</strong> for this upgrade.".replace("{{discount}}", l).replace("{{amount}}", e.proration).replace("{{card_text}}", c) : "", s.message = a.replace("{{plan}}", n).replace("{{amount}}", t[n].price).replace("{{prorate_text}}", u), s.confirm_text = "UPGRADE PLAN";
                                        break;
                                    case "UPGRADE_FROM_PAID":
                                        s.title = r.replace("{{plan}}", n), u = e.proration > 0 ? "<br/><br/>{{discount}} Deducting the unused time from your current plan, {{card_text}} will be charged <strong>${{amount}}</strong> for this upgrade.".replace("{{discount}}", l).replace("{{amount}}", e.proration).replace("{{card_text}}", c) : "<br/><br/>" + l + "You won't be charged for this upgrade.", s.message = a.replace("{{plan}}", n).replace("{{amount}}", t[n].price).replace("{{prorate_text}}", u), s.confirm_text = "UPGRADE PLAN";
                                        break;
                                    case "DOWNGRADE_TO_FREE":
                                        s.title = o.replace("{{plan}}", n), u = e.proration > 0 ? d.replace("{{amount}}", e.proration) : "", s.message = "You will be downgraded to the <strong>Free</strong> plan. {{prorate_text}}<br/></br><span class='warning'>You will no longer be able to access your private data or create any new private graphs.</span><br /><br />Plan changes are immediate.".replace("{{prorate_text}}", u), s.confirm_text = "DOWNGRADE PLAN";
                                        break;
                                    case "DOWNGRADE_TO_PAID":
                                        s.title = o.replace("{{plan}}", n), u = e.proration > 0 ? d.replace("{{amount}}", e.proration) : "", s.message = i.replace("{{plan}}", n).replace("{{amount}}", t[n].price).replace("{{data_limit}}", t[n].limit).replace("{{prorate_text}}", u), s.confirm_text = "DOWNGRADE PLAN"
                                }
                                return s
                            }(l);
                            Object(W.confirm)({}, u.title, u.message, p, null, null, null, u.confirm_text)
                        }), (function(t) {
                            e();
                            var n = "";
                            n = t.responseJSON && t.responseJSON.msg ? t.responseJSON.msg : "Please try again", Object(W.displayMessage)(null, "Error", "An error occurred.<br/>" + n)
                        }))
                    }))
                },
                V = function(e) {
                    var t = function() {
                        Object(W.creditCardPanel)(null, e, null, (function(e) {
                            e ? Object(W.showWaitMessage)(null, "Processing credit card", "Please wait...", (function(t) {
                                Object(A.addCreditCard)(e, null, null, (function() {
                                    t(), Object(W.displayMessage)(null, "Credit Card Added", "Your credit card information is updated", (function() {
                                        setTimeout((function() {
                                            n(), r()
                                        }), 100)
                                    }))
                                }), (function(e) {
                                    var n;
                                    e.responseJSON && e.responseJSON.msg && (n = "<br />" + e.responseJSON.msg), Object(W.displayMessage)(null, "Error", "Failed to add this new card: " + n), t()
                                }))
                            })) : Object(W.displayMessage)(null, "Error", "Unable to obtain a token for the credit card")
                        }))
                    };

                    function n() {
                        document.querySelector(".card-container").classList.add("not-shown"), document.querySelector(".no-cards").classList.add("not-shown"), document.getElementById("btnNewCard").removeEventListener("click", t)
                    }

                    function r() {
                        Object(W.showWaitMessage)(null, "Please wait...", "Fetching Card Info", (function(e) {
                            document.getElementById("btnNewCard").addEventListener("click", t), Object(A.retriveCards)((function(t) {
                                if (console.log(t.cards), !t.cards || t.cards.length < 1) document.querySelector(".no-cards").classList.remove("not-shown");
                                else {
                                    var n = document.querySelector(".card-container"),
                                        r = document.getElementById("cardHolder"),
                                        o = document.getElementById("cardNumber"),
                                        a = document.getElementById("cardExpiry"),
                                        i = document.getElementById("cardBrand");
                                    r.innerHTML = t.cards[0].name, o.innerHTML = "&bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; " + t.cards[0].last4, a.innerHTML = t.cards[0].exp_month + "/" + t.cards[0].exp_year, i.innerHTML = t.cards[0].brand, n.classList.remove("not-shown")
                                }
                                e()
                            }), (function() {
                                e()
                            }))
                        }))
                    }
                    return {
                        retrieveCards: r,
                        clearCards: n
                    }
                },
                X = function(e, t, n) {
                    t.addEventListener("click", (function() {
                        "" !== e.value.trim() && Object(W.showWaitMessage)(null, "Validating Coupon", "Please wait...", (function(t) {
                            Object(A.applyCoupon)(e.value, (function(r) {
                                t(), console.log(r);
                                var o = n.querySelector("div.coupon");
                                o && n.removeChild(o);
                                var a = document.createElement("div");
                                a.className = "coupon", a.innerHTML = r.coupon, n.appendChild(a), e.value = "", n.classList.remove("not-shown");
                                var i = "Congratulations!<br/>Your coupon <strong>" + r.coupon + "</strong>";
                                r.has_account ? i += " will be applied to your next invoice." : i += " will be in effect when you switch to a new plan.", Object(W.displayMessage)(null, "Coupon Added", i)
                            }), (function(e) {
                                t(), console.log(e);
                                var n = "We could not validate the coupon.<br/>" + e.responseJSON.error;
                                Object(W.displayMessage)(null, "Error Adding Coupon", n)
                            }))
                        }))
                    }))
                },
                K = {
                    "\xc7": "c",
                    "\xe7": "c",
                    "\u011e": "g",
                    "\u011f": "g",
                    "\u0130": "i",
                    "\u0131": "i",
                    "\xd6": "o",
                    "\xf6": "o",
                    "\u015e": "s",
                    "\u015f": "s",
                    "\xdc": "u",
                    "\xfc": "u"
                },
                $ = function(e) {
                    return "string" === typeof e ? e.split("").map((function(e) {
                        return Object.prototype.hasOwnProperty.call(K, e) ? K[e] : e
                    })).join("") : e
                },
                Z = n(63),
                J = function(e) {
                    var t = e.GraphHistory,
                        n = e.graphStore,
                        r = {};
                    r.graphReferences = n.get("references"), r.hasGraphReference = "string" == typeof r.graphReferences && "" !== r.graphReferences.trim(), r.nodeReferences = t.getNodes().filter((function(e) {
                        return "string" === typeof e.reference && "" !== e.reference.trim()
                    })).sort((function(e, t) {
                        var n = e.name.toLowerCase(),
                            r = t.name.toLowerCase();
                        return n < r ? -1 : n > r ? 1 : 0
                    })).map((function(e, t) {
                        return {
                            index: t + 1,
                            name: e.name,
                            reference: e.reference
                        }
                    }));
                    var o = Math.ceil(100 * r.nodeReferences.length / t.getNodes().length);
                    return r.hasNodeReference = o >= 75, r.nodeReferenceDetail = [r.nodeReferences.length, "nodes have references out of", t.getNodes().length, "nodes in total", "(" + o + "%)"].join(" "), r
                };

            function Q(e) {
                var t;
                try {
                    var n = "__storage_test__";
                    return (t = window[e]).setItem(n, n), t.removeItem(n), !0
                } catch (r) {
                    return r instanceof DOMException && (22 === r.code || 1014 === r.code || "QuotaExceededError" === r.name || "NS_ERROR_DOM_QUOTA_REACHED" === r.name) && 0 !== t.length
                }
            }
            var ee = function(e, t) {
                    Q("sessionStorage") && sessionStorage.setItem(e, t)
                },
                te = function(e) {
                    if (Q("sessionStorage")) return sessionStorage.getItem(e)
                },
                ne = function(e, t) {
                    Q("localStorage") && localStorage.setItem(e, t)
                },
                re = function(e) {
                    if (Q("localStorage")) return localStorage.getItem(e)
                },
                oe = function(e, t) {
                    var n = Object(l.a)(t);
                    return e.replaceWith(n), n
                },
                ae = function(e, t) {
                    var n = t.color || "#000",
                        r = function() {
                            var r = e.$elem.val();
                            e.$elem.on("keydown", (function(a) {
                                if (13 === a.keyCode || 9 === a.keyCode) {
                                    var i = this.value;
                                    return !!i && (e.onSubmit && e.onSubmit.call(this, i, r), t.$elem = oe(e.$elem, d.a[t.template]({
                                        value: i,
                                        color: n
                                    })), o(), !1)
                                }
                                if (27 === a.keyCode) return !r && e.onCancel ? (e.onCancel.call(this), !1) : (t.$elem = oe(e.$elem, d.a[t.template]({
                                    value: r,
                                    color: n
                                })), o(), !1)
                            })), e.$elem.on("blur", (function() {
                                r || !e.onCancel ? (t.$elem = oe(e.$elem, d.a[t.template]({
                                    value: r,
                                    color: n
                                })), o()) : e.onCancel.call(this)
                            })), e.bind && e.$elem.find(e.bind.sel).on(e.bind.ev, e.bind.fn), e.$elem.focus()
                        };

                    function o() {
                        var o = t.clickable ? t.$elem.find(t.clickable) : t.$elem;
                        o.click((function(a) {
                            return a.preventDefault(), t.onClick && t.onClick.call(this), e.$elem = oe(t.$elem, d.a[e.template]({
                                value: o.text(),
                                color: n
                            })), r(), !1
                        })), t.bind && t.$elem.find(t.bind.sel).on(t.bind.ev, t.bind.fn)
                    }
                    return e.$elem && e.$elem.length > 0 ? r() : o(), {
                        setSpanColor: function(e) {
                            n = e, (t.clickable ? t.$elem.find(t.clickable) : t.$elem).css("color", e)
                        }
                    }
                },
                ie = n(54),
                se = n(77),
                ce = n(33)
        },
        21: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return r
            }));
            var r = window.GraphCommons.Session
        },
        22: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "BrowserView", (function() {
                return S
            })), n.d(t, "Canvas", (function() {
                return Y
            })), n.d(t, "CanvasEdgeCreator", (function() {
                return B
            })), n.d(t, "CanvasNodeCreator", (function() {
                return R
            })), n.d(t, "CommentView", (function() {
                return Q
            })), n.d(t, "ConnectHelper", (function() {
                return D
            })), n.d(t, "Coordinator", (function() {
                return re
            })), n.d(t, "forceAtlas2", (function() {
                return L
            })), n.d(t, "GroupNodeSizeInterpolator", (function() {
                return F
            })), n.d(t, "GroupWeightInterpolator", (function() {
                return G
            })), n.d(t, "HubBrowserView", (function() {
                return oe
            })), n.d(t, "HubDataCoordinator", (function() {
                return ae
            })), n.d(t, "NodeSizeInterpolator", (function() {
                return P
            })), n.d(t, "OnboardingView", (function() {
                return p
            })), n.d(t, "SearchBox", (function() {
                return pe
            })), n.d(t, "Spreadsheet", (function() {
                return ee
            })), n.d(t, "SpreadsheetSwitcher", (function() {
                return te
            })), n.d(t, "WebGLCanvas", (function() {
                return ke
            })), n.d(t, "WebGLEdgeCreator", (function() {
                return xe
            })), n.d(t, "WebGLNodeCreator", (function() {
                return be
            })), n.d(t, "WeightInterpolator", (function() {
                return A
            })), n.d(t, "initSaveAsButton", (function() {
                return m
            })), n.d(t, "initSaveButton", (function() {
                return h
            })), n.d(t, "initializeLeftBar", (function() {
                return b
            })), n.d(t, "showHoverNodeCard", (function() {
                return M
            })), n.d(t, "statsComponent", (function() {
                return Pe
            })), n.d(t, "SearchBoxHelper", (function() {
                return r
            })), n.d(t, "WebGL", (function() {
                return o
            }));
            var r = {};
            n.r(r), n.d(r, "inGraphTypeAheadSearch", (function() {
                return ce
            }));
            var o = {};
            n.r(o), n.d(o, "CircleNodeProgram", (function() {
                return fe
            })), n.d(o, "CurveLinkProgram", (function() {
                return he
            })), n.d(o, "CurveRectLinkProgram", (function() {
                return ge
            })), n.d(o, "StraightLinkProgram", (function() {
                return me
            })), n.d(o, "StraightRectLinkProgram", (function() {
                return ye
            }));
            var a = n(12),
                i = n.n(a),
                s = n(3),
                c = n(2),
                l = n(7),
                d = n(5),
                u = n(9),
                p = function(e, t) {
                    var n = e.uiStore,
                        r = e.graphStore,
                        o = e.dispatcher,
                        a = e.GraphHistory,
                        i = this;
                    a.setOnboardModule(i);
                    var s = Object(c.GraphBot)(),
                        p = function() {
                            i.at_completed = !0, o.emit("updateEditMode", u.a.EDIT, i), Object(d.updateUser)(f.id, {
                                user: {
                                    need_help: !1,
                                    tour_completed: !0
                                }
                            }), Object(d.userUpdatedTour)("completed"), s.clear(), Object(l.displayMessage)(e, "Congratulations!", "You have completed the tutorial.", (function() {
                                a.clearSelectedNodes(), s.clear();
                                var t = ["You've just learned everything to get started with OntoGraph. ", "Go ahead and build beautiful graphs.", "<br><br>", "<strong><a href='/invitations/new' target='_blank'>Invite friends and collegues</a></strong> to make graphs together. ", "<br><br>", "<strong><a href='mailto:support@graphcommons.com'>Get in touch</a></strong> for your questions and comments. Thanks!"].join("");
                                Object(l.displayMessage)(e, "Congratulations!", t, (function() {
                                    o.unbindTarget(i), a.setOnboardModule(null), s.clear(), o.emit("onOnboardCompleted")
                                }), "DONE", !0), s.clear(), s.run([{
                                    target: "li.btn-link",
                                    position: "bottom-right",
                                    title: "",
                                    message: "View and update your profile page"
                                }, {
                                    target: "div.logo-canvas",
                                    position: "top",
                                    title: "",
                                    message: "Go to home page to see what others created. Click the Help icon on the left for videos and shortcuts."
                                }, {
                                    target: "button.btn-save",
                                    position: "bottom-center",
                                    title: "",
                                    message: "Remember to save your work!"
                                }])
                            }), "CONTINUE", !0)
                        },
                        f = r.get("user"),
                        h = "" === Object(c.parseUrlParam)(window.location.search, "onboard") && f.need_help;
                    Object(l.onboardWelcomePanel)(e, h, (function(e) {
                        var t = document.querySelector(".map-controller.zoom-in");
                        if (t)
                            for (var n = 0; n < 8; n += 1) t.click();
                        i.triggerAction("onboarding_started"), Object(d.updateUser)(f.id, {
                            user: {
                                tour_started: !0
                            }
                        }), Object(d.userStartedTour)((function() {
                            console.log("tour-start-success")
                        }), (function() {
                            console.log("tour-start-fail")
                        })), h && e && Object(d.updateUser)(f.id, {
                            need_help: !1
                        })
                    }), (function(e) {
                        o.unbindTarget(i), a.setOnboardModule(null), h && e && Object(d.updateUser)(f.id, {
                            need_help: !1
                        })
                    }));
                    var g = "",
                        m = "",
                        y = 1,
                        b = function(e) {
                            var t = {};
                            t.target = e.target, t.title = "Enter the relationship", t.message = 'For example, type "COLLABORATES" and hit Enter', t.position = "top", s.run(t)
                        },
                        v = function(e) {
                            var t = {};
                            t.title = e || "", t.message = "Moving on, continue to learn how to edit node details for filtering.", t.onConfirm = function() {
                                y = 2, n.get("editMode") !== u.a.VIEW ? function() {
                                    var e = {
                                        target: "button.map-controller.in-graph",
                                        position: "right",
                                        title: "Switch to View Mode",
                                        message: "Click on the Pen icon to toggle from Edit Mode to View Mode. This is how visitors will view your graph."
                                    };
                                    y = 2, s.run(e)
                                }() : w()
                            }, t.onSkip = function() {
                                p()
                            }, s.run(t)
                        },
                        _ = function() {
                            var e = {
                                position: "left",
                                title: "Connect multiple Vertexs at once",
                                message: 'First, hit Ctrl or Cmd + click on the "' + g + "\" Vertex you've just added..."
                            };
                            s.run(e)
                        };

                    function w() {
                        var e = {
                            target: void 0,
                            position: "bottom",
                            title: "View Vertex card",
                            message: "Now, click on a Vertex to view its details."
                        };
                        s.run(e)
                    }
                    this.triggerAction = function(e, n) {
                        var r, o = n || {},
                            c = a.getNodes().length;
                        switch (e) {
                            case "onboarding_started":
                                r = {
                                    target: "span.map-message",
                                    position: "top-center",
                                    title: "Add your first Vertex",
                                    message: "Click anywhere on the canvas."
                                }, s.run(r);
                                break;
                            case "add_node_dialogue_opened":
                                0 === c && function(e) {
                                    var t = {
                                        target: e.target,
                                        position: "left",
                                        title: "Enter a Vertex Order",
                                        message: "Define what this Vertex is..."
                                    };
                                    s.run(t)
                                }(o);
                                break;
                            case "nodetype_entered":
                                1 === y && (r = {
                                    target: o.target,
                                    position: "left"
                                }, c < 3 && ("Person" === o.value || o.force) && (r.title = 'Add the name of this "' + o.value + '"', r.message = "Type a name and hit Enter.", s.run(r)));
                                break;
                            case "node_name_entered":
                                1 === y && (r = {
                                    target: o.target,
                                    position: "bottom"
                                }, 0 === c && (r.message = "Great! Now hit Enter or click Add.", s.run(r)));
                                break;
                            case "node_added_to_canvas":
                                r = {
                                    target: void 0,
                                    position: "left"
                                }, 1 === y && (1 === c ? (Object(d.userUpdatedTour)("phase_1"), r.title = "Add another Vertex", r.message = "Click anywhere on canvas to add another Vertex...", s.run(r)) : 2 == c ? (r.title = "Connect the Vertexs", r.message = "Hit Ctrl or Cmd + click on a Vertex...", s.run(r)) : 3 === c && (s.clear(), setTimeout((function() {
                                    t.getForcePaused() ? _() : function() {
                                        var e = {
                                            target: ".map-controller.play-pause",
                                            title: "Hit spacebar to pause the graph",
                                            message: "Gravity forces at work here, pause the layout before your Vertexs fly away!"
                                        };
                                        s.run(e)
                                    }()
                                }), 4)));
                                break;
                            case "add_node_dialogue_opened_type_selected":
                                r = {
                                    position: "left"
                                }, 1 === y && (c < 2 ? (r.target = o.target_name, r.title = 'Enter the Object of this "' + g + '"', r.message = "Type a Object and hit Enter.", s.run(r)) : c < 3 ? (r.target = o.target_name, r.title = 'Enter the name of this "' + g + '"', r.message = "Type another Object and hit Enter.", s.run(r)) : 3 === c && (r.target = o.target_type, r.title = "Enter a new Vertex Order", r.message = 'Let\'s make it an "Organization" this time...', s.run(r)));
                                break;
                            case "connecting_src_node_clicked":
                                if (r = {
                                        target: void 0,
                                        position: "left"
                                    }, 1 === y)
                                    if (2 === c) r.title = "Complete the connection", r.message = "Now, click on another Vertex...", s.run(r);
                                    else if (3 === c) {
                                    var l = a.getLinks().length;
                                    l < 2 ? (r.title = "SHIFT + Click on another Vertex", r.message = "Hold the SHIFT key and click one of the other Vertexs...", s.run(r)) : 2 == l && (r.title = "", r.message = "Yes, click on the other Vertex...", s.run(r))
                                } else 2 === a.getNodeTypes().length && (r.title = "Complete the connection", r.message = "Now, click on another Vertex...", s.run(r));
                                break;
                            case "connecting_shift_clicked":
                                r = {
                                    target: void 0,
                                    position: "left"
                                }, 1 === y && 3 === c && (r.title = "Release SHIFT and click on the remaining...", r.message = "This will complete the series of connections.", s.run(r));
                                break;
                            case "add_edge_dialogue_opened":
                                if (r = {
                                        target: o.target,
                                        position: "bottom"
                                    }, 1 === y)
                                    if (2 === c) b(o);
                                    else if (3 === c) {
                                    var u = a.getLinks().length;
                                    0 === u ? b(o) : 1 === u ? (r.title = "Enter a new relation", r.position = "top", o.to_count > 1 ? (r.message = "You're about to connect " + o.to_count + ' Vertexs at once, type "AFFILIATED"...', s.run(r)) : (r.message = "Select an existing relation Order, and click ADD.", s.run(r))) : 2 === u && (r.title = "", r.message = "Just hit ENTER to add this relationship", r.position = "top", s.run(r))
                                }
                                break;
                            case "edge_added_to_canvas":
                                r = {
                                    target: void 0,
                                    position: "left"
                                };
                                var f = a.getLinks().length;
                                1 === y ? (1 === f && Object(d.userUpdatedTour)("phase_2"), 2 === c ? (r.title = "Add another Vertex", r.message = "Let's add a third Vertex, click on the canvas again...", s.run(r)) : 3 === c ? 3 === f ? (Object(d.userUpdatedTour)("phase_3"), v("A Triangle!")) : 2 === f && (r.title = "Add another relation", r.message = "Connect the last Vertex to the other to complete a triangle... ", s.run(r)) : f >= 3 && v()) : w();
                                break;
                            case "canvas_paused":
                                r = {
                                    target: void 0,
                                    position: "left"
                                }, 3 === a.getNodes().length && 1 === a.getLinks().length ? _() : 4 === a.getNodes().length && 2 === a.getNodeTypes().length && (r.title = 'Connect your new Vertex to a "' + g + '"', r.message = 'Click on one of the "' + g + '" Vertexs...', s.run(r));
                                break;
                            case "edge_name_entered":
                                ! function(e) {
                                    var t = {
                                            target: e.target,
                                            position: "bottom"
                                        },
                                        n = a.getEdgeTypes(),
                                        r = n.filter((function(e) {
                                            return 1 === e.directed
                                        }));
                                    n.length > 0 && r.length < 1 && (t.title = "Make it a directed relation", t.message = "Check this option to display an arrow on the connection from " + g + " to " + m + "...", s.run(t))
                                }(o);
                                break;
                            case "edge_direction_selected":
                                r = {
                                    target: o.target,
                                    position: "top"
                                }, a.getEdgeTypes().length > 0 && (r.title = "ADD this relation!", r.message = "", s.run(r));
                                break;
                            case "toggle_view_mode":
                                Object(d.userUpdatedTour)("phase_5"), 2 === y && w();
                                break;
                            case "node_card_opened":
                                2 === y && function() {
                                    s.clear();
                                    var e = {
                                        target: "div.gc-card-header button.edit-card",
                                        position: "left",
                                        title: "Edit Vertex details",
                                        message: "This is a Vertex card."
                                    };
                                    setTimeout((function() {
                                        s.run(e)
                                    }), 200)
                                }();
                                break;
                            case "node_edit_opened":
                                Object(d.userUpdatedTour)("phase_6"),
                                    function(e) {
                                        var t = {
                                            target: e.target,
                                            position: "bottom-center",
                                            title: "Add a description",
                                            message: 'Describe this "' + e.type_name + '" in one sentence.'
                                        };
                                        s.run(t)
                                    }(o);
                                break;
                            case "node_edit_description_added":
                                o.value.length > 3 && (r = {
                                    target: o.target,
                                    position: "bottom-center",
                                    title: "Add an image",
                                    message: "Copy this image address and paste in the input box (any image URL works) <pre>https://images.app.goo.gl/WwbGXgUNi94Dw3o28</pre>"
                                }, s.run(r));
                                break;
                            case "node_edit_image_added":
                                o.value.length > 3 && (r = {
                                    target: o.target,
                                    position: "top",
                                    title: "Add a property",
                                    message: "Click below to add a Vertex property... Useful for filtering Vertexs in your graph."
                                }, s.run(r));
                                break;
                            case "node_edit_property_added":
                                1 === o.prop_count ? (Object(d.userUpdatedTour)("phase_7"), r = {
                                    target: o.target,
                                    position: "bottom",
                                    title: "Add a property key",
                                    message: 'Type "City"...'
                                }, s.run(r)) : (r = {
                                    target: o.target,
                                    position: "top",
                                    title: "Add a property key",
                                    message: 'Type "Year"...'
                                }, s.run(r));
                                break;
                            case "node_edit_property_key_added":
                                1 === o.prop_count ? ("city" === o.value || "city".indexOf(o.value) < 0) && (r = {
                                    target: o.target,
                                    position: "bottom",
                                    title: "Add a property value",
                                    message: 'Type "Berlin"...'
                                }, s.run(r)) : ("year" === o.value || "year".indexOf(o.value) < 0) && (r = {
                                    target: o.target,
                                    position: "top",
                                    title: "Add a property value",
                                    message: 'Type "2011"... You can add textual or numeric values, as many as you need.'
                                }, s.run(r));
                                break;
                            case "node_edit_property_val_added":
                                1 === o.prop_count ? ("berlin" === o.value || "berlin".indexOf(o.value) < 0) && (r = {
                                    target: "button.gc-btn.gc-add-property",
                                    position: "top",
                                    title: "Add another property",
                                    message: "Click on the button again..."
                                }, s.run(r)) : ("2005" === o.value || "2005".indexOf(o.value) < 0) && (r = {
                                    target: "button.gc-btn.gc-btn-confirm",
                                    position: "top-center",
                                    title: "Save your Vertex details",
                                    message: "Click SAVE or hit Enter. These will be displayed in the Vertex card."
                                }, s.run(r));
                                break;
                            case "onboard_completed":
                                if (2 === y) {
                                    y = 3, p();
                                    break
                                }
                                i.triggerAction("cancelled");
                                break;
                            case "cancelled":
                                s.clear();
                                var h = a.getLinks().length;
                                2 === y ? w() : (r = {
                                    target: void 0,
                                    position: "bottom"
                                }, 0 === c ? (r.title = "", r.message = "Click on the canvas to add a Vertex", s.run(r)) : 1 === c ? (r.title = "Add your second Vertex", r.message = "Click on the canvas, or press key 'n' to add another \"" + g + '"', s.run(r)) : 2 === c ? 0 === h ? (r.title = "", r.message = 'Now, click on one of the "' + g + '" Vertexs', s.run(r)) : 1 === h && (r.title = "", r.message = 'Now, click on the canvas to create another "' + g + '" Vertex', s.run(r)) : 3 === c ? h < 3 ? (r.title = "", r.message = "Press Ctrl or Cmd + Click on the last Vertex you just created to connect it to the others", s.run(r)) : 3 === h && v() : c > 3 && v())
                        }
                    }, o.bind("editModeUpdated", (function(e) {
                        e === u.a.VIEW && i.triggerAction("toggle_view_mode")
                    }), this), o.bind("onNodesReleased", (function() {
                        i.triggerAction("cancelled")
                    }), this), o.bind("trigger", (function(e) {
                        switch (e.action) {
                            case "nodetype_create":
                                var t = a.getNodeTypes();
                                1 == t.length ? g = t[0].name : 2 == t.length && (m = t[1].name);
                                break;
                            case "edgetype_create":
                                e.directed && Object(d.userUpdatedTour)("phase_4")
                        }
                    }), this)
                },
                f = n(4),
                h = function(e, t) {
                    var n, r = e.dispatcher,
                        o = e.graphStore,
                        a = Object(f.a)(t.button),
                        i = !1,
                        s = t.onSave || function() {};
                    n = o.get("user").id ? "Save" : "Sign In to Save";
                    var c = function(e) {
                            i || (a.text(e || n), a.prop("disabled", !1), a.fadeIn(400), i = !0)
                        },
                        l = function(e) {
                            i && (e && a.text(e), a.fadeOut(500), a.prop("disabled", !0), i = !1)
                        },
                        d = function() {
                            a.prop("disabled", !1)
                        };
                    a.on("click", (function() {
                        s()
                    }));
                    var u = {
                        getName: function() {
                            return "default-save-button"
                        },
                        isVisible: function() {
                            return i
                        },
                        cleanUp: function() {
                            r.unbindTarget(u), a.text(""), a.hide(), i = !1
                        }
                    };
                    return r.bind("onGraphSaveStarted", (function() {
                        a.text("Saving..."), c("Saving..."), a.prop("disabled", !0)
                    }), u), r.bind("onGraphSaved", (function() {
                        l("Graph Saved")
                    }), u), r.bind("onGraphSaveFailed", (function() {
                        d(), a.text(n)
                    }), u), r.bind("clearGraph", (function() {
                        l()
                    }), u), r.bind("graphStore.isDirty.updated", (function() {
                        o.get("isDirty") ? c() : l()
                    }), u), r.bind("graphStore.isSnapshotDirty.updated", (function() {
                        c()
                    }), u), r.bind("triggerSnapshot", (function() {
                        o.get("isDirty") || o.get("isSnapshotDirty") ? c() : l()
                    }), u), r.bind("onPaymentRequired", (function() {
                        d(), a.text(n)
                    }), u), r.bind("onCanvasPauseStateChanged", (function(e) {
                        e && (o.get("isDirty") ? c() : l()), e || (o.get("isSnapshotDirty") || o.get("isDirty") ? c() : l())
                    }), u), r.bind("onGraphUserChanged", (function() {
                        n = "Save", a.text(n)
                    }), u), u
                },
                g = n(67),
                m = function(e, t) {
                    var n, r = e.dispatcher,
                        o = e.graphStore,
                        a = Object(f.a)(t.button),
                        i = !1,
                        s = t.onSave || function() {},
                        c = !!o.get("user").id;
                    n = c ? "Save" : "Sign In to Save", a.text(n), a.prop("disabled", !1);
                    var l = function() {
                            a.prop("disabled", !0)
                        },
                        d = function() {
                            a.prop("disabled", !1)
                        };
                    return a.on("click", (function() {
                        s()
                    })), r.bind("onGraphSaveStarted", (function() {
                        var e;
                        e = "Saving...", i || (a.text(e || n), a.prop("disabled", !1), a.fadeIn(400), i = !0), l()
                    })), r.bind("graphStore.isDirty.updated", (function() {
                        d(), a.show()
                    })), r.bind("graphStore.isSnapshotDirty.updated", (function() {
                        d(), a.show()
                    })), r.bind("onGraphSaveFailed", (function() {
                        d(), a.text(n)
                    })), r.bind("onPaymentRequired", (function() {
                        d(), a.text(n)
                    })), r.bind("clearGraph", (function() {
                        a.hide(), l()
                    })), r.bind("onGraphUserChanged", (function() {
                        n = "Save", a.text(n)
                    })), {
                        isVisible: function() {
                            return i
                        }
                    }
                },
                y = n(0),
                b = function(e, t) {
                    for (var n = e.uiStore, r = e.graphStore, o = e.dispatcher, a = e.GraphHistory, i = {
                            cartography: !1
                        }, c = t.parent, d = t.viewCoordinator; c.firstChild;) c.removeChild(c.firstChild);
                    var p, f = !!r.get("id"),
                        h = !!r.get("user").id,
                        g = n.get("isOnlyExploreAllowed");
                    p = g ? {
                        show_explore: !0,
                        show_remove: !0,
                        show_reset: !0,
                        show_onboard: !0
                    } : {
                        show_create: !0,
                        show_undo: !0,
                        show_explore: r.get("belongsToHub"),
                        show_delete: !0,
                        show_reset: !r.get("id"),
                        show_datatable: !0,
                        show_import: h,
                        show_carto: f,
                        show_onboard: !0
                    };
                    var m = s.a["graphs/left_bar"](p);
                    c.appendChild(m.trim().toDOM());
                    var b = function() {
                            t.onCartographyHide(), i.cartography = !1, N("edit")
                        },
                        v = c.querySelector("button.map-controller.edit"),
                        _ = c.querySelector("button.map-controller.explore"),
                        w = c.querySelector("button.map-controller.erase"),
                        O = c.querySelector("button.map-controller.remove"),
                        E = c.querySelector("button.map-controller.reset"),
                        j = c.querySelector("button.map-controller.datatable"),
                        S = c.querySelector("button.map-controller.graph-import"),
                        x = c.querySelector("button.map-controller.graph-cartography"),
                        k = c.querySelector("button.map-controller.undo"),
                        C = {};

                    function N(e) {
                        Object.keys(C).forEach((function(t) {
                            t === e ? Object(y.h)(C[t], "reversed") : Object(y.nb)(C[t], "reversed")
                        }))
                    }
                    return v && (C.edit = v), _ && (C.explore = _), w && (C.erase = w), O && (C.remove = O), E && (C.clear = E), j && (C.datatable = j), S && (C.import = S), x && (C.cartography = x), k && (C.undo = k), v && v.addEventListener("click", (function() {
                        d && "min" !== d.getDatatableSize() && d.toggleDatatable("min"), n.get("editMode") !== u.a.EDIT ? o.emit("updateEditMode", u.a.EDIT) : n.get("editMode") === u.a.EDIT && o.emit("updateEditMode", u.a.VIEW)
                    })), _ && _.addEventListener("click", (function() {
                        switch (d && "min" !== d.getDatatableSize() && d.toggleDatatable("min"), n.get("editMode")) {
                            case u.a.EXPLORE:
                                g ? o.emit("updateEditMode", u.a.VIEW) : o.emit("updateEditMode", u.a.EDIT);
                                break;
                            default:
                                o.emit("updateEditMode", u.a.EXPLORE), o.emit("onExplorePanelOpened")
                        }
                    })), w && w.addEventListener("click", (function() {
                        switch (d && "min" !== d.getDatatableSize() && d.toggleDatatable("min"), n.get("editMode")) {
                            case u.a.DELETE:
                                g ? o.emit("updateEditMode", u.a.EXPLORE) : o.emit("updateEditMode", u.a.EDIT);
                                break;
                            default:
                                o.emit("updateEditMode", u.a.DELETE)
                        }
                    })), j && j.addEventListener("click", (function() {
                        n.get("editMode") !== u.a.EDIT && o.emit("updateEditMode", u.a.EDIT), d && "min" !== d.getDatatableSize() && N("datatable"), d && d.toggleDatatable()
                    })), E && E.addEventListener("click", (function() {
                        if (r.get("isDirty")) {
                            var t = "";
                            t = !r.get("id") ? "All Vertexs and Vectors will be cleared from the graph." : "Your changes since the last save will be removed.", Object(l.confirm)(e, "Remove Changes?", t, (function() {
                                a.undoHistorySinceLastSave()
                            }))
                        }
                    })), S && t.onImportClicked && S.addEventListener("click", t.onImportClicked), x && x.addEventListener("click", (function() {
                        i.cartography ? (b(), i.cartography = !1) : (t.onCartographyShow(), i.cartography = !0)
                    })), k && k.addEventListener("click", (function() {
                        a.undo()
                    })), {
                        hide: function() {
                            Object(y.h)(c, "not-shown"), i.cartography && b()
                        },
                        show: function(e) {
                            e || (e = "edit"), "carto" !== e && (i.cartography = !1), N(e), Object(y.nb)(c, "not-shown")
                        },
                        isVisible: function() {
                            return !Object(y.N)(c, "not-shown")
                        },
                        getButton: function(e) {
                            return C[e]
                        },
                        disable: function(e, t) {
                            var n = C[e];
                            n && (t ? Object(y.h)(n, "not-shown") : Object(y.nb)(n, "not-shown"))
                        }
                    }
                },
                v = n(55),
                _ = n(45),
                w = n(78);

            function O(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function E(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? O(Object(n), !0).forEach((function(t) {
                        j(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : O(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function j(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var S = function(e, t, r, o, a, f, y, O, j) {
                    var S = t.uiStore,
                        x = t.graphStore,
                        k = t.dispatcher,
                        C = t.GraphHistory,
                        N = this;
                    f = f || {};
                    var T, L = {
                            is_user_in: !!x.get("user").id,
                            is_graph_created: !!x.get("id"),
                            is_read_only: S.get("readOnly"),
                            allow_explore: x.get("belongsToHub") && !x.get("isEmbed"),
                            allow_explore_only: S.get("isOnlyExploreAllowed"),
                            default_auto_save: !0
                        },
                        P = !1,
                        A = !1,
                        D = L.is_graph_created && !x.get("isEmbed"),
                        M = a,
                        q = x.get("user"),
                        I = function() {
                            var e = {
                                graph: {
                                    id: x.get("id")
                                }
                            };
                            r.getForcePaused() && x.get("isSnapshotDirty") && "min" === M.getDatatableSize() && (e.graph.positions = r.takeSnapshot(), e.graph.layout = {}, e.graph.layout.zoom = r.getCurrentZoom(), x.update("layout", (function(e) {
                                return E(E({}, e), {}, {
                                    transform: r.getTransform()
                                })
                            })), x.get("layout").old_snapshot = !1, x.get("layout").zoom = r.getCurrentZoom()), C.saveGraph(e), y && y(r, e)
                        },
                        R = function(e) {
                            var n;
                            n = e ? "You need to save this graph to view " + e + " panel" : "You need to save your graph to continue", V = L.allow_explore_only ? Object(l.showSaveExplorePanel)(t, (function(t, n) {
                                ! function(e, t, n) {
                                    var o = {
                                        hub: {
                                            layout: Object(c.BuildLayoutSettings)(x.get("layout").algorithm, r.getGraphEngine().layout),
                                            status: t
                                        }
                                    };
                                    e && (o.hub.name = e), o.hub.positions = r.takeSnapshot(), o.hub.layout.zoom = r.getCurrentZoom(), x.update("layout", (function(e) {
                                        return E(E({}, e), {}, {
                                            transform: r.getTransform()
                                        })
                                    })), C.saveNewCommunityGraph(o, n)
                                }(t, n, e)
                            }), null) : Object(l.newGraphSaveDialog)(t, n, (function(t, n) {
                                ! function(e, t, n) {
                                    var o = {
                                        graph: {
                                            layout: Object(c.BuildLayoutSettings)(x.get("layout").algorithm, r.getGraphEngine().layout),
                                            status: t
                                        }
                                    };
                                    e && (o.graph.name = e), x.get("belongsToHub") && (o.graph.hub = x.get("hub").id), o.graph.positions = r.takeSnapshot(), o.graph.layout.zoom = r.getCurrentZoom(), o.graph.layout.fix_node_overlaps_on_pause = x.get("layout").fix_node_overlaps_on_pause, x.update("layout", (function(e) {
                                        return E(E({}, e), {}, {
                                            transform: r.getTransform()
                                        })
                                    })), C.saveNewGraph(o, n)
                                }(t, n, e)
                            }), null)
                        },
                        B = function() {};
                    B = L.is_user_in ? L.is_graph_created ? I : R : function() {
                        var e = {
                            onSignUp: function() {
                                R()
                            },
                            onSignedIn: function() {
                                R()
                            },
                            hub: x.get("belongsToHub") ? x.get("hub").id : null
                        };
                        Object(c.showAuthentication)(t, e)
                    };
                    var F, G, H, U = function() {
                            F = h(t, {
                                button: "#btnSave",
                                onSave: B
                            })
                        },
                        z = function() {
                            G = new g.AutoSaver(t, {
                                handleSave: I,
                                handleCheckSignalsNeedSaving: function() {
                                    return S.get("hasUnsavedBatches")
                                },
                                handleCheckPositionsNeedSaving: function() {
                                    return S.get("editMode") === u.a.EDIT && x.get("isSnapshotDirty")
                                }
                            }), H = new g.AutoSaverDisplay(t, {
                                el: ".graph-autosave-notify"
                            })
                        },
                        W = function(e) {
                            L.is_read_only || (e ? (G && (k.unbindTarget(G), G.cleanUp(), G = null), H && (k.unbindTarget(H), H.cleanUp(), H = null), U()) : (F && (F.cleanUp(), F = null), z()), (S.get("hasUnsavedBatches") || x.get("isSnapshotDirty")) && Object(l.showWaitMessage)(t, "Please wait", "Saving latest changes", (function(e) {
                                B(), e()
                            })))
                        };
                    L.is_read_only && !q.can_edit || L.is_graph_created || (A = !0, m(t, {
                        button: "#btnSave",
                        onSave: function() {
                            if (L.is_user_in) R();
                            else {
                                var e = {
                                    onSignUp: function() {
                                        R()
                                    },
                                    onSignedIn: function() {
                                        R()
                                    },
                                    hub: x.get("belongsToHub") ? x.get("hub").id : null
                                };
                                Object(c.showAuthentication)(t, e)
                            }
                        }
                    }));
                    var Y, V, X = function() {
                            r.fixNodeOverlaps(), L.is_read_only || C.triggerSnapshot(!0)
                        },
                        K = document.querySelector(".map-controller.play-pause"),
                        $ = document.querySelector(".map-controller.play-pause img.play"),
                        Z = document.querySelector(".map-controller.play-pause img.pause"),
                        J = e("span.map-message"),
                        Q = document.querySelector("button.map-controller.in-graph"),
                        ee = e(".map-controller.filter"),
                        te = e(".graph-recommend"),
                        ne = e(".graph-analyze"),
                        re = e(".graph-info"),
                        oe = function() {
                            "group" !== M.getTypeInBar() ? (M.clearBar(), ke(), M.requestBar("group")) : M.clearBar()
                        },
                        ae = function() {
                            Object(c.removeClass)($, "move-up"), Object(c.removeClass)(Z, "move-up")
                        },
                        ie = function() {
                            Object(c.addClass)($, "move-up"), Object(c.addClass)(Z, "move-up")
                        },
                        se = function() {
                            return Object(c.hasClass)($, "move-up")
                        },
                        ce = function() {
                            S.get("editMode") !== u.a.EDIT && k.emit("updateEditMode", u.a.EDIT), Y.show("import"), Object(l.showImportPanel)(t, (function() {
                                Y.show("edit")
                            }))
                        },
                        le = function() {
                            if (x.get("isDirty") && S.get("historySinceLastSave", !0).find((function(e) {
                                    return "nodetype_create" === e.action || "edgetype_create"
                                }))) {
                                return void Object(l.displayMessage)(t, "Unsaved Changes", "Please save your graph before opening the Cartography panel")
                            }
                            S.get("editMode") !== u.a.EDIT && k.emit("updateEditMode", u.a.EDIT), Y.show("cartography"), window.SHOW_CARTOGRAPHY_PANEL = function() {
                                Object(l.showCartographyPanel)(t, null, (function() {
                                    Y.show("edit")
                                }))
                            }, O()
                        },
                        de = function() {
                            S.get("freezeMode") && M && (M.clearBar(), k.emit("updateFreezeMode"));
                            var e = S.get("editMode");
                            e != u.a.EDIT && e !== u.a.EXPLORE ? L.allow_explore_only ? (e = u.a.EXPLORE, k.emit("onExplorePanelOpened")) : e = u.a.EDIT : e = u.a.VIEW, k.emit("updateEditMode", e)
                        };
                    S.get("readOnly") || (Q.addEventListener("click", de), Y = b(t, {
                        parent: document.querySelector("div.left-bar"),
                        viewCoordinator: M,
                        onImportClicked: function() {
                            ce()
                        },
                        onCartographyShow: function() {
                            le()
                        },
                        onCartographyHide: function() {
                            j(), Y.show("edit")
                        }
                    }));
                    var ue, pe, fe, he, ge = function() {
                        if (C.getNodes().length < 1 ? (Object(c.addClass)(K, "hidden"), J.removeClass("not-shown"), ne.hide()) : (Object(c.removeClass)(K, "hidden"), J.addClass("not-shown"), ne.show()), !L.is_read_only) {
                            var e = Y.getButton("layout");
                            C.getLinks().length < 1 ? Object(c.addClass)(e, "not-shown") : Object(c.removeClass)(e, "not-shown")
                        }
                        var t = S.get("historySinceLastSave").length;
                        t > 0 && (Y && Y.disable("undo", !1), !C.isOnboardEnabled() && P && (S.get("editMode") === u.a.VIEW ? setTimeout((function() {
                            return Object(c.HelpDisplay)({
                                target: "button.map-controller.edit.in-graph",
                                position: "right",
                                title: "Auto Save",
                                message: "Your changes are saved automatically.\nSwitch to edit mode and click undo or press Ctrl or Cmd + Z to revert changes."
                            })
                        }), 0) : setTimeout((function() {
                            return Object(c.HelpDisplay)({
                                target: "div.left-bar button.undo",
                                position: "right",
                                title: "Auto Save",
                                message: "Your changes are saved automatically.\nClick undo or press Ctrl or Cmd + Z to revert changes."
                            })
                        }), 0), P = !1)), !C.isOnboardEnabled() && A && t > 3 && (setTimeout((function() {
                            return Object(c.HelpDisplay)({
                                target: "button.btn-save",
                                position: "bottom-center",
                                title: "Save your work",
                                message: "Save your graph to keep your changes."
                            })
                        }), 0), A = !1)
                    };
                    e(".map-controller.toggle-spreadsheet").click((function() {
                        M && M.toggleDatatable("max")
                    })), L.is_graph_created && (pe = e(".graph-toggle-comments"), fe = document.getElementById("comment-count"), he = document.getElementById("mobile-comment-count"), ue = function(e) {
                        "comments" === M.getTypeInBar() ? M.clearBar() : M.requestBar("comments", {
                            id: e
                        })
                    }, pe.click((function(e) {
                        return e.preventDefault(), ue(), pe.blur(), !1
                    }))), e(".tipped-avatar").each((function(e, t) {
                        i.a.create(t, {
                            position: "bottom",
                            hideOnClickOutside: !0
                        })
                    }));
                    var me = document.querySelector("a.share");
                    me && me.addEventListener("click", (function(e) {
                        return e.preventDefault(), "share" === M.getTypeInBar() ? M.clearBar() : M.requestBar("share"), !1
                    }));
                    var ye, be, ve, _e, we = document.querySelector("a.stories");
                    if (we) {
                        var Oe = function(e) {
                            e.start_with_help = x.get("user").need_story_help, x.get("belongsToHub") && (e.belongs_to_hub = !0, e.hub = {
                                id: x.get("hub").id,
                                name: x.get("hub").name
                            }), Object(v.StoryView)(t, e), x.get("user").need_story_help && (Object(d.updateUser)(x.get("user").id, {
                                need_story_help: !1
                            }), x.get("user").need_story_help = !1)
                        };
                        ye = function(e, t, n) {
                            Oe({
                                storyId: e,
                                selectedSlide: t,
                                onClose: function() {
                                    n ? ve(e) : _e()
                                }
                            })
                        }, be = function() {
                            if ("webgl-canvas" != r.getName()) {
                                var e = {
                                    svg_data: r.getSVGData(!0),
                                    transform: r.getTransform(),
                                    onClose: function() {
                                        _e({})
                                    }
                                };
                                Oe(e)
                            } else {
                                var t = Object(c.getURLParamsHash)(Object(c.getURLParams)());
                                t.webgl = "false", t.show = "stories", Promise.resolve().then(n.bind(null, 55)), t.auto = "true";
                                var o = "/graphs/" + x.get("id") + Object(c.buildUrlParams)(t);
                                Object(c.redirectTo)(o)
                            }
                        }, ve = function(e) {
                            Object(v.ReadOnlyStoryView)(t, {
                                storyId: e,
                                onRequestEdit: function(e, t) {
                                    ye(e, t, !0)
                                },
                                onClose: function() {
                                    _e()
                                },
                                onRelatedStoryRequested: function(e, t) {
                                    t.graph.id === x.get("id") ? ve(e) : Object(c.redirectTo)("/stories/" + e)
                                },
                                parent: document.body,
                                updateUrl: !0
                            })
                        }, _e = function(e) {
                            "stories" === M.getTypeInBar() ? M.clearBar() : (k.emit("updateEditMode", u.a.VIEW), M.requestBar("stories", {
                                skipNewOnEmpty: e
                            }))
                        }, we.addEventListener("click", (function(e) {
                            return e.preventDefault(), _e(), !1
                        }))
                    }
                    e("#reset-zoom-options a").on("click", (function(t) {
                        e(".tpd-tooltip").css("display", "none"), t.preventDefault()
                    }));
                    var Ee = function() {
                        e(K).is(":visible") && !x.get("isEmbed") || r.showSnapshot(), r.scaleToShowEntireGraph(a.getTypeInBar())
                    };
                    e("#show-entire-graph").click((function(e) {
                        return Ee(), this.blur(), e.preventDefault(), !1
                    }));
                    var je = function() {
                        var e = C.getSelectedNodes(),
                            t = window.location.origin + "/graphs/" + x.get("id");
                        return e && e.length > 0 && (t = t + "/selection/" + e.join()), t
                    };
                    e(".tw-share").click((function() {
                        var e = je();
                        return this.href = "https://twitter.com/share?url=" + e + "&text=" + x.get("title") + "&via=graphcommons", Object(c.openPopupWindow)(this.href), !1
                    })), e(".email-share").click((function() {
                        var e = je();
                        return this.href = "mailto:?Subject=" + x.get("title") + " - OntoGraph&body=" + x.get("title") + " " + e, Object(c.openPopupWindow)(this.href), !1
                    })), e(".fb-share").click((function() {
                        var e = je();
                        return this.href = "https://www.facebook.com/sharer.php?u=" + e, Object(c.openPopupWindow)(this.href), !1
                    })), e(".link-share").click((function() {
                        return Object(l.shareableLink)(t), !1
                    })), e(".map-controller.show-shortcuts").click((function(e) {
                        return Object(l.helpPanel)(t, {
                            focus: "shortcuts"
                        }), e.preventDefault(), !1
                    })), e(".map-controller.zoom-in").click((function() {
                        r.zoomIn()
                    })), e(".map-controller.zoom-out").click((function() {
                        r.zoomOut()
                    }));
                    var Se;
                    if (x.get("isEmbed") || function() {
                            i.a.create(K, {
                                position: "left",
                                hideOnClickOutside: !0
                            }), e(".loFullNodeName").click((function() {
                                L.is_graph_created && !L.is_read_only && Object(d.updateGraph)(x.get("id"), {
                                    graph: {
                                        layout_node_fullname: !this.checked
                                    },
                                    id: x.get("id")
                                }), x.set("layoutNodeFullname", !this.checked);
                                var e = i.a.get(K);
                                e && e.items().length > 0 && (e.items()[0].content.querySelector(".loFullNodeName").checked = this.checked)
                            })), e(".loHideSmallText").click((function() {
                                x.get("layout").hide_small_node_labels = this.checked, r.hideSmallText(this.checked);
                                var e = i.a.get(K);
                                e && e.items().length > 0 && (e.items()[0].content.querySelector(".loHideSmallText").checked = this.checked), L.is_graph_created && !L.is_read_only && Object(d.updateGraph)(x.get("id"), {
                                    graph: {
                                        layout_hide_small_node_labels: this.checked
                                    },
                                    id: x.get("id")
                                })
                            })), e(".loAlwaysShowEdgeNames").click((function() {
                                L.is_graph_created && !L.is_read_only && Object(d.updateGraph)(x.get("id"), {
                                    graph: {
                                        layout_always_show_edge_names: this.checked
                                    },
                                    id: x.get("id")
                                }), x.get("layout").always_show_edge_names = this.checked, r.getGraphEngine().renderer.rerender();
                                var e = i.a.get(K);
                                e && e.items().length > 0 && (e.items()[0].content.querySelector(".loAlwaysShowEdgeNames").checked = this.checked)
                            }));
                            var n = function(e) {
                                    var t = i.a.get(K);
                                    t && t.items().length > 0 && (t.items()[0].content.querySelector(".adjust-scale").value = e)
                                },
                                o = function() {
                                    if ("group" !== S.get("freezeMode") && L.is_graph_created && !L.is_read_only) {
                                        var e = {
                                            layout: Object(c.BuildLayoutSettings)(x.get("layout").algorithm, r.getGraphEngine().layout)
                                        };
                                        Object(d.saveGraphLayout)(x.get("id"), e)
                                    }
                                },
                                a = null,
                                s = function() {
                                    o(), a = null
                                },
                                u = null;
                            e(".adjust-scale").bind("keyup input change", (function() {
                                var e = this.value;
                                a && clearTimeout(a), a = setTimeout(s, 2e3), u && clearTimeout(u), u = setTimeout((function() {
                                    ! function(e) {
                                        var t = r.getGraphEngine();
                                        "force_directed" === x.get("layout").algorithm ? t.layout.simulator.springLength(parseFloat(e)) : t.layout.updateSettings({
                                            scalingRatio: parseFloat(e)
                                        }), r.getForcePaused() && r.resumeFor(500), u = null
                                    }(e)
                                }), 250)
                            })), e(".switch-layout-algorithm").click((function(e) {
                                var t;
                                if (L.is_graph_created && x.get("user").is_admin && (t = "force_directed" === x.get("layout").algorithm ? "force_atlas2" : "force_directed", Object(d.saveGraph)(x.get("id"), {
                                        graph: {
                                            id: x.get("id"),
                                            history: [],
                                            layout: {
                                                algorithm: t
                                            }
                                        }
                                    })), L.is_graph_created) {
                                    var n = "force_directed" === x.get("layout").algorithm ? "fa2" : "fd",
                                        r = ["/graphs/", x.get("id"), "?auto=true&layout=", n];
                                    x.get("isWebGL") && r.push("&webgl=true"), Object(c.redirectTo)(r.join(""))
                                }
                                return e.preventDefault(), !1
                            }));
                            var p = function(e) {
                                    Object(l.showWaitMessage)(t, "Calculating Layout", "Please wait", (function(n) {
                                        var o = Object(c.getScreenDimensions)(),
                                            a = {
                                                data: {
                                                    graph: {
                                                        nodes: C.getNodes().filter((function(t) {
                                                            return t.type === e.pivot_type || t.type === e.surround_type
                                                        })).map((function(t) {
                                                            return {
                                                                id: t.id,
                                                                name: t.name,
                                                                type: t.type,
                                                                group: t.type === e.surround_type && t.properties && t.properties[e.group_surround_type] ? t.properties[e.group_surround_type] : null
                                                            }
                                                        })),
                                                        edges: C.getLinks().filter((function(t) {
                                                            if (t.name !== e.support_relation && t.name !== e.oppose_relation) return !1;
                                                            var n = C.getNodeById(t.from).type,
                                                                r = C.getNodeById(t.to).type;
                                                            return n === e.pivot_type && r === e.surround_type || r === e.pivot_type && n === e.surround_type
                                                        })).map((function(e) {
                                                            return {
                                                                id: e.id,
                                                                name: e.name,
                                                                from: e.from,
                                                                to: e.to
                                                            }
                                                        }))
                                                    }
                                                },
                                                width: o.x,
                                                height: o.y - 120,
                                                pivot_type: e.pivot_type,
                                                surround_type: e.surround_type,
                                                group_surround_type: e.group_surround_type,
                                                support_relation: e.support_relation,
                                                oppose_relation: e.oppose_relation,
                                                pivot_order: e.pivot_order,
                                                double_arc: e.double_arc,
                                                save: e.save
                                            };
                                        0 != a.data.graph.edges.length ? Object(d.calculateCircularLayout)(x.get("id"), a, (function(t) {
                                            t.success && t.positions && (Object.keys(t.positions).forEach((function(e) {
                                                var n = t.positions[e];
                                                n.pos_y = n.pos_y + 80
                                            })), r.updateSnapshot(t.positions, r.getCurrentZoom()), r.lockNodes(Object.keys(t.positions)), x.set("isSnapshotDirty", !0), x.set("circularLayoutSettings", {
                                                pivot_type: e.pivot_type,
                                                surround_type: e.surround_type,
                                                group_surround_type: e.group_surround_type,
                                                support_relation: e.support_relation,
                                                oppose_relation: e.oppose_relation,
                                                pivot_order: e.pivot_order,
                                                double_arc: e.double_arc
                                            })), n()
                                        }), (function(e) {
                                            console.log(e), n()
                                        })) : (n(), Object(l.displayMessage)(t, "No Vectors", "There are no support and oppose relations between specified types"))
                                    }))
                                },
                                f = function() {
                                    Object(l.circularLayoutSettingsPanel)(t, {}, (function(e) {
                                        p(e)
                                    }))
                                };
                            e(".trigger-circular-layout").click((function(e) {
                                var t;
                                return (t = x.get("circularLayoutSettings")) && t.pivot_type && t.surround_type && t.group_surround_type && t.support_relation && t.oppose_relation ? p(x.get("circularLayoutSettings")) : f(), e.preventDefault(), !1
                            })), e(".circular-layout-settings").click((function(e) {
                                return f(), e.preventDefault(), !1
                            })), e(".layout-advanced").click((function(e) {
                                if (r) {
                                    var a = x.get("layout").algorithm,
                                        i = r.getGraphEngine(),
                                        s = i.layout,
                                        c = i.renderer,
                                        d = function(e) {
                                            "force_atlas2" === x.get("layout").algorithm ? n(e.scalingRatio) : n(e.springLength), o()
                                        };
                                    switch (a) {
                                        case "force_atlas2":
                                            Object(l.forceAtlas2Settings)(t, s.getSettings(), (function(e) {
                                                s.updateSettings(e), c.resume(), d && d.call(null, e)
                                            }));
                                            break;
                                        case "force_directed":
                                        default:
                                            var u = {
                                                springLength: s.simulator.springLength(),
                                                springCoeff: s.simulator.springCoeff(),
                                                gravity: s.simulator.gravity(),
                                                theta: s.simulator.theta(),
                                                dragCoeff: s.simulator.dragCoeff(),
                                                timeStep: s.simulator.timeStep(),
                                                stableThreshold: s.simulator.stableThreshold()
                                            };
                                            Object(l.forceDirectedSettings)(t, u, (function(e) {
                                                var t = s.simulator;
                                                t.springLength(e.springLength), t.springCoeff(e.springCoeff), t.gravity(e.gravity), t.theta(e.theta), t.dragCoeff(e.dragCoeff), t.timeStep(e.timeStep), t.stableThreshold(e.stableThreshold), c.resume(), d && d.call(null, e)
                                            }))
                                    }
                                }
                                return e.preventDefault(), !1
                            })), e("a.show-snapshot").click((function(e) {
                                return Object(c.hideTipped)(), r.showSnapshot(), e.preventDefault(), !1
                            })), e("input.open-with-snapshot").click((function() {
                                if (L.is_graph_created) {
                                    var e = {
                                        snapshot: this.checked
                                    };
                                    Object(d.updateGraph)(x.get("id"), {
                                        graph: e,
                                        id: x.get("id")
                                    })
                                }
                            })), e("a.fix-node-overlaps").click((function(e) {
                                return Object(c.hideTipped)(), X(), e.preventDefault(), !1
                            })), e("input.loFixNodeOverlapOnPause").change((function() {
                                x.get("layout").fix_node_overlaps_on_pause = this.checked ? 1 : 2, L.is_graph_created && !L.is_read_only && Object(d.updateGraph)(x.get("id"), {
                                    graph: {
                                        layout_fix_node_overlaps_on_pause: x.get("layout").fix_node_overlaps_on_pause
                                    },
                                    id: x.get("id")
                                })
                            })), r && r.onScaleChanged(n), e("a.zoomout-fixed-nodes").click((function(e) {
                                return r.zoomOutFixedNodes(), e.preventDefault(), !1
                            })), e("a.zoomin-fixed-nodes").click((function(e) {
                                return r.zoomInFixedNodes(), e.preventDefault(), !1
                            })), e("a.switch-renderer").click((function() {
                                var e = Object(c.getURLParams)(),
                                    t = Object(c.getURLParamsHash)(e),
                                    n = this.getAttribute("data-switch-to");
                                return "webgl" === n ? (t.webgl = !0, t.svg = null) : (t.webgl = null, t.svg = !0), t.auto = !0, L.is_graph_created && !L.is_read_only && x.get("user").is_admin && Object(d.updateGraph)(x.get("id"), {
                                    graph: {
                                        layout_renderer: n
                                    },
                                    id: x.get("id")
                                }), this.href = window.location.pathname + Object(c.buildUrlParams)(t), !0
                            })), e(".disable-autosave").removeAttr("checked").change((function() {
                                W(this.checked)
                            }));
                            var h = 100,
                                g = x.get("layout");
                            "force_atlas2" === g.algorithm ? h = g.scalingRatio : "force_directed" === g.algorithm && (h = g.springLength), n(h)
                        }(), D) {
                        var xe = function() {
                            if (0 !== te.length) {
                                var e, t = parseInt(x.get("recommendedCount")),
                                    n = "",
                                    r = te.find("img.reccomend"),
                                    o = te.find("img.reccomended");
                                switch (x.get("isUserRecommended") ? (r.addClass("not-shown"), o.removeClass("not-shown")) : (o.addClass("not-shown"), r.removeClass("not-shown")), t > 0 && (n = t), te.find("span#recommend-count").text(n), t) {
                                    case 0:
                                        e = "Be the first to recommend this graph!";
                                        break;
                                    case 1:
                                        e = "One person recommends this graph";
                                        break;
                                    default:
                                        e = "Recommended by " + t + " people"
                                }
                                try {
                                    i.a.get("span#recommenders").items()[0].content.innerHTML = e
                                } catch (a) {
                                    console.log("error setting recommended user count")
                                }
                            }
                        };
                        if (L.is_user_in) {
                            te.click((function(t) {
                                return t.preventDefault(), x.get("isUserRecommended") ? (e(".tpd-tooltip").css("display", "none"), x.set("isUserRecommended", !1), x.update("recommendedCount", (function(e) {
                                    return e - 1
                                })), xe(), Object(d.unrecommend)(x.get("id"), (function(e) {
                                    var t = parseInt(e.val);
                                    t !== x.get("recommendedCount") && (x.set("recommendedCount", t), xe())
                                }), (function(e) {
                                    console.log(e)
                                }))) : (e(".tpd-tooltip").css("display", "none"), x.set("isUserRecommended", !0), x.update("recommendedCount", (function(e) {
                                    return e + 1
                                })), xe(), Object(d.recommend)(x.get("id"), (function(e) {
                                    var t = parseInt(e.val);
                                    t !== x.get("recommendedCount") && (x.set("recommendedCount", t), xe())
                                }), (function(e) {
                                    console.log(e)
                                }))), !1
                            }))
                        } else te.click((function(e) {
                            return e.preventDefault(), Object(c.showAuthentication)(t), !1
                        }));
                        i.a.create("span#recommenders", {
                            hideOnClickOutside: !0
                        }), xe(), e(".recommend-tipped").click((function(n) {
                            return n.preventDefault(), e(".tpd-tooltip").css("display", "none"), x.get("recommendedCount") > 0 && Object(l.recommendDialog)(t), !1
                        }))
                    }

                    function ke() {
                        C.setCanvasAnimation(!1)
                    }
                    q.id || (Se = document.querySelector(".btnSignIn")) && Se.addEventListener("click", (function(e) {
                        var n = {
                            onSignUp: function() {
                                x.get("isDirty") || window.location.reload()
                            },
                            onSignedIn: function() {
                                x.get("isDirty") || window.location.reload()
                            },
                            hub: x.get("belongsToHub") ? x.get("hub").id : null
                        };
                        return Object(c.showAuthentication)(t, n), e.preventDefault(), !1
                    }));
                    var Ce = function() {
                        se() ? (C.setCanvasAnimation(!1), x.get("layout").fix_node_overlaps_on_pause < 2 && (X(), 0 == x.get("layout").fix_node_overlaps_on_pause && (x.get("layout").fix_node_overlaps_on_pause = 1, c.notify.infoWithCallback("Node labels are automatically adjusted. View Layout Settings to disable.", (function() {
                            e(K).mouseover()
                        })), L.is_graph_created && !L.is_read_only && Object(d.updateGraph)(x.get("id"), {
                            graph: {
                                layout_fix_node_overlaps_on_pause: x.get("layout").fix_node_overlaps_on_pause
                            },
                            id: x.get("id")
                        })))) : C.setCanvasAnimation(!0)
                    };
                    K.addEventListener("click", (function() {
                        Ce(), K.blur()
                    })), C.getFilterManager().setCanvas(r);
                    var Ne, Te, Le = x.get("filters").length > 0;
                    !L.is_read_only && L.is_graph_created || L.is_read_only && Le ? (Ne = function(e) {
                        var n;
                        try {
                            n = JSON.parse(decodeURIComponent(e))
                        } catch (r) {
                            return void Object(c.updateUrlParam)("expanded-filter", null)
                        }
                        "filter" !== S.get("freezeMode") && (k.emit("updateFreezeMode", "filter"), ee.addClass("with-notification")), Object(l.initializeWithExpandedRangeFilter)(t, M, n)
                    }, Te = function(e) {
                        "filters" === M.getTypeInBar() ? M.clearBar() : M.requestBar("filters", {
                            with_composition_panel: e
                        }), ee.blur()
                    }, ee.click((function() {
                        Te()
                    }))) : ee.addClass("not-shown"), L.is_graph_created || ee.addClass("not-shown"), C.getAnalysisManager().setCanvas(r);
                    var Pe = function(e, t, n) {
                        "analysis" !== M.getTypeInBar() ? (M.clearBar(), M.requestBar("analysis", {
                            highlightClustersOnStart: e,
                            showCompositionPanelOnStart: t,
                            runClusteringOnStart: n
                        })) : M.clearBar()
                    };
                    ne.click((function(e) {
                        return Pe(), ne.blur(), e.preventDefault(), !1
                    }));
                    var Ae = function() {
                        "info" !== M.getTypeInBar() ? (M.clearBar(), M.requestBar("info")) : M.clearBar()
                    };
                    re.click((function(e) {
                        return Ae(), re.blur(), e.preventDefault(), !1
                    }));
                    var De = function() {
                            L.is_user_in && (L.is_graph_created ? x.get("belongsToHub") && !x.get("community") ? Object(l.showContributorsPanel)(t) : Object(l.showCollaboratorsPanel)(t) : R("Collaborators"))
                        },
                        Me = function() {
                            (L.is_graph_created || C.getNodeTypes().length > 0) && Object(l.exportDialogue)(t, x.get("id"))
                        },
                        qe = function() {
                            L.is_graph_created ? Object(_.graphCard)(t, e, Ie, De, Re, Ye) : Object(_.graphCard)(t, e)
                        };

                    function Ie() {
                        Object(l.editGraphPanel)(t)
                    }

                    function Re() {
                        L.is_user_in && (L.is_graph_created && x.get("user").is_admin ? Object(l.showLicensingPanel)(t, (function(e, t) {
                            Object(d.updateGraph)(x.get("id"), {
                                graph: {
                                    license_cc_by: e.cc_by,
                                    license_cc_sa: e.cc_sa,
                                    license_cc_nd: e.cc_nd,
                                    license_cc_nc: e.cc_nc
                                },
                                id: x.get("id")
                            }, (function() {
                                x.set("license", e), t()
                            }))
                        })) : R("Licensing"))
                    }
                    this.onGraphLicenseChanged = function() {};
                    L.is_graph_created && (x.get("isEmbed") || (Object(c.isSmallScreen)() ? (e(".graph-title-tipped").addClass("fake-link"), e(".graph-title-tipped").click((function() {
                        qe()
                    }))) : i.a.create(".graph-title-tipped"))), e(".graph-export").click((function(e) {
                        e.preventDefault(), Object(c.hideTipped)(), Me()
                    })), e(".open-graph-info").click((function() {
                        return Object(c.hideTipped)(), qe(), !1
                    })), e(".open-graph-edit").click((function() {
                        return Object(c.hideTipped)(), Ie(), !1
                    }));
                    e(".gc-pnl-duplicate").click((function(e) {
                        var n;
                        return n = "Set a name for your new graph", x.get("belongsToHub") && x.get("user").is_admin && (n += "</br>Hub data will be transferred to this new graph."), Object(l.newGraphSaveDialog)(t, n, (function(e) {
                            var t = "/graphs/" + x.get("id") + "/duplicate";
                            e && (t = t + "?name=" + e), Object(c.redirectTo)(t)
                        })), e.preventDefault(), !1
                    }));
                    var Be = function() {
                        var e;
                        e = L.is_read_only ? {} : {
                            onGraphEditRequested: function() {
                                Ie()
                            },
                            onNewStoryRequested: function() {
                                be()
                            },
                            onAnalysisRequested: function() {
                                Pe(!1, !0)
                            },
                            onClusteringRequested: function() {
                                Pe(!1, !1, !0)
                            },
                            onFiltersRequested: function() {
                                Te(!0)
                            },
                            onCartographyRequested: function() {
                                le()
                            },
                            onDatatableRequested: function() {
                                M && M.toggleDatatable && M.toggleDatatable("mid")
                            }
                        }, M.getTypeInBar() && M.clearBar(), Object(l.showWaitMessage)(t, "Please wait", "Preparing graph checklist", (function(n) {
                            Object(d.checkGraphQuality)(x.get("id"), (function(r) {
                                Object(l.showGraphQualityPanel)(t, r, e);
                                var o = Fe(r.checks);
                                x.set("qualityScore", o), T && T.setProgress(o), n()
                            }), (function() {
                                Object(l.displayMessage)(t, "Error", "Unable to obtain graph check list"), n()
                            }))
                        }))
                    };

                    function Fe(e) {
                        var t = 0,
                            n = 0;
                        return e.forEach((function(e) {
                            t += e.passing, n += e.total
                        })), Math.round(t / n * 100)
                    }
                    var Ge = function() {
                            Object(d.checkGraphQuality)(x.get("id"), (function(e) {
                                var t = Fe(e.checks);
                                x.set("qualityScore", t), x.set("referencesQualityScore", e.checks[2].passing), T && T.setProgress(t)
                            }))
                        },
                        He = function() {
                            var e = Object(c.prepareGraphReferencePanelData)(t);
                            Object(l.showGraphReferencePanel)(t, e)
                        },
                        Ue = function() {
                            if (x.get("referencesQualityScore") > 0) {
                                var e = document.querySelector("a.btnOpenReferences");
                                Object(c.removeClass)(e, "not-shown"), e.addEventListener("click", (function(e) {
                                    return e.preventDefault(), He(), !1
                                }))
                            }
                        };
                    e("#btnGraphQuality").click((function(e) {
                        e.preventDefault(), Object(c.hideTipped)(), Be()
                    }));
                    var ze = "You have unsaved changes! Are you sure to navigate away from this page?";
                    e(".warn-before-leave").click((function(e) {
                        if (!x.get("isEmbed") && x.get("isDirty") && !Object(l.confirm)(ze)) return e.preventDefault(), e.stopPropagation(), !1;
                        window.onbeforeunload = null, N.cleanUp()
                    }));
                    var We;

                    function Ye() {
                        Object(l.showGraphStatus)(t, (function(e, t) {
                            Object(d.setGraphStatus)(x.get("id"), e, (function() {
                                x.set("status", e), t()
                            }), (function(e) {
                                402 == e.status ? (k.emit("onPaymentRequired", null, e.responseJSON), t({
                                    msg: "Payment required"
                                })) : t(e.responseJSON)
                            }))
                        }))
                    }
                    this.fnOnGraphSaveFailed = function() {}, this.onGraphCreateFailed = function() {
                        Object(l.displayMessage)(t, "Error Saving Graph", "An Error Occurred. Please try again")
                    }, this.triggerSave = function() {
                        B()
                    }, e(".embed-share").click((function(e) {
                        return Object(l.embedDialog)(t, x.get("id")), e.preventDefault(), !1
                    })), e(".btnGettingStarted").click((function(e) {
                        return Object(l.helpPanel)(t), e.preventDefault(), !1
                    })), e(".graph-status-small").click((function(e) {
                        return e.preventDefault(), !1
                    })), !S.get("readOnly") && q.is_admin && !x.get("community") && L.is_graph_created ? e(".graph-status").click((function(t) {
                        return e(".tpd-tooltip").css("display", "none"), Ye(), t.preventDefault(), !1
                    })) : (e(".graph-status").click((function(e) {
                        return e.preventDefault(), !1
                    })), e(".graph-status").addClass("not-shown")), L.is_graph_created && !x.get("user").is_admin && e(".graph-licensing").addClass("not-shown"), e(".graph-licensing").click((function(t) {
                        return e(".tpd-tooltip").css("display", "none"), Re(), t.preventDefault(), !1
                    })), e(".graph-collaborators").click((function(t) {
                        return e(".tpd-tooltip").css("display", "none"), De(), t.preventDefault(), !1
                    })), e(".graph-merge").click((function(n) {
                        return e(".tpd-tooltip").css("display", "none"), x.get("isDirty") ? Object(l.displayMessage)(t, "Unsaved changes", "Please save your work to continue") : Object(l.showGraphMergePanel)(t, C.getNodeTypes(), C.getEdgeTypes(), C.getNodes(), C.getLinks(), (function(e) {
                            var n = {
                                graph: {
                                    id: x.get("id"),
                                    history: e
                                }
                            };
                            Object(l.showWaitMessage)(t, "Please wait", "Updating graph", (function(e) {
                                Object(d.saveGraph)(x.get("id"), n, (function() {
                                    window.location.reload(), e()
                                }), (function() {
                                    window.location.reload(), e()
                                }))
                            }))
                        })), n.preventDefault(), !1
                    })), q.is_hub_member && e(".start-graph-btn").click((function(n) {
                        return e(".tpd-tooltip").css("display", "none"), Object(l.hubGraphCreateDialog)(t, q.id, x.get("hub").id), n.preventDefault(), !1
                    }));
                    var Ve, Xe = 0,
                        Ke = function(e) {
                            (32 === e.keyCode && (Object(c.isInputFieldActive)(document.activeElement) || o && o.hasSelected() ? e.returnValue = !0 : Ce()), 69 !== e.keyCode || L.is_read_only && !L.allow_explore || (Object(c.isInputFieldActive)(document.activeElement) || o && o.hasSelected() ? e.returnValue = !0 : de()), 8 === e.keyCode && (Object(c.isInputFieldActive)(document.activeElement) ? e.returnValue = !0 : e.returnValue = !1), 191 === e.keyCode && c.keyModifiers.isShiftPressed() && (Object(c.isInputFieldActive)(document.activeElement) ? e.returnValue = !0 : Object(l.helpPanel)(t, {
                                focus: "shortcuts"
                            })), 90 === e.keyCode && (e.ctrlKey || e.metaKey)) && (Object(c.isInputFieldActive)(document.activeElement) ? e.returnValue = !0 : S.get("editMode") === u.a.EDIT && !(Xe > 0) && C.undo())
                        };
                    document.addEventListener("keydown", Ke, !1), this.cleanUp = function() {
                        document.removeEventListener("keydown", Ke, !1)
                    }, this.setViewCoordinator = function(e) {
                        M = e
                    }, ge(), this.graphLoaded = function() {
                        x.get("id") || S.get("readOnly") ? (P = !0, z()) : U(),
                            function() {
                                var n = e("#pnlGraphCover"),
                                    o = e("#btnEnterGraph"),
                                    a = e("#btnGraphLoading");
                                o.click((function() {
                                    n.fadeOut(1e3, (function() {
                                        i()
                                    }))
                                }));
                                var i = function() {
                                    n.hide();
                                    var e = document.querySelector("div.graph-edit");
                                    Object(c.addClass)(e, "loaded")
                                };
                                L.is_graph_created ? f.hideCoverOnLoad ? window.location.search.match(/noanim=true/) ? i() : n.fadeOut(1e3, (function() {
                                    i()
                                })) : n.is(":hidden") || (n.addClass("graph-reveal"), a.addClass("not-shown"), o.removeClass("not-shown").removeAttr("disabled")) : window.location.search.match(/noanim=true/) ? i() : n.hide({
                                    complete: function() {
                                        i()
                                    }
                                });
                                if (f.blocked_node_count) {
                                    var s = function() {
                                            Object(d.ignoreBlockedNodeWarning)(x.get("id"))
                                        },
                                        h = function(e) {
                                            window.open("/me/billing", "_blank"), e && s()
                                        },
                                        g = function(e) {
                                            e && s()
                                        },
                                        m = "This graph has " + Object(c.buildNumericText)(f.blocked_node_count, "node that is", "nodes that are", "{quantity} blocked {item}") + " still private but marked as blocked due to a downgrade in your plan.";
                                    x.set("blockedNodesStatement", m), Object(l.confirm)(t, "Graph With Blocked Nodes", m, h, g, "Don't show this warning again", null, "REVIEW PLAN")
                                } else if (f.graphHelp) new p(t, r);
                                else {
                                    var y, b = window.location.pathname.indexOf("/comments/");
                                    b > 0 && (y = window.location.pathname.substring(b + 10));
                                    var v = Object(c.getURLParamsHash)(window.location.search),
                                        _ = (v.show || "").toLowerCase();
                                    if (0 === _.indexOf("collab")) x.get("user").is_admin && De();
                                    else if (0 === _.indexOf("cartog")) x.get("user").is_admin && le();
                                    else if (0 === _.indexOf("graph")) Ae();
                                    else if (0 === _.indexOf("info")) Ae(), i();
                                    else if (0 === _.indexOf("edit-info")) !L.is_read_only && L.is_graph_created && Ie();
                                    else if (0 === _.indexOf("comment") || y) L.is_graph_created && ue(y);
                                    else if (0 === _.indexOf("analysis-cluster")) L.is_graph_created && (Pe(!0), n.hide(), i());
                                    else if (0 === _.indexOf("analysis")) L.is_graph_created && Pe();
                                    else if (0 === _.indexOf("groups")) L.is_graph_created && oe();
                                    else if (0 === _.indexOf("filter"))(!L.is_read_only && L.is_graph_created || L.is_read_only && Le) && Te();
                                    else if (v.filters)(!L.is_read_only && L.is_graph_created || L.is_read_only && Le) && v["expanded-filter"] && Ne(v["expanded-filter"]);
                                    else if (v["expanded-filter"])(!L.is_read_only && L.is_graph_created || L.is_read_only && Le) && Ne(v["expanded-filter"]);
                                    else if (0 === _.indexOf("embedg")) L.is_graph_created && Object(l.embedDialog)(t, x.get("id"));
                                    else if (0 === _.indexOf("licens")) L.is_graph_created && x.get("user").is_admin && Re();
                                    else if (0 === _.indexOf("export")) Me();
                                    else if (0 === _.indexOf("status")) L.is_graph_created && x.get("user").is_admin && Ye();
                                    else if (0 === _.indexOf("import")) L.is_graph_created && L.is_read_only || ce();
                                    else if (0 === _.indexOf("node")) {
                                        var w = C.getNodeById(v.nid);
                                        w && Object(l.buildExpandedNodeCard)(t, w, (function(e) {
                                            C.clearSelectedNodes(), C.selectNode(e), N.requestBar("share")
                                        }))
                                    } else if (0 === _.indexOf("shortcuts")) Object(l.helpPanel)(t);
                                    else if (0 === _.indexOf("help")) Object(l.helpPanel)(t);
                                    else if (0 === _.indexOf("datatable")) M && M.toggleDatatable && M.toggleDatatable("max");
                                    else if (0 === _.indexOf("explore")) {
                                        if (x.get("belongsToHub") && (k.emit("updateEditMode", u.a.EDIT), !v.n)) {
                                            var O = function() {
                                                Object(c.HelpDisplay)({
                                                    target: "div.left-bar button.explore",
                                                    position: "right",
                                                    title: "To open the Explore panel",
                                                    message: "Click anywhere on the canvas"
                                                })
                                            };
                                            k.emit("onExplorePanelOpened", null, O)
                                        }
                                    } else if (0 === _.indexOf("share")) M.requestBar("share");
                                    else if (0 === _.indexOf("stories") || -1 !== window.location.pathname.indexOf("/stories/")) {
                                        var E;
                                        if ("function" === typeof _e) window.location.pathname.indexOf("/stories/") >= 0 && (E = window.location.pathname.replace("/graphs/" + x.get("id") + "/stories/", "")), E ? (n.hide(), i(), "true" === v.edit ? ye(E, v.slide, "true" === v["return-to-view"]) : ve(E)) : "true" === v.new ? (n.hide(), i(), be()) : (n.fadeOut(1e3, (function() {
                                            i()
                                        })), _e())
                                    } else "checklist" === _ ? (n.hide(), i(), Be()) : "references" === _ ? (n.hide(), i(), He()) : v.sel && getSelection(v.sel, (function(e) {
                                        Object(l.imgPanel)(t, {
                                            image: e.image,
                                            name: e.description
                                        })
                                    }));
                                    "true" === v.fitgraph && Ee()
                                }
                            }(), !L.is_read_only && L.is_graph_created && function() {
                                T = Object(w.ProgressMeter)(t);
                                var n = x.get("qualityScore");
                                void 0 === n ? Ge() : T.setProgress(n), T.show(), e("#btnOpenCheckList").click((function(e) {
                                    return e.preventDefault(), Be(), !1
                                }))
                            }(), L.is_read_only && L.is_graph_created && (void 0 === x.get("referencesQualityScore") ? Object(d.checkReferenceQuality)(x.get("id"), (function(e) {
                                x.set("referencesQualityScore", e.checks[0].passing), Ue()
                            })) : Ue())
                    }, this.updateSaveMode = function(e) {
                        W(e)
                    };
                    var $e = document.querySelector("button.onboarding");
                    $e && $e.addEventListener("click", (function() {
                        N.cleanUp(), Object(c.redirectTo)("/graphs/new?onboard=true")
                    }));
                    var Ze = document.getElementById("btn-toggle-graph-model");
                    Ze && Ze.addEventListener("click", (function(t) {
                        return e(".tpd-tooltip").css("display", "none"), oe(), t.preventDefault(), !1
                    })), k.bind("onFilterApplied", (function() {
                        var e = C.getFilterManager().getRules();
                        Array.isArray(e) && e.length > 0 ? Object(c.updateUrlParam)("filters", encodeURIComponent(JSON.stringify(e))) : Object(c.updateUrlParam)("filters", null);
                        var t = C.getFilterManager().getTotalFilteredNodeCount(),
                            n = C.getFilterManager().getTotalFilteredEdgeCount();
                        t > 0 || n > 0 ? ee.addClass("with-notification") : ee.removeClass("with-notification")
                    }), this), k.bind("freezeModeUpdated", (function(e, t) {
                        if (e) {
                            switch (L.is_read_only || Y.hide(), e) {
                                case "filter":
                                    ee.addClass("filter-on"), ee.addClass("menu-selected");
                                    break;
                                case "analysis":
                                    ne.addClass("menu-selected");
                                    break;
                                case "comments":
                                    pe.addClass("menu-selected");
                                    break;
                                case "group":
                                    C.setCanvasAnimation(!0), x.set("isSnapshotDirty", !1)
                            }
                            switch (t) {
                                case "filter":
                                    ee.removeClass("menu-selected"), ee.removeClass("filter-on"), ee.removeClass("with-notification");
                                    break;
                                case "analysis":
                                    ne.removeClass("menu-selected");
                                    break;
                                case "comments":
                                    pe.removeClass("menu-selected")
                            }
                        } else switch (L.is_read_only || S.get("editMode") !== u.a.VIEW && Y.hide(), t) {
                            case "filter":
                                ee.removeClass("menu-selected"), ee.removeClass("filter-on"), ee.removeClass("with-notification");
                                break;
                            case "analysis":
                                ne.removeClass("menu-selected");
                                break;
                            case "comments":
                                pe.removeClass("menu-selected")
                        }
                    }), this), k.bind("onGraphSaved", (function(e) {
                        window.onbeforeunload = null, e && function() {
                            try {
                                var e = i.a.get(K);
                                e && e.items().length > 0 && (Object(c.removeClass)(e.items()[0].content.querySelector("li.snapshot-divider"), "not-shown"), Object(c.removeClass)(e.items()[0].content.querySelector("li.show-snapshot"), "not-shown"), Object(c.removeClass)(e.items()[0].content.querySelector("li.open-with-snapshot"), "not-shown"), e.items()[0].content.querySelector("li.open-with-snapshot").querySelector("input").checked = !0)
                            } catch (t) {
                                console.log("unable to remove tipped snapshot")
                            }
                        }(), T && Ge()
                    }), this), k.bind("onGraphCreated", (function(e, t, n) {
                        window.onbeforeunload = null;
                        var r = ["/graphs/", t, "?auto=true"];
                        n && (r.push("&show="), r.push(n)), N.cleanUp(), Object(c.redirectTo)(r.join(""))
                    }), this), k.bind("onPaymentRequired", (function(e, n) {
                        ! function(e) {
                            Object(l.showPlanUpgrade)(t, e, (function() {
                                V && V.ext.revert()
                            }))
                        }(n)
                    }), this), k.bind("graphStore.status.updated", (function(e) {
                        switch (e) {
                            case 0:
                                te.parent().removeClass("not-shown");
                                try {
                                    var t = i.a.get(".graph-title-tipped").items()[0].content;
                                    t.querySelector(".graph-status-WIP").classList.remove("not-shown"), t.querySelector(".graph-status-published").classList.add("not-shown"), t.querySelector(".graph-status-private").classList.add("not-shown")
                                } catch (o) {
                                    console.log(o), console.log("unable to update tipped share")
                                }
                                break;
                            case 1:
                                te.parent().removeClass("not-shown");
                                try {
                                    var n = i.a.get(".graph-title-tipped").items()[0].content;
                                    n.querySelector(".graph-status-WIP").classList.add("not-shown"), n.querySelector(".graph-status-published").classList.remove("not-shown"), n.querySelector(".graph-status-private").classList.add("not-shown")
                                } catch (o) {
                                    console.log(o), console.log("unable to update tipped share")
                                }
                                break;
                            case 2:
                                te.parent().addClass("not-shown");
                                try {
                                    var r = i.a.get(".graph-title-tipped").items()[0].content;
                                    r.querySelector(".graph-status-WIP").classList.add("not-shown"), r.querySelector(".graph-status-published").classList.add("not-shown"), r.querySelector(".graph-status-private").classList.remove("not-shown")
                                } catch (o) {
                                    console.log(o), console.log("unable to update tipped share")
                                }
                        }
                    }), this), k.bind("triggerSnapshot", (function() {
                        ke()
                    }), this), k.bind("trigger", ge, this), k.bind("onUndo", (function(e, t) {
                        var n;
                        n = 1 == e.signals.length ? ["Undid", e.signals[0].action].join(" ") : ["Undid", e.signals.length, "actions"].join(" ");
                        var r = Object(c.buildNumericText)(t, "undo", "undos", "({quantity} {item} left)");
                        c.notify.info([n, r].join(" ")), 0 === t && Y.disable("undo", !0)
                    }), this), k.bind("editModeUpdated", (function(e) {
                        switch (e) {
                            case u.a.VIEW:
                                L.is_read_only && !L.allow_explore || (Object(c.removeClass)(Q, "hide-it"), Y.hide()), J.hasClass("not-shown") || J.addClass("not-shown");
                                break;
                            case u.a.EDIT:
                                L.is_read_only || (Object(c.addClass)(Q, "hide-it"), Y.show("edit"), "webgl-canvas" == r.getName() && Object(c.HelpDisplay)({
                                    target: "button.map-controller.edit.in-graph",
                                    position: "right",
                                    title: "Editing disabled in WebGL mode",
                                    message: "<a href='/graphs/" + x.get("id") + "?svg=true&auto=true'>Switch to SVG mode</a> to edit your graph."
                                })), C.getNodes().length < 1 && J.removeClass("not-shown"), J.text("Click on the canvas to start");
                                break;
                            case u.a.DELETE:
                                L.is_read_only && !L.allow_explore_only || (Object(c.addClass)(Q, "hide-it"), Y.show("erase"), "webgl-canvas" == r.getName() && Object(c.HelpDisplay)({
                                    target: "button.map-controller.erase",
                                    position: "right",
                                    title: "Editing disabled in WebGL mode",
                                    message: "<a href='/graphs/" + x.get("id") + "?svg=true&auto=true'>Switch to SVG mode</a> to edit your graph."
                                })), J.hasClass("not-shown") || J.addClass("not-shown");
                                break;
                            case u.a.EXPLORE:
                                L.allow_explore && (Object(c.addClass)(Q, "hide-it"), Y.show("explore")), C.getNodes().length < 1 && J.removeClass("not-shown"), J.text("Click on the canvas to explore")
                        }
                    }), this), k.bind("graphStore.isDirty.updated", (function(e) {
                        e && (x.get("isEmbed") || (window.onbeforeunload = function(e) {
                            return (e || window.event).returnValue = ze, ze
                        }))
                    }), this), k.bind("onModalOpened", (function() {
                        1 !== (Xe += 1) || M.getTypeInBar() || (We = se(), ae())
                    }), this), k.bind("onModalClosed", (function() {
                        0 !== (Xe = Math.max(0, Xe - 1)) || M.getTypeInBar() || (We ? (ie(), x.set("isSnapshotDirty", !1)) : ae())
                    }), this), k.bind("onBarOpened", (function(e) {
                        switch (e) {
                            case "filters":
                                break;
                            case "comments":
                                pe && pe.removeClass("with-notification");
                                break;
                            case "analysis":
                                break;
                            case "group":
                                return;
                            case "share":
                                Object(c.addClass)(me, "menu-selected");
                                break;
                            case "stories":
                                Object(c.addClass)(we, "menu-selected");
                                break;
                            case "info":
                                re.addClass("menu-selected")
                        }
                        0 === Xe && (We = se(), ae()), e && L.is_graph_created && Object(d.openRightBar)(x.get("id"), e)
                    }), this), k.bind("onBarClosed", (function(e) {
                        switch (e) {
                            case "filters":
                                "filter" === S.get("freezeMode") && ee && ee.addClass("with-notification");
                                break;
                            case "comments":
                            case "analysis":
                                break;
                            case "share":
                                Object(c.removeClass)(me, "menu-selected");
                                break;
                            case "stories":
                                Object(c.removeClass)(we, "menu-selected");
                                break;
                            case "info":
                                re.removeClass("menu-selected")
                        }
                        0 === Xe && (We ? ie() : ae())
                    }), this), k.bind("onCommentCountUpdated", (function(e) {
                        pe && (e > 0 ? (fe && (fe.innerHTML = e, Object(c.removeClass)(fe, "hidden")), he && (he.innerHTML = e)) : (fe && (fe.innerHTML = "", Object(c.addClass)(fe, "hidden")), he && (he.innerHTML = 0)))
                    }), this), k.bind("onDatatableOpened", (function() {
                        1 === (Xe += 1) && (Ve = se(), ae()), Y && Y.isVisible() && Y.show("datatable")
                    }), this), k.bind("onDatatableClosed", (function() {
                        if (0 === (Xe = Math.max(0, Xe - 1)) && (Ve ? ie() : ae()), Y && Y.isVisible()) switch (S.get("editMode")) {
                            case u.a.EDIT:
                                Y.show("edit");
                                break;
                            case u.a.DELETE:
                                Y.show("erase")
                        }
                    }), this), k.bind("onOnboardCompleted", (function() {
                        N.triggerSave()
                    }), this), k.bind("onCanvasPauseStateChanged", (function(e) {
                        e ? (ie(), r.setRendererState(!0)) : (ae(), r.setRendererState(!1))
                    }), this), k.bind("clearGraph", (function() {
                        J.removeClass("not-shown"), Y.disable("undo", !0)
                    }), this), k.bind("onGraphUserChanged", (function() {
                        if (q = x.get("user"), L.is_user_in = !!q.id, Se) {
                            var e = Se.parentNode;
                            e.removeChild(Se);
                            var t = s.a["graphs/topbar_user_avatar"](q);
                            e.appendChild(t.trim().toDOM())
                        }
                    }), this)
                },
                x = n(34),
                k = n.n(x),
                C = n(73),
                N = n(13),
                T = n.n(N),
                L = function(e, t) {
                    var n = {
                        linLogMode: !1,
                        outboundAttractionDistribution: !1,
                        adjustSizes: !1,
                        edgeWeightInfluence: 0,
                        scalingRatio: 50,
                        strongGravityMode: !1,
                        gravity: .85,
                        slowDown: 2,
                        barnesHutOptimize: !1,
                        barnesHutTheta: .5,
                        startingIterations: 1,
                        iterationsPerRender: 1,
                        stableThreshold: 1
                    };
                    n = g(t = t || {}, n);
                    var r, o = {
                            x1: Number.MAX_VALUE,
                            y1: Number.MAX_VALUE,
                            x2: Number.MIN_VALUE,
                            y2: Number.MIN_VALUE
                        },
                        a = {
                            maxForce: 10,
                            iterations: 0,
                            converged: !1
                        },
                        i = 0,
                        s = [],
                        c = {},
                        l = {},
                        d = function() {
                            return console.log("called"), {
                                x: 1024 * Math.random() - 512,
                                y: 1024 * Math.random() - 512
                            }
                        },
                        u = function(e) {
                            s.push(e), c[e] = {
                                    pos: {
                                        x: 5 * Math.random() - 10,
                                        y: 5 * Math.random() - 10
                                    },
                                    dx: 0,
                                    dy: 0,
                                    old_dx: 0,
                                    old_dy: 0,
                                    mass: 1,
                                    convergence: 1,
                                    size: 1,
                                    fixed: 0
                                }, i += 1,
                                function(e, t) {
                                    e.x < t.x1 && (t.x1 = e.x), e.x > t.x2 && (t.x2 = e.x), e.y < t.y1 && (t.y1 = e.y), e.y > t.y2 && (t.y2 = e.y)
                                }(c[e].pos, o)
                        },
                        p = function(e) {
                            l[e.id] = {
                                source: e.fromId,
                                target: e.toId,
                                weight: e.data && e.data.weight ? e.data.weight : 0
                            };
                            var t = c[e.fromId],
                                n = c[e.toId];
                            t && (t.mass += 1), n && (n.mass += 1)
                        },
                        f = function(e) {
                            for (var t = 0; t < e.length; ++t) {
                                var n = e[t];
                                n.node && ("add" === n.changeType ? u(n.node.id) : (f = n.node, s.splice(s.indexOf(f.id), 1), delete c[f.id], i -= 1)), n.link && ("add" === n.changeType ? p(n.link) : (r = n.link, o = void 0, a = void 0, d = void 0, (d = l[r.id]) && (o = c[d.source], a = c[d.target], o && (o.mass -= 1), a && (a.mass -= 1), delete l[r.id])))
                            }
                            var r, o, a, d, f
                        };
                    return e.forEachNode((function(e) {
                        u(e.id)
                    })), e.forEachLink(p), e.on("changed", f), {
                        run: function() {
                            this.step()
                        },
                        step: function() {
                            return function() {
                                var e, t, d, u, p, f, h, g, m, y, b, v, _, w, O, E, j, S, x, k = 1 / 0,
                                    C = -1 / 0,
                                    N = 1 / 0,
                                    T = -1 / 0;
                                for (d in c) c[d].old_dx = c[d].dx, c[d].old_dy = c[d].dy, c[d].dx = 0, c[d].dy = 0;
                                if (n.outboundAttractionDistribution) {
                                    for (d in m = 0, c) m += c[d].mass;
                                    m /= i
                                }
                                if (n.barnesHutOptimize) {
                                    var L, P;
                                    for (d in r = [], k = o.x1, N = o.y1, C = o.x2, T = o.y2, r.push({
                                            node: -1,
                                            centerX: (k + C) / 2,
                                            centerY: (N + T) / 2,
                                            size: Math.max(C - k, T - N),
                                            nextSibling: -1,
                                            firstChild: -1,
                                            mass: 0,
                                            massCenterX: 0,
                                            massCenterY: 0
                                        }), e = 1, c)
                                        for (t = 0;;)
                                            if (r[t].firstChild >= 0) L = c[d].pos.x < r[t].centerX ? c[d].pos.y < r[t].centerY ? r[t].firstChild : r[t].firstChild + 1 : c[d].pos.y < r[t].centerY ? r[t].firstChild + 2 : r[t].firstChild + 3, r[t].massCenterX = (r[t].massCenterX * r[t].mass + c[d].pos.x * c[d].mass) / (r[t].mass + c[d].mass), r[t].massCenterY = (r[t].massCenterY * r[t].mass + c[d].pos.y * c[d].mass) / (r[t].mass + c[d].mass), r[t].mass += c[d].mass, t = L;
                                            else {
                                                if (r[t].node < 0) {
                                                    r[t].node = d;
                                                    break
                                                }
                                                if (r[t].firstChild = e, h = r[t].size / 2, g = r[t].firstChild, r[g] = {}, r[g].node = -1, r[g].centerX = r[t].centerX - h, r[g].centerY = r[t].centerY - h, r[g].size = h, r[g].nextSibling = g + 1, r[g].firstChild = -1, r[g].mass = 0, r[g].massCenterX = 0, r[g].massCenterY = 0, r[g += 1] = {}, r[g].node = -1, r[g].centerX = r[t].centerX - h, r[g].centerY = r[t].centerY + h, r[g].size = h, r[g].nextSibling = g + 1, r[g].firstChild = -1, r[g].mass = 0, r[g].massCenterX = 0, r[g].massCenterY = 0, r[g += 1] = {}, r[g].node = -1, r[g].centerX = r[t].centerX + h, r[g].centerY = r[t].centerY - h, r[g].size = h, r[g].nextSibling = g + 1, r[g].firstChild = -1, r[g].mass = 0, r[g].massCenterX = 0, r[g].massCenterY = 0, r[g += 1] = {}, r[g].node = -1, r[g].centerX = r[t].centerX + h, r[g].centerY = r[t].centerY + h, r[g].size = h, r[g].nextSibling = r[t].nextSibling, r[g].firstChild = -1, r[g].mass = 0, r[g].massCenterX = 0, r[g].massCenterY = 0, e += 4, L = c[r[t].node].pos.x < r[t].centerX ? c[r[t].node].pos.y < r[t].centerY ? r[t].firstChild : r[t].firstChild + 1 : c[r[t].node].pos.y < r[t].centerY ? r[t].firstChild + 2 : r[t].firstChild + 3, r[t].mass = c[r[t].node].mass, r[t].massCenterX = c[r[t].node].pos.x, r[t].massCenterY = c[r[t].node].pos.y, r[L].node = r[t].node, r[t].node = -1, L !== (P = c[d].pos.x < r[t].centerX ? c[d].pos.y < r[t].centerY ? r[t].firstChild : r[t].firstChild + 1 : c[d].pos.y < r[t].centerY ? r[t].firstChild + 2 : r[t].firstChild + 3)) {
                                                    r[P].node = d;
                                                    break
                                                }
                                                t = L
                                            }
                                }
                                if (n.barnesHutOptimize)
                                    for (d in y = n.scalingRatio, c)
                                        for (t = 0;;)
                                            if (r[t].firstChild >= 0) {
                                                if (w = Math.sqrt(Math.pow(c[d].pos.x - r[t].massCenterX, 2) + Math.pow(c[d].pos.y - r[t].massCenterY, 2)), 2 * r[t].size / w < n.barnesHutTheta) {
                                                    if (b = c[d].pos.x - r[t].massCenterX, v = c[d].pos.y - r[t].massCenterY, n.adjustSize ? w > 0 ? (O = y * c[d].mass * r[t].mass / w / w, c[d].dx += b * O, c[d].dy += v * O) : w < 0 && (O = -y * c[d].mass * r[t].mass / w, c[d].dx += b * O, c[d].dy += v * O) : w > 0 && (O = y * c[d].mass * r[t].mass / w / w, c[d].dx += b * O, c[d].dy += v * O), r[t].nextSibling < 0) break;
                                                    t = r[t].nextSibling;
                                                    continue
                                                }
                                                t = r[t].firstChild
                                            } else {
                                                if (-1 !== r[t].node && r[t].node !== d && (b = c[d].pos.x - c[r[t].node].pos.x, v = c[d].pos.y - c[r[t].node].pos.y, w = Math.sqrt(b * b + v * v), n.adjustSize ? w > 0 ? (O = y * c[d].mass * c[r[t].node].mass / w / w, c[d].dx += b * O, c[d].dy += v * O) : w < 0 && (O = -y * c[d].mass * c[r[t].node].mass / w, c[d].dx += b * O, c[d].dy += v * O) : w > 0 && (O = y * c[d].mass * c[r[t].node].mass / w / w, c[d].dx += b * O, c[d].dy += v * O)), r[t].nextSibling < 0) break;
                                                t = r[t].nextSibling
                                            }
                                else
                                    for (y = n.scalingRatio, u = 0; u < i; u += 1)
                                        for (p = 0; p < u; p += 1) b = c[s[u]].pos.x - c[s[p]].pos.x, v = c[s[u]].pos.y - c[s[p]].pos.y, n.adjustSize ? (w = Math.sqrt(b * b + v * v) - c[s[u]].size - c[s[p]].size) > 0 ? (O = y * c[s[u]].mass * c[s[p]].mass / w / w, c[s[u]].dx += b * O, c[s[u]].dy += v * O, c[s[p]].dx += b * O, c[s[p]].dy += v * O) : w < 0 && (O = 100 * y * c[s[u]].mass * c[s[p]].mass, c[s[u]].dx += b * O, c[s[u]].dy += v * O, c[s[p]].dx -= b * O, c[s[p]].dy -= v * O) : (w = Math.sqrt(b * b + v * v)) > 0 && (O = y * c[s[u]].mass * c[s[p]].mass / w / w, c[s[u]].dx += b * O, c[s[u]].dy += v * O, c[s[p]].dx -= b * O, c[s[p]].dy -= v * O);
                                for (d in g = n.gravity / n.scalingRatio, y = n.scalingRatio, c) O = 0, b = c[d].pos.x, v = c[d].pos.y, w = Math.sqrt(Math.pow(b, 2) + Math.pow(v, 2)), n.strongGravityMode ? w > 0 && (O = y * c[d].mass * g) : w > 0 && (O = y * c[d].mass * g / w), c[d].dx -= b * O, c[d].dy -= v * O;
                                for (f in y = 1 * (n.outboundAttractionDistribution ? m : 1), l) u = l[f].source, p = l[f].target, h = l[f].weight, _ = Math.pow(h, n.edgeWeightInfluence), b = c[u].pos.x - c[p].pos.x, v = c[u].pos.y - c[p].pos.y, n.adjustSizes ? (w = Math.sqrt(Math.pow(b, 2) + Math.pow(v, 2) - c[u].size - c[p].size), n.linLogMode ? n.outboundAttractionDistribution ? w > 0 && (O = -y * _ * Math.log(1 + w) / w / c[u].mass) : w > 0 && (O = -y * _ * Math.log(1 + w) / w) : n.outboundAttractionDistribution ? w > 0 && (O = -y * _ / c[u].mass) : w > 0 && (O = -y * _)) : (w = Math.sqrt(Math.pow(b, 2) + Math.pow(v, 2)), n.linLogMode ? n.outboundAttractionDistribution ? w > 0 && (O = -y * _ * Math.log(1 + w) / w / c[u].mass) : w > 0 && (O = -y * _ * Math.log(1 + w) / w) : n.outboundAttractionDistribution ? (w = 1, O = -y * _ / c[u].mass) : (w = 1, O = -y * _)), w > 0 && (c[u].dx += b * O, c[u].dy += v * O, c[p].dx -= b * O, c[p].dy -= v * O);
                                if (n.adjustSizes)
                                    for (d in c) c[d].fixed || ((E = Math.sqrt(Math.pow(c[d].dx, 2) + Math.pow(c[d].dy, 2))) > a.maxForce && (c[d].dx = c[d].dx * a.maxForce / E, c[d].dy = c[d].dy * a.maxForce / E), j = c[d].mass * Math.sqrt((c[d].old_dx - c[d].dx) * (c[d].old_dx - c[d].dx) + (c[d].old_dy - c[d].dy) * (c[d].old_dy - c[d].dy)), S = Math.sqrt((c[d].old_dx + c[d].dx) * (c[d].old_dx + c[d].dx) + (c[d].old_dy + c[d].dy) * (c[d].old_dy + c[d].dy)) / 2, x = .1 * Math.log(1 + S) / (1 + Math.sqrt(j)), c[d].pos.x = c[d].pos.x + c[d].dx * (x / n.slowDown), c[d].pos.y = c[d].pos.y + c[d].dy * (x / n.slowDown));
                                else
                                    for (d in c) c[d].fixed || (j = c[d].mass * Math.sqrt((c[d].old_dx - c[d].dx) * (c[d].old_dx - c[d].dx) + (c[d].old_dy - c[d].dy) * (c[d].old_dy - c[d].dy)), S = Math.sqrt((c[d].old_dx + c[d].dx) * (c[d].old_dx + c[d].dx) + (c[d].old_dy + c[d].dy) * (c[d].old_dy + c[d].dy)) / 2, x = c[d].convergence * Math.log(1 + S) / (1 + Math.sqrt(j)), c[d].convergence = Math.min(1, Math.sqrt(x * (Math.pow(c[d].dx, 2) + Math.pow(c[d].dy, 2)) / (1 + Math.sqrt(j)))), c[d].pos.x = c[d].pos.x + c[d].dx * (x / n.slowDown), c[d].pos.y = c[d].pos.y + c[d].dy * (x / n.slowDown));
                                a.iterations++;
                                var A = 0,
                                    D = 0;
                                for (d in k = 1 / 0, C = -1 / 0, N = 1 / 0, T = -1 / 0, c) k = Math.min(k, c[d].pos.x), C = Math.max(C, c[d].pos.x), N = Math.min(N, c[d].pos.y), T = Math.max(T, c[d].pos.y), A += Math.abs(c[d].dx), D += Math.abs(c[d].dy);
                                return o.x1 = k, o.y1 = N, o.x2 = C, o.y2 = T, Math.sqrt(A * A + D * D) / i < n.stableThreshold
                            }()
                        },
                        getGraphRect: function() {
                            return {
                                x1: o.x1 === 1 / 0 ? 0 : o.x1,
                                y1: o.y1 === 1 / 0 ? 0 : o.y1,
                                x2: o.x2 === -1 / 0 ? 0 : o.x2,
                                y2: o.y2 === -1 / 0 ? 0 : o.y2
                            }
                        },
                        dispose: function() {
                            e.off("change", f)
                        },
                        isNodePinned: function(e) {
                            return 1 === c[e.id].fixed
                        },
                        pinNode: function(e, t) {
                            c[e.id].fixed = t ? 1 : 0
                        },
                        getNodePosition: h,
                        getLinkPosition: function(e) {
                            var t = l[e];
                            return {
                                from: h(t.source),
                                to: h(t.target)
                            }
                        },
                        setNodePosition: function(e, t, n) {
                            var r = c[e].pos;
                            r.x = t, r.y = n
                        },
                        placeNode: function(t) {
                            return "function" === typeof t ? (d = t, 0 !== e.getNodesCount() && (o.x1 = Number.MAX_VALUE, o.y1 = Number.MAX_VALUE, o.x2 = Number.MIN_VALUE, o.y2 = Number.MIN_VALUE, e.forEachNode((function(e) {
                                u(e.id)
                            }))), this) : d(t)
                        },
                        updateSettings: function(e) {
                            n = g(e, n)
                        },
                        getSettings: function() {
                            return n
                        }
                    };

                    function h(e) {
                        return c[e] || u(e), c[e].pos
                    }

                    function g() {
                        var e, t, n = {};
                        for (e = arguments.length - 1; e >= 0; e -= 1)
                            for (t in arguments[e]) n[t] = arguments[e][t];
                        return n
                    }
                },
                P = function() {
                    var e, t, n = {},
                        r = {},
                        o = {
                            min: 1 / 0,
                            max: -1 / 0
                        },
                        a = {
                            min: 1 / 0,
                            max: -1 / 0
                        },
                        i = {
                            min: 1 / 0,
                            max: -1 / 0
                        },
                        s = function(e) {
                            o = {
                                min: 1 / 0,
                                max: -1 / 0
                            }, e.forEachNode((function(e) {
                                var t = 0;
                                e.links.forEach((function(e) {
                                    var n = e.data.getEdgeData();
                                    t += parseFloat(n.weight || 1)
                                })), t > o.max && (o.max = t), t < o.min && (o.min = t)
                            }))
                        },
                        c = function(e) {
                            a = {
                                min: 1 / 0,
                                max: -1 / 0
                            }, e.forEachNode((function(e) {
                                var t = 0;
                                e.links.forEach((function(n) {
                                    if (n.data.edgeType.directed && n.toId === e.data.id) {
                                        var r = n.data.getEdgeData();
                                        t += parseFloat(r.weight || 1)
                                    }
                                })), t > a.max && (a.max = t), t < a.min && (a.min = t)
                            }))
                        },
                        l = function(e) {
                            i = {
                                min: 1 / 0,
                                max: -1 / 0
                            }, e.forEachNode((function(e) {
                                var t = 0;
                                e.links.forEach((function(n) {
                                    if (n.data.edgeType.directed && n.fromId === e.data.id) {
                                        var r = n.data.getEdgeData();
                                        t += parseFloat(r.weight || 1)
                                    }
                                })), t > i.max && (i.max = t), t < i.min && (i.min = t)
                            }))
                        },
                        d = function(n) {
                            var o = T.a.Graph.centrality().betweennessCentrality(n);
                            if (0 != o.length) {
                                for (var a = 0; a < o.length; a += 1) r[o[a].key] = o[a].value;
                                t = o[o.length - 1].value, e = o[0].value
                            }
                        };

                    function u(s) {
                        var c = s.data.getNodeData(),
                            l = n[c.type_id],
                            d = l.min_size || 8;
                        if (!l) return d;
                        switch (l.type) {
                            case "neutral":
                                return (l.max_size - d) / 2;
                            case "metric_degree":
                                return d + s.links.length / 4;
                            case "metric_in_degree":
                                var u = 0;
                                return s.links.forEach((function(e) {
                                    !e.data.temp && e.data.edgeType.directed && e.toId === s.data.id && (u += 1)
                                })), d + u / 2;
                            case "metric_out_degree":
                                var p = 0;
                                return s.links.forEach((function(e) {
                                    !e.data.temp && e.data.edgeType.directed && e.fromId === s.data.id && (p += 1)
                                })), d + p / 2;
                            case "metric_betweenness":
                                return r && r[c.id] ? t === e ? d : d + Math.floor((r[c.id] - t) / (e - t) * (l.max_size - d)) / 2 : d;
                            case "metric_closeness":
                                return d;
                            case "metric_weighted_degree":
                                if (o.max == o.min) return d;
                                var f = 0;
                                return s.links.forEach((function(e) {
                                    f += parseFloat(e.data.getEdgeData().weight || 1)
                                })), d + Math.floor((f - o.min) / (o.max - o.min) * (l.max_size - d)) / 2;
                            case "metric_weighted_in_degree":
                                if (a.max == a.min) return d;
                                var h = 0;
                                return s.links.forEach((function(e) {
                                    !e.data.temp && e.data.edgeType.directed && e.toId === s.data.id && (h += parseFloat(e.data.getEdgeData().weight))
                                })), d + Math.floor((h - a.min) / (a.max - a.min) * (l.max_size - d)) / 2;
                            case "metric_weighted_out_degree":
                                if (i.max === i.min) return d;
                                var g = 0;
                                return s.links.forEach((function(e) {
                                    !e.data.temp && e.data.edgeType.directed && e.fromId === s.data.id && (g += parseFloat(e.data.getEdgeData().weight))
                                })), d + Math.floor((g - i.min) / (i.max - i.min) * (l.max_size - d)) / 2;
                            default:
                                var m = c.properties[l.type];
                                return isNaN(m) || l.max == l.min ? d : d + Math.floor((m - l.min) / (l.max - l.min) * (l.max_size - d)) / 2
                        }
                    }
                    return {
                        calculate: function(e, t, r) {
                            var o, a, i, p, f, h, g;
                            for (o in t)
                                if (Object.prototype.hasOwnProperty.call(t, o)) switch (n[t[o].id] = {
                                    min: 999999999,
                                    max: -99999999,
                                    type: t[o].size || "metric_degree",
                                    max_size: t[o].size_limit || 48,
                                    min_size: t[o].size_min_limit || 8
                                }, t[o].size) {
                                    case "metric_betweenness":
                                        p = !0;
                                        break;
                                    case "metric_weighted_degree":
                                        f = !0;
                                        break;
                                    case "metric_weighted_in_degree":
                                        h = !0;
                                        break;
                                    case "metric_weighted_out_degree":
                                        g = !0
                                }
                            e.forEachNode((function(e) {
                                var t;
                                if (e && (t = e.data.getNodeData()), t && Object.prototype.hasOwnProperty.call(n, t.type_id)) {
                                    if ("metric_betweenness" === (i = n[t.type_id]).type || "metric_closeness" === i.type || "metric_degree" === i.type || "metric_in_degree" === i.type || "metric_out_degree" === i.type || "metric_weighted_degree" === i.type || "metric_weighted_in_degree" === i.type || "metric_weighted_out_degree" === i.type || "neutral" === i.type) return;
                                    if (a = parseFloat(t.properties[i.type]), isNaN(a)) return;
                                    a < i.min && (i.min = a), a > i.max && (i.max = a)
                                }
                            })), p && d(e), f && s(e), h && c(e), g && l(e), r && e.forEachNode((function(e) {
                                e && (e.data.node_size = u(e), e.data.uiUpdate())
                            }))
                        },
                        getValueFor: function(e) {
                            return void 0 !== e.data.node_size ? e.data.node_size : 8
                        },
                        addNewValue: function(e, t) {
                            var r = !1,
                                o = e.data.getNodeData(),
                                a = n[o.type_id];
                            if (a && "metric_betweenness" !== a.type && "metric_closeness" !== a.type && "metric_degree" !== a.type && "metric_in_degree" !== a.type && "metric_out_degree" !== a.type && "metric_weighted_degree" !== a.type && "metric_weighted_in_degree" !== a.type && "metric_weighted_out_degree" !== a.type && "neutral" !== a.type) {
                                var i;
                                if (o.properties && (i = parseFloat(o.properties[a.type])), !isNaN(i)) {
                                    var s = n[o.type_id];
                                    i < s.min && (s.min = i, r = !0), i > s.max && (s.max = i, r = !0)
                                }
                                r ? t.forEachNode((function(e) {
                                    e && (e.data.node_size = u(e), e.data.uiUpdate())
                                })) : (e.data.node_size = u(e), e.data.uiUpdate())
                            }
                        },
                        introduceNewType: function(e) {
                            Object.prototype.hasOwnProperty.call(n, e) || (n[e] = {
                                min: 999999999,
                                max: -99999999,
                                type: "metric_degree",
                                max_size: 48,
                                min_size: 8
                            })
                        },
                        calculateForType: function(e, t) {
                            var r, o = n[t];
                            o && "metric_closeness" !== o.type && "metric_degree" !== o.type && "metric_in_degree" !== o.type && "metric_out_degree" !== o.type && "metric_weighted_degree" !== o.type && "metric_weighted_in_degree" !== o.type && "metric_weighted_out_degree" !== o.type && "neutral" !== o.type && ("metric_betweenness" !== o.type ? (n[t].min = 9999999, n[t].max = -9999999, e.forEachNode((function(e) {
                                var o;
                                if (e && (o = e.data.getNodeData()), o && o.type_id === t) {
                                    if (r = o.properties[n[t].type], isNaN(r)) return;
                                    (r = parseFloat(r)) < n[t].min && (n[t].min = r), r > n[t].max && (n[t].max = r)
                                }
                            })), e.forEachNode((function(e) {
                                var n;
                                e && (n = e.data.getNodeData()), n && n.type_id === t && (e.data.node_size = u(e))
                            }))) : d(e))
                        },
                        updateForMetrics: function(e, t) {
                            var r, o = !1,
                                a = !1,
                                i = !1,
                                p = !1;
                            for (r in n)
                                if (Object.prototype.hasOwnProperty.call(n, r)) switch (n[r].type) {
                                    case "metric_betweenness":
                                        o = !0;
                                        break;
                                    case "metric_weighted_degree":
                                        a = !0;
                                        break;
                                    case "metric_weighted_in_degree":
                                        i = !0;
                                        break;
                                    case "metric_weighted_out_degree":
                                        p = !0
                                }
                            o && d(e), a && s(e), i && c(e), p && l(e), t && e.forEachNode((function(e) {
                                e.data.node_size = u(e), e.data.uiUpdate()
                            }))
                        }
                    }
                },
                A = function() {
                    var e = !0,
                        t = 9999999999,
                        n = -9999999999;

                    function r(r) {
                        var o = r.getEdgeData(),
                            a = o.weight ? o.weight : 1;
                        return e ? a - t + 1 : Math.floor((a - t) / (n - t) * 10) + 1
                    }
                    return {
                        calculate: function(o, a) {
                            a && (t = 9999999999, n = -9999999999), o.forEachLink((function(e) {
                                if (e) {
                                    var r = e.data.getEdgeData(),
                                        o = Number(r.weight) || 1;
                                    o < t && (t = o), o > n && (n = o)
                                }
                            })), e = !(n - t > 10), a ? o.forEachLink((function(e) {
                                e && (e.data.updateWeight(r(e.data)), e.data.uiUpdate())
                            })) : o.forEachLink((function(e) {
                                e.data.updateWeight(r(e.data))
                            }))
                        },
                        getValueFor: function(e) {
                            var t = e.getWeight();
                            return void 0 !== t ? t : 1
                        },
                        addNewValue: function(o, a) {
                            var i = o.getEdgeData(),
                                s = i.weight ? i.weight : 1,
                                c = !1;
                            parseInt(s) < t && (t = parseInt(s), c = !0), parseInt(s) > n && (n = parseInt(s), c = !0), e = !(n - t > 10), c ? a.forEachLink((function(e) {
                                e && (e.data.updateWeight(r(e.data)), e.data.uiUpdate())
                            })) : (o.updateWeight(r(o)), o.uiUpdate())
                        }
                    }
                },
                D = function(e, t, n) {
                    var r = e.GraphHistory,
                        o = n.map,
                        a = n.canvas,
                        i = n.graph,
                        s = n.svgGraphics,
                        c = n.layout,
                        l = n.renderer,
                        d = n.linkMaps,
                        u = null,
                        p = null,
                        f = [],
                        h = {},
                        g = !1,
                        m = function(e) {
                            var t = s.getSvgRoot().firstChild.getCTM();
                            h = {
                                x: (e.clientX - o.parentNode.offsetLeft - t.e) / t.a - u.data.ui.position.x,
                                y: (e.clientY - o.parentNode.offsetTop - t.f) / t.a - u.data.ui.position.y
                            };
                            var n = Math.sqrt(Math.pow(h.x, 2) + Math.pow(h.y, 2)),
                                r = (n - 2) / n;
                            h.x = h.x * r, h.y = h.y * r, p.attr("d", "M0,0L" + h.x + "," + h.y)
                        };
                    return this.startSelection = function(e) {
                        g = false, u = e, f = [], p = T.a.Graph.svg("path").attr("stroke", "#333").attr("stroke-dasharray", "5, 5").attr("stroke-width", 1).attr("marker-end", "url(#Triangle)").attr("d", "M0,0L0,0"), Object(y.h)(s.getSvgRoot(), "linking-mode"), u.data.setLinkSource(!0), u.data.highlightNode(), u.data.ui.appendChild(p), window.addEventListener("mousemove", m, !1), c.pinNode(u, !0), l.pause(), y.Y.on("shift", "connect_helper", (function() {
                            p.attr("stroke-width", 2)
                        }), (function() {
                            p.attr("stroke-width", 1)
                        })), r.isOnboardEnabled() && r.triggerOnboardAction("connecting_src_node_clicked", {
                            target: s.getNodeUI(u.id)
                        })
                    }, this.addToSelection = function(e) {
                        var n, o = f.indexOf(e);
                        if (o < 0) {
                            if (e.id === u.data.id) return;
                            f.push(e), c.pinNode(e, !0), e.data.setLinkTarget(!0), i.addLink(u.id, e.id, new t.TempCanvasEdge({
                                temp: !0
                            })), l.rerender()
                        } else {
                            for (f.splice(o, 1), e.data.setLinkTarget(!1), n = u.links.length - 1; n >= 0; n -= 1)
                                if (u.links[n].data.temp && (u.links[n].fromId === e.id || u.links[n].toId === e.id)) {
                                    d.removeLink(u.links[n]), i.removeLink(u.links[n]);
                                    break
                                }
                            e.data.is_locked || c.pinNode(e, !1), l.rerender()
                        }
                        r.isOnboardEnabled() && r.triggerOnboardAction("connecting_shift_clicked")
                    }, this.isActive = function() {
                        return null !== u
                    }, this.hasSelectedNodes = function() {
                        return f.length > 0
                    }, this.clearSelection = function() {
                        var e;
                        if (r.isOnboardEnabled() && r.triggerOnboardAction("cancelled"), u) {
                            for (Object(y.nb)(s.getSvgRoot(), "linking-mode"), u.data.setLinkSource(!1), e = 0; e < f.length; e += 1) f[e].data.setLinkTarget(!1), f[e].data.is_locked || c.pinNode(f[e], !1), f[e].data.dehighlight();
                            for (g || (p && p.parentNode && p.parentNode.removeChild(p), window.removeEventListener("mousemove", m, !1), y.Y.off("shift", "connect_helper")), e = u.links.length - 1; e >= 0; e -= 1) u.links[e].data.temp && (d.removeLink(u.links[e]), i.removeLink(u.links[e]));
                            u.data.dehighlight(), u.data.is_locked || c.pinNode(u, !1), p = null, u = null, f = [], a.getForcePaused() || l.resume()
                        }
                    }, this.addFinalNode = function(e, t, n) {
                        var r = f.indexOf(e) > -1;
                        if (e.id !== u.data.id && (r || this.addToSelection(e, t, n), !(f.length < 1))) {
                            var o = {
                                source: u,
                                target: f
                            };
                            return g || (p.parentNode && p.parentNode.removeChild(p), p = null, window.removeEventListener("mousemove", m, !1), y.Y.off("shift", "connect_helper")), o
                        }
                    }, this.checkIfStartNode = function(e) {
                        return e.id === u.id
                    }, this
                },
                M = function(e, t, n, r) {
                    var o = e.GraphHistory,
                        a = e.uiStore,
                        i = null,
                        c = function() {
                            i = setTimeout((function() {
                                h && (h.parentNode.removeChild(h), h = null)
                            }), 500)
                        },
                        l = function() {
                            h && (h.parentNode.removeChild(h), h = null)
                        },
                        d = o.getNodeById(t.data.id),
                        p = {
                            id: d.id,
                            name: d.name,
                            type: d.type,
                            typeFirstChar: d.type.charAt(0).toUpperCase(),
                            image: d.image,
                            color: t.nodeType.color,
                            description: d.description,
                            location: [d.properties.city, d.properties.state_code, d.properties.country_code].filter((function(e) {
                                return e && "" !== e.trim()
                            })).join(", "),
                            show_explore: (a.get("editMode") === u.a.EDIT || a.get("editMode") === u.a.EXPLORE) && d.total_edges > d.edges.length
                        };
                    p.description && p.description.length > 100 && (p.description = p.description.substring(0, 100) + "...", p.has_more = !0), t.nodeType.secondary_display_name && d.properties && d.properties[t.nodeType.secondary_display_name] && (p.secondary_display_name = d.properties[t.nodeType.secondary_display_name]);
                    var f = s.a["graphs/node_hover_card"](p);
                    document.body.appendChild(f.trim().toDOM());
                    var h = document.body.lastElementChild,
                        g = t.getUIBounds(),
                        m = Object(y.I)(),
                        b = h.getBoundingClientRect();
                    b.height + (g.bottom + 8) > m.y ? h.style.bottom = m.y - (g.top - 8) + "px" : h.style.top = g.bottom + 8 + "px", b.width + g.left > m.x ? h.style.right = "8px" : h.style.left = Math.floor(g.left) + "px";
                    var v = h.querySelector("#btnExpand");
                    (v && v.addEventListener("click", (function(e) {
                        e.preventDefault(), l(), "function" === typeof n && n()
                    })), h.addEventListener("mouseover", (function() {
                        clearTimeout(i)
                    })), h.addEventListener("mouseout", (function() {
                        c()
                    })), p.has_more) && h.querySelector("#btnSelectNode").addEventListener("click", (function(e) {
                        return e.preventDefault(), l(), r && r(), !1
                    }));
                    return {
                        destroy: l,
                        scheduleDestroy: c
                    }
                },
                q = window.GraphCommons.View.GroupCanvasNodeIconPath,
                I = window.GraphCommons.View.MissingNodeIconPath,
                R = function(e, t) {
                    var n = e.uiStore,
                        r = e.graphStore,
                        o = e.GraphHistory,
                        a = e.dispatcher,
                        i = "#FFFFFF",
                        s = function(e) {
                            return k()(e).darken(10).toString()
                        },
                        c = function(e) {
                            var t = e / 9,
                                n = Math.PI / 6;
                            return ["matrix(", t, ", 0, 0, ", t, ", ", (1 - e) * Math.cos(n), ", ", (1 - e) * Math.sin(n), ")"].join("")
                        },
                        d = this,
                        p = t.canvas,
                        f = t.graph,
                        h = t.svgGraphics,
                        g = t.layout,
                        m = t.renderer,
                        b = t._connectHelper,
                        v = function(e) {
                            this.data = e, this.id = e.id
                        };
                    v.HOVER_CARD_WAIT = 1200, v.prototype.getNodeData = function() {
                        return this.data
                    }, v.prototype.uiInit = function(e, t) {
                        this.vivaParent = e, this.is_locked && g.pinNode(e, !0);
                        var n = this.uiDOMInit(t);
                        return this.ui = n.ui, this.body = n.body, this.uiText = n.uiText, this.uiBodyText = n.uiBodyText, this.lockNode(this.data.is_locked), this.uiActionInit(), this.ui
                    }, v.prototype.buildNodeName = function(e) {
                        var t = !e && !r.get("layoutNodeFullname"),
                            n = o.nodeDisplayName(this.id);
                        return t && n.length > 12 ? [n.substring(0, 9), "..."].join("") : n
                    }, v.prototype.buildSecondaryNodeName = function(e) {
                        var t = !e && !r.get("layoutNodeFullname"),
                            n = o.nodeSecondaryDisplayName(this.id);
                        return t && n.length > 12 ? [n.substring(0, 9), "..."].join("") : n
                    }, v.prototype.lockNode = function(e) {
                        if (this.is_locked = e, g.pinNode(this.vivaParent, e), n.get("readOnly")) this.disable_drag = e;
                        else if (e) {
                            var t = p.getNodeSizeInterpolator().getValueFor(this.vivaParent);
                            this.uiLocked || (this.uiLocked = this.ui.append("circle").attr("fill", i), this.uiLocked.style.pointerEvents = "none"), this.uiLocked.attr("r", t / 4)
                        } else this.uiLocked && (this.uiLocked.parentNode.removeChild(this.uiLocked), this.uiLocked = null)
                    }, v.prototype.uiDOMInit = function() {};
                    var _ = function(e) {
                        var t, n = e.ui,
                            r = e.onClick,
                            o = e.onDoubleClick,
                            a = {};
                        n.addEventListener("mousedown", (function(e) {
                            a.x = e.clientX, a.y = e.clientY
                        })), n.addEventListener("click", (function(e) {
                            e.preventDefault(), e.clientX === a.x && e.clientY === a.y && (b.isActive() ? r(e) : null == t ? t = setTimeout((function() {
                                t = null, r(e)
                            }), 200) : (clearTimeout(t), t = null, o(e)), e.stopPropagation())
                        }))
                    };
                    v.prototype.uiActionInit = function() {
                        _({
                            ui: this.body,
                            onClick: this.onClick.bind(this),
                            onDoubleClick: this.onDoubleClick.bind(this)
                        }), this.body.addEventListener("mouseover", this.onMouseOver.bind(this)), this.body.addEventListener("mouseout", this.onMouseOut.bind(this)), this.uiExpand && (_({
                            ui: this.uiExpand,
                            onClick: this.onExpandClick.bind(this),
                            onDoubleClick: this.onExpandDoubleClick.bind(this)
                        }), this.uiExpand.addEventListener("mouseover", this.onMouseOver.bind(this)), this.uiExpand.addEventListener("mouseout", this.onMouseOut.bind(this)), this.uiExpand.addEventListener("mouseover", (function() {
                            p.setHoveredExpandButton({
                                id: this.id
                            })
                        })), this.uiExpand.addEventListener("mouseout", (function() {
                            p.setHoveredExpandButton(null)
                        })))
                    }, v.prototype.onDoubleClick = function() {}, v.prototype.onClick = function() {}, v.prototype.onExpandClick = function() {}, v.prototype.onExpandDoubleClick = function() {}, v.prototype.onMouseOver = function(e) {
                        var t, r;
                        if (p.setHoveredNode({
                                id: this.id
                            }), n.get("editMode") !== u.a.VIEW && (b.isActive() || m.pause(), (e.ctrlKey || e.metaKey) && (document.body.style.cursor = "cell")), b.isActive()) this.linkSource || this.linkTarget || (this.setPotentialLinkTarget(!0), this.highlightNode());
                        else if (this.waitingForLongMouseOver = !0, setTimeout(this.handleLongMouseOver.bind(this), v.HOVER_CARD_WAIT), Object(y.h)(h.getSvgRoot(), "peek-mode"), !this.peeked)
                            for (Object(y.h)(this.ui, "peeked"), this.peeked = !0, t = 0; t < this.vivaParent.links.length; t += 1) {
                                if (r = this.vivaParent.links[t], Object(y.N)(r.data.ui, "peeked") || (Object(y.h)(r.data.ui, "peeked"), Object(y.h)(r.data.text_ui.text, "peeked"), r.data.ui.setAttribute("stroke-width", Math.max(1, p.getWeightInterpolator().getValueFor(r.data) + 1))), r.toId !== this.data.id) {
                                    var o = f.getNode(r.toId);
                                    Object(y.h)(o.data.ui, "peeked")
                                } else {
                                    var a = f.getNode(r.fromId);
                                    Object(y.h)(a.data.ui, "peeked")
                                }
                                h.renderLink(r.id)
                            }
                        this.nodeType.secondary_display_name || this.uiText.text(this.buildNodeName(!0)), this.show_text_on_hover && this.uiShowText()
                    }, v.prototype.handleLongMouseOver = function() {
                        this.waitingForLongMouseOver && (this.uiHoverCard && this.uiHoverCard.destroy(), this.uiHoverCard = M(e, this, function() {
                            a.emit("openExpandPanel", {
                                nodes: [this.data],
                                position: g.getNodePosition(this.id)
                            })
                        }.bind(this), function() {
                            o.clearSelectedNodes(), o.addToSelectedNodes(this.data.id)
                        }.bind(this)))
                    }, v.prototype.clearHoverCard = function() {
                        this.waitingForLongMouseOver = !1, this.uiHoverCard && this.uiHoverCard.scheduleDestroy()
                    }, v.prototype.onMouseOut = function() {
                        if (this.clearHoverCard(), p.setHoveredNode(null), n.get("editMode") === u.a.VIEW || b.isActive() || p.getForcePaused() || m.resume(), b.isActive() && (this.linkSource || this.linkTarget || (this.setPotentialLinkTarget(!1), this.dehighlight())), this.peeked) {
                            var e, t;
                            for (Object(y.nb)(this.ui, "peeked"), this.peeked = !1, e = 0; e < this.vivaParent.links.length; e += 1) {
                                t = this.vivaParent.links[e], Object(y.N)(t.data.ui, "peeked") && (Object(y.nb)(t.data.ui, "peeked"), Object(y.nb)(t.data.text_ui.text, "peeked")), Object(y.N)(t.data.ui, "selected-edge") || Object(y.N)(t.data.ui, "highlighted") || t.data.ui.setAttribute("stroke-width", Math.max(1, p.getWeightInterpolator().getValueFor(t.data)));
                                var r = t.toId !== this.data.id ? t.toId : t.fromId,
                                    a = f.getNode(r);
                                Object(y.nb)(a.data.ui, "peeked"), h.renderLink(t.id)
                            }
                            0 === p.getSelectedNodes().length && 0 === o.getSelectedEdges().length && Object(y.nb)(h.getSvgRoot(), "peek-mode")
                        }
                        this.nodeType.secondary_display_name || this.uiText.text(this.buildNodeName()), this.show_text_on_hover && this.uiHideText()
                    }, v.prototype.onLongPress = function() {
                        var e = p.getSelectedNodes();
                        switch (n.get("editMode")) {
                            case u.a.VIEW:
                            case u.a.DELETE:
                                e.indexOf(this.data.id) < 0 ? o.addToSelectedNodes(this.data.id) : o.removeFromSelectedNodes(this.data.id);
                                break;
                            case u.a.EDIT:
                                b.isActive() ? b.addToSelection(this.vivaParent) : e.indexOf(this.data.id) < 0 ? o.addToSelectedNodes(this.data.id) : o.removeFromSelectedNodes(this.data.id, d)
                        }
                    }, v.prototype.unmute = function() {
                        Object(y.h)(this.ui, "highlighted"), Object(y.nb)(this.ui, "peeked")
                    }, v.prototype.highlightNode = function(e, t) {
                        var n, r, o = this.body;
                        if (o ? (Object(y.h)(o, "selected"), o.setAttribute("stroke", this.data.color), o.setAttribute("fill", "white")) : (o = this.ui.querySelector("image")) && (Object(y.h)(o, "selected"), o.setAttribute("stroke", this.data.color)), Object(y.h)(this.ui, "selected"), Object(y.nb)(this.ui, "peeked"), this.peeked = !1, !e)
                            for (n = 0; n < this.vivaParent.links.length; n += 1) {
                                var a = (r = this.vivaParent.links[n]).toId !== this.vivaParent.id ? r.toId : r.fromId,
                                    i = f.getNode(a);
                                t && !i.data.selected || (Object(y.N)(r.data.ui, "highlighted") || Object(y.N)(r.data.ui, "peeked") || r.data.ui.setAttribute("stroke-width", Math.max(1, p.getWeightInterpolator().getValueFor(r.data)) + 1), Object(y.h)(r.data.ui, "highlighted"), Object(y.nb)(r.data.ui, "peeked"), Object(y.h)(r.data.text_ui.text, "highlighted"), Object(y.nb)(r.data.text_ui.text, "peeked"), Object(y.h)(i.data.ui, "highlighted"), Object(y.nb)(i.data.ui, "peeked"))
                            }
                    }, v.prototype.isLinkedWithASelectedNode = function() {
                        var e, t, n, r = p.getSelectedNodes();
                        if (r.length < 1) return !1;
                        for (e = 0; e < this.vivaParent.links.length; e += 1) {
                            var o = this.vivaParent.links[e];
                            for (n = o.toId !== this.data.id ? o.toId : o.fromId, t = 0; t < r.length; t += 1)
                                if (r[t] === n) return !0
                        }
                        return !1
                    }, v.prototype.dehighlight = function(e, t) {
                        switch (this.uiBodyType) {
                            case "image":
                                Object(y.nb)(this.body, "selected"), this.body.setAttribute("stroke", "white");
                                break;
                            case "circle":
                            default:
                                this.body.setAttribute("fill", this.data.color), this.body.setAttribute("stroke", i), Object(y.nb)(this.body, "selected")
                        }
                        if (Object(y.nb)(this.ui, "selected"), this.isLinkedWithASelectedNode() && !e || (Object(y.nb)(this.ui, "highlighted"), Object(y.nb)(this.ui, "peeked")), !t) {
                            var n, r, o, a, s = p.getSelectedNodes();
                            for (n = 0; n < this.vivaParent.links.length; n += 1)
                                if (r = (a = this.vivaParent.links[n]).toId !== this.data.id ? a.toId : a.fromId, !(s.indexOf(r) >= 0) || e) {
                                    o = f.getNode(r);
                                    var c = a.data.ui,
                                        l = void 0;
                                    if (a.data.temp || (l = a.data.text_ui.text), !c) continue;
                                    (Object(y.N)(c, "highlighted") || Object(y.N)(c, "peeked")) && c.setAttribute("stroke-width", Math.max(1, p.getWeightInterpolator().getValueFor(a.data))), Object(y.nb)(c, "highlighted"), Object(y.nb)(c, "peeked"), l && (Object(y.nb)(l, "highlighted"), Object(y.nb)(l, "peeked")), o.data.isLinkedWithASelectedNode() && !e || (Object(y.nb)(o.data.ui, "highlighted"), Object(y.nb)(o.data.ui, "peeked"))
                                }
                        }
                    }, v.prototype.uiUpdate = function() {}, v.prototype.uiUpdateText = function() {}, v.prototype.uiShowText = function() {
                        this.uiText.attr("display", "block")
                    }, v.prototype.uiHideText = function() {
                        this.uiText.attr("display", "none")
                    }, v.prototype.delete = function() {
                        var e, t = this.vivaParent.links;
                        for (e = t.length - 1; e >= 0; e -= 1) t[e].data.delete(!0);
                        f.removeNode(this.id)
                    }, v.prototype.setLinkSource = function(e) {
                        this.linkSource = e, e ? Object(y.h)(this.ui, "link-source") : Object(y.nb)(this.ui, "link-source")
                    }, v.prototype.setLinkTarget = function(e) {
                        this.linkTarget = e, e ? Object(y.h)(this.ui, "link-target") : Object(y.nb)(this.ui, "link-target")
                    }, v.prototype.setPotentialLinkTarget = function(e) {
                        this.potentialLinkTarget = e, e ? Object(y.h)(this.ui, "potential-link-target") : Object(y.nb)(this.ui, "potential-link-target")
                    }, v.prototype.getUIBounds = function() {
                        return this.ui.getBoundingClientRect()
                    };
                    var w = function(e) {
                        v.call(this, e)
                    };
                    (w.prototype = Object.create(v.prototype)).constructor = w, w.prototype.uiDOMInit = function() {
                        var e = p.getNodeSizeInterpolator().getValueFor(this.vivaParent),
                            t = h.getNodeUI(this.data.id);
                        if (t)
                            for (; t.firstChild;) t.removeChild(t.firstChild);
                        else t = T.a.Graph.svg("g");
                        var n = t.append("circle").attr("r", e).attr("fill", this.data.color).attr("stroke", i).attr("stroke-width", .2 * e).attr("class", "central");
                        this.uiCircleBody = !0;
                        var r = t.append("image").attr("transform", ["translate(", -.5 * e, ",", -.5 * e, ")"].join("")).attr("width", e).attr("height", e).link(q);
                        this.uiExpand = r;
                        var o = t.append("text");
                        return o.attr("x", 1.4 * e).attr("dominant-baseline", "central").attr("font-size", Math.floor(2.4 * e)).text(this.buildNodeName()).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", this.data.color), {
                            ui: t,
                            body: n,
                            uiText: o
                        }
                    }, w.prototype.uiUpdate = function() {
                        var e = p.getNodeSizeInterpolator().getValueFor(this.vivaParent);
                        this.body.attr("r", e).attr("fill", this.data.color).attr("stroke", i).attr("stroke-width", .2 * e).attr("class", "central"), this.uiExpand.attr("transform", ["translate(", -.5 * e, ",", -.5 * e, ")"].join("")).attr("width", e).attr("height", e), this.uiUpdateText(e)
                    }, w.prototype.uiUpdateText = function(e) {
                        e || (e = p.getNodeSizeInterpolator().getValueFor(this.vivaParent)), this.uiText.attr("x", 1.4 * e).attr("dominant-baseline", "central").attr("font-size", Math.floor(2.4 * e)).text(this.buildNodeName()).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", this.data.color)
                    }, w.prototype.buildNodeName = function() {
                        return [this.data.count, this.data.name].join(" ")
                    }, w.prototype.onClick = function(e) {
                        (e = e || {}).shiftKey && (n.get("readOnly") || p.updateNodeType(this.data.id))
                    }, w.prototype.onDoubleClick = function() {
                        p.reinsertNodes(this.data.id)
                    }, w.prototype.onExpandDoubleClick = function(e) {
                        this.onDoubleClick(e)
                    }, w.prototype.onExpandClick = function(e) {
                        this.onClick(e)
                    }, w.prototype.updateNodeType = function(e) {
                        var t = !1;
                        return e.id === this.data.id && (e.name && (this.data.name = e.name, t = !0), e.color && (this.data.color = e.color, t = !0)), t
                    };
                    var O = function(e) {
                        v.call(this, e), this.nodeType = o.getNodeTypeById(e.type_id)
                    };
                    (O.prototype = Object.create(v.prototype)).constructor = O, O.prototype.uiDOMInit = function(e) {
                        var t, r = p.getNodeSizeInterpolator().getValueFor(this.vivaParent),
                            a = this.ui;
                        if (a)
                            for (; a.firstChild;) a.removeChild(a.firstChild);
                        else a = T.a.Graph.svg("g");
                        this.nodeType.image_as_icon && this.data.image && !e ? (this.uiCircleBody = !1, t = a.append("image").attr("x", -1 * r).attr("y", -1 * r).attr("width", 2 * r).attr("height", 2 * r).link(this.data.image).attr("stroke", i).attr("stroke-width", .2 * r).attr("class", "central").on("error", (function() {
                            this.IMAGE_FALLBACKED || (this.link(I), this.IMAGE_FALLBACKED = !0)
                        }))) : (this.uiCircleBody = !0, t = a.append("circle").attr("r", r).attr("fill", this.data.color).attr("stroke", i).attr("stroke-width", .2 * r).attr("class", "central"));
                        var l = this.uiInitText(a, r);
                        this.nodeType.hide_name || !p.getForceDisplaySmallNodeNames() && r * p.getCurrentZoom() < 4 ? l.attr("display", "none") : l.attr("display", "block");
                        var d = this.uiInitCenterNodeText(a, r),
                            f = a.append("path");
                        return f.attr("d", "M1.28571429,1.28571429 L1.28571429,5 L-1.28571429,5 L-1.28571429,1.28571429 L-5,1.28571429 L-5,-1.28571429 L-1.28571429,-1.28571429 L-1.28571429,-3.2305603 L-1.28571429,-5 L1.28571429,-5 L1.28571429,-1.28571429 L5,-1.28571429 L5,1.28571429 L1.28571429,1.28571429 Z").attr("fill", i).attr("stroke", s(this.data.color)).attr("transform", c(r)), f.attr("class", "expand-node"), (n.get("editMode") === u.a.EDIT || n.get("editMode") === u.a.EXPLORE) && o.getNodeById(this.data.id).total_edges >= this.vivaParent.links.length && Object(y.h)(f, "not-shown"), this.uiExpand = f, {
                            ui: a,
                            body: t,
                            uiText: l,
                            uiBodyText: d
                        }
                    }, O.prototype.uiInitCenterNodeText = function(e, t) {
                        if (this.nodeType.centered_display_name || this.nodeType.centered_secondary_display_name) {
                            var n = 1.8 * t,
                                r = e.append("text");
                            r.attr("x", 0).attr("dominant-baseline", "auto").attr("text-anchor", "middle").attr("font-size", n).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", "#FFF");
                            var o = r.append("tspan");
                            o.attr("pointer-events", "none"), this.nodeType.centered_display_name && o.attr("x", 0).attr("y", -.5 * n).attr("dominant-baseline", "auto").text(this.data.properties[this.nodeType.centered_display_name]).attr("font-family", "'Apercu Bold Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", "#FFF").attr("pointer-events", "none");
                            var a = r.append("tspan");
                            return a.attr("pointer-events", "none"), this.nodeType.centered_secondary_display_name && a.attr("x", 0).attr("y", .5 * n).attr("dominant-baseline", "auto").text(this.data.properties[this.nodeType.centered_secondary_display_name]).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", "#FFF"), r
                        }
                    }, O.prototype.uiInitText = function(e, t) {
                        if (this.nodeType.secondary_display_name) {
                            var n = Math.floor(2.4 * t),
                                r = e.append("text");
                            return r.attr("x", 1.4 * t).attr("dominant-baseline", "central").attr("font-size", n).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", this.data.color), r.append("tspan").attr("x", 1.4 * t).attr("dominant-baseline", "central").attr("font-size", n).text(this.buildNodeName()).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", this.data.color), r.append("tspan").attr("x", 1.4 * t).attr("dy", .75 * n).attr("dominant-baseline", "central").attr("font-size", .75 * n).text(this.buildSecondaryNodeName()).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", "#CCC"), r
                        }
                        var o = e.append("text");
                        return o.attr("x", 1.4 * t).attr("dominant-baseline", "central").attr("font-size", Math.floor(2.4 * t)).text(this.buildNodeName()).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("fill", this.data.color), o
                    }, O.prototype.uiUpdateCenterNodeText = function(e) {
                        if (this.uiBodyText) {
                            var t = .3 * e;
                            t * p.getCurrentZoom() < 4 ? this.uiBodyText.attr("display", "none") : this.uiBodyText.attr("display", "block");
                            var n = this.uiBodyText.childNodes[0];
                            n && (n.attr("y", -.5 * t), n.attr("font-size", t), this.nodeType.centered_display_name && n.text(this.data.properties[this.nodeType.centered_display_name]));
                            var r = this.uiBodyText.childNodes[1];
                            r && (r.attr("y", t), r.attr("font-size", t), this.nodeType.centered_secondary_display_name && r.text(this.data.properties[this.nodeType.centered_secondary_display_name]))
                        }
                    }, O.prototype.uiUpdateText = function(e) {
                        this.show_text_on_hover = !1, void 0 === e && (e = p.getNodeSizeInterpolator().getValueFor(this.vivaParent));
                        var t = Math.floor(2.4 * e),
                            n = 1.4 * e;
                        this.nodeType.hide_name || (this.nodeType.secondary_display_name ? (this.uiText.attr("x", n).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif"), this.uiText.childNodes[0].attr("x", n).text(this.buildNodeName()).attr("font-size", t), this.uiText.childNodes[1].attr("x", n).attr("dy", .75 * t).text(this.buildSecondaryNodeName()).attr("font-size", .75 * t)) : this.uiText.text(this.buildNodeName()).attr("x", n).attr("font-size", t).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("fill", this.data.color));
                        this.nodeType.hide_name || !p.getForceDisplaySmallNodeNames() && e * p.getCurrentZoom() < 4 ? (this.nodeType.hide_name || (this.show_text_on_hover = !0), this.uiHideText()) : this.uiShowText(), this.uiUpdateCenterNodeText(e)
                    }, O.prototype.uiUpdate = function() {
                        var e = p.getNodeSizeInterpolator().getValueFor(this.vivaParent);
                        if (this.nodeType.image_as_icon && this.data.image ? (this.uiCircleBody && this.uiInit(this.vivaParent), this.body.attr("x", -1 * e).attr("y", -1 * e).attr("width", 2 * e).attr("height", 2 * e).attr("stroke-width", .2 * e).link(this.data.image)) : (this.uiCircleBody || this.uiInit(this.vivaParent), this.body.attr("r", e), this.body.attr("stroke-width", .2 * e), Object(y.N)(this.body, "selected") ? (this.body.attr("stroke", this.data.color), this.body.attr("fill", "white")) : (this.body.attr("fill", this.data.color), this.body.attr("stroke", i))), !n.get("readOnly") && this.is_locked && this.uiLocked && (n.get("editMode") === u.a.EDIT ? this.uiLocked.attr("visibility", "visible") : this.uiLocked.attr("visibility", "hidden")), this.uiUpdateText(e), this.uiExpand) {
                            this.uiExpand.attr("stroke", s(this.data.color)).attr("transform", c(e));
                            var t = o.getNodeById(this.data.id);
                            if (!t) return;
                            (n.get("editMode") === u.a.EDIT || n.get("editMode") === u.a.EXPLORE) && t.total_edges > this.vivaParent.links.length ? Object(y.nb)(this.uiExpand, "not-shown") : Object(y.h)(this.uiExpand, "not-shown")
                        }
                    }, O.prototype.handleClickInEditMode = function(t) {
                        var r = t.shiftKey,
                            a = t.ctrlKey || t.metaKey,
                            i = p.getSelectedNodes(),
                            s = o.getSelectedEdges();
                        if (b.isActive())
                            if (r) b.addToSelection(this.vivaParent);
                            else if (b.checkIfStartNode(this.vivaParent) && !b.hasSelectedNodes()) b.clearSelection(), this.onDoubleClick();
                        else {
                            var c = b.addFinalNode(this.vivaParent);
                            p.finalizeLinking(c)
                        } else r ? i.indexOf(this.data.id) < 0 ? Object(l.editNodePanel)(e, this.data.id) : o.removeFromSelectedNodes(this.data.id) : a ? n.get("isOnlyExploreAllowed") ? this.data.id !== p.getLastClickedNode() ? (o.clearSelectedNodes(), Object(y.h)(h.getSvgRoot(), "peek-mode"), o.addToSelectedNodes(this.data.id)) : this.onDoubleClick() : (o.clearSelectedNodes(), b.startSelection(this.vivaParent)) : ((i.length > 0 || s.length > 0) && o.clearSelectedNodes(), o.addToSelectedNodes(this.data.id)), p.setLastClickedNode(this.data.id)
                    }, O.prototype.handleClickInViewMode = function(e) {
                        var t = p.getSelectedNodes(),
                            n = o.getSelectedEdges();
                        e.shiftKey ? t.indexOf(this.data.id) < 0 ? o.addToSelectedNodes(this.data.id) : o.removeFromSelectedNodes(this.data.id) : ((t.length > 0 || n.length > 0) && o.clearSelectedNodes(), o.addToSelectedNodes(this.data.id)), p.refreshCursor()
                    }, O.prototype.handleClickInDeleteMode = function(e) {
                        e.shiftKey ? o.addToSelectedNodes(this.data.id) : (o.addToSelectedNodes(this.data.id), p.deleteSelectedNodesAndEdges())
                    }, O.prototype.onClick = function(e) {
                        switch (this.clearHoverCard(), n.get("hasListenerFocus", p) && o.requestFocus(p), e = e || {}, n.get("editMode")) {
                            case u.a.EDIT:
                                this.handleClickInEditMode(e);
                                break;
                            case u.a.VIEW:
                                this.handleClickInViewMode(e);
                                break;
                            case u.a.DELETE:
                                this.handleClickInDeleteMode(e)
                        }
                    }, O.prototype.onDoubleClick = function() {
                        this.clearHoverCard(), (n.get("editMode") === u.a.EDIT || n.get("editMode") === u.a.EXPLORE) && o.getNodeById(this.data.id).total_edges > this.vivaParent.links.length && a.emit("openExpandPanel", {
                            nodes: [this.data],
                            position: g.getNodePosition(this.id)
                        })
                    }, O.prototype.onExpandClick = function(e) {
                        this.onDoubleClick(e)
                    }, O.prototype.delete = function() {
                        v.prototype.delete.call(this), p.getWeightInterpolator().calculate(f, !0), p.getNodeSizeInterpolator().calculate(f, o.getNodeTypes(), !0)
                    }, O.prototype.updateNodeType = function(e) {
                        var t = !1;
                        if (e.id === this.data.type_id) {
                            if (this.data.properties = this.data.properties || {}, Array.isArray(e.properties))
                                for (var n = 0; n < e.properties.length; n += 1) {
                                    var r = e.prev.properties[n].name,
                                        o = e.prev.properties[n].name_alias;
                                    (r || o) && Object.prototype.hasOwnProperty.call(this.data.properties, e.prev.properties[n].name) && (this.data.properties[e.properties[n].name] = this.data.properties[e.prev.properties[n].name], delete this.data.properties[e.prev.properties[n].name])
                                }
                            e.color && (this.data.color = e.color, t = !0)
                        }
                        return t
                    };
                    var E = function(e) {
                        v.call(this, e)
                    };
                    return (E.prototype = Object.create(v.prototype)).constructor = E, E.prototype.uiDOMInit = function() {
                        var e = 36 + Math.round(this.data.nodes.length / 8),
                            t = T.a.Graph.svg("g"),
                            n = t.append("text"),
                            o = Math.floor(e * r.get("clusterLabelNameSizeFactor")),
                            a = s(this.data.color);
                        return n.attr("x", 0).attr("font-family", "'Apercu Bold Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("stroke-width", "3px").attr("stroke", "#FFF").attr("fill", a).attr("dominant-baseline", "central").attr("font-size", o), Object(y.i)(this.data.name.toUpperCase(), 10).forEach((function(e, t) {
                            n.append("tspan").attr("x", 0).attr("y", o * t + 25).attr("dominant-baseline", "central").attr("font-size", o).text(e).attr("font-family", "'Apercu Bold Pro', Helvetica, Arial, sans-serif").attr("letter-spacing", "-0.02em").attr("stroke-width", "3px").attr("stroke", "#FFF").attr("fill", a)
                        })), {
                            ui: t,
                            body: t,
                            uiText: n
                        }
                    }, E.prototype.unmute = function() {
                        Object(y.h)(this.ui, "highlighted")
                    }, E.prototype.reset = function() {
                        Object(y.nb)(this.ui, "highlighted"), this.peeked = !1
                    }, E.prototype.onMouseOver = function() {
                        a.emit("onNodesReleased"), p.setHoveredNode({
                            id: this.id,
                            cluster: !0
                        }), this.peeked || (this.peeked = !0, Object(y.h)(h.getSvgRoot(), "peek-mode"), Object(y.h)(this.ui, "highlighted"), this.data.nodes.forEach((function(e) {
                            var t = f.getNode(e);
                            t && (t.data.highlighted = !0, Object(y.h)(t.data.ui, "highlighted"), t.links.forEach((function(t) {
                                var n = t.toId !== e ? t.toId : t.fromId;
                                f.getNode(n).data.highlighted && (Object(y.h)(t.data.ui, "highlighted"), Object(y.h)(t.data.text_ui.text, "highlighted"))
                            })))
                        })))
                    }, E.prototype.onMouseOut = function() {
                        p.setHoveredNode(null), this.peeked && (this.peeked = !1, Object(y.nb)(this.ui, "highlighted"), Object(y.nb)(h.getSvgRoot(), "peek-mode"), this.data.nodes.forEach((function(e) {
                            var t = f.getNode(e);
                            t && (t.data.highlighted = !1, Object(y.nb)(t.data.ui, "highlighted"), t.links.forEach((function(t) {
                                var n = t.toId !== e.id ? t.toId : t.fromId;
                                f.getNode(n).data.highlighted || (Object(y.nb)(t.data.ui, "highlighted"), Object(y.nb)(t.data.text_ui.text, "highlighted"))
                            })))
                        })))
                    }, E.prototype.lockNode = function(e) {
                        this.is_locked = e, g.pinNode(this.vivaParent, e)
                    }, {
                        BaseCanvasNode: v,
                        GroupCanvasNode: w,
                        DefaultCanvasNode: O,
                        ClusterNameCanvasNode: E
                    }
                },
                B = function(e, t) {
                    var n = e.uiStore,
                        r = e.graphStore,
                        o = e.GraphHistory,
                        a = function(e) {
                            return e && "url" === e.substring(0, 3) ? e : k()(e).lighten(15).toString()
                        },
                        i = t.canvas,
                        s = t.graph,
                        c = t.svgGraphics,
                        l = t.renderer,
                        d = t._nodeSizeInterpolator,
                        p = t.linkMaps,
                        f = c.getSvgRoot().querySelector("defs"),
                        h = function(e) {
                            this.data = e, this.id = e.id
                        };
                    h.prototype.getEdgeData = function() {
                        return this.data
                    }, h.prototype.updateWeight = function(e) {
                        this.link_size = e
                    }, h.prototype.getWeight = function() {
                        return this.link_size
                    }, h.prototype.uiInit = function(e) {
                        this.vivaParent = e, p.addLink(this.vivaParent);
                        var t = this.uiDOMInit();
                        return this.ui = t, this.uiActionInit(), this.ui
                    }, h.prototype.buildEdgeName = function() {
                        var e;
                        if (e = this.edgeType.display_name && this.data.properties && "string" === typeof this.data.properties[this.edgeType.display_name] && "" !== this.data.properties[this.edgeType.display_name].trim() ? this.data.properties[this.edgeType.display_name].trim() : this.data.name, r.get("layout").show_edge_weights) {
                            var t = 1;
                            try {
                                t = parseFloat(this.data.weight)
                            } catch (n) {}
                            t % 1 !== 0 && (t = t.toFixed(2)), e += " (" + t + ")"
                        }
                        return e
                    }, h.prototype.uiDOMInit = function() {}, h.prototype.uiActionInit = function() {
                        this.ui.addEventListener("mouseover", this.onMouseOver.bind(this)), this.ui.addEventListener("mouseout", this.onMouseOut.bind(this)), this.ui.addEventListener("mousedown", this.onMouseDown.bind(this))
                    }, h.prototype.onMouseOver = function() {
                        Object(y.N)(this.ui, "selected-edge") || Object(y.N)(this.ui, "peeked") || Object(y.N)(this.ui, "highlighted") || this.ui.setAttribute("stroke-width", Math.max(1, i.getWeightInterpolator().getValueFor(this) + 1))
                    }, h.prototype.onMouseOut = function() {
                        Object(y.N)(this.ui, "selected-edge") || Object(y.N)(this.ui, "peeked") || Object(y.N)(this.ui, "highlighted") || this.ui.setAttribute("stroke-width", Math.max(1, i.getWeightInterpolator().getValueFor(this)))
                    }, h.prototype.onMouseDown = function(e) {
                        e.shiftKey || n.get("editMode") != u.a.DELETE ? i.selectEdge(this.vivaParent) : (i.selectEdge(this.vivaParent), i.deleteSelectedNodesAndEdges())
                    }, h.prototype.select = function() {
                        this.vivaParent.data.selected = !0, Object(y.h)(this.ui, "selected-edge"), Object(y.h)(this.text_ui.text, "selected-edge"), this.text_ui.text.attr("visibility", "visible");
                        var e = Math.max(1, i.getWeightInterpolator().getValueFor(this)) + 1;
                        this.ui.setAttribute("stroke-width", e), this.ui.attr("marker-end", "");
                        var t = i.getSelectedNodes();
                        if (t.indexOf(this.data.to) < 0) {
                            var n = s.getNode(this.data.to);
                            n.data.highlighted = !0, n.data.highlightNode(!0)
                        }
                        if (t.indexOf(this.data.from) < 0) {
                            var r = s.getNode(this.data.from);
                            r.data.highlighted = !0, r.data.highlightNode(!0)
                        }
                        l.rerender()
                    }, h.prototype.unselect = function() {
                        this.vivaParent.data.selected = !1, Object(y.nb)(this.ui, "selected-edge"), Object(y.nb)(this.text_ui.text, "selected-edge"), r.get("layout").always_show_edge_names || this.text_ui.text.attr("visibility", "hidden"), this.ui.setAttribute("stroke", a(this.data.color));
                        var e = Math.max(1, i.getWeightInterpolator().getValueFor(this));
                        this.ui.setAttribute("stroke-width", e), this.edgeType.directed && (this.data.arrowTriangle ? this.ui.attr("marker-end", "url(#" + this.data.arrowTriangle + "_Triangle)") : this.ui.attr("marker-end", "url(#" + this.data.name_id + "_Triangle)"));
                        var t = s.getNode(this.data.from);
                        t.data.selected || (0 === t.links.filter((function(e) {
                            return e.data.selected
                        })).length && (t.data.highlighted = !1, t.data.dehighlight(!1, !0)), t.data.isLinkedWithASelectedNode() && Object(y.h)(t.data.ui, "peeked"));
                        var n = s.getNode(this.data.to);
                        n.data.selected || (0 === n.links.filter((function(e) {
                            return e.data.selected
                        })).length && (n.data.highlighted = !1, n.data.dehighlight(!1, !0)), n.data.isLinkedWithASelectedNode() && Object(y.h)(n.data.ui, "peeked"))
                    }, h.prototype.highlight = function() {}, h.prototype.dehighlight = function() {}, h.prototype.uiUpdate = function() {}, h.prototype.uiUpdateText = function() {}, h.prototype.delete = function(e) {
                        if (this.text_ui.text.parentNode.removeChild(this.text_ui.text), this.text_ui.path.parentNode.removeChild(this.text_ui.path), p.removeLink(this.vivaParent), s.removeLink(this.vivaParent), i.getWeightInterpolator().calculate(s, !0), i.getNodeSizeInterpolator().updateForMetrics(s, !0), !e) {
                            var t = s.getNode(this.data.from);
                            if (!t.data.selected) 0 === t.links.filter((function(e) {
                                return e.data.selected
                            })).length && (t.data.highlighted = !1, t.data.dehighlight(!1, !0));
                            var n = s.getNode(this.data.to);
                            if (!n.data.selected) 0 === n.links.filter((function(e) {
                                return e.data.selected
                            })).length && (n.data.highlighted = !1, n.data.dehighlight(!1, !0));
                            n.data.uiUpdate(), t.data.uiUpdate()
                        }
                    }, h.prototype.placeLink = function(e, t) {
                        this.data.from === this.data.to ? this.placeLoopLink(e, t) : r.get("layout").use_curved_edges ? this.placeDefaultCurveLink(e, t) : this.placeDefaultLink(e, t)
                    }, h.prototype.placeDefaultCurveLink = function(e, t) {
                        var n, o, a = this.vivaParent,
                            c = this.data,
                            l = s.getNode(a.toId),
                            u = s.getNode(a.fromId);
                        n = d.getValueFor(l), o = d.getValueFor(u);
                        var f, h = Math.sqrt(Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)),
                            g = h ? o / h : 0,
                            m = e.x + (t.x - e.x) * g,
                            b = e.y + (t.y - e.y) * g;
                        f = c.isMeta ? c.directed : !c.temp && this.edgeType.directed;
                        var v = h ? (h - n - (f ? .2 * n + 3 : 0)) / h : 0,
                            _ = e.x + (t.x - e.x) * v,
                            w = e.y + (t.y - e.y) * v;
                        if (i.isClusterColorsApplied() && "url" === c.color.substring(0, 3)) {
                            var O = l.data.getNodeData(),
                                E = u.data.getNodeData();
                            c.color = _ < m ? "url(#gradient" + O.color.replace("#", "") + "-" + E.color.replace("#", "") + ")" : "url(#gradient" + E.color.replace("#", "") + "-" + O.color.replace("#", "") + ")", this.ui.attr("stroke", c.color)
                        }
                        var j = p.getSiblings(a).indexOf(a.id),
                            S = (b - w) / (m - _);
                        S = -1 / S;
                        var x = .5 * (m + _),
                            k = .5 * (b + w),
                            C = .2 * h,
                            N = (j % 2 === 0 ? -1 : 1) * (Math.floor(j / 2) * (.75 * C) + 1 * C),
                            T = x + Math.cos(Math.atan(S)) * N,
                            L = k + Math.sin(Math.atan(S)) * N,
                            P = "M" + m + "," + b + " Q" + T + "," + L + " " + _ + "," + w;
                        if (this.ui.attr("d", P), !c.temp) {
                            var A = !1;
                            (r.get("layout").always_show_edge_names || u.data.selected || l.data.selected || a.data.selected) && (A = !0), A || (u.data.peeked || l.data.peeked) && (A = !0), A ? (_ < m && (P = "M" + _ + "," + w + " Q" + T + "," + L + " " + m + "," + b), this.text_ui.path.attr("d", P), this.text_ui.text.attr("visibility", "visible"), this.text_ui.text.attr("fill", c.color), Object(y.nb)(this.text_ui.text, "not-shown")) : (this.text_ui.text.attr("visibility", "hidden"), Object(y.h)(this.text_ui.text, "not-shown"))
                        }
                    }, h.prototype.placeDefaultLink = function(e, t) {
                        var n, o, a = this.vivaParent,
                            c = this.data,
                            l = s.getNode(a.toId),
                            u = s.getNode(a.fromId);
                        n = d.getValueFor(l), o = d.getValueFor(u);
                        var f, h = Math.sqrt(Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)),
                            g = h ? o / h : 0,
                            m = e.x + (t.x - e.x) * g,
                            b = e.y + (t.y - e.y) * g;
                        f = c.isMeta ? c.directed : !c.temp && this.edgeType.directed;
                        var v = h ? (h - n - (f ? .2 * n + 3 : 0)) / h : 0,
                            _ = e.x + (t.x - e.x) * v,
                            w = e.y + (t.y - e.y) * v;
                        if (i.isClusterColorsApplied() && "url" === c.color.substring(0, 3)) {
                            var O = l.data.getNodeData(),
                                E = u.data.getNodeData();
                            c.color = _ < m ? "url(#gradient" + O.color.replace("#", "") + "-" + E.color.replace("#", "") + ")" : "url(#gradient" + E.color.replace("#", "") + "-" + O.color.replace("#", "") + ")", this.ui.attr("stroke", c.color)
                        }
                        var j, S, x, k, C = 0,
                            N = p.getSiblings(a);
                        if (N && N.length > 1 && (C = N.indexOf(a.id), j = N.length % 2 === 1 && C > 0 ? C - 1 : C), N.length % 2 === 1 && 0 === C) k = "M" + m + "," + b + " L" + _ + "," + w;
                        else {
                            S = !0;
                            var T = (b - w) / (m - _);
                            T = -1 / T;
                            var L, P = {
                                    x: .5 * (m + _),
                                    y: .5 * (b + w)
                                },
                                A = .2 * h;
                            L = N.length % 2 !== 0 || 1 !== C && 0 !== C ? (j % 2 === 0 ? -1 : 1) * (Math.floor(j / 2) * (.75 * A) + 1 * A) : 0 === C ? .75 * A : .75 * A * -1;
                            var D = Math.cos(Math.atan(T)) * L,
                                M = Math.sin(Math.atan(T)) * L;
                            k = "M" + m + "," + b + " Q" + (x = {
                                x: P.x + D,
                                y: P.y + M
                            }).x + "," + x.y + " " + _ + "," + w
                        }
                        if (this.ui.attr("d", k), !c.temp) {
                            var q = !1;
                            (r.get("layout").always_show_edge_names || u.data.selected || l.data.selected || a.data.selected) && (q = !0), q || (u.data.peeked || l.data.peeked) && (q = !0), q ? (_ < m && (k = S ? "M" + _ + "," + w + " Q" + x.x + "," + x.y + " " + m + "," + b : "M" + _ + "," + w + "L" + m + "," + b), this.text_ui.path.attr("d", k), this.text_ui.text.attr("visibility", "visible"), this.text_ui.text.attr("fill", c.color), Object(y.nb)(this.text_ui.text, "not-shown")) : (this.text_ui.text.attr("visibility", "hidden"), Object(y.h)(this.text_ui.text, "not-shown"))
                        }
                    }, h.prototype.placeLoopLink = function(e) {
                        var t, n, r, o, a, c, l, d, u = this.vivaParent,
                            f = this.data,
                            h = s.getNode(f.to),
                            g = i.getNodeSizeInterpolator().getValueFor(h),
                            m = p.getSiblings(u),
                            b = 0 === m.length ? 0 : m.indexOf(u.id),
                            v = 2 * g + 30 * Math.floor(b / 2);
                        n = e.y, o = e.y, b % 2 === 0 ? (t = e.x + g, r = e.x - g, a = {
                            x: e.x + v,
                            y: e.y - v
                        }, c = {
                            x: e.x - v,
                            y: e.y - v
                        }, l = "M" + t + "," + n + " C" + a.x + "," + a.y + " " + c.x + "," + c.y + " " + r + "," + o, d = "M" + r + "," + o + " C" + c.x + "," + c.y + " " + a.x + "," + a.y + " " + t + "," + n, this.text_ui.text.attr("dy", -1 * (Math.max(1, i.getWeightInterpolator().getValueFor(this)) + 2))) : (t = e.x - g, r = e.x + g, a = {
                            x: e.x - v,
                            y: e.y + v
                        }, c = {
                            x: e.x + v,
                            y: e.y + v
                        }, d = "M" + t + "," + n + " C" + a.x + "," + a.y + " " + c.x + "," + c.y + " " + r + "," + o, l = "M" + r + "," + o + " C" + c.x + "," + c.y + " " + a.x + "," + a.y + " " + t + "," + n, this.text_ui.text.attr("dy", Math.max(1, i.getWeightInterpolator().getValueFor(this)) + 8)), this.ui.attr("d", l), this.text_ui.path.attr("d", d), this.text_ui.text.attr("visibility", "visible"), this.text_ui.text.attr("fill", f.color), Object(y.nb)(this.text_ui.text, "not-shown")
                    };
                    var g = function(e) {
                        h.call(this, e), this.edgeType = o.getEdgeTypeById(e.name_id)
                    };
                    (g.prototype = Object.create(h.prototype)).constructor = g, g.prototype.uiDOMInit = function() {
                        var e = T.a.Graph.svg("path").attr("stroke", a(this.data.color)).attr("stroke-width", Math.max(1, i.getWeightInterpolator().getValueFor(this))).attr("class", "generic-edge").attr("fill", "none");
                        return this.edgeType.directed && (this.data.arrowTriangle ? e.attr("marker-end", "url(#" + this.data.arrowTriangle + "_Triangle)") : e.attr("marker-end", "url(#" + this.data.name_id + "_Triangle)")), e.attr("id", this.id), this.uiDOMInitText(), e
                    }, g.prototype.uiDOMInitText = function() {
                        var e = "tp_" + Object(y.M)(),
                            t = T.a.Graph.svg("path").attr("id", e).attr("d", "");
                        f.append(t);
                        var n = T.a.Graph.svg("text");
                        n.attr("font-size", "8px").attr("font-style", "italic").attr("fill", a(this.data.color)).attr("font-family", "'Apercu Regular Pro', Helvetica, Arial, sans-serif").attr("text-anchor", "middle").attr("dy", -1 * (Math.max(1, i.getWeightInterpolator().getValueFor(this)) + 2)).attr("letter-spacing", "-0.02em");
                        var r = T.a.Graph.svg("textPath").attr("startOffset", "50%").link("#" + e).text(this.buildEdgeName());
                        n.append(r), c.getSvgRoot().children && ("function" === typeof c.getSvgRoot().children ? c.getSvgRoot().children()[0].append(n) : c.getSvgRoot().children[0].append(n)), this.text_ui = {
                            text: n,
                            path: t
                        }
                    }, g.prototype.uiUpdate = function() {
                        var e = Math.max(1, i.getWeightInterpolator().getValueFor(this));
                        this.ui.setAttribute("stroke", a(this.data.color)), this.ui.setAttribute("stroke-width", e), this.ui.setAttribute("class", "generic-edge"), this.edgeType.directed && (this.data.arrowTriangle ? this.ui.setAttribute("marker-end", "url(#" + this.data.arrowTriangle + "_Triangle)") : this.ui.setAttribute("marker-end", "url(#" + this.data.name_id + "_Triangle)")), this.uiUpdateText()
                    }, g.prototype.uiUpdateText = function() {
                        var e = Math.max(1, i.getWeightInterpolator().getValueFor(this));
                        this.text_ui.text.attr("fill", a(this.data.color)), this.text_ui.text.attr("dy", -1 * (Math.max(1, e) + 2));
                        var t = this.text_ui.text.querySelector("textPath");
                        t && (t.innerHTML = this.buildEdgeName())
                    };
                    var m = function(e) {
                        h.call(this, e), this.temp = !0
                    };
                    (m.prototype = Object.create(h.prototype)).constructor = m, m.prototype.uiDOMInit = function() {
                        return T.a.Graph.svg("path").attr("stroke", "#333").attr("stroke-dasharray", "5, 5").attr("stroke-width", 2).attr("class", "generic-edge").attr("fill", "none")
                    }, m.prototype.placeLink = function(e, t) {
                        this.placeDefaultLink(e, t)
                    };
                    var b = function(e) {
                        g.call(this, e), this.isMeta = !0, this.edgeType = null
                    };
                    return (b.prototype = Object.create(g.prototype)).constructor = g, b.prototype.uiDOMInit = function() {
                        var e = T.a.Graph.svg("path").attr("stroke", a(this.data.color)).attr("stroke-width", 1).attr("class", "generic-edge").attr("fill", "none");
                        return this.data.directed && e.attr("marker-end", "url(" + this.data.color + "_Triangle)"), e.attr("id", this.data.id), this.uiDOMInitText(), e
                    }, b.prototype.uiDOMInitText = function() {
                        g.prototype.uiDOMInitText.call(this), this.text_ui.text.attr("letter-spacing", "-0.1em")
                    }, b.prototype.buildEdgeName = function() {
                        return this.data.count > 1 ? [this.data.count, this.data.name].join(" ") : this.data.name
                    }, b.prototype.uiUpdate = function() {
                        var e = Math.max(1, i.getWeightInterpolator().getValueFor(this));
                        this.ui.setAttribute("stroke", a(this.data.color)), this.ui.setAttribute("stroke-width", e), this.ui.setAttribute("class", "generic-edge"), this.data.directed && this.ui.setAttribute("marker-end", "url(" + this.data.color + "_Triangle)"), this.uiUpdateText()
                    }, {
                        BaseCanvasEdge: h,
                        DefaultCanvasEdge: g,
                        TempCanvasEdge: m,
                        GroupCanvasEdge: b
                    }
                },
                F = function() {
                    var e = {
                        min: 999999999,
                        max: -99999999
                    };
                    return {
                        calculate: function(t) {
                            t && (t.forEach((function(t) {
                                t.count > e.max && (e.max = t.count), t.count < e.min && (e.min = t.count)
                            })), e.range = e.max - e.min)
                        },
                        getValueFor: function(t) {
                            var n = t.data.getNodeData();
                            return n.isMeta ? 0 === e.range ? 12 : 12 + Math.floor((n.count - e.min) / (e.max - e.min) * 8) : 8
                        },
                        addNewValue: function() {},
                        introduceNewType: function() {},
                        calculateForType: function() {},
                        updateForMetrics: function() {}
                    }
                },
                G = function(e) {
                    var t = e.graph,
                        n = {
                            min: 9999999999,
                            max: -9999999999,
                            range: 0
                        };
                    return {
                        calculate: function() {
                            n = {
                                min: 9999999999,
                                max: -9999999999,
                                range: 0
                            }, t.forEachLink((function(e) {
                                var t = e.data.getEdgeData();
                                t.isMeta && (t.count < n.min && (n.min = t.count), t.count > n.max && (n.max = t.count))
                            })), n.range = n.max - n.min
                        },
                        getValueFor: function(e) {
                            var t = e.getEdgeData();
                            return t.isMeta ? 0 === n.range ? 1 : Math.floor((t.count - n.min) / n.range * 10) + 1 : 1
                        },
                        addNewValue: function(e) {
                            var t = e.getEdgeData();
                            t.isMeta && (t.count < n.min && (n.min = t.count), t.count > n.max && (n.max = t.count), n.range = n.max - n.min)
                        }
                    }
                };

            function H(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function U(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? H(Object(n), !0).forEach((function(t) {
                        z(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : H(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function z(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var W = void 0,
                Y = function(e, t, n, r, o) {
                    var a, i, s, c, p, f = this,
                        h = t.uiStore,
                        g = t.graphStore,
                        m = t.dispatcher,
                        b = t.GraphHistory,
                        v = 1,
                        _ = !g.get("layout").hide_small_node_labels,
                        w = r,
                        O = w,
                        E = h.get("isOnlyExploreAllowed"),
                        j = (a = document, i = {}, s = !1, c = !1, p = !1, a.onkeydown = function(e) {
                            var t, n;
                            if (!s && 16 === e.keyCode && (s = !0, t = i["shift-pressed"]))
                                for (n = 0; n < t.length; n += 1) t[n].fn.call(t[n].ctx);
                            if (!c && (17 === e.keyCode || 224 === e.keyCode || 91 === e.keyCode) && (c = !0, t = i["ctrl-pressed"]))
                                for (n = 0; n < t.length; n += 1) t[n].fn.call(t[n].ctx);
                            if (18 === e.keyCode && (p = !0, t = i["alt-pressed"]))
                                for (n = 0; n < t.length; n += 1) t[n].fn.call(t[n].ctx);
                            if (i[e.keyCode] && (t = i[e.keyCode]))
                                for (n = 0; n < t.length && !t[n].fn.call(t[n].ctx, {
                                        shift: e.shiftKey,
                                        ctrl: e.ctrlKey,
                                        alt: e.altKey
                                    }); n += 1);
                        }, a.onkeyup = function(e) {
                            var t, n;
                            if (s && 16 === e.keyCode && (s = !1, t = i["shift-released"]))
                                for (n = 0; n < t.length; n += 1) t[n].fn.call(t[n].ctx);
                            if (c && (17 === e.keyCode || 224 === e.keyCode || 91 === e.keyCode) && (c = !1, t = i["ctrl-released"]))
                                for (n = 0; n < t.length; n += 1) t[n].fn.call(t[n].ctx);
                            if (18 === e.keyCode && (p = !1, t = i["alt-released"]))
                                for (n = 0; n < t.length; n += 1) t[n].fn.call(t[n].ctx)
                        }, {
                            on: function(e, t, n) {
                                i[e] || (i[e] = []), i[e].push({
                                    ctx: t,
                                    fn: n
                                })
                            },
                            remove: function(e, t, n) {
                                i[e] && i[e].splice(i[e].indexOf({
                                    ctx: t,
                                    fn: n
                                }), 1)
                            },
                            isShiftPressed: function() {
                                return s
                            },
                            isCtrlPressed: function() {
                                return c
                            },
                            isAltPressed: function() {
                                return p
                            },
                            reset: function() {
                                i = {}
                            }
                        }),
                        S = !1,
                        x = !1,
                        N = !1,
                        M = this,
                        q = null,
                        I = null,
                        H = [],
                        z = [],
                        Y = [],
                        V = "",
                        X = null,
                        K = n,
                        $ = !g.get("layoutNodeFullname"),
                        Z = !1,
                        J = [],
                        Q = function(e, t, n) {
                            var r = ["matrix(", [n, 0, 0, n, e, t].join(", "), ")"].join("");
                            ke.setTransform(r), Ce.setTransform(e, t, n), v = n
                        },
                        ee = function(e) {
                            return e && "url" === e.substring(0, 3) ? e : k()(e).lighten(15).toString()
                        },
                        te = function(e) {
                            var t = null;
                            switch (e) {
                                case u.a.EDIT:
                                    t = "edit";
                                    break;
                                case u.a.EXPLORE:
                                    t = "explore";
                                    break;
                                case u.a.DELETE:
                                    t = "delete";
                                    break;
                                case u.a.FILTER:
                                    t = "filter";
                                    break;
                                case u.a.FREEZE:
                                    t = "freeze";
                                    break;
                                case u.a.VIEW:
                                    t = "view"
                            }
                            return t
                        };
                    this.isClusterColorsApplied = function() {
                        return Z
                    }, this.getCurrentZoom = function() {
                        return v
                    }, this.getForceDisplaySmallNodeNames = function() {
                        return _
                    }, this.getNodeSizeInterpolator = function() {
                        return Ie
                    }, this.getWeightInterpolator = function() {
                        return Re
                    }, this.refreshCursor = function() {
                        I && (ae.style.cursor = "pointer"), N ? ae.style.cursor = "move" : Fe.isActive() || K === u.a.EDIT && x ? ae.style.cursor = "alias" : S || y.d.isActive() ? ae.style.cursor = "crosshair" : q && !q.cluster ? ae.style.cursor = "pointer" : K !== u.a.EDIT || (b.getSelectedNodes() || []).length || (b.getSelectedEdges() || []).length ? ae.style.cursor = "default" : ae.style.cursor = "copy"
                    }, this.setHoveredNode = function(e) {
                        q = e || null, f.refreshCursor()
                    }, this.getHoveredNode = function() {
                        return q
                    }, this.setHoveredExpandButton = function(e) {
                        I = e || null, f.refreshCursor()
                    }, this.getHoveredExpandNode = function() {
                        return I
                    }, this.getSelectedNodes = function() {
                        return H.map((function(e) {
                            return e.id
                        }))
                    };
                    var ne = function() {
                            var e = {};
                            return {
                                addLink: function(t) {
                                    var n;
                                    n = t.fromId < t.toId ? t.fromId + "-" + t.toId : t.toId + "-" + t.fromId, void 0 === e[n] && (e[n] = []), e[n].push(t.id)
                                },
                                getSiblings: function(t) {
                                    var n;
                                    return n = t.fromId < t.toId ? t.fromId + "-" + t.toId : t.toId + "-" + t.fromId, e[n]
                                },
                                removeLink: function(t) {
                                    var n, r;
                                    if (n = t.fromId < t.toId ? t.fromId + "-" + t.toId : t.toId + "-" + t.fromId, e[n]) {
                                        for (r = 0; r < e[n].length; r += 1) e[n][r] === t.id && e[n].splice(r, 1);
                                        0 == e[n].length && (e[n] = void 0)
                                    }
                                },
                                removeIndex: function(t) {
                                    var n;
                                    n = t.fromId < t.toId ? t.fromId + "-" + t.toId : t.toId + "-" + t.fromId, e[n] = void 0
                                },
                                reset: function() {
                                    e = {}
                                }
                            }
                        }(),
                        re = {},
                        oe = {},
                        ae = document.querySelector(e),
                        ie = T.a.Graph.graph(),
                        se = function(e, t, n) {
                            var r, o, a;
                            for (H.push(e), e.data.selected = !0, e.data.highlightNode(t, n), a = 0; a < e.links.length; a += 1) r = (o = e.links[a]).toId === e.id ? o.fromId : o.toId, ie.getNode(r).data.selected && ke.renderLink(o.id)
                        },
                        ce = function(e) {
                            var t, n;
                            for (H.splice(H.indexOf(e), 1), e.data.selected = !1, e.data.dehighlight(), t = 0; t < e.links.length; t += 1)(n = e.links[t].data.text_ui) && (n.text.attr("visibility", "hidden"), Object(y.h)(n.text, "not-shown"))
                        },
                        le = function() {
                            var e = b.getNodeTypes(),
                                t = b.getEdgeTypes(),
                                n = b.getNodes(),
                                r = b.getLinks();
                            e && function(e) {
                                for (var t = 0; t < e.length; t += 1) re[e[t].id] = {
                                    color: e[t].color,
                                    id: e[t].id,
                                    name: e[t].name,
                                    image_as_icon: e[t].image_as_icon,
                                    size: e[t].size,
                                    size_limit: e[t].size_limit,
                                    size_min_limit: Number(e[t].size_min_limit),
                                    hide_name: e[t].hide_name,
                                    display_name: e[t].display_name,
                                    secondary_display_name: e[t].secondary_display_name,
                                    centered_display_name: e[t].centered_display_name,
                                    centered_secondary_display_name: e[t].centered_secondary_display_name
                                }
                            }(e), t && function(e) {
                                for (var t = 0; t < e.length; t += 1) oe[e[t].id] = {
                                    color: e[t].color,
                                    weighted: e[t].weighted,
                                    directed: e[t].directed,
                                    display_name: e[t].display_name,
                                    id: e[t].id,
                                    name: e[t].name
                                }, me(e[t].id)
                            }(t), n && function(e) {
                                for (var t = 0; t < e.length; t += 1) {
                                    var n = e[t],
                                        r = {
                                            id: n.id,
                                            type: n.type,
                                            name: n.name,
                                            type_id: n.type_id,
                                            size: n.size,
                                            image: n.image,
                                            reference: n.reference,
                                            pos_x: n.pos_x,
                                            pos_y: n.pos_y,
                                            is_locked: n.is_locked,
                                            properties: {},
                                            color: re[n.type_id].color
                                        },
                                        o = void 0,
                                        a = b.getNodeTypeById(n.type_id).properties;
                                    if (a && n.properties)
                                        for (o = 0; o < a.length; o += 1) Object.prototype.hasOwnProperty.call(n.properties, a[o].name) && (r.properties[a[o].name] = n.properties[a[o].name]);
                                    ie.addNode(n.id, new Ue(r))
                                }
                            }(n), r && (! function(e) {
                                for (var t = 0; t < e.length; t += 1) {
                                    var n = e[t];
                                    ie.addLink(n.from, n.to, new Ye({
                                        name: n.name,
                                        name_id: n.name_id,
                                        weight: n.weight,
                                        id: n.id,
                                        from: n.from,
                                        to: n.to,
                                        color: oe[n.name_id].color,
                                        properties: n.properties ? Object(y.p)(n.properties) : null
                                    }))
                                }
                                e.length > 0 && (V = e[e.length - 1].name)
                            }(r), Re.calculate(ie))
                        },
                        de = function() {
                            (ge(), he(), Z) && b.getAnalysisManager().getClusters().forEach((function(e) {
                                var t = ie.getNode(e.id);
                                t && t.data.reset()
                            }));
                            f.refreshCursor()
                        };
                    var ue = function() {
                            ge(), he(), Ce.rerender(), f.refreshCursor()
                        },
                        pe = function(e) {
                            Y.push(e), e.data.select(), Object(y.h)(ke.getSvgRoot(), "peek-mode")
                        },
                        fe = function(e) {
                            Y.splice(Y.indexOf(e), 1), e.data.unselect()
                        };

                    function he() {
                        for (var e = Y.length - 1; e >= 0; e -= 1) fe(Y[e])
                    }

                    function ge() {
                        var e, t = 0;
                        for (t = H.length - 1; t >= 0; t -= 1) ce(H[t]);
                        for (t = z.length - 1; t >= 0; t -= 1) e = z[t], z.splice(z.indexOf(e), 1), e.data.highlighted = !1, e.data.dehighlight();
                        Object(y.nb)(ke.getSvgRoot(), "peek-mode"), X = null
                    }

                    function me(e) {
                        var t = T.a.Graph.svg("marker").attr("id", e.split(" ").join("+") + "_Triangle").attr("viewBox", "0 0 10 10").attr("refX", "5").attr("refY", "5").attr("markerUnits", "strokeWidth").attr("markerWidth", "10").attr("markerHeight", "5").attr("orient", "auto").attr("fill", ee(oe[e].color));
                        t.append("path").attr("d", "M 0 0 L 10 5 L 0 10 z"), qe.append(t)
                    }
                    var ye, be = function(e) {
                            var t = e.replace("#", "") + "_Triangle";
                            if (!document.getElementById(t)) {
                                var n = T.a.Graph.svg("marker").attr("id", t).attr("viewBox", "0 0 10 10").attr("refX", "10").attr("refY", "5").attr("markerUnits", "strokeWidth").attr("markerWidth", "10").attr("markerHeight", "5").attr("orient", "auto").attr("fill", ee(e));
                                n.append("path").attr("d", "M 0 0 L 10 5 L 0 10 z"), qe.append(n), J.push(n)
                            }
                        },
                        ve = function(e, t) {
                            var n = "gradient" + e.replace("#", "") + "-" + t.replace("#", ""),
                                r = qe.querySelector("linearGradient#" + n);
                            if (!r) {
                                r = T.a.Graph.svg("linearGradient").attr("id", n).attr("x1", "0%").attr("x2", "100%").attr("y1", "0%").attr("y2", "0%");
                                var o = T.a.Graph.svg("stop").attr("offset", "0%").attr("style", "stop-color: " + ee(e));
                                r.append(o);
                                var a = T.a.Graph.svg("stop").attr("offset", "100%").attr("style", "stop-color: " + ee(t));
                                r.append(a), qe.append(r)
                            }
                            return "url(#" + n + ")"
                        },
                        _e = function(e) {
                            var t = null !== ht ? 380 : 0,
                                n = T.a.Graph.Utils.getDimension(ae),
                                r = e.data.ui.getBoundingClientRect();
                            return r.left < n.left || r.right > n.left + n.width - t || r.top < n.top + 60 || r.bottom > n.top + n.height
                        },
                        we = function() {
                            ie.forEachNode((function(e) {
                                e && e.data.converted && (e.data.ui = e.data.uiInit(e), e.data.converted.selected && (Object(y.h)(e.data.ui, "selected"), Object(y.h)(e.data.ui.querySelector("image"), "selected")), e.data.converted.highlighted && Object(y.h)(e.data.ui, "highlighted"), e.data.selected && e.data.highlightNode(!0), e.data.converted = null)
                            }))
                        },
                        Oe = function() {
                            b.getSelectedNodes().length > 0 && (ie.forEachNode((function(e) {
                                e && (Object(y.N)(e.data.ui, "selected") || Object(y.N)(e.data.ui, "highlighted") || e.data.ui.attr("opacity", .2))
                            })), ie.forEachLink((function(e) {
                                e && (Object(y.N)(e.data.ui, "selected-edge") || Object(y.N)(e.data.ui, "highlighted") || e.data.ui.attr("opacity", .2))
                            })), ke.getSvgRoot().setAttribute("class", "")), ie.forEachNode((function(e) {
                                if (e) {
                                    var t = e.data.ui.querySelector("path.expand-node");
                                    t && (t.style.opacity = 100)
                                }
                            }))
                        },
                        Ee = function(e) {
                            H.length > 0 && (ie.forEachLink((function(e) {
                                e.data.ui.removeAttribute("opacity")
                            })), ie.forEachNode((function(e) {
                                e && (Object(y.N)(e.data.ui, "selected") || Object(y.N)(e.data.ui, "highlighted") || e.data.ui.removeAttribute("opacity"))
                            })), ie.forEachLink((function(e) {
                                e && (Object(y.N)(e.data.ui, "selected-edge") || Object(y.N)(e.data.ui, "highlighted") || e.data.ui.removeAttribute("opacity"))
                            })), ie.forEachNode((function(e) {
                                e && e.data.uiUpdate()
                            })), ke.getSvgRoot().setAttribute("class", e)), ie.forEachNode((function(e) {
                                if (e) {
                                    var t = e.data.ui.querySelector("path.expand-node");
                                    t && (t.style.opacity = 100)
                                }
                            }))
                        },
                        je = function() {
                            var e = H.map((function(e) {
                                    return e.data.data.id
                                })),
                                t = Y.map((function(e) {
                                    return e.data.id
                                }));
                            b.buildDeleteSignals(e, t, (function(e, t) {
                                e ? b.clearSelectedNodes() : (t.filter((function(e) {
                                    return "node_delete" === e.action
                                })).forEach((function(e) {
                                    var t = ye.getNodePosition(e.id);
                                    e.pos = {
                                        x: t.x,
                                        y: t.y
                                    }
                                })), b.notify(t), Y.splice(0, Y.length), H.splice(0, H.length), b.clearSelectedNodes(), Object(y.nb)(ke.getSvgRoot(), "peek-mode"))
                            }))
                        },
                        Se = T.a.Graph.geom(),
                        xe = g.get("layout");
                    ye = "force_directed" === xe.algorithm ? T.a.Graph.Layout.forceDirected(ie, xe) : L(ie, xe);
                    var ke = T.a.Graph.View.svgGraphics();
                    ke.node((function(e) {
                        return e.data.uiInit(e)
                    })).placeNode((function(e, t) {
                        e.attr("transform", "translate(" + t.x + ", " + t.y + ")")
                    })), ke.link((function(e) {
                        return e.data.uiInit(e)
                    })).placeLink((function(e, t, n, r) {
                        r.data.placeLink(t, n)
                    }));
                    var Ce = T.a.Graph.View.renderer(ie, {
                            container: ae,
                            graphics: ke,
                            layout: ye,
                            prerender: r ? 0 : "force_directed" === xe.algorithm ? 800 : 10
                        }),
                        Ne = !1;
                    Ce.on("container-drag", (function(e, t) {
                        e ? (N = !0, f.refreshCursor(), Ne || 0 === t.x && 0 === t.y || (Ne = !0)) : (N = !1, f.refreshCursor(), Ne && (w && b.triggerSnapshot(!0, M), Ne = !1))
                    }));
                    var Te = null;
                    Ce.on("render", (function() {
                        !Le && Z && b.getAnalysisManager().getClusters().forEach((function(e) {
                            var t = ie.getNode(e.id);
                            if (t) {
                                var n = t.data.pivotNode;
                                if (n) {
                                    var r = ye.getNodePosition(n.id);
                                    e.pos_x = Math.cos(e.angle) * e.dist + r.x, e.pos_y = Math.sin(e.angle) * e.dist + r.y, ye.setNodePosition(e.id, e.pos_x, e.pos_y)
                                }
                            }
                        }))
                    })), Ce.on("scale", (function(e) {
                        w && b.triggerSnapshot(!0, M), v = e, Te && clearTimeout(Te), Te = setTimeout((function() {
                            ie.forEachNode((function(e) {
                                e.data.uiUpdateText()
                            }))
                        }), 400)
                    }));
                    var Le = !1,
                        Pe = null,
                        Ae = {},
                        De = {},
                        Me = function(e) {
                            ie.getNode(e).data instanceof ze && (Ae[e] && (clearTimeout(Ae[e]), Ae[e] = null), De[e] || (De[e] = function(e) {
                                return function() {
                                    var t = b.getAnalysisManager().getClusters().find((function(t) {
                                        return t.id === e
                                    }));
                                    Object(d.updateCluster)(g.get("id"), t.id, {
                                        angle: t.angle,
                                        dist: t.dist
                                    }), Ae[e] = null, De[e] = null
                                }
                            }(e)), Ae[e] = setTimeout(De[e], 2e3))
                        };
                    Ce.on("drag", (function(e, t) {
                        var n = ie.getNode(e).data;
                        if ("function" == typeof n.clearHoverCard && n.clearHoverCard(), Z && function(e) {
                                var t = ie.getNode(e);
                                if (t.data instanceof ze) {
                                    var n = b.getAnalysisManager().getClusters().find((function(e) {
                                            return e.id === t.data.id
                                        })),
                                        r = t.data.pivotNode;
                                    if (!r) return;
                                    var o = ye.getNodePosition(r.id),
                                        a = ye.getNodePosition(e);
                                    n.dist = Math.sqrt(Math.pow(a.x - o.x, 2) + Math.pow(a.y - o.y, 2)), n.angle = Math.PI + Math.atan2(o.y - a.y, o.x - a.x), Le = !0, Pe && clearTimeout(Pe), Pe = setTimeout((function() {
                                        Le = !1, Ce.rerender()
                                    }), 500)
                                }
                            }(e), K != u.a.VIEW && !Fe.isActive() && Ce.getPaused() && (w || Ce.resume()), w) {
                            var r, o;
                            for (b.triggerSnapshot(!0, M), r = 0; r < H.length; r += 1) e !== H[r].id && (o = ye.getNodePosition(H[r].id), ye.setNodePosition(H[r].id, o.x + t.x, o.y + t.y));
                            h.get("readOnly") || Z && Me(e)
                        }
                    }));
                    var qe = ke.getSvgRoot().append("defs"),
                        Ie = P(t, {
                            graph: ie
                        }),
                        Re = A({
                            graph: ie
                        }),
                        Be = {},
                        Fe = new D(t, Be, {
                            map: ae,
                            canvas: M,
                            graph: ie,
                            svgGraphics: ke,
                            layout: ye,
                            renderer: Ce,
                            linkMaps: ne
                        }),
                        Ge = R(t, {
                            canvas: M,
                            graph: ie,
                            svgGraphics: ke,
                            layout: ye,
                            renderer: Ce,
                            _connectHelper: Fe
                        }),
                        He = Ge.GroupCanvasNode,
                        Ue = Ge.DefaultCanvasNode,
                        ze = Ge.ClusterNameCanvasNode,
                        We = B(t, {
                            canvas: M,
                            graph: ie,
                            svgGraphics: ke,
                            layout: ye,
                            renderer: Ce,
                            _connectHelper: Fe,
                            _weightInterpolator: Re,
                            _nodeSizeInterpolator: Ie,
                            linkMaps: ne
                        }),
                        Ye = We.DefaultCanvasEdge,
                        Ve = We.GroupCanvasEdge,
                        Xe = We.TempCanvasEdge;
                    Be.DefaultCanvasEdge = Ye, Be.GroupCanvasEdge = Ve, Be.TempCanvasEdge = Xe, le(), Ce.run(400), Ce.reset(), Ie.calculate(ie, re, !0);
                    var Ke, $e = (Ke = "Triangle", T.a.Graph.svg("marker").attr("id", Ke).attr("viewBox", "0 0 10 10").attr("refX", "5").attr("refY", "5").attr("markerUnits", "strokeWidth").attr("markerWidth", "10").attr("markerHeight", "5").attr("orient", "auto"));
                    $e.append("path").attr("d", "M 0 0 L 10 5 L 0 10 z"), qe.append($e);
                    var Ze = function(e) {
                            E || h.get("editMode") === u.a.EXPLORE ? m.emit("onExplorePanelOpened") : "function" === typeof o && o(e)
                        },
                        Je = {};
                    ae.addEventListener("mousedown", (function(e) {
                        b.requestFocus(M), Je.x = e.clientX, Je.y = e.clientY, y.Y.isShiftPressed() && (Ce.pinGraph(!0), f.refreshCursor(), y.d.create("#map", (function(e) {
                            var t = ke.getSvgRoot().firstChild.getCTM();
                            e.left = (e.left - t.e) / t.a, e.right = e.left + e.width / t.a, e.top = (e.top - t.f) / t.a, e.bottom = e.top + e.height / t.a, ie.forEachNode((function(t) {
                                var n = [t.data.ui.position.x, t.data.ui.position.y];
                                n[0] >= e.left && n[0] <= e.right && n[1] >= e.top && n[1] <= e.bottom && (H.indexOf(t) < 0 ? (se(t), b.addToSelectedNodes(t.id, M)) : (ce(t), b.removeFromSelectedNodes(t.id, M)))
                            }));
                            var n = null;
                            ie.forEachLink((function(t) {
                                var r = t.data.ui.position.from,
                                    o = t.data.ui.position.to;
                                (r.x >= e.left && r.x <= e.right && o.x >= e.left && o.x <= e.right && r.y >= e.top && r.y <= e.bottom && o.y >= e.top && o.y <= e.bottom || Se.intersectRect(e.left, e.top, e.right, e.bottom, r.x, r.y, o.x, o.y)) && (Y.indexOf(t) < 0 ? (pe(t), n = t) : fe(t))
                            })), (H.length > 0 || Y.length > 0) && Object(y.h)(ke.getSvgRoot(), "peek-mode"), 0 == H.length && 0 == Y.length && Object(y.nb)(ke.getSvgRoot(), "peek-mode"), Ce.pinGraph(!1), f.refreshCursor(), n && n.data && b.focusEdge([{
                                from: n.data.data.from,
                                to: n.data.data.to,
                                id: n.data.id
                            }], M), K == u.a.DELETE && (H.length > 0 || Y.length > 0) && je()
                        })))
                    })), ae.addEventListener("click", (function(e) {
                        if (Je.x === e.clientX || Je.y === e.clientY) {
                            b.requestFocus(M);
                            var t = !1;
                            if (Fe.isActive() && (Fe.clearSelection(), t = !0, f.refreshCursor()), !y.Y.isShiftPressed() && ((H.length > 0 || z.length > 0 || Y.length > 0) && (b.clearSelectedNodes(M), ue(), t = !0), Object(y.nb)(ke.getSvgRoot(), "peek-mode"), !(K !== u.a.EDIT && K !== u.a.EXPLORE || t))) {
                                var n = ke.getSvgRoot().firstChild.getCTM(),
                                    r = {
                                        x: (e.clientX - n.e) / n.a,
                                        y: (e.clientY - n.f) / n.a
                                    };
                                Ze(r), f.refreshCursor()
                            }
                        }
                    }), !1), j.on("27", ae, (function() {
                        "cards" !== ht && (Fe.isActive() && (Fe.clearSelection(), this.refreshCursor()), (H.length > 0 || Y.length > 0) && (b.clearSelectedNodes(M), ue()))
                    })), y.Y.on(["shift", "ctrl", "cmd"], "render.pause", (function() {
                        Fe.isActive() || Ce.pause()
                    }), (function() {
                        Fe.isActive() || w || Ce.resume()
                    })), y.Y.on("shift", "marquee", null, (function() {
                        y.d.isActive() && y.d.destroy()
                    })), y.Y.on("shift", "cursor.crosshair", (function() {
                        S = !0, f.refreshCursor()
                    }), (function() {
                        S = !1, f.refreshCursor()
                    })), y.Y.on(["cmd", "ctrl"], "cursor.cell", (function() {
                        x = !0, f.refreshCursor()
                    }), (function() {
                        x = !1, f.refreshCursor()
                    })), j.on("78", ae, (function() {
                        K == u.a.EDIT && "body" === document.activeElement.tagName.toLowerCase() && (b.requestFocus(M), Ze())
                    }));
                    var Qe = function() {
                        K != u.a.VIEW && (Object(y.W)(document.activeElement) || Fe.isActive() || h.get("hasListenerFocus", M) && (0 == H.length && 0 == Y.length || je()))
                    };
                    j.on("46", ae, Qe), j.on("8", ae, Qe);
                    var et = function(e) {
                            var t;
                            if (t = Object.prototype.hasOwnProperty.call(e, "name_id") ? b.getEdgeTypeById(e.name_id) : b.getEdgeTypeById(e.name)) {
                                e.name_id = t.id;
                                var n = ie.addLink(e.from, e.to, new Ye({
                                    name: e.name,
                                    name_id: e.name_id,
                                    weight: e.weight,
                                    id: e.id,
                                    from: e.from,
                                    to: e.to,
                                    color: oe[e.name_id].color,
                                    properties: e.properties ? Object(y.p)(e.properties) : null
                                }));
                                Re.addNewValue(n.data, ie), h.get("isImportingBatch") || Ie.updateForMetrics(ie, !0), V = e.name;
                                var r = ie.getNode(e.from),
                                    o = ie.getNode(e.to);
                                r.data.uiUpdate(), o.data.uiUpdate(), w && Ce.rerender(), b.isOnboardEnabled() && b.triggerOnboardAction("edge_added_to_canvas", {})
                            } else console.log(e.type + " is not defined")
                        },
                        tt = function(e) {
                            var t, n;
                            if (Object.prototype.hasOwnProperty.call(e, "type_id")) Object.prototype.hasOwnProperty.call(re, e.type_id) && (t = e.type_id);
                            else
                                for (n in re)
                                    if (Object.prototype.hasOwnProperty.call(re, n) && re[n].name === e.type) {
                                        t = n;
                                        break
                                    } if (t) {
                                var r, o = {
                                        id: e.id,
                                        type: e.type,
                                        name: e.name,
                                        type_id: t,
                                        size: e.size,
                                        image: e.image,
                                        reference: e.reference,
                                        pos_x: e.pos_x,
                                        pos_y: e.pos_y,
                                        properties: {},
                                        color: re[t].color
                                    },
                                    a = b.getNodeTypeById(t).properties;
                                if (a && e.properties)
                                    for (r = 0; r < a.length; r += 1) Object.prototype.hasOwnProperty.call(e.properties, a[r].name) && (o.properties[a[r].name] = e.properties[a[r].name]);
                                var i = ie.addNode(e.id, new Ue(o));
                                e.pos && (ye.setNodePosition(i.id, e.pos.x, e.pos.y), Ce.rerender()), Ie.addNewValue(ie.getNode(e.id), ie), b.isOnboardEnabled() && b.triggerOnboardAction("node_added_to_canvas", {
                                    target: ke.getNodeUI(e.id)
                                })
                            } else console.log("nodetype is not defined")
                        },
                        nt = function(e) {
                            var t, n = !1;
                            b.getEdgeTypeById(e.id) ? (e.color && (oe[e.id].color = e.color, n = !0, t = e.id.split(" ").join("+") + "_Triangle", qe.removeChild(document.getElementById(t)), me(e.id)), e.name && (n = !0, oe[e.id].name = e.name, ie.forEachLink((function(t) {
                                t && t.data && t.data.edgeType.id === e.id && t.data.text_ui.text.text(e.name)
                            }))), n && ie.forEachLink((function(t) {
                                var n = t.data.getEdgeData();
                                n.name_id === e.id && (n.color = e.color, t.data.uiUpdate())
                            }))) : console.log("could not find Vector Order for the id: " + e.id)
                        },
                        rt = function(e) {
                            var t;
                            "string" === typeof e ? t = ie.getNode(e) : "object" === typeof e && (t = ie.getNode(e.id)), t.data.delete(), Object(y.nb)(ke.getSvgRoot(), "peek-mode")
                        };

                    function ot(e) {
                        var t = e.data.ui.getBoundingClientRect(),
                            n = at(.5 * (t.right + t.left), .5 * (t.bottom + t.top));
                        Ce.moveTo(n.x, n.y)
                    }

                    function at(e, t) {
                        var n = T.a.Graph.Utils.getDimension(ae),
                            r = ft ? n.width : 0,
                            o = null !== ht ? 190 : 0,
                            a = ke.getSvgRoot().firstChild.getCTM();
                        return {
                            x: (e + o - r - a.e) / a.a,
                            y: (t - a.f) / a.a
                        }
                    }
                    this.hasSelected = function() {
                        return H.length > 0
                    }, this.resize = function(e, t, n) {
                        ae.style.width = e + "px", ae.style.height = t + "px", n || Ce.rerender()
                    }, this.getContainer = function() {
                        return ae
                    }, this.resetZoom = function() {
                        Ce.reset();
                        var e = 1 / 0,
                            t = -1 / 0,
                            n = 1 / 0,
                            r = -1 / 0;
                        ie.forEachNode((function(o) {
                            var a = ye.getNodePosition(o.id);
                            e > a.x && (e = a.x), t < a.x && (t = a.x), n > a.y && (n = a.y), r < a.y && (r = a.y)
                        })), Ce.moveTo((e + t) / 2, (n + r) / 2)
                    }, this.zoomIn = function() {
                        Ce.zoomIn()
                    }, this.zoomOut = function() {
                        Ce.zoomOut()
                    }, this.refresh = function() {
                        ie.forEachNode((function(e) {
                            e.data.uiUpdate()
                        }))
                    }, this.getNodePosition = function(e) {
                        return ye.getNodePosition(e)
                    };
                    this.increaseSpringLength = function() {
                        ye && Ce && (ye.simulator.springLength(ye.simulator.springLength() + 10), Ce.resume(), w && Ce.pause(), g.update("layout", (function(e) {
                            return U(U({}, e), {}, {
                                springLength: e.simulator.springLength()
                            })
                        })), h.get("readOnly") || g.get("isDirty"))
                    }, this.decreaseSpringLength = function() {
                        ye && Ce && (ye.simulator.springLength(Math.max(0, ye.simulator.springLength() - 10)), Ce.resume(), w && Ce.pause(), g.update("layout", (function(e) {
                            return U(U({}, e), {}, {
                                springLength: e.simulator.springLength()
                            })
                        })), h.get("readOnly") || g.get("isDirty"))
                    };
                    this.increaseGravity = function() {
                        ye && Ce && (ye.simulator.gravity(ye.simulator.gravity() + -.2), Ce.resume(), w && Ce.pause(), g.update("layout", (function(e) {
                            return U(U({}, e), {}, {
                                gravity: e.simulator.gravity()
                            })
                        })), h.get("readOnly") || g.get("isDirty"))
                    }, this.decreaseGravity = function() {
                        ye && Ce && (ye.simulator.gravity(Math.min(-.1, ye.simulator.gravity() - -.2)), Ce.resume(), w && Ce.pause(), g.update("layout", (function(e) {
                            return U(U({}, e), {}, {
                                gravity: e.simulator.gravity()
                            })
                        })), h.get("readOnly") || g.get("isDirty"))
                    };
                    this.getSVGDataStripped = function() {
                        var e, t, n = ke.getSvgRoot().getAttribute("class");
                        ie.forEachNode((function(e) {
                            e.data.uiCircleBody || (e.data.converted = {
                                selected: Object(y.N)(e.data.ui, "selected"),
                                highlighted: Object(y.N)(e.data.ui, "highlighted")
                            }, e.data.ui = e.data.uiInit(e, !0), e.data.converted.selected && (Object(y.h)(e.data.ui, "selected"), Object(y.h)(e.data.ui.querySelector("circle"), "selected")), e.data.converted.highlighted && Object(y.h)(e.data.ui, "highlighted"), e.data.selected && e.data.highlightNode(!0))
                        })), Oe(), e = b.getSelectedNodes().length > 0, t = g.get("layout").always_show_edge_names, ie.forEachLink((function(n) {
                            if (n) {
                                var r = n.data,
                                    o = r.ui.attr("d").split(" ");
                                if (r.text_ui.temp_path = r.text_ui.text.querySelector("textPath"), r.text_ui.temp_path && r.text_ui.text.removeChild(r.text_ui.temp_path), 2 == o.length) {
                                    var a, i = {
                                            x: parseFloat(o[0].split(",")[0].substring(1).trim()),
                                            y: parseFloat(o[0].split(",")[1].trim())
                                        },
                                        s = {
                                            x: parseFloat(o[1].split(",")[0].substring(1).trim()),
                                            y: parseFloat(o[1].split(",")[1].trim())
                                        };
                                    a = s.x > i.x ? (Math.atan2(s.y - i.y, s.x - i.x) - Math.atan2(0, 0)) * (180 / Math.PI) : (Math.atan2(i.y - s.y, i.x - s.x) - Math.atan2(0, 0)) * (180 / Math.PI), r.text_ui.text.attr("x", (i.x + s.x) / 2), r.text_ui.text.attr("y", (i.y + s.y) / 2), r.text_ui.text.attr("transform", "rotate(" + a + " " + (i.x + s.x) / 2 + ", " + (i.y + s.y) / 2 + ")"), e ? Object(y.N)(r.text_ui.text, "peeked") || Object(y.N)(r.text_ui.text, "highlighted") || Object(y.N)(r.text_ui.text, "selected-edge") ? (r.text_ui.text.text(r.buildEdgeName()), r.text_ui.text.attr("opacity", W)) : (r.text_ui.text.attr("opacity", .2), t && r.text_ui.text.text(r.buildEdgeName())) : t && (r.text_ui.text.text(r.buildEdgeName()), r.text_ui.text.attr("opacity", W)), Z && "url" === r.data.color.substring(0, 3) && r.text_ui.text.attr("fill", ie.getNode(r.data.from).data.getNodeData().color)
                                }
                            }
                        }));
                        var r = Object(y.H)(ke.getSvgRoot(), !0);
                        return Ee(n), we(), ie.forEachLink((function(e) {
                            if (e) {
                                var t = e.data;
                                t.text_ui.text.attr("x", null), t.text_ui.text.attr("y", null), t.text_ui.text.attr("transform", null), t.text_ui.text.attr("visibility", null), t.text_ui.text.text(""), t.text_ui.text.attr("opacity", null), Z && t.text_ui.text.attr("fill", t.data.color), t.text_ui.temp_path && (t.text_ui.text.append(t.text_ui.temp_path), t.text_ui.temp_path = null)
                            }
                        })), r
                    }, this.getSVGData = function(e) {
                        var t = ke.getSvgRoot().getAttribute("class");
                        Oe();
                        var n = Object(y.H)(ke.getSvgRoot(), e);
                        return Ee(t), we(), n
                    }, this.setRendererState = function(e) {
                        Fe.isActive() || (e ? (Ce.resume(), w = !1) : (Ce.pause(), w = !0), b.isOnboardEnabled() && b.triggerOnboardAction("canvas_paused"))
                    }, this.getForcePaused = function() {
                        return w
                    }, this.takeSnapshot = function() {
                        var e, t = {},
                            n = ke.getSvgRoot().firstChild.getCTM();
                        return ie.forEachNode((function(r) {
                            r && (e = ye.getNodePosition(r.data.id), t[r.data.id] = {
                                pos_x: e.x * n.a + n.e,
                                pos_y: e.y * n.a + n.f,
                                is_locked: r.data.is_locked
                            }, r.data.data.pos_x = t[r.data.id].pos_x, r.data.data.pos_y = t[r.data.id].pos_y)
                        })), t
                    };
                    var it = function(e, t) {
                            var n = t || g.get("layout").zoom,
                                r = T.a.Graph.Utils.getDimension(ae),
                                o = r.width / 2,
                                a = r.height / 2;
                            ke.setTransform("matrix(" + n + ", 0, 0, " + n + ", " + o + ", " + a + ")"), Ce.setTransform(o, a, n), v = n;
                            var i = ke.getSvgRoot().firstChild.getCTM();
                            e ? ie.forEachNode((function(t) {
                                var n = e[t.id],
                                    r = {
                                        x: (n.pos_x - i.e) / i.a,
                                        y: (n.pos_y - i.f) / i.a
                                    };
                                ye.setNodePosition(t.id, r.x, r.y)
                            })) : ie.forEachNode((function(e) {
                                if (e && void 0 !== e.data.data.pos_x && void 0 !== e.data.data.pos_y) {
                                    var t = {
                                        x: (e.data.data.pos_x - i.e) / i.a,
                                        y: (e.data.data.pos_y - i.f) / i.a
                                    };
                                    ye.setNodePosition(e.id, t.x, t.y)
                                }
                            }))
                        },
                        st = function() {
                            ie.forEachNode((function(e) {
                                e && void 0 !== e.data.data.pos_x && void 0 !== e.data.data.pos_y && ye.setNodePosition(e.id, e.data.data.pos_x, e.data.data.pos_y)
                            }));
                            var e = g.get("layout").layoutTransform;
                            ke.setTransform(e);
                            var t = e;
                            if (t) {
                                var n = (t = (t = t.substring(7)).substring(0, t.length - 1)).split(", ").map((function(e) {
                                    return parseFloat(e.trim())
                                }));
                                Ce.setTransform(n[4], n[5], n[0]), v = parseFloat(n[0])
                            }
                        };
                    this.lockNodes = function(e) {
                        ie.forEachNode((function(e) {
                            e.data.lockNode(!1)
                        })), e.forEach((function(e) {
                            ie.getNode(e).data.lockNode(!0)
                        }))
                    }, this.isLocked = function(e) {
                        var t = ie.getNode(e);
                        if (t) return t.data.is_locked;
                        console.log("isLocked: node ".concat(e, " not found"))
                    }, this.toggleNodeLock = function(e) {
                        var t = ie.getNode(e);
                        t ? t.data.lockNode(!t.data.is_locked) : console.log("toggleNodeLock: node ".concat(e, " not found"))
                    }, this.updateSnapshot = function(e, t) {
                        var n = t,
                            r = T.a.Graph.Utils.getDimension(ae),
                            o = r.width / 2,
                            a = r.height / 2;
                        ke.setTransform("matrix(" + n + ", 0, 0, " + n + ", " + o + ", " + a + ")"), Ce.setTransform(0, 0, n), v = n;
                        var i = ke.getSvgRoot().firstChild.getCTM();
                        e && ie.forEachNode((function(t) {
                            var n = e[t.id];
                            if (n) {
                                var r = {
                                    x: (n.pos_x - i.e) / i.a,
                                    y: (n.pos_y - i.f) / i.a
                                };
                                ye.setNodePosition(t.id, r.x, r.y)
                            }
                        })), Ce.rerender()
                    }, this.showSnapshot = function(e, t) {
                        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2];
                        Ce.pause(), !e && g.get("layout").old_snapshot ? st() : it(e, t), _ || M.hideSmallText(!_), Ce.rerender(), w = !0, n && m.emit("updateEditMode", u.a.VIEW), b.triggerSnapshot(!1, M)
                    }, this.scaleToShowEntireGraph = function(e) {
                        var t, n, r = e ? 380 : 0,
                            o = ke.getSvgRoot().firstChild.getBoundingClientRect(),
                            a = T.a.Graph.Utils.getDimension(ae),
                            i = o.width / (a.width - r - 120),
                            s = o.height / (a.height - 120),
                            c = Math.max(i, s);
                        void 0 !== c && (n = (t = function(e) {
                            var t = (e = (e = e.substring(7)).substring(0, e.length - 1)).split(",").map((function(e) {
                                return Number(e.trim())
                            }));
                            return {
                                x: t[4],
                                y: t[5],
                                zoom: t[0]
                            }
                        }(ke.getTransform())).zoom / c, Q(t.x, t.y, n));
                        var l = .5 * ((o = ke.getSvgRoot().firstChild.getBoundingClientRect()).left + o.right),
                            d = .5 * (o.top + o.bottom),
                            u = (a.width - r) / 2 - l,
                            p = 30 + a.height / 2 - d;
                        Q(t.x + u, t.y + p, n), ie.forEachNode((function(e) {
                            e.data.uiUpdateText()
                        }))
                    };
                    var ct, lt, dt, ut, pt = 0,
                        ft = !1,
                        ht = null;

                    function gt() {
                        var e = b.getAnalysisManager().getClusters();
                        (e = e.filter((function(e) {
                            return 100 * e.nodes.length / b.getNodes().length >= 1
                        }))).forEach((function(e) {
                            var t = Object(y.p)(e);
                            t.is_locked = !0;
                            var n = new ze(t);
                            ie.addNode(e.id, n);
                            var r = e.nodes.map((function(e) {
                                return b.getNodeById(e)
                            })).filter((function(e) {
                                return e
                            })).sort((function(e, t) {
                                return e.edges.length < t.edges.length ? 1 : e.edges.length > t.edges.length ? -1 : 0
                            }))[0];
                            if (r) {
                                n.pivotNode = r;
                                var o = ye.getNodePosition(r.id);
                                if (null === e.angle || null === e.dist)
                                    if (null !== e.pos_x && null !== e.pos_y) e.dist = Math.sqrt(Math.pow(e.pos_x - o.x, 2) + Math.pow(e.pos_y - o.y, 2)), e.angle = Math.PI + Math.atan2(o.y - e.pos_y, o.x - e.pos_x);
                                    else {
                                        var a = ie.getNode(r.id).data.ui.getBoundingClientRect().height;
                                        e.dist = 2 * a, e.angle = Math.PI / 2
                                    }
                                e.pos_x = Math.cos(e.angle) * e.dist + o.x, e.pos_y = Math.sin(e.angle) * e.dist + o.y, ye.setNodePosition(e.id, e.pos_x, e.pos_y)
                            }
                        })), Ce.rerender()
                    }

                    function mt() {
                        Object.keys(Ae).forEach((function(e) {
                            clearTimeout(Ae[e])
                        })), Object.keys(De).forEach((function(e) {
                            "function" === typeof De[e] && De[e].call()
                        })), ie.forEachNode((function(e) {
                            e.data instanceof ze && ie.removeNode(e.id)
                        }))
                    }

                    function yt(e) {
                        ie.clear(), ne.reset();
                        for (var t = ke.getSvgRoot().querySelector("g"); t.firstChild;) t.removeChild(t.firstChild);
                        if (!e) {
                            for (; qe.firstChild;) qe.removeChild(qe.firstChild);
                            J = []
                        }
                    }
                    this.getTransform = function() {
                        var e = ke.getTransform();
                        return e && "undefined" !== e ? e : "matrix(1,0,0,1,0,0)"
                    }, this.getGraphEngine = function() {
                        return {
                            graph: ie,
                            renderer: Ce,
                            graphics: ke,
                            layout: ye
                        }
                    }, this.hideSmallText = function(e) {
                        _ = !e, ie.forEachNode((function(e) {
                            e.data.uiUpdateText()
                        }))
                    }, this.applyClusterColors = function() {
                        Z && M.revertToNodeTypeColors(), de();
                        var e = b.getAnalysisManager().getClusters(),
                            t = 0;
                        e.forEach((function(e) {
                            e.nodes.forEach((function(n) {
                                var r = ie.getNode(n);
                                r ? (r.data.getNodeData().color = e.color, r.data.uiUpdate()) : t += 1
                            }))
                        })), t > 0 && console.log("WARNING: Clustering data contains " + t + "node that no longer exists in the graph."), ie.forEachLink((function(e) {
                            var t = e.data.getEdgeData(),
                                n = ie.getNode(e.fromId).data.getNodeData().color,
                                r = ie.getNode(e.toId).data.getNodeData().color;
                            if (n !== r) {
                                var o = ve(n, r);
                                ve(r, n), t.color = o
                            } else t.color = n;
                            e.data.edgeType.directed && (be(r), t.arrowTriangle = r.replace("#", "")), e.data.uiUpdate()
                        })), Z = !0, gt()
                    }, this.revertToNodeTypeColors = function() {
                        mt(), ie.forEachNode((function(e) {
                                e.data.getNodeData().color = e.data.nodeType.color, e.data.uiUpdate()
                            })), ie.forEachLink((function(e) {
                                var t = e.data.getEdgeData();
                                t.color = e.data.edgeType.color, t.arrowTriangle = null, e.data.uiUpdate()
                            })),
                            function() {
                                var e = qe.querySelectorAll("linearGradient");
                                if (e)
                                    for (var t = 0; t < e.length; t += 1) qe.removeChild(e[t])
                            }(), J.forEach((function(e) {
                                qe.removeChild(e)
                            })), J = [], Z = !1
                    }, this.showGraphModel = function(e) {
                        var n;
                        ut || (dt = {
                            positions: M.takeSnapshot(),
                            zoom: v,
                            layout: Object(y.a)(xe.algorithm, ye)
                        }), yt(), "force_atlas2" === xe.algorithm ? (n = 400, ye.updateSettings({
                            linLogMode: !0,
                            gravity: .1,
                            edgeWeightInfluence: 0,
                            scalingRatio: n,
                            strongGravityMode: !0
                        }), bt.forEach((function(e) {
                            e.call(null, n)
                        }))) : (n = 250, ye.simulator.springLength(n), bt.forEach((function(e) {
                            e.call(null, n)
                        }))), Ie = F(t), Re = G({
                            graph: ie
                        }), ut = e.type || "default", Ie.calculate(e.nodes), e.nodes.forEach((function(e) {
                            e.isMeta ? ie.addNode(e.id, new He(e)) : ie.addNode(e.id, new Ue(e))
                        }));
                        var r = {};
                        e.edges.forEach((function(e) {
                            e.directed && (Object.prototype.hasOwnProperty.call(r, e.color) || (be(e.color), r[e.color] = !0))
                        })), e.edges.forEach((function(e) {
                            e.isMeta ? ie.addLink(e.from, e.to, new Ve(e)) : ie.addLink(e.from, e.to, new Ye(e))
                        })), Re.calculate(), ie.forEachNode((function(e) {
                            e.data.uiUpdate()
                        })), ie.forEachLink((function(e) {
                            e.data.uiUpdate()
                        }));
                        var o = T.a.Graph.Utils.getDimension(ae),
                            a = o.width / 2,
                            i = o.height / 2;
                        ke.setTransform("matrix(1, 0, 0, 1, " + a + ", " + i + ")"), Ce.setTransform(a, i, 1), v = 1
                    }, this.finalizeLinking = function(e) {
                        var n = this;
                        e && (b.requestFocus(M), Object(l.newEdge)(t, e.source.data, e.target.map((function(e) {
                            return e.data
                        })), V, (function(r, o, a, i) {
                            Fe.clearSelection(), n.refreshCursor();
                            var s = e.source.data.data.id,
                                c = e.target.map((function(e) {
                                    return e.data.data.id
                                }));
                            b.createEdge(s, c, r, o, a, (function(e, n) {
                                i && i(), w || Ce.resume(), e ? Object(l.displayMessage)(t, "Error", "Unable to reach the server") : n && Object(l.displayMessage)(t, "Existing Vectors", "Adding " + n + " existing Vector" + (n > 1 ? "s" : "") + " in the Hub, with all existing properties")
                            }))
                        }), (function(e) {
                            e && e(), Fe.clearSelection(), n.refreshCursor()
                        })))
                    }, this.setLastClickedNode = function(e) {
                        X = e
                    }, this.getLastClickedNode = function() {
                        return X
                    }, this.deleteSelectedNodesAndEdges = function() {
                        je()
                    }, this.selectEdge = function(e) {
                        pe(e)
                    }, this.reinsertNodes = function(e) {
                        var t = b.getNodes().filter((function(t) {
                            return t.group_id === e
                        }));
                        rt(e), t.forEach((function(e) {
                            tt(e), ie.getNode(e.id).data.data.color = e.color
                        })), t.forEach((function(e) {
                            e.edges.forEach((function(t) {
                                var n = t.from === e.id ? t.to : t.from;
                                if (ie.getNode(n)) {
                                    for (var r = ie.getLinks(t.from), o = !1, a = 0; a < r.length; a += 1)
                                        if (r[a].data.id === t.id) {
                                            o = !0;
                                            break
                                        }
                                    o || et(t)
                                } else {
                                    var i, s, c = ie.getNode(b.getNodeById(n).group_id),
                                        l = b.getEdgeTypeById(t.name_id);
                                    l.directed ? t.from === n ? (i = [c.id, t.to], s = c.id) : (i = [t.from, c.id], s = t.from) : s = (i = [e.id, c.id].sort())[0], i.push(l.name);
                                    for (var d = i.join("-"), u = ie.getLinks(s), p = null, f = 0; f < u.length; f += 1)
                                        if (u[f].data.id === d) {
                                            p = u[f].data;
                                            break
                                        }
                                    p ? (p.data.count += 1, p.uiUpdate()) : ie.addLink(i[0], i[1], new Ve({
                                        id: d,
                                        name: l.name,
                                        name_id: l.name_id,
                                        from: i[0],
                                        color: l.color,
                                        directed: l.directed,
                                        to: i[1],
                                        weight: 1,
                                        count: 1,
                                        isMeta: !0
                                    }))
                                }
                            }))
                        })), Re.calculate(), ie.forEachNode((function(e) {
                            e.data.uiUpdate()
                        })), ie.forEachLink((function(e) {
                            e.data.uiUpdate()
                        })), ke.renderLinks(), w && (Ce.resume(), setTimeout((function() {
                            Ce.pause()
                        }), 1e3))
                    }, this.updateNodeType = function(e) {
                        var n = b.getNodeTypeById(e);
                        Object(l.showNameColorDialog)(t, "Change the type name and color", n.name, n.color, (function(e, t, r) {
                            if (n.name !== e || n.color !== t) {
                                var o = {
                                    action: "nodetype_update",
                                    id: n.id,
                                    prev: {}
                                };
                                n.name !== e && (o.name = e, o.prev.name = n.name), n.color !== t && (o.color = t, o.prev.color = n.color), b.notify(o), r()
                            }
                        }))
                    };
                    var bt = [];
                    this.onScaleChanged = function(e) {
                        bt.push(e)
                    }, this.fixNodeOverlaps = function() {
                        var e = !_;
                        e && M.hideSmallText(!1);
                        var t = [],
                            n = 0;
                        ie.forEachNode((function(e) {
                            if (!ye.isNodePinned(e)) {
                                var r = e.data.ui.getBoundingClientRect(),
                                    o = ye.getNodePosition(e.id);
                                t[n] = new C.Rectangle(o.x, o.x + r.width / v, o.y, o.y + 1.1 * r.height / v), n += 1
                            }
                        })), C.removeOverlaps(t), n = 0, ie.forEachNode((function(e) {
                            if (!ye.isNodePinned(e)) {
                                var r = t[n];
                                ye.setNodePosition(e.id, r.x, r.y), n += 1
                            }
                        })), Ce.rerender(), e && M.hideSmallText(!0)
                    }, this.zoomOutFixedNodes = function() {
                        var e = M.takeSnapshot();
                        M.zoomOut(), M.updateSnapshot(e, v), b.triggerSnapshot(!0, M)
                    }, this.zoomInFixedNodes = function() {
                        var e = M.takeSnapshot();
                        M.zoomIn(), M.updateSnapshot(e, v), b.triggerSnapshot(!0, M)
                    }, this.placeFixedGeoPositions = function() {
                        var e = -1 / 0,
                            t = 1 / 0,
                            n = -1 / 0,
                            r = 1 / 0;
                        ie.forEachNode((function(o) {
                            if (Object.prototype.hasOwnProperty.call(o.data.data.properties, "LatLng")) {
                                var a = o.data.data.properties.LatLng.split(" "),
                                    i = {
                                        x: parseFloat(a[1]),
                                        y: parseFloat(a[0])
                                    };
                                i.x > e && (e = i.x), i.x < t && (t = i.x), i.y > n && (n = i.y), i.y < r && (r = i.y)
                            }
                        }));
                        var o = e - t,
                            a = n - r,
                            i = 120,
                            s = ae.getBoundingClientRect(),
                            c = s.width - i,
                            l = s.height - i,
                            d = Math.min(l / a, c / o),
                            u = ke.getSvgRoot().firstChild.getCTM();
                        ie.forEachNode((function(e) {
                            if (e) {
                                if (!Object.prototype.hasOwnProperty.call(e.data.data.properties, "LatLng")) return;
                                var n = e.data.data.properties.LatLng.split(" "),
                                    o = {
                                        x: parseFloat(n[1]),
                                        y: parseFloat(n[0])
                                    };
                                o.x = (o.x - t) * d + 60, o.y = (a - o.y + r) * d + .25 * l + 60;
                                var i = {
                                    x: (o.x - u.e) / u.a,
                                    y: (o.y - u.f) / u.a
                                };
                                ye.setNodePosition(e.id, i.x, i.y), e.data.lockNode(!0)
                            }
                        })), Ce.moveTo(0, 0)
                    }, this.resumeFor = function(e) {
                        Ce.resume(), setTimeout((function() {
                            Ce.pause()
                        }), e)
                    }, this.addNode = function(e, t) {
                        var n = b.getNodeById(e);
                        n.color = b.getNodeTypeById(n.type_id).color, ie.addNode(n.id, new Ue(n)), t && ye.setNodePosition(e, t.x, t.y)
                    }, this.addLink = function(e) {
                        var t;
                        (t = "string" === typeof e ? b.getEdgeById(e) : e).color = b.getEdgeTypeById(t.name_id).color, ie.addLink(t.from, t.to, new Ye(t))
                    }, this.removeNode = function(e) {
                        (Array.isArray(e) ? e : [e]).forEach((function(e) {
                            ie.removeNode(e)
                        }))
                    }, this.removeLink = function(e) {
                        (Array.isArray(e) ? e : [e]).forEach((function(t) {
                            var n, r, o, a = ie.getLinks(t.from);
                            if (a)
                                for (r = a.length - 1; r >= 0; r -= 1)
                                    if ((o = a[r]).data.id === t.id) {
                                        n = o.data;
                                        break
                                    }
                            if (n) {
                                var i = n.text_ui;
                                i && (i.text.parentNode.removeChild(i.text), i.path.parentNode.removeChild(i.path), e.text_ui = null);
                                var s = n.vivaParent;
                                ie.removeLink(s), ne.removeLink(s)
                            }
                        }))
                    }, this.calculateCentralitiesForFilter = function() {
                        var e = {},
                            t = T.a.Graph.centrality(),
                            n = t.betweennessCentrality(ie),
                            r = t.degreeCentrality(ie);
                        return b.getNodeTypes().forEach((function(t) {
                            e[t.id] = {}
                        })), n.forEach((function(t) {
                            var n = t.key,
                                r = ie.getNode(n).data.getNodeData().type_id;
                            Object.prototype.hasOwnProperty.call(e[r], n) || (e[r][n] = {}), e[r][n].betweenness = parseFloat(t.value)
                        })), r.forEach((function(t) {
                            var n = t.key,
                                r = ie.getNode(n).data.getNodeData().type_id;
                            Object.prototype.hasOwnProperty.call(e[r], n) || (e[r][n] = {}), e[r][n].degree = parseFloat(t.value)
                        })), ie.forEachNode((function(t) {
                            var n = t.id,
                                r = t.data.getNodeData().type_id,
                                o = ye.getNodePosition(n);
                            Object.prototype.hasOwnProperty.call(e[r], n) || (e[r][n] = {}), e[r][n].x = o.x, e[r][n].y = o.y
                        })), e
                    }, this.preview = function() {
                        var e = this.takeSnapshot(),
                            t = Ce.getZoom();
                        yt(!1), le(), Ie.calculate(ie, re, !0), this.showSnapshot(e, t, !1)
                    }, this.getName = function() {
                        return "svg-canvas"
                    }, m.bind("trigger", (function(e) {
                        switch (e.action) {
                            case "nodetype_create":
                                ! function(e) {
                                    re[e.id] ? console.log(e.id + " is already defined") : (re[e.id] = {
                                        color: e.color,
                                        id: e.id,
                                        name: e.name,
                                        image_as_icon: e.image_as_icon,
                                        display_name: e.display_name,
                                        size: e.size,
                                        size_limit: e.size_limit,
                                        size_min_limit: Number(e.size_min_limit) || 8,
                                        centered_display_name: e.centered_display_name,
                                        centered_secondary_display_name: e.centered_secondary_display_name
                                    }, Ie.introduceNewType(e.id))
                                }(e);
                                break;
                            case "nodetype_update":
                                ! function(e) {
                                    var t = b.getNodeTypeById(e.id);
                                    t ? (e.color && (t.color = e.color), e.size && (t.size = e.size), e.properties && e.properties.length !== e.prev.properties.length ? console.log("signal.properties and signal.properties_prev should be the same length") : ie.forEachNode((function(t) {
                                        t.data.updateNodeType(e) && t.data.uiUpdate()
                                    }))) : console.log("could not find nodetype for the id: " + e.id)
                                }(e);
                                break;
                            case "nodetype_delete":
                                ! function(e) {
                                    var t, n = !1;
                                    for (t in e)
                                        if (Object.prototype.hasOwnProperty.call(e, t)) {
                                            if ("id" === t || "action" === t) continue;
                                            n = !0
                                        }
                                    if (!n) {
                                        var r;
                                        for (t in re) Object.prototype.hasOwnProperty.call(re, t) && re[t].id === e.id && (r = t, delete re[t]);
                                        r && ie.forEachNode((function(e) {
                                            var t = e.data.getNodeData();
                                            t.type === r && ie.removeNode(t.id)
                                        }))
                                    }
                                }(e);
                                break;
                            case "edgetype_create":
                                ! function(e) {
                                    oe[e.id] ? console.log(e.name + "(" + e.id + ") is already defined") : (oe[e.id] = {
                                        color: e.color,
                                        weighted: e.weighted,
                                        directed: e.directed,
                                        display_name: e.display_name,
                                        id: e.id,
                                        name: e.name
                                    }, me(e.id), V = e.name)
                                }(e);
                                break;
                            case "edgetype_update":
                                nt(e);
                                break;
                            case "edgetype_delete":
                                ! function(e) {
                                    var t, n = !1;
                                    for (t in e)
                                        if (Object.prototype.hasOwnProperty.call(e, t)) {
                                            if ("id" === t || "action" === t) continue;
                                            n = !0
                                        }
                                    if (!n) {
                                        var r;
                                        for (t in oe) Object.prototype.hasOwnProperty.call(oe, t) && oe[t].id === e.id && (r = t, delete oe[t]);
                                        r && ie.forEachLink((function(e) {
                                            e.data.getEdgeData().name === r && ie.removeLink(e)
                                        }))
                                    }
                                }(e);
                                break;
                            case "node_create":
                                tt(e);
                                break;
                            case "node_update":
                                ! function(e) {
                                    var t = ie.getNode(e.id);
                                    if (t) {
                                        var n, r, o, a = t.data.getNodeData(),
                                            i = !1;
                                        if (Object.prototype.hasOwnProperty.call(e, "type") || Object.prototype.hasOwnProperty.call(e, "type_id"))
                                            if (i = !0, Object.prototype.hasOwnProperty.call(e, "type")) {
                                                if (!(o = b.getNodeTypeByName(e.type))) return void console.log("node_update: type value does not have a corresponding node type");
                                                e.type_id = o.id
                                            } else {
                                                if (!(o = b.getNodeTypeById(e.type_id))) return void console.log("node_update: type_id value does not have a corresponding node type");
                                                e.type = o.name
                                            }
                                        for (n in i && (a.properties = {}, a.color = b.getNodeTypeById(e.type_id).color), e)
                                            if (Object.prototype.hasOwnProperty.call(e, n)) {
                                                if ("id" === n || "action" === n || "prev" === n) continue;
                                                if ("properties" === n)
                                                    for (r in e.properties) Object.prototype.hasOwnProperty.call(e.properties, r) && (a.properties[r] = e.properties[r]);
                                                else a[n] = e[n]
                                            }(Object.prototype.hasOwnProperty.call(e, re[a.type_id].size) || Object.prototype.hasOwnProperty.call(e, "properties") && Object.prototype.hasOwnProperty.call(e.properties, re[a.type_id].size)) && Ie.calculateForType(ie, a.type_id), Object.prototype.hasOwnProperty.call(e, "type_id") && Ie.calculate(ie, re, !0), Object.prototype.hasOwnProperty.call(e, "properties") && Object.prototype.hasOwnProperty.call(e.properties, "LatLng") && t.data.lockNode(!0), t.data.uiUpdate()
                                    } else console.log("node does not exist")
                                }(e);
                                break;
                            case "node_delete":
                                rt(e);
                                break;
                            case "edge_create":
                                et(e);
                                break;
                            case "edge_update":
                                ! function(e) {
                                    var t, n, r, o, a, i;
                                    if (e.prev)
                                        if (Object.prototype.hasOwnProperty.call(e.prev, "from") || Object.prototype.hasOwnProperty.call(e.prev, "to")) {
                                            var s = e.prev.from || e.prev.to;
                                            if (!(t = ie.getNode(s))) return void console.log("Could not find vivanode with the id: " + s);
                                            for (n = t.links, r = 0; r < n.length; r += 1)
                                                if (n[r].data.id === e.id) {
                                                    i = {};
                                                    var c = n[r].data.getEdgeData();
                                                    for (o in c)
                                                        if (Object.prototype.hasOwnProperty.call(c, o))
                                                            if ("properties" === o)
                                                                for (a in c.properties) Object.prototype.hasOwnProperty.call(c.properties, a) && (i.properties || (i.properties = {}), i.properties[a] = c.properties[a]);
                                                            else i[o] = c[o];
                                                    ie.removeLink(n[r]);
                                                    break
                                                }
                                            if (!i) return void console.log("could not find the link to update");
                                            for (o in e)
                                                if (Object.prototype.hasOwnProperty.call(e, o)) {
                                                    if ("id" === o || "action" === o || "prev" === o) continue;
                                                    if ("properties" === o)
                                                        for (a in e.properties) Object.prototype.hasOwnProperty.call(e.properties, a) && (i.properties || (i.properties = {}), i.properties[a] = e.properties[a]);
                                                    else i[o] = e[o]
                                                }
                                            ie.addLink(e.from, e.to, new Ye(i))
                                        } else {
                                            if (!(t = ie.getNode(e.from))) return void console.log("Could not find vivanode with the id: " + e.from);
                                            for (n = t.links, r = 0; r < n.length; r += 1)
                                                if (n[r].data.id === e.id) {
                                                    var l = n[r].data,
                                                        d = l.getEdgeData();
                                                    for (o in e)
                                                        if (Object.prototype.hasOwnProperty.call(e, o)) {
                                                            if ("name" === o || "name_id" === o) continue;
                                                            if ("properties" === o)
                                                                for (a in e.properties) Object.prototype.hasOwnProperty.call(e.properties, a) && (d.properties || (d.properties = {}), d.properties[a] = e.properties[a]);
                                                            else d[o] = e[o]
                                                        }
                                                    if (e.prev && e.prev.name && e.name) {
                                                        var u = b.getEdgeTypeByName(e.name);
                                                        l.edgeType = u, d.color = u.color, d.name = u.name, d.name_id = u.name_id
                                                    }
                                                    Re.calculate(ie, !0), Object.prototype.hasOwnProperty.call(e, "weight") && Ie.updateForMetrics(ie, !0), l.uiUpdate();
                                                    break
                                                }
                                        }
                                    else console.log("signal does not contain prev key")
                                }(e);
                                break;
                            case "edge_delete":
                                ! function(e) {
                                    var t, n, r = ie.getLinks(e.from);
                                    for (n = r.length - 1; n >= 0; n -= 1)
                                        if (r[n].data.id === e.id) {
                                            t = r[n];
                                            break
                                        }
                                    t && t.data.delete(), Object(y.nb)(ke.getSvgRoot(), "peek-mode")
                                }(e)
                        }
                    }), this), m.bind("onNodeUnselected", (function(e) {
                        var t = ie.getNode(e);
                        t && ce(t), H.length < 1 && Y.length < 1 && Object(y.nb)(ke.getSvgRoot(), "peek-mode")
                    }), this), m.bind("uiStore.isPreviewMode.updated", (function(e) {
                        var t = ke.getSvgRoot();
                        e ? t.classList.add("preview-mode") : t.classList.remove("preview-mode")
                    })), m.bind("uiStore.isImportingBatch.updated", (function(e) {
                        e || Ie.updateForMetrics(ie, !0)
                    })), m.bind("onClusterSelected", (function(e, t) {
                        var n, r, o;
                        if (de(), n = Array.isArray(t) ? t : [t], Object(y.h)(ke.getSvgRoot(), "peek-mode"), Z) {
                            var a = ie.getNode(e);
                            a && a.data.unmute()
                        }
                        for (r = n.length - 1; r >= 0; r -= 1)(o = ie.getNode(n[r])) && (H.push(o), o.data.unmute(), o.links.forEach((function(e) {
                            var t = o.id !== e.fromId ? e.fromId : e.toId,
                                n = ie.getNode(t);
                            Object(y.N)(n.data.ui, "highlighted") && (Object(y.h)(e.data.ui, "highlighted"), Object(y.nb)(e.data.ui, "peeked"))
                        })));
                        o && _e(o) && ot(o)
                    }), this), m.bind("onNodeSelected", (function(e) {
                        var t, n, r;
                        for (t = Array.isArray(e) ? e : [e], Object(y.h)(ke.getSvgRoot(), "peek-mode"), n = t.length - 1; n >= 0; n -= 1)(r = ie.getNode(t[n])) && se(r);
                        r && _e(r) && ot(r), f.refreshCursor()
                    }), this), m.bind("onNodeFocused", (function(e) {
                        ue();
                        var t, n = Array.isArray(e) ? e : [e];
                        for (t = 0; t < n.length; t += 1) {
                            var r = ie.getNode(n[t]);
                            r && (_e(r) && ot(r), Object(y.h)(ke.getSvgRoot(), "peek-mode"), se(r))
                        }
                    }), this), m.bind("onEdgeFocused", (function(e) {
                        var t;
                        for (ue(), Object(y.h)(ke.getSvgRoot(), "peek-mode"), t = 0; t < e.length; t += 1) {
                            var n = e[t],
                                r = ie.getNode(n.from),
                                o = ie.getNode(n.to),
                                a = r.links;
                            if (_e(r) || _e(o)) {
                                var i = r.data.ui.getBoundingClientRect(),
                                    s = o.data.ui.getBoundingClientRect(),
                                    c = at(.5 * (i.left + s.right), .5 * (i.top + s.top));
                                Ce.moveTo(c.x, c.y)
                            }
                            for (var l = 0; l < a.length; l += 1)
                                if (a[l].data.id === n.id) {
                                    pe(a[l]);
                                    break
                                }
                        }
                    }), this), m.bind("onNodesReleased", de, this), m.bind("editModeUpdated", (function(e) {
                        var t = K;
                        K = e, Fe.isActive() && (Fe.clearSelection(), f.refreshCursor());
                        var n = te(t);
                        null !== n && Object(y.nb)(ke.getSvgRoot(), n);
                        var r = te(K);
                        null !== r && Object(y.h)(ke.getSvgRoot(), r), f.refreshCursor(), ie.forEachNode((function(e) {
                            e.data.uiUpdate()
                        }))
                    }), this), m.bind("onModalOpened", (function() {
                        1 === (pt += 1) && (ct = w, w = !0, Ce.pause())
                    }), this), m.bind("onModalClosed", (function() {
                        0 === (pt -= 1) && ((w = ct) ? Ce.pause() : Ce.resume())
                    }), this), m.bind("onDatatableOpened", (function() {
                        ft = !0, 1 === (pt += 1) && (O = w, w = !0, Ce.pause())
                    }), this), m.bind("onDatatableClosed", (function() {
                        var e, t;
                        ft = !1, e = v, t = ke.getTransform(), Ce.reset(), ke.setTransform(t), Ce.rerender(), v = e, h.get("freezeMode") || 0 === (pt -= 1) && ((w = O) ? Ce.pause() : Ce.resume())
                    }), this), m.bind("onBarOpened", (function(e) {
                        ht = e, 1 === (pt += 1) && (O = w, ct = w, w = !0, Ce.pause())
                    }), this), m.bind("onBarClosed", (function() {
                        ht = null, 0 === (pt -= 1) && ((w = O) ? Ce.pause() : Ce.resume())
                    }), this), m.bind("graphStore.layoutNodeFullname.updated", (function(e) {
                        $ != !e && ($ = !e, ie.forEachNode((function(e) {
                            e.data.uiUpdate()
                        })))
                    }), this), m.bind("onBeforeFilterApplied", (function() {
                        lt = ke.getTransform()
                    }), this), m.bind("onFilterApplied", (function() {
                        Ie.updateForMetrics(ie, !0), Re.calculate(ie, !0), lt && ke.setTransform(lt), Ce.rerender()
                    }), this), m.bind("onClustersUpdated", (function() {
                        Z && (mt(), gt())
                    }), this), m.bind("freezeModeUpdated", (function(e, n) {
                        "group" === n && (yt(), "force_atlas2" === xe.algorithm ? (ye.updateSettings(dt.layout), bt.forEach((function(e) {
                            e.call(null, dt.layout.scalingRatio)
                        }))) : (ye.simulator.springLength(dt.layout.springLength), ye.simulator.springCoeff(dt.layout.springCoeff), ye.simulator.gravity(dt.layout.gravity), ye.simulator.theta(dt.layout.theta), ye.simulator.dragCoeff(dt.layout.dragCoeff), ye.simulator.timeStep(dt.layout.timeStep), ye.simulator.stableThreshold(dt.layout.stableThreshold), bt.forEach((function(e) {
                            e.call(null, dt.layout.springLength)
                        }))), Ie = P(t, {
                            graph: ie
                        }), Re = A({
                            graph: ie
                        }), le(), Ie.calculate(ie, re, !0), M.showSnapshot(dt.positions, dt.zoom), ut = null)
                    }), this), m.bind("clearGraph", (function(e) {
                        yt(e)
                    }), this), m.bind("refreshGraph", (function() {
                        le(), f.showSnapshot()
                    }), this), b.setRenderingController(this)
                },
                V = n(6),
                X = n.n(V),
                K = n(109),
                $ = n.n(K),
                Z = n(21),
                J = n(54),
                Q = function(e, t, n) {
                    var r = e.dispatcher,
                        o = e.graphStore,
                        a = e.uiStore,
                        u = e.GraphHistory,
                        p = !1,
                        f = new $.a.Converter;
                    f.setOption("literalMidWordUnderscores", !0), f.setOption("strikethrough", !0);
                    var h, g, m, b, v, _ = document.querySelector(t.commentsContainer),
                        w = !1,
                        O = !!o.get("user").id && !o.get("isEmbed"),
                        E = 0,
                        j = (v = null, function() {
                            v && (clearTimeout(v), v = null), v = setTimeout((function() {
                                I(), v = null
                            }), 300)
                        }),
                        S = function(e) {
                            var t = '<a class="user-mention" href="' + Object(y.B)() + '/users/$1" target="_blank">@$1</a>';
                            return "\uff20" === e[0] || "@" === e[0] ? e.match(/editors|owner|commentors/) ? e.substring(1).replace(/([\w]+)/, '<span class="user-mention clickable">@$1</span>') : e.substring(1).replace(/([\w]+)/, t) : e
                        },
                        x = function(e) {
                            p || 27 === e.keyCode && (n ? n() : k())
                        };

                    function k() {
                        w && (O && a.set("lastCommentText", _.querySelector("textarea").value), h && (_.removeChild(h), h = null), document.removeEventListener("keydown", x), window.removeEventListener("resize", j), _.classList.add("not-shown"), w = !1, r.emit("onBarClosed", "comments"), r.emit("updateFreezeMode", null), C())
                    }

                    function C() {
                        var e = Object(y.K)(window.location.search);
                        e.show = w ? "comments" : null, Object(y.xb)(window.location.pathname + Object(y.l)(e))
                    }
                    var N, T = function() {
                            N && (clearTimeout(N), N = null)
                        },
                        L = function() {
                            var e = this.getAttribute("data-id");
                            e && (N = setTimeout((function() {
                                u.focusNode(e), N = null
                            }), 250))
                        },
                        P = function(t) {
                            t && (p = !0, Object(l.commentWithImagePanel)(e, t, {
                                onClose: function() {
                                    p = !1
                                }
                            }))
                        },
                        A = function(e, n) {
                            var r, a;
                            e.text = (r = e.text, a = function(e) {
                                return e.replace(/\[[#]([^\]]+)\]\((\w{8}-\w{4}-\w{4}-\w{4}-\w{12})\)/gi, '<span class="node-reference" data-id="$2">#$1</span>')
                            }(a = (a = (a = (a = r || "").trim()).replace(/\n/gi, "<br/>")).split(" ").map(S).join(" ")), function(e) {
                                var t = e.substring(3);
                                return t.substring(0, t.length - 4)
                            }(f.makeHtml(a))), e.formatted_date = X()(e.created_at).fromNow(), e.selected = e.id === t.selected_comment;
                            var c = s.a["graphs/comment_block"](e);
                            n ? m.insertBefore(c.trim().toDOM(), m.firstChild) : m.appendChild(c.trim().toDOM());
                            var l = m.querySelector("li#c_" + e.id);
                            if (Object(y.ab)(l), e.image && l.querySelector("img").addEventListener("click", (function() {
                                    P(e)
                                })), e.can_delete) {
                                var u = l.querySelector("div.comment-setting");
                                l.addEventListener("mouseover", (function() {
                                    u.classList.remove("hide-it")
                                })), l.addEventListener("mouseout", (function() {
                                    u.classList.add("hide-it")
                                })), u.addEventListener("click", (function(t) {
                                    return t.preventDefault(),
                                        function(e, t) {
                                            var n;
                                            e.can_delete && (n = e.user.is_self ? "Are you sure to remove your comment?" : "As an admin to this graph, you have the privilege to delete this comment.\n\nAre you sure to remove this comment?", confirm(n) && (Object(d.removeComment)(o.get("id"), e.id, (function() {})), t.parentNode.removeChild(t), E = Math.max(0, E - 1), D()))
                                        }(e, l), !1
                                }))
                            }
                            var p, h = l.querySelectorAll("span.node-reference");
                            if (h)
                                for (p = h.length - 1; p >= 0; p -= 1) h[p].addEventListener("mouseover", L), h[p].addEventListener("mouseout", T);
                            var g = l.querySelector("div.user-name");
                            i.a.create(g, {
                                position: "top",
                                hideOnClickOutside: !0
                            })
                        };

                    function D() {
                        E < 1 ? b.classList.remove("not-shown") : b.classList.add("not-shown"), r.emit("onCommentCountUpdated", E)
                    }

                    function M(e) {
                        E = e.length, e.forEach(A), D(), I(), t.selected_comment && (! function(e) {
                            var t = g.getBoundingClientRect().top,
                                n = g.querySelector("#c_" + e);
                            if (n) {
                                var r = n.getBoundingClientRect().top;
                                g.scrollTo({
                                    top: r - t
                                })
                            }
                        }(t.selected_comment), P(e.find((function(e) {
                            return e.selected && e.image
                        }))))
                    }

                    function q(e) {
                        console.log(e)
                    }

                    function I() {
                        var e = g.getBoundingClientRect().top,
                            t = g.nextElementSibling.getBoundingClientRect().top - e;
                        g.style.height = t + "px"
                    }
                    return function() {
                        r.emit("onBarOpened", "comments"), r.emit("updateFreezeMode", "comments"), _.classList.remove("not-shown"), w = !0;
                        var i = {
                            user: o.get("user"),
                            embed: o.get("isEmbed"),
                            id: o.get("id")
                        };
                        i.readonly = !i.user.id || i.embed, Z.a && Z.a.isSignupAllowed() && (i.signupAllowed = !0);
                        var l = s.a["graphs/comments_bar"](i);
                        _.appendChild(l.trim().toDOM()), E = 0, h = _.querySelector("div.bar-content.bar__comments"), g = _.querySelector("div.bar-content__body"), m = g.querySelector("ul.bar-content__blocks-holder"), b = g.querySelector("div.bar-content__body-empty"), _.querySelector("div.bar-content__footer button").addEventListener("click", (function() {
                                n ? n() : k()
                            })), O ? function(n) {
                                var r = function(t) {
                                        var n = {
                                            text: Object(J.addIdsForNodeReferences)(e, t)
                                        };
                                        Object(d.postComment)(o.get("id"), n, (function(e) {
                                            i.clear(), m.parentNode.scrollTop = 0, A(e.comment, !0), E += 1, D()
                                        }), (function() {
                                            console.log("post comment failed")
                                        }))
                                    },
                                    i = Object(c.CommentEntry)(e, {
                                        root: n.querySelector("div.comment-entry"),
                                        onSubmit: r,
                                        onCaptureRequested: function(e) {
                                            "function" === typeof t.onShareRequested && t.onShareRequested(e)
                                        },
                                        initial_text: a.get("lastCommentText")
                                    });
                                i.focus()
                            }(h) : i.embed || function(t) {
                                var n = t.querySelector("div.bar-content__header");
                                Object(y.vb)(e, {
                                    bindTo: n
                                })
                            }(h), document.addEventListener("keydown", x), window.addEventListener("resize", j), I(), g.classList.add("gc-custom-scrollbar"),
                            function() {
                                var e = m.parentNode,
                                    t = e.getBoundingClientRect().top,
                                    n = setInterval((function() {
                                        if (w) {
                                            var r = e.getBoundingClientRect().top;
                                            r !== t && (t = r, j())
                                        } else clearInterval(n)
                                    }), 200)
                            }(), Object(d.getComments)(o.get("id"), M, q), r.emit("onCommentsOpened"), C()
                    }(), {
                        close: k
                    }
                },
                ee = function(e, t, n, r) {
                    var o = this,
                        a = t.dispatcher,
                        i = t.graphStore,
                        s = t.uiStore,
                        c = t.GraphHistory,
                        d = this,
                        p = i.get("isHub") || !1,
                        h = n,
                        g = s.get("isOnlyExploreAllowed"),
                        m = r,
                        b = [],
                        v = [],
                        _ = {},
                        w = {},
                        O = null,
                        E = !0,
                        j = [{
                            id: "",
                            type: "",
                            name: "",
                            type_id: "",
                            properties: {}
                        }],
                        S = [],
                        x = !1,
                        k = document.querySelector(e);
                    k.style.display = "block";
                    var C, N = document.querySelector(".datatable-title-text"),
                        T = document.querySelector(".datatable-title-symbol"),
                        L = [],
                        P = [],
                        A = {},
                        D = Object(f.a)(e),
                        M = function() {
                            E ? j.push({
                                type: void 0 != c.getNodeTypeById(O) ? c.getNodeTypeById(O).name : "",
                                type_id: O,
                                properties: {}
                            }) : j.push({
                                name_id: O,
                                name: void 0 != c.getEdgeTypeById(O) ? c.getEdgeTypeById(O).name : ""
                            })
                        };
                    N.parentNode.addEventListener("click", (function() {
                        var e;
                        O && h != u.a.VIEW && (i.get("belongsToHub") && !i.get("user").is_admin || (e = E ? c.getNodeTypeById(O) : c.getEdgeTypeById(O), function(e, n, r, o) {
                            Object(l.showNameColorDialog)(t, "Change the type name and color", n, r, (function(t, a, i) {
                                var s = n !== t,
                                    l = r !== a;
                                if (s) return i.call(), void(o ? c.handleNodeTypeRename(e, t) : c.handleEdgeTypeRename(e, t));
                                if (s || l) {
                                    var d = {
                                        action: o ? "nodetype_update" : "edgetype_update",
                                        id: e,
                                        prev: {}
                                    };
                                    n !== t && (d.name = t, d.prev.name = n), r !== a && (d.color = a, d.prev.color = r), c.notify(d), N.innerHTML = t, N.style.color = a, T.style.color = a
                                }
                                i.call()
                            }), i.get("belongsToHub") && i.get("user").is_admin ? "Name and color will change for the whole hub" : null)
                        }(O, e.name, e.color, E)))
                    }), !1);
                    var q = function() {
                            var e = (C.getSelected() || [])[0];
                            if (e) {
                                var n = C.getCellMeta(e[0], e[1]).prop.replace("properties.", "");
                                te(), Object(l.confirm)(t, "DELETE PROPERTY", "Are you sure you want to delete " + n + " property", (function() {
                                    var e = {};
                                    if (E) {
                                        var t = c.getNodeTypeById(O);
                                        if (!t) return void console.log("could not retrieve current Vertex Order data");
                                        e.action = "nodetype_delete", e.id = t.id, e.properties = {}, e.properties[n] = null
                                    } else {
                                        var r = c.getEdgeTypeById(O);
                                        if (!r) return void console.log("Could not retrieve current Vector Order data");
                                        e.action = "edgetype_delete", e.id = r.id, e[n] = null
                                    }
                                    c.notify(e, d), d.switchTo(O, E)
                                }), (function() {}))
                            } else console.log("nothing is selected")
                        },
                        I = {
                            callback: function(e) {
                                switch (e) {
                                    case "gc_select_row":
                                        n = (C.getSelected() || [])[0], r = Math.min(n[0], n[2]), o = Math.max(n[0], n[2]), a = C.countCols(), n && C.selectCell(r, 0, o, a - 1);
                                        break;
                                    case "gc_remove_row":
                                        ! function() {
                                            var e = (C.getSelected() || [])[0];
                                            e && (E ? U(e) : z(e), C.selectCell(e[0], e[1], e[2], e[3]))
                                        }();
                                        break;
                                    case "gc_new_column":
                                    case "gc_edit_column":
                                        break;
                                    case "gc_delete_column":
                                        q();
                                        break;
                                    case "gc_hub_explore":
                                        setTimeout((function() {
                                            for (var e = (C.getSelected() || [])[0], t = e[0] < e[2] ? e[0] : e[2], n = e[2] > e[0] ? e[2] : e[0], r = [], o = t; o <= n; o += 1) {
                                                var a = C.getDataAtRowProp(o, "id");
                                                a && r.push(a)
                                            }
                                            if (r.length) {
                                                var s = "/hubs/" + i.get("hub").id + "/explore?auto=true&" + (E ? "n=" : "e=") + r.join(",");
                                                window.open(s, "_blank")
                                            }
                                        }), 1);
                                        break;
                                    case "gc_direct_link":
                                        setTimeout((function() {
                                            var e, n, r = (C.getSelected() || [])[0],
                                                o = r[0];
                                            E ? e = C.getDataAtRowProp(o, "id") : 0 === r[1] ? e = C.getDataAtRowProp(o, "from") : 2 === r[1] && (e = C.getDataAtRowProp(o, "to")), e && (n = i.get("isHub") ? "/hubs/" + i.get("hub").id + "/data/selection/" + e : "/graphs/" + i.get("id") + "/selection/" + e, Object(l.showNodeUrl)(t, window.location.origin + n))
                                        }), 1)
                                }
                                var n, r, o, a
                            },
                            items: {
                                gc_select_row: {
                                    name: "Select Row",
                                    disabled: function() {
                                        var e = C.countCols(),
                                            t = (C.getSelected() || [])[0];
                                        return !t || (!C.getDataAtRowProp(t[0], "id") || t[3] - t[1] === e - 1)
                                    }
                                },
                                gc_remove_row: {
                                    name: "Delete Row",
                                    disabled: function() {
                                        var e = C.countCols(),
                                            t = (C.getSelected() || [])[0];
                                        if (!t) return !0;
                                        if (!C.getDataAtRowProp(t[0], "id")) return !0;
                                        var n = Math.min(t[1], t[3]),
                                            r = Math.max(t[1], t[3]);
                                        return !(0 === n && r + 2 >= e)
                                    }
                                },
                                hsep1: "---------",
                                gc_delete_column: {
                                    name: "Delete This Property",
                                    disabled: function() {
                                        if (i.get("belongsToHub") && !i.get("user").is_admin) return !0;
                                        var e = (C.getSelected() || [])[0];
                                        if (!e) return !0;
                                        if (e[1] !== e[3]) return !0;
                                        var t = C.getCellMeta(e[2], e[3]).prop;
                                        return !E || "string" !== typeof t || t.indexOf("properties.") < 0
                                    }
                                },
                                gc_direct_link: {
                                    name: "Link To Node",
                                    disabled: function() {
                                        var e = (C.getSelected() || [])[0];
                                        if (!e) return !0;
                                        if (e[0] !== e[2]) return !0;
                                        if (!E) {
                                            if (e[1] !== e[3]) return !0;
                                            if (0 !== e[1] && 2 !== e[1]) return !0
                                        }
                                        return !1
                                    }
                                }
                            }
                        },
                        R = function(e, n) {
                            var r, o, a = {},
                                i = n[0];
                            if (e.name)
                                if (e.type) {
                                    for (r in e)
                                        if (Object.prototype.hasOwnProperty.call(e, r))
                                            if ("properties" === r)
                                                for (o in a.properties = {}, e.properties) Object.prototype.hasOwnProperty.call(e.properties, o) && (a.properties[o] = e.properties[o]);
                                            else a[r] = e[r];
                                    var s = function(e) {
                                        13 == oe ? C.selectCell(e + 1, 0, e + 1, 0, !0) : 9 == oe && C.selectCell(e, 1, e, 1, !0)
                                    };
                                    setTimeout((function() {
                                        c.createNode(a, null, (function(e, n) {
                                            e ? e.message && e.message.indexOf("duplicate") >= 0 ? (C.deselectCell(), C.setDataAtRowProp(i, "name", "", "gc-preventDuplicate")) : Object(l.displayMessage)(t, "Error", "Unable to add this node.<br/>" + e.message) : n ? Object(l.displayMessage)(t, "Existing Node", "Adding an existing node in the Hub, with all existing properties", (function() {
                                                s(i)
                                            })) : s(i)
                                        }))
                                    }), 1)
                                } else console.log("node_create: type is required");
                            else console.log("node_create: name is required")
                        },
                        B = function(e, t) {
                            if (e.name) {
                                var n, r = {};
                                r.action = "node_update", r.id = e.id, r.prev = {}, 0 == t[1].indexOf("properties.") && t[1].length > 11 ? (r.properties = {}, r.prev.properties = {}, n = t[1].substring(11), r.properties[n] = t[3], r.prev.properties[n] = t[2]) : (r[n = t[1]] = t[3], r.prev[n] = t[2]), c.notify(r, d), r.prev && r.prev.name && (S.splice(S.indexOf(r.prev.name), 1), S.push(r.name))
                            } else console.log("node_update: name field is required")
                        },
                        F = function(e, t) {
                            C.selectCell(e, t, e, t);
                            var n = C.getCell(e, t);
                            n && (n.className += " htInvalid"), setTimeout((function() {
                                var n = C.getCell(e, t);
                                n && (n.className = n.className.replace("htInvalid", ""))
                            }), 2e3)
                        },
                        G = function(e, n) {
                            var r = n[0];
                            if (e.fromName)
                                if (e.toName) {
                                    var o = X(e.fromName);
                                    if (!o) return console.log("edge_create: source Vertex is not defined"), void F(r, 0);
                                    var a = X(e.toName);
                                    if (!a) return console.log("edge_create: target Vertex is not defined"), void F(r, 2);
                                    if (c.doesEdgeExist(o.id, a.id, e.name) || o.id === a.id) {
                                        console.log("you are not supposed to create this Vector");
                                        var i = C.countCols();
                                        C.setDataAtRowProp(r, "fromType", "", "gc-preventDuplicate"), C.setDataAtRowProp(r, "fromName", "", "gc-preventDuplicate"), C.setDataAtRowProp(r, "toType", "", "gc-preventDuplicate"), C.setDataAtRowProp(r, "toName", "", "gc-preventDuplicate"), C.selectCell(r, 0, r, 0);
                                        for (var s = 0; s < i; s += 1) {
                                            var d = C.getCell(r, s);
                                            d && (d.className += " htInvalid")
                                        }
                                        setTimeout((function() {
                                            for (var e = 0; e < i; e += 1) {
                                                var t = C.getCell(r, e);
                                                t && (t.className = t.className.replace("htInvalid", ""))
                                            }
                                        }), 2e3)
                                    } else setTimeout((function() {
                                        var n = function(e) {
                                            13 == oe ? C.selectCell(e + 1, 0, e + 1, 0) : 9 == oe && C.selectCell(e, 3, e, 3)
                                        };
                                        c.createEdge(o.id, a.id, e.name, e.weight || 1, null, (function(e, o) {
                                            e ? Object(l.displayMessage)(t, "Error", "Unable to reach the server") : o ? Object(l.displayMessage)(t, "Existing Vectors", "Adding " + o + " existing edge" + (o > 1 ? "s" : "") + " in the Hub, with all existing properties", (function() {
                                                n(r)
                                            })) : n(r)
                                        }))
                                    }), 1)
                                } else console.log("edge_create: toName field is required");
                            else console.log("edge_create: fromName field is required")
                        },
                        H = function(e, n) {
                            if (e.fromName)
                                if (e.toName) {
                                    var r = n[0],
                                        o = e.from,
                                        a = e.to,
                                        i = c.getEdgeById(e.id);
                                    if ("fromName" !== n[1] && "toName" !== n[1]) {
                                        var s, u = {
                                            action: "edge_update"
                                        };
                                        u.id = e.id, u.name = e.name, u.name_id = e.name_id, u.from = i.from, u.to = i.to, 0 == n[1].indexOf("properties.") && n[1].length > 11 ? (s = n[1].substring(11), u.properties = {}, u.prev = {}, u.prev.properties = {}, u.properties[s] = n[3], u.prev.properties[s] = n[2]) : (s = n[1], u.prev = {}, u[s] = n[3], u.prev[s] = n[2]), c.notify(u, d)
                                    } else {
                                        if ("fromName" === n[1]) {
                                            var p = X(n[3]);
                                            if (!p) return console.log("edge_update: source node is not defined"), void F(r, 0);
                                            o = p.id
                                        }
                                        if ("toName" === n[1]) {
                                            var f = X(n[3]);
                                            if (!f) return console.log("edge_update: source node is not defined"), void F(r, 2);
                                            a = f.id
                                        }
                                        if (o === a || c.doesEdgeExist(o, a, e.name, e.id)) {
                                            console.log("you are not supposed to create this Vector");
                                            var h = C.countCols(),
                                                g = c.getNodeById(i.from),
                                                m = c.getNodeById(i.to);
                                            return C.setDataAtRowProp(r, "fromName", g.name, "gc-preventDuplicate"), C.setDataAtRowProp(r, "toName", m.name, "gc-preventDuplicate"), void setTimeout((function() {
                                                Object(l.displayMessage)(t, "Not Allowed", "Source and target nodes are invalid", (function() {
                                                    C.selectCell(r - 1, 0, r - 1, h - 1);
                                                    for (var e = 0; e < h; e += 1) F(r, e)
                                                }))
                                            }), 1)
                                        }
                                        var y, b, v = {};
                                        for (y in e)
                                            if (Object.prototype.hasOwnProperty.call(e, y)) switch (y) {
                                                case "properties":
                                                    for (b in v.properties = {}, e.properties) Object.prototype.hasOwnProperty.call(e.properties, b) && (v.properties[b] = e.properties[b]);
                                                    break;
                                                default:
                                                    v[y] = e[y]
                                            }
                                        v.from = o, v.to = a;
                                        var _ = n[1],
                                            w = n[2];
                                        setTimeout((function() {
                                            c.handleUpdateEdge(v, (function(e) {
                                                var n;
                                                if (e) {
                                                    console.log(e), n = "fromName" == _ ? 0 : 2, C.selectCell(r, n), C.setDataAtRowProp(r, _, w, "gc-preventDuplicate");
                                                    var o = function() {
                                                        F(r, n)
                                                    };
                                                    "not the owner" === e.message ? Object(l.displayMessage)(t, "Not Allowed", "Only admins or the owner of the Vector can change the source and target nodes.", o) : Object(l.displayMessage)(t, "Server Error", "Please try again.", o)
                                                } else {
                                                    var a = j.splice(j.length - 2, 1);
                                                    j.splice(r, 0, a[0])
                                                }
                                            }))
                                        }), 1)
                                    }
                                } else console.log("edge_update: toName field is required");
                            else console.log("edge_update: fromName field is required")
                        };

                    function U(e) {
                        te();
                        var t, n = [];
                        for (t = e[0]; t <= e[2]; t += 1) j[t].id && n.push(j[t].id);
                        if (!(n.length < 1)) {
                            c.buildDeleteSignals(n, null, (function(e, t) {
                                if (!e) {
                                    var n;
                                    for (n = 0; n < t.length; n += 1) c.notify(t[n]);
                                    c.clearSelectedNodes(d)
                                }
                            }))
                        }
                    }

                    function z(e) {
                        te();
                        var t, n = [];
                        for (t = e[0]; t <= e[2]; t += 1) j[t].id && n.push(j[t].id);
                        if (!(n.length < 1)) {
                            c.buildDeleteSignals(null, n, (function(t, n) {
                                if (!t) {
                                    var r;
                                    for (r = 0; r < n.length; r += 1) c.notify(n[r], d);
                                    j.splice(e[0], e[2] - e[0] + 1), 0 == j.length && j.push({
                                        name_id: O,
                                        name: void 0 != c.getEdgeTypeById(O) ? c.getEdgeTypeById(O).name : ""
                                    }), c.clearSelectedNodes(d), C.render()
                                }
                            }))
                        }
                    }
                    var W = function(e) {
                        var t, n, r, o = Y(e.id),
                            a = o.type_id;
                        o || console.log("could not find a node with id " + e.id), _[a].splice(_[a].indexOf(o), 1), A[a] === e.id && (A[a] = null);
                        var i = !1,
                            s = function(e) {
                                var t, n, r, o = [];
                                for (t in w)
                                    if (Object.prototype.hasOwnProperty.call(w, t))
                                        for (n = w[t], r = 0; r < n.length; r += 1) n[r].to !== e && n[r].from !== e || o.push(n[r]);
                                return o
                            }(e.id);
                        for (t = 0; t < s.length; t += 1) {
                            for (n = (r = w[s[t].name_id]).length - 1; n >= 0; n -= 1)
                                if (r[n].id == s[t].id) {
                                    r.splice(n, 1);
                                    break
                                }
                            A[s[t].name_id] === s[t].id && (A[s[t].name_id] = null), E || s[t].name_id !== a || (i = !0)
                        }
                        E && O === a && (i = !0), 0 == j.length && (E ? j.push({
                            type: void 0 != c.getNodeTypeById(O) ? c.getNodeTypeById(O).name : "",
                            type_id: O,
                            properties: {}
                        }) : j.push({
                            name_id: O,
                            name: void 0 != c.getEdgeTypeById(O) ? c.getEdgeTypeById(O).name : ""
                        })), i && C.render()
                    };

                    function Y(e) {
                        var t, n;
                        for (t in _)
                            if (Object.prototype.hasOwnProperty.call(_, t))
                                for (n = 0; n < _[t].length; n += 1)
                                    if (_[t][n].id && _[t][n].id == e) return _[t][n]
                    }

                    function V(e) {
                        var t, n;
                        for (t in w)
                            if (Object.prototype.hasOwnProperty.call(w, t))
                                for (n = 0; n < w[t].length; n += 1)
                                    if (w[t][n].id && w[t][n].id === e) return w[t][n]
                    }

                    function X(e) {
                        var t, n;
                        for (t in _)
                            if (Object.prototype.hasOwnProperty.call(_, t))
                                for (n = 0; n < _[t].length; n += 1)
                                    if (_[t][n].name && _[t][n].name === e) return _[t][n]
                    }
                    var K = function(e) {
                            var t, n, r = c.getNodeTypeById(e.id);
                            if (r) {
                                if (e.properties) {
                                    if (e.properties.length !== e.prev.properties.length) return void console.log("signal.properties and signal.properties_prev should be the same length");
                                    for (t = 0; t < e.properties.length; t += 1) {
                                        var o = e.prev.properties[t].name,
                                            a = e.prev.properties[t].name_alias;
                                        if ((o || a) && Object.prototype.hasOwnProperty.call(_, e.id))
                                            for (n = 0; n < _[e.id].length; n += 1) _[e.id][n].properties && Object.prototype.hasOwnProperty.call(_[e.id][n].properties, e.prev.properties[t].name) && (_[e.id][n].properties[e.properties[t].name] = _[e.id][n].properties[e.prev.properties[t].name], delete _[e.id][n].properties[e.prev.properties[t].name])
                                    }
                                }
                                E && O === r.id && d.switchTo(O, E)
                            } else console.log("Could not find nodetype for id: " + e.id)
                        },
                        $ = function(e) {
                            var t, n, r = c.getEdgeTypeById(e.id);
                            if (r) {
                                if (e.properties) {
                                    if (e.properties.length !== e.prev.properties.length) return void console.log("signal.properties and signal.properties_prev should be the same length");
                                    for (t = 0; t < e.properties.length; t += 1) {
                                        var o = e.prev.properties[t].name,
                                            a = e.prev.properties[t].name_alias;
                                        if ((o || a) && Object.prototype.hasOwnProperty.call(w, e.id))
                                            for (n = 0; n < w[e.id].length; n += 1) w[e.id][n].properties && Object.prototype.hasOwnProperty.call(w[e.id][n].properties, e.prev.properties[t].name) && (w[e.id][n].properties[e.properties[t].name] = w[e.id][n].properties[e.prev.properties[t].name], delete w[e.id][n].properties[e.prev.properties[t].name])
                                    }
                                }
                                if (e.name)
                                    for (n = 0; n < w[e.id].length; n += 1) w[e.id][n].properties && (w[e.id][n].name = e.name);
                                E || O !== r.id || d.switchTo(O, E)
                            } else console.log("Could not find Vector Order for id: " + e.id)
                        },
                        Z = function(e, t) {
                            var n, r = [];
                            for (r.push({
                                    data: "fromName",
                                    type: "autocomplete",
                                    source: S,
                                    strict: !0,
                                    allowInvalid: !1,
                                    validator: Q,
                                    readOnly: h != u.a.EDIT || t || g
                                }), r.push({
                                    data: "name",
                                    readOnly: !0
                                }), r.push({
                                    data: "toName",
                                    type: "autocomplete",
                                    source: S,
                                    strict: !0,
                                    allowInvalid: !1,
                                    validator: Q,
                                    readOnly: h != u.a.EDIT || t || g
                                }), r.push({
                                    data: "weight",
                                    readOnly: h != u.a.EDIT || t || g
                                }), n = 0; n < e.length - 1; n += 1) r.push({
                                data: "properties." + e[n],
                                readOnly: h != u.a.EDIT || t || g
                            });
                            return r.push({
                                readOnly: !0
                            }), r
                        },
                        J = function(e, t) {
                            var n, r = [];
                            for (r.push({
                                    data: "name",
                                    validator: Q,
                                    allowInvalid: !1,
                                    readOnly: h != u.a.EDIT || t || g
                                }), r.push({
                                    data: "description",
                                    readOnly: h != u.a.EDIT || t || g
                                }), r.push({
                                    data: "image",
                                    readOnly: h != u.a.EDIT || t || g
                                }), r.push({
                                    data: "reference",
                                    readOnly: h != u.a.EDIT || t || g
                                }), n = 0; n < e.length - 1; n += 1) "type" !== e[n] && "name" !== e[n] && "description" !== e[n] && "image" !== e[n] && "reference" !== e[n] && r.push({
                                data: "properties." + e[n],
                                readOnly: h != u.a.EDIT || t || g
                            });
                            return r.push({
                                readOnly: !0
                            }), r
                        };

                    function Q(e, t) {
                        t("" !== e)
                    }
                    var ee = function() {
                            var e = c.getNodeTypes(),
                                t = c.getEdgeTypes(),
                                n = c.getNodes(),
                                r = c.getLinks();
                            e && function(e) {
                                for (var t = 0; t < e.length; t += 1) b.push(e[t].id);
                                if (e.length > 0) {
                                    var n = e[e.length - 1];
                                    T.innerHTML = "&#x25cf;", n ? (N.innerHTML = n.name, N.style.color = n.color, T.style.color = n.color, O = n.id, E = !0) : N.innerHTML = ""
                                }
                            }(e), t && function(e) {
                                for (var t = 0; t < e.length; t += 1) v.push(e[t].id), w[e[t].id] = [];
                                if (e.length > 0) {
                                    var n = e[e.length - 1];
                                    T.innerHTML = "&mdash;", n ? (N.innerHTML = n.name, N.style.color = n.color, T.style.color = n.color, O = n.id, E = !1) : N.innerHTML = ""
                                }
                            }(t), n && function(e) {
                                var t, n;
                                for (t = 0; t < e.length; t += 1) {
                                    var r = e[t],
                                        o = c.getNodeTypeById(r.type_id),
                                        a = {
                                            id: r.id,
                                            type: r.type,
                                            name: r.name,
                                            type_id: o.id,
                                            image: r.image,
                                            description: r.description,
                                            reference: r.reference,
                                            properties: {}
                                        },
                                        i = o.properties;
                                    if (i && r.properties)
                                        for (n = 0; n < i.length; n += 1) Object.prototype.hasOwnProperty.call(r.properties, i[n].name) && (a.properties[i[n].name] = r.properties[i[n].name]);
                                    Object.prototype.hasOwnProperty.call(_, o.id) || (_[o.id] = []), _[o.id].push(a), S.push(r.name)
                                }
                            }(n), r && function(e) {
                                var t;
                                for (t = 0; t < e.length; t += 1) {
                                    var n = e[t],
                                        r = c.getEdgeTypeById(n.name_id);
                                    Object.prototype.hasOwnProperty.call(w, r.id) || (w[r.id] = []);
                                    var o = Y(n.from),
                                        a = Y(n.to),
                                        i = {
                                            from: n.from,
                                            fromType: o.type,
                                            fromName: o.name,
                                            fromTypeId: o.type_id,
                                            name: n.name,
                                            name_id: n.name_id,
                                            to: n.to,
                                            toType: a.type,
                                            toName: a.name,
                                            toTypeId: a.type_id,
                                            id: n.id,
                                            properties: {}
                                        };
                                    r.weighted && (i.weight = n.weight);
                                    var s = r.properties;
                                    if (s && n.properties)
                                        for (var l = 0; l < s.length; l += 1) Object.prototype.hasOwnProperty.call(n.properties, s[l].name) && (i.properties[s[l].name] = n.properties[s[l].name]);
                                    w[n.name_id].push(i)
                                }
                            }(r), e && e.length > 0 && (O = e[0].name, E = !0), e && 0 != e.length || (k.className += " hide-it")
                        },
                        te = function() {
                            C && C.deselectCell()
                        };
                    i.get("isHub") && (I.items.hsep2 = "---------", I.items.gc_hub_explore = {
                        name: "Open In Explore",
                        disabled: function() {
                            return !1
                        }
                    }), D.handsontable({
                        observeChanges: !1,
                        minSpareRows: 0,
                        rowHeaders: !0,
                        colHeaders: ["Type", "Name", "---"],
                        columns: [{
                            data: "type",
                            readOnly: h != u.a.EDIT && null == O
                        }, {
                            data: "name",
                            readOnly: h != u.a.EDIT && null == O
                        }, {
                            readOnly: h != u.a.EDIT && null == O
                        }],
                        data: j,
                        stretchH: "last",
                        contextMenu: h == u.a.EDIT && I,
                        width: Object(y.I)().x / 2,
                        height: Object(y.I)().y - 192,
                        undo: !1,
                        manualColumnResize: !0,
                        columnSorting: !0,
                        fillHandle: !1,
                        colWidths: [160, 160, 160, 160],
                        copyPaste: Object(y.O)() ? {
                            swfPath: "ZeroClipboard.swf"
                        } : null
                    }), D.on("click", "label.gc-ss-editprop", (function(e) {
                        var n, r, o, a;
                        (C.deselectCell(), h == u.a.EDIT) && (i.get("belongsToHub") && !i.get("user").is_admin || (n = e.target, r = n.className.indexOf(" last") >= 0, o = r ? "" : n.innerHTML, a = r ? "Add new property" : "Update the property name", Object(l.singleTextEntry)(t, a, o, r ? "ADD" : "UPDATE", (function(e) {
                            if (e !== o) {
                                if (E) {
                                    if (c.getPropNamesForNodeType(O).indexOf(e) >= 0) return
                                } else if (c.getPropNamesForLinkType(O).indexOf(e) >= 0) return;
                                var t = {};
                                t.id = O, t.action = E ? "nodetype_update" : "edgetype_update", t.properties = [], t.properties.push({
                                    name: e.trim(),
                                    name_alias: e.trim()
                                }), t.prev = {
                                    properties: []
                                }, t.prev.properties.push({
                                    name: r ? null : o,
                                    name_alias: r ? null : o
                                }), c.notify(t, d), E ? K(t) : $(t)
                            }
                        }))))
                    })), (C = D.handsontable("getInstance")).addHook("beforeColumnSort", (function() {
                        j.pop()
                    })), C.addHook("afterColumnSort", (function() {
                        M()
                    }));
                    var ne = !1;
                    C.addHook("beforeOnCellMouseDown", (function(e, t) {
                        -1 === t.row && (ne = !0)
                    }));
                    var re = [];
                    C.addHook("afterSelectionEndByProp", (function(e, t, n) {
                        if (c.requestFocus(d), ne) ne = !1;
                        else {
                            if (I) {
                                var r = Math.abs(n - e) + 1,
                                    o = r + " row" + (r > 1 ? "s" : "");
                                I.items.gc_remove_row.name = "Delete " + o, I.items.gc_select_row.name = "Select " + o
                            }
                            var a = C.getDataAtRowProp(e, "id"),
                                i = [];
                            if (e === n) {
                                if (!a) return;
                                i.push(a)
                            } else
                                for (var s = n > e ? n : e, l = e < n ? e : n; l <= s; l += 1) {
                                    var u = C.getDataAtRowProp(l, "id");
                                    u && i.push(u)
                                }
                            if (O && a && (A[O] = a), x) x = !1;
                            else if (!Object(y.n)(re, i))
                                if (re = i, E) c.focusNode(i, d);
                                else {
                                    for (var p = [], f = 0; f < i.length; f += 1) {
                                        var h = c.getEdgeById(i[f]);
                                        p.push({
                                            id: h.id,
                                            from: h.from,
                                            to: h.to
                                        })
                                    }
                                    c.focusEdge(p, d)
                                }
                        }
                    })), C.addHook("afterDeselect", (function() {
                        I && (I.items.gc_remove_row.name = "Delete row", I.items.gc_select_row.name = "Select row"), re = [], L.forEach((function(e) {
                            "function" === typeof e && e.call()
                        })), i.get("isHub") || c.clearSelectedNodes()
                    })), C.addHook("afterValidate", (function(e, t, n, r) {
                        if (!e) {
                            var o = C.getCell(n, C.propToCol(r));
                            o && setTimeout((function() {
                                o.className = o.className.replace("htInvalid", "")
                            }), 2e3)
                        }
                    })), C.addHook("beforeChange", (function(e, t) {
                        if ("loadData" !== t && "gc-preventDuplicate" !== t) {
                            var n, r, o = -1;
                            for (r = 0; r < e.length; r += 1)(n = e[r][0]) > o && (o = n);
                            for (; j.length - 1 < o;) E ? j.push({
                                type: void 0 != c.getNodeTypeById(O) ? c.getNodeTypeById(O).name : "",
                                type_id: O,
                                properties: {}
                            }) : j.push({
                                name_id: O,
                                name: void 0 != c.getEdgeTypeById(O) ? c.getEdgeTypeById(O).name : ""
                            })
                        }
                    }));
                    var oe = 0;
                    C.addHook("afterChange", (function(e, t) {
                        if ("loadData" !== t && "gc-preventDuplicate" !== t && "external" !== t) {
                            var n, r, o = [];
                            if (!e && e.length > 0) return void console.log("change should exist");
                            for (n = 0; n < e.length; n += 1) {
                                var a = e[n];
                                if ((!a || 4 !== a.length || a[2] !== a[3]) && (r = j[a[0]]))
                                    if (r.id) {
                                        if (o.indexOf(a[0]) >= 0) continue;
                                        E ? B(r, a) : H(r, a)
                                    } else o.push(a[0]), E ? "name" === a[1] ? R(r, a) : console.log("you can only create by filling name property") : r.fromName && r.toName ? G(r, a) : console.log("you can only create Vectors by have defining fromName and toName")
                            }
                        }
                    })), C.addHook("beforeKeyDown", (function(e) {
                        if (oe = e.keyCode, 46 === e.keyCode || 8 === e.keyCode) {
                            if (h != u.a.EDIT) return;
                            var t = (C.getSelected() || [])[0];
                            if (!t) return;
                            if (!C.getDataAtRowProp(t[0], "id")) return void e.stopImmediatePropagation();
                            if (Object(y.W)(document.activeElement)) return;
                            var n = Math.min(t[1], t[3]),
                                r = Math.max(t[1], t[3]);
                            E ? 0 === n && (e.stopImmediatePropagation(), U(t), e.preventDefault()) : 0 === n && r >= 2 && (e.stopImmediatePropagation(), z(t), e.preventDefault())
                        }
                    })), this.switchTo = function(e, t) {
                        if (O = e, E = t, p) {
                            C && C.deselectCell();
                            var n = [],
                                r = [];
                            e && (n = t ? c.getPropAliasesForNodeType(e) : c.getPropAliasesForLinkType(e), r = t ? c.getPropNamesForNodeType(e) : c.getPropNamesForLinkType(e));
                            for (var o = 0; o < n.length; o += 1) n[o] = '<label class="gc-ss-editprop">' + n[o] + "</label>";
                            if (n.push('<label class="gc-ss-editprop last">+</label>'), r.push("---"), E ? (n.unshift("Name", "Description", "Image", "Reference"), r.unshift("name", "description", "image", "reference")) : n.unshift("Name", "Relation", "Name", "Weight"), j)
                                for (var a = j.length - 1; a >= 0; a -= 1) Object.prototype.hasOwnProperty.call(j[a], "id") && j[a].id && "" !== j[a].id || j.splice(a, 1);
                            E ? (Object.prototype.hasOwnProperty.call(_, O) || (_[O] = []), j = _[O]) : (Object.prototype.hasOwnProperty.call(w, O) || (w[O] = []), j = w[O]), j || (j = []), M();
                            var i = [];
                            if (t) {
                                i = [160, 160, 160, 160];
                                for (var s = 4; s < n.length - 1; s += 1) i.push(160)
                            } else
                                for (var l = 0; l < n.length - 1; l += 1) i.push(160);
                            var d = {
                                data: j,
                                colHeaders: n,
                                columns: t ? J(r, null == O) : Z(r, null == O),
                                fixedColumnsLeft: t ? 1 : 0,
                                contextMenu: h == u.a.EDIT && I,
                                colWidths: i,
                                rowHeaders: function(e) {
                                    if (E) {
                                        var t = j[e].id;
                                        return t && 2 === c.getNodeStatus(t) ? '<div class="relative"><span class="ss-gizmo ss-lock" title="Private node" style="position: absolute; left: -3px;"></span>' + (e + 1) + "</div>" : e + 1
                                    }
                                    return e + 1
                                }
                            };
                            if (C.updateSettings(d), C.render(), t) {
                                var f = c.getNodeTypeById(O);
                                f ? (T.innerHTML = "&#x25cf;", N.innerHTML = f.name, N.style.color = f.color, T.style.color = f.color) : N.innerHTML = ""
                            } else {
                                var g = c.getEdgeTypeById(O);
                                g ? (T.innerHTML = "&mdash;", N.innerHTML = g.name, N.style.color = g.color, T.style.color = g.color) : N.innerHTML = ""
                            }
                        }
                    };
                    var ae;

                    function ie() {
                        p && (A[O] ? function() {
                            var e;
                            if (E) {
                                c.focusNode(A[O], d);
                                var t = _[O];
                                for (e = 0; e < t.length; e += 1)
                                    if (A[O] === t[e].id) {
                                        window.requestAnimationFrame((function() {
                                            x = !0, C.selectCell(e, 0, e, C.countCols() - 1, !0)
                                        }));
                                        break
                                    }
                            } else {
                                var n = w[O];
                                for (e = 0; e < n.length; e += 1)
                                    if (A[O] === n[e].id) {
                                        c.focusEdge([{
                                            from: n[e].from,
                                            to: n[e].to,
                                            id: n[e].id
                                        }], d), window.requestAnimationFrame((function() {
                                            x = !0, C.selectCell(e, 0, e, C.countCols() - 1, !0)
                                        }));
                                        break
                                    }
                            }! function(e, t) {
                                for (var n = 0; n < P.length; n += 1) "function" === typeof P[n] && P[n].call(null, e, t)
                            }(A[O], E)
                        }() : c.clearSelectedNodes())
                    }
                    this.triggerColumnDelete = function(e, t) {
                        C.selectCell(e, t, e, t), q()
                    }, this.resize = function(e, t) {
                        C.updateSettings({
                            width: Math.floor(e),
                            height: Math.floor(t - 192)
                        })
                    }, this.getContainer = function() {
                        return k
                    }, this.hasSelected = function() {
                        return void 0 !== C.getSelected()
                    }, this.getHOT = function() {
                        return C
                    }, this.onDeselect = function(e) {
                        L.push(e)
                    }, this.onSheetChanged = function(e) {
                        P.push(e)
                    }, this.getCurrentData = function() {
                        return j
                    }, this.getNodeData = function() {
                        return _
                    }, this.getEdgeData = function() {
                        return w
                    }, this.cleanUp = function() {
                        var e = document.getElementById("CopyPasteDiv");
                        e && e.parentNode.removeChild(e);
                        var t = document.body.querySelector(".htMenu");
                        t && t.parentNode.removeChild(t)
                    }, k.parentNode.style.height = "0", ee(), a.bind("trigger", (function(e) {
                        switch (e.action) {
                            case "nodetype_create":
                                ! function(e) {
                                    b.indexOf(e.id) < 0 && b.push(e.id), 1 == b.length && (k.className = k.className.replace("hide-it", ""))
                                }(e);
                                break;
                            case "nodetype_update":
                                K(e);
                                break;
                            case "nodetype_delete":
                                ! function(e) {
                                    var t = b.indexOf(e.id);
                                    if (t < 0) console.log("nodetype with id (" + e.id + ") is not registered");
                                    else {
                                        var n, r = !1;
                                        for (n in e)
                                            if (Object.prototype.hasOwnProperty.call(e, n)) {
                                                if ("id" === n || "action" === n) continue;
                                                r = !0
                                            }
                                        if (r || b.splice(t, 1), 0 == b.length && (k.className += " hide-it"), A[e.id] = null, O === e.id) {
                                            var o = c.getNodeTypes();
                                            o.length > 0 && d.switchTo(o[0].id, !0)
                                        }
                                    }
                                }(e);
                                break;
                            case "edgetype_create":
                                ! function(e) {
                                    v.indexOf(e.id) < 0 && v.push(e.id), Object.prototype.hasOwnProperty.call(w, e.id) || (w[e.id] = [])
                                }(e);
                                break;
                            case "edgetype_update":
                                return void $(e);
                            case "edgetype_delete":
                                ! function(e) {
                                    var t = v.indexOf(e.id);
                                    if (t < 0) console.log("edgetype with id (" + e.id + ") is not registered");
                                    else {
                                        var n, r = !1;
                                        for (n in e)
                                            if (Object.prototype.hasOwnProperty.call(e, n)) {
                                                if ("id" === n || "action" === n) continue;
                                                r = !0
                                            }
                                        if (r || v.splice(t, 1), A[e.id] = null, O === e.id) {
                                            var o = c.getNodeTypes();
                                            o.length > 0 && d.switchTo(o[0].id, !0)
                                        }
                                    }
                                }(e);
                                break;
                            case "node_create":
                                ! function(e) {
                                    var t;
                                    if (t = Object.prototype.hasOwnProperty.call(e, "type_id") ? c.getNodeTypeById(e.type_id) : c.getNodeTypeByName(e.type)) {
                                        Object.prototype.hasOwnProperty.call(_, t.id) || (_[t.id] = []), null === O && d.switchTo(t.id, !0);
                                        var n = {
                                                id: e.id,
                                                type: e.type,
                                                name: e.name,
                                                type_id: t.id,
                                                description: e.description,
                                                image: e.image,
                                                reference: e.reference,
                                                properties: {}
                                            },
                                            r = t.properties;
                                        if (r && e.properties)
                                            for (var o = 0; o < r.length; o += 1) Object.prototype.hasOwnProperty.call(e.properties, r[o].name) && (n.properties[r[o].name] = e.properties[r[o].name]);
                                        if (_[t.id].push(n), E && O === t.id) {
                                            for (var a = j.length - 1; a >= 0; a -= 1) Object.prototype.hasOwnProperty.call(j[a], "id") && j[a].id && "" !== j[a].id || j.splice(a, 1);
                                            j.push({
                                                properties: {},
                                                type: e.type,
                                                type_id: O
                                            }), C.render()
                                        }
                                        S.push(n.name)
                                    } else console.log(e.type + " is not defined")
                                }(e);
                                break;
                            case "node_update":
                                ! function(e) {
                                    var t = Y(e.id);
                                    if (t) {
                                        var n, r, o, a, i, s = !1;
                                        if (Object.prototype.hasOwnProperty.call(e, "type") || Object.prototype.hasOwnProperty.call(e, "type_id"))
                                            if (s = !0, Object.prototype.hasOwnProperty.call(e, "type")) {
                                                if (!(n = c.getNodeTypeByName(e.type))) return void console.log("node_update: type value does not have a corresponding node type");
                                                e.type_id = n.id
                                            } else {
                                                if (!(n = c.getNodeTypeById(e.type_id))) return void console.log("node_update: type_id value does not have a corresponding node type");
                                                e.type = n.name
                                            }
                                        for (o in s && (t.properties = {}, r = t.type_id), e)
                                            if (Object.prototype.hasOwnProperty.call(e, o)) {
                                                if ("id" === o || "action" === o || "prev" === o) continue;
                                                if ("properties" === o)
                                                    for (a in e.properties) Object.prototype.hasOwnProperty.call(e.properties, a) && (t.properties[a] = e.properties[a]);
                                                else t[o] = e[o]
                                            }
                                        if (s)
                                            for (Object.prototype.hasOwnProperty.call(_, e.type_id) || (_[e.type_id] = []), _[e.type_id].push(t), i = _[r].length - 1; i >= 0; i -= 1)
                                                if (_[r][i].id === e.id) {
                                                    _[r].splice(i, 1);
                                                    break
                                                }
                                        var l = !1;
                                        for (o in E && t.type_id === O && (l = !0), s && e.prev.type_id === O && (l = !0), w)
                                            if (Object.prototype.hasOwnProperty.call(w, o))
                                                for (i = 0; i < w[o].length; i += 1) w[o][i].from === t.id && (w[o][i].fromType = t.type, w[o][i].fromName = t.name, E || o !== O || (l = !0)), w[o][i].to === t.id && (w[o][i].toType = t.type, w[o][i].toName = t.name, E || o !== O || (l = !0));
                                        l && d.switchTo(O, E), e.prev && e.prev.name && (S.splice(S.indexOf(e.prev.name), 1), S.push(e.name))
                                    } else console.log("could not find a node with id" + e.id)
                                }(e);
                                break;
                            case "node_delete":
                                W(e);
                                break;
                            case "edge_create":
                                ! function(e) {
                                    var t, n, r;
                                    if (t = Object.prototype.hasOwnProperty.call(e, "name_id") ? c.getEdgeTypeById(e.name_id) : c.getEdgeTypeByName(e.name)) {
                                        e.name_id = t.id, Object.prototype.hasOwnProperty.call(w, e.name_id) || (w[e.name_id] = []), null === O && d.switchTo(e.name_id, !1);
                                        var o = Y(e.from),
                                            a = Y(e.to),
                                            i = {
                                                from: e.from,
                                                fromType: o.type,
                                                fromName: o.name,
                                                fromTypeId: o.type_id,
                                                name: e.name,
                                                name_id: e.name_id,
                                                to: e.to,
                                                toType: a.type,
                                                toName: a.name,
                                                toTypeId: a.type_id,
                                                id: e.id,
                                                properties: {}
                                            };
                                        if (t.weighted && (i.weight = e.weight), Object.prototype.hasOwnProperty.call(e, "properties") && e.properties && Object.prototype.hasOwnProperty.call(t, "properties") && t.properties)
                                            for (n = 0; n < t.properties.length; n += 1) r = t.properties[n].name, Object.prototype.hasOwnProperty.call(e.properties, r) && (i.properties[r] = e.properties[r]);
                                        if (w[e.name_id].push(i), !E && O === e.name_id) {
                                            for (n = j.length - 1; n >= 0; n -= 1) Object.prototype.hasOwnProperty.call(j[n], "id") && j[n].id && "" !== j[n].id || j.splice(n, 1);
                                            j.push({
                                                name: e.name,
                                                name_id: e.name_id
                                            }), C.render()
                                        }
                                    } else console.log(e.name_id + " is not defined")
                                }(e);
                                break;
                            case "edge_update":
                                ! function(e) {
                                    if (e.prev) {
                                        var t, n, r = V(e.id);
                                        if (r) {
                                            if (e.prev.from) {
                                                var o = c.getNodeById(e.from);
                                                o || console.log('could not find a node for the updated "from" id' + e.from), r.from = e.from, r.fromName = o.name, r.fromType = o.type
                                            }
                                            if (e.prev.to) {
                                                var a = c.getNodeById(e.to);
                                                a || console.log('could not find a node for the updated "to" id' + e.to), r.to = e.to, r.toName = a.name, r.toType = a.type
                                            }
                                            for (t in e)
                                                if (Object.prototype.hasOwnProperty.call(e, t)) {
                                                    if ("id" === t || "action" === t || "to" === t || "from" === t || "toName" === t || "fromName" === t || "toType" === t || "fromType" === t || "name" === t) continue;
                                                    if ("properties" === t)
                                                        for (n in e.properties) Object.prototype.hasOwnProperty.call(e.properties, n) && (r.properties || (r.properties = {}), r.properties[n] = e.properties[n]);
                                                    else r[t] = e[t]
                                                }
                                            if (e.prev && e.prev.name && e.name) {
                                                var i = c.getEdgeTypeById(r.name_id),
                                                    s = c.getEdgeTypeByName(e.name);
                                                r.name = s.name, r.name_id = s.id;
                                                for (var l = 0; l < w[i.id].length; l += 1)
                                                    if (w[i.id][l].id === r.id) {
                                                        w[i.id].splice(l, 1);
                                                        break
                                                    }
                                                w[s.id].push(r)
                                            }
                                            E || e.name !== O || C.render()
                                        } else console.log("could not find the Vector for the id " + e.id)
                                    } else console.log("signal does not have the prev key")
                                }(e);
                                break;
                            case "edge_delete":
                                ! function(e) {
                                    var t = V(e.id);
                                    t ? (w[t.name_id].splice(w[t.name_id].indexOf(t), 1), A[t.name_id] === t.id && (A[t.name_id] = null), E || O !== t.name_id || C.render()) : console.log("could not find a Vector with id " + e.id)
                                }(e)
                        }
                    }), this), a.bind("onTypeFocused", (function(e, t) {
                        e ? (Object(y.nb)(k, "hide-it"), o.switchTo(e, t), ie()) : Object(y.h)(k, "hide-it")
                    }), this), a.bind("releaseFocus", te, this), a.bind("onNodeSelected", (function(e) {
                        var t;
                        t = Array.isArray(e) ? e[0] : e;
                        var n, r = c.getNodeById(t);
                        if (r) {
                            if (Object(y.N)(k.parentElement, "datatable-min")) return O = r.type_id, void(E = !0);
                            O !== r.type_id && o.switchTo(r.type_id, !0);
                            var a = _[r.type_id];
                            for (n = 0; n < a.length; n += 1)
                                if (r.id === a[n].id) {
                                    window.requestAnimationFrame((function() {
                                        x = !0, C.selectCell(n, 0, n, C.countCols() - 1, !0)
                                    }));
                                    break
                                }
                        } else console.log("node does not exist")
                    }), this), a.bind("onEdgeFocused", (function(e) {
                        var t, n = e[0].id,
                            r = c.getEdgeById(n);
                        if (r) {
                            if (Object(y.N)(k.parentElement, "datatable-min")) return O = r.name_id, void(E = !1);
                            O !== r.name_id && o.switchTo(r.name_id, !1);
                            var a = w[r.name_id];
                            for (t = 0; t < a.length; t += 1)
                                if (r.id === a[t].id) {
                                    window.requestAnimationFrame((function() {
                                        x = !0, C.selectCell(t, 0, t, C.countCols() - 1, !0)
                                    }));
                                    break
                                }
                        } else console.log("edge does not exist")
                    }), this), a.bind("editModeUpdated", (function(e) {
                        m || (h = e, o.switchTo(O, E))
                    }), this), a.bind("onModalOpened", (function() {
                        C ? (ae = (C.getSelected() || [])[0], C.deselectCell()) : ae = null
                    }), this), a.bind("onModalClosed", (function() {
                        ae && C && C.selectCell(ae[0], ae[1])
                    }), this), a.bind("onDatatableOpened", (function() {
                        p = !0, o.switchTo(O, E), ie()
                    }), this), a.bind("onDatatableClosed", (function() {
                        p = !1
                    }), this), a.bind("clearGraph", (function() {
                        _ = {}, w = {}, O = null, E = !0, j = [{
                            id: "",
                            type: "",
                            name: "",
                            type_id: "",
                            properties: {}
                        }]
                    }), this), a.bind("refreshGraph", (function() {
                        ee()
                    }), this)
                },
                te = function(e, t, n) {
                    var r, o, a, s = t.dispatcher,
                        c = t.graphStore,
                        d = t.uiStore,
                        p = t.GraphHistory,
                        h = n,
                        g = c.get("isHubGraph"),
                        m = document.querySelector(e),
                        b = m.querySelector(".gc-ss-btn-left"),
                        v = m.querySelector(".gc-ss-btn-right"),
                        _ = b.parentElement,
                        w = m.querySelector("#pnlTypes"),
                        O = w.querySelector("ul"),
                        E = m.querySelector(".gc-ss-btn-show-list"),
                        j = m.querySelector(".gc-ss-btn-new-type"),
                        S = m.parentElement.querySelector(".spreadsheet-types-list-container"),
                        x = 0,
                        k = {},
                        C = {},
                        N = !1,
                        T = function(e) {
                            var t;
                            for (t in e)
                                if (Object.prototype.hasOwnProperty.call(e, t)) return !1;
                            return !0
                        },
                        L = function(e, t) {
                            var n;
                            for (n in e) Object.prototype.hasOwnProperty.call(e, n) && e[n] && t(e[n])
                        },
                        P = function() {
                            var e;
                            if (g) {
                                for (e in k)
                                    if (Object.prototype.hasOwnProperty.call(k, e) && k[e].count > 0) return !0;
                                for (e in C)
                                    if (Object.prototype.hasOwnProperty.call(k, e) && k[e].count > 0) return !0;
                                return !1
                            }
                            return !T(k) || !T(C)
                        },
                        A = function(e, t) {
                            L(k, (function(e) {
                                e.underlined && (Object(y.nb)(e.dom, "underline"), e.underlined = !1)
                            })), L(C, (function(e) {
                                e.underlined && (Object(y.nb)(e.dom, "underline"), e.underlined = !1)
                            }));
                            var n = t ? k[e] : C[e];
                            Object(y.h)(n.dom, "underline"), n.underlined = !0, D(n.dom, O, _)
                        };

                    function D(e, t, n) {
                        var r = !0,
                            o = t.style.marginLeft;
                        "" === o && (o = "0px"), o = o.substring(0, o.length - 2), o = -1 * parseFloat(o);
                        var a = e.offsetLeft - o,
                            i = e.clientWidth;
                        if (a > 12 && a + i + 110 < n.offsetLeft && (r = !1), r)
                            if (a < 12) t.style.marginLeft = -1 * e.offsetLeft + "px";
                            else {
                                var s = a + i + 110 - n.offsetLeft;
                                s > 0 && (t.style.marginLeft = -1 * (o + s) + "px")
                            }
                    }
                    var M = function() {
                            _.offsetLeft > 0 && (w.offsetLeft + O.clientWidth < _.offsetLeft ? (_.style.visibility = "hidden", O.style.left = "0px", O.style.marginLeft = "0px") : _.style.visibility = "visible")
                        },
                        q = function(e) {
                            var n = e.id,
                                r = e.name,
                                a = document.createElement("li");
                            a.setAttribute("nodetype-id", n), g && Object(y.h)(a, "not-shown");
                            var i = document.createElement("a");
                            i.innerHTML = r, i.addEventListener("click", (function() {
                                s.emit(p, "onTypeFocused", n, !0)
                            }), !1);
                            var f = document.createElement("label");
                            f.className = "edge-count", f.innerHTML = "[x]", (h === u.a.VIEW || d.get("readOnly")) && (f.style.visibility = "hidden"), f.addEventListener("click", (function() {
                                Object.prototype.hasOwnProperty.call(k, n) && k[n].count <= 0 && Object(l.confirm)(t, "Delete Node Type", "Are you sure you want to delete this node type?", (function() {
                                    p.notify({
                                        action: "nodetype_delete",
                                        id: n
                                    }), G()
                                }), null, null, c.get("belongsToHub") && c.get("user").is_admin ? "Node type will be deleted from the hub" : null)
                            }), !1), a.appendChild(i), a.appendChild(f);
                            var m = null;
                            for (var b in k)
                                if (Object.prototype.hasOwnProperty.call(k, b) && b !== n) {
                                    var v = k[b].dom;
                                    if (v.querySelector("a").innerHTML.trim().toLowerCase() > r.toLowerCase()) {
                                        m = v;
                                        break
                                    }
                                }
                            m ? O.insertBefore(a, m) : T(C) ? O.appendChild(a) : (o = -1, L(k, (function() {
                                o += 1
                            })), O.insertBefore(a, O.querySelectorAll("li")[o])), e.dom = a
                        },
                        I = function(e) {
                            var t = k[e],
                                n = t.dom,
                                r = n.querySelector(".edge-count"),
                                o = t.count > 0 ? t.count : "x";
                            r.innerHTML = "[" + o + "]", "x" === o ? (g && (Object(y.h)(n, "not-shown"), O.style.marginLeft = "0px", P() || (E.style.display = "none")), h === u.a.View || d.get("readOnly") || c.get("belongsToHub") && !c.get("user").is_admin ? r.style.visibility = "hidden" : r.style.visibility = "visible") : (r.style.visibility = "visible", g && Object(y.N)(n, "not-shown") && (Object(y.nb)(n, "not-shown"), E.style.display = "inline-block", D(n, O, _)))
                        };

                    function R(e, t) {
                        var n = C[e];
                        void 0 !== t && (n.count = t);
                        var r = n.dom,
                            o = r.querySelector(".edge-count"),
                            a = n.count > 0 ? n.count : "x";
                        o.innerHTML = "[" + a + "]", "x" === a ? (g && (Object(y.h)(r, "not-shown"), O.style.marginLeft = "0px", P() || (E.style.display = "none")), h === u.a.View || d.get("readOnly") || c.get("belongsToHub") && !c.get("user").is_admin ? o.style.visibility = "hidden" : o.style.visibility = "visible") : (o.style.visibility = "visible", g && Object(y.N)(r, "not-shown") && (Object(y.nb)(r, "not-shown"), E.style.display = "inline-block", D(r, O, _)))
                    }
                    var B = function(e) {
                            var n = e.id,
                                r = e.name,
                                o = document.createElement("li");
                            o.setAttribute("edgetype-id", n), g && Object(y.h)(o, "not-shown");
                            var a = document.createElement("a");
                            a.innerHTML = r, a.addEventListener("click", (function() {
                                s.emit(p, "onTypeFocused", n, !1)
                            }), !1);
                            var i, d = document.createElement("label");
                            for (var f in d.className = "edge-count", d.innerHTML = "[x]", h === u.a.VIEW && (d.style.visibility = "hidden"), d.addEventListener("click", (function() {
                                    Object.prototype.hasOwnProperty.call(C, n) && C[n].count <= 0 && Object(l.confirm)(t, "Delete Vector Order", "Are you sure you want to delete this Vector Order?", (function() {
                                        p.notify({
                                            action: "edgetype_delete",
                                            id: n
                                        })
                                    }), null, null, c.get("belongsToHub") && c.get("user").is_admin ? "Edge type will be deleted from the hub" : null)
                                }), !1), o.appendChild(a), o.appendChild(d), C)
                                if (Object.prototype.hasOwnProperty.call(C, f) && f !== n) {
                                    var m = C[f].dom;
                                    if (m.querySelector("a").innerHTML.trim().toLowerCase() > r.toLowerCase()) {
                                        i = m;
                                        break
                                    }
                                }
                            i ? O.insertBefore(o, i) : O.appendChild(o), e.dom = o
                        },
                        F = function() {
                            var e = p.getNodeTypes(),
                                t = p.getEdgeTypes(),
                                n = p.getNodes(),
                                a = p.getLinks();
                            if (e)
                                for (o = 0; o < e.length; o += 1) k[e[o].id] = {
                                    id: e[o].id,
                                    name: e[o].name,
                                    color: e[o].color,
                                    count: 0
                                }, q(k[e[o].id]);
                            if (t)
                                for (o = 0; o < t.length; o += 1) C[t[o].id] = {
                                    id: t[o].id,
                                    name: t[o].name,
                                    color: t[o].color,
                                    count: 0
                                }, B(C[t[o].id]);
                            if (n) {
                                for (o = 0; o < n.length; o += 1) Object.prototype.hasOwnProperty.call(k, n[o].type_id) && (k[n[o].type_id].count += 1);
                                for (o in k) Object.prototype.hasOwnProperty.call(k, o) && I(o)
                            }
                            if (a) {
                                for (o = 0; o < a.length; o += 1) Object.prototype.hasOwnProperty.call(C, a[o].name_id) && (C[a[o].name_id].count += 1);
                                if (a.length > 0)
                                    for (o in r = a[a.length - 1].name_id, N = !1, C) Object.prototype.hasOwnProperty.call(C, o) && R(o)
                            }
                        };

                    function G() {
                        var e = O.getElementsByTagName("li");
                        if (e)
                            for (var t = 0; t < e.length; t += 1)
                                if (!Object(y.N)(e[t], "not-shown")) {
                                    var n = e[t].getAttribute("nodetype-id");
                                    return void(n ? s.emit(p, "onTypeFocused", n, !0) : s.emit(p, "onTypeFocused", e[t].getAttribute("edgetype_id"), !1))
                                }
                        s.emit(p, "onTypeFocused", null, !1)
                    }
                    b.addEventListener("click", (function() {
                        if (x > 0) {
                            x -= 1;
                            var e = O.querySelectorAll("li");
                            if (e && e.length > x) {
                                var t = e[x];
                                O.style.marginLeft = -1 * t.offsetLeft + "px"
                            }
                        }
                    }), !1), v.addEventListener("mousedown", (function() {
                        var e = O.querySelectorAll("li");
                        if (e && e.length > x + 1) {
                            var t = e[x += 1];
                            O.style.marginLeft = -1 * t.offsetLeft + "px"
                        }
                    }), !1), E.addEventListener("mouseenter", (function(e) {
                        var t, n;
                        clearTimeout(a), S.style.display = "block";
                        for (var o = S.querySelector("ul"); o.firstChild;) o.removeChild(o.firstChild);
                        var i = [];
                        L(k, (function(e) {
                            i.push(e)
                        })), i = i.sort((function(e, t) {
                            return e.name < t.name ? -1 : e.name > t.name ? 1 : 0
                        }));
                        var c = function() {
                            var e, a = i[t];
                            if (g && 0 === a.count) return "continue";
                            (n = document.createElement("li")).innerHTML = "&#x25cf; " + a.name + " (" + a.count + ")", n.setAttribute("data-type", "node"), n.setAttribute("data-id", a.id), n.style.color = a.color, t === r && n.setAttribute("class", "focused"), e = a.id, n.addEventListener("click", (function() {
                                s.emit(p, "onTypeFocused", e, !0), S.style.display = "none"
                            }), !1), o.appendChild(n)
                        };
                        for (t = 0; t < i.length; t += 1) c();
                        var l = [];
                        L(C, (function(e) {
                            l.push(e)
                        })), l = l.sort((function(e, t) {
                            return e.name < t.name ? -1 : e.name > t.name ? 1 : 0
                        }));
                        var d = function() {
                            var e, a = l[t];
                            if (g && 0 === a.count) return "continue";
                            (n = document.createElement("li")).innerHTML = "&mdash; " + a.name + " (" + a.count + ")", n.setAttribute("data-type", "edge"), n.setAttribute("data-id", a.id), n.style.color = a.color, t === r && n.setAttribute("class", "focused"), e = a.id, n.addEventListener("click", (function() {
                                s.emit(p, "onTypeFocused", e, !1), S.style.display = "none"
                            }), !1), o.appendChild(n)
                        };
                        for (t = 0; t < l.length; t += 1) d();
                        e.preventDefault(), e.stopPropagation()
                    }), !1), E.addEventListener("mouseleave", (function() {
                        a = setTimeout((function() {
                            S.style.display = "none"
                        }), 150)
                    }), !1), S.addEventListener("mouseenter", (function() {
                        clearTimeout(a)
                    }), !1), S.addEventListener("mouseleave", (function() {
                        a = setTimeout((function() {
                            S.style.display = "none"
                        }), 150)
                    }), !1), i.a.create(j, {
                        size: "large",
                        position: "top",
                        hideOnClickOutside: !0
                    }), Object(f.a)("#newtype-options a").on("click", (function(e) {
                        Object(f.a)(".tpd-tooltip").css("display", "none"), e.preventDefault()
                    }));
                    var H = m.querySelector("#tipped-new-nodetype");
                    H && H.addEventListener("click", (function(e) {
                        Object(l.newNodeType)(t, (function(e) {
                            var t = {
                                action: "nodetype_create",
                                id: Object(y.M)(),
                                name: e,
                                name_alias: e,
                                color: Object(y.kb)()
                            };
                            p.notify(t), s.emit(p, "onTypeFocused", t.id, !0)
                        }), (function() {})), e.preventDefault()
                    }), !1);
                    var U = m.querySelector("#tipped-new-edgetype");
                    U && U.addEventListener("click", (function(e) {
                        console.log("creating nodetype"), Object(l.newEdgeType)(t, (function(e, t) {
                            var n = {
                                action: "edgetype_create",
                                id: Object(y.M)(),
                                name: e,
                                name_alias: e,
                                directed: t ? 1 : 0,
                                weighted: 1,
                                color: Object(y.kb)()
                            };
                            p.notify(n), s.emit(p, "onTypeFocused", n.id, !1)
                        }), (function() {})), e.preventDefault()
                    }), !1), F(), G(), P() || (E.style.display = "none"), M(), this.adjust = function(e) {
                        e && (m.style.width = e + "px"), M();
                        var t = O.querySelectorAll("li.underline");
                        t.length > 0 && D(t[0], O, _)
                    }, this.setSize = function(e) {
                        switch (e) {
                            case "min":
                                m.classList.remove("switcher-max"), m.classList.remove("switcher-mid"), m.classList.add("switcher-min");
                                break;
                            case "mid":
                                m.classList.remove("switcher-min"), m.classList.remove("switcher-max"), m.classList.add("switcher-mid");
                                break;
                            case "max":
                                m.classList.remove("switcher-min"), m.classList.remove("switcher-mid"), m.classList.add("switcher-max")
                        }
                        var t = O.querySelectorAll("li.underline");
                        t.length > 0 && D(t[0], O, _)
                    }, this.selectFirstType = function() {
                        G()
                    }, s.bind("onTypeFocused", (function(e, t) {
                        e && (r = e, N = t, A(e, t))
                    }), this), s.bind("onNodeSelected", (function(e) {
                        var t = (Array.isArray(e) ? e : [e])[0],
                            n = p.getNodeById(t);
                        n && (r = n.type_id, N = !0, A(r, !0))
                    }), this), s.bind("trigger", (function(e) {
                        var t, n, o;
                        switch (e.action) {
                            case "nodetype_create":
                                Object.prototype.hasOwnProperty.call(k, e.id) || (k[e.id] = {
                                    id: e.id,
                                    name: e.name,
                                    color: e.color,
                                    count: 0
                                }, q(k[e.id]), E.style.display = "inline-block", M());
                                break;
                            case "nodetype_update":
                                Object.prototype.hasOwnProperty.call(k, e.id) && (Object.prototype.hasOwnProperty.call(e, "name") && (k[e.id].name = e.name, function(e, t) {
                                    for (var n = O.getElementsByTagName("li"), r = 0; r < n.length; r += 1) {
                                        var o = n[r];
                                        if (o.getAttribute("nodetype-id") === e) {
                                            o.querySelector("a").innerHTML = t;
                                            break
                                        }
                                    }
                                }(e.id, e.name)), Object.prototype.hasOwnProperty.call(e, "color") && (k[e.id].color = e.color));
                                break;
                            case "nodetype_delete":
                                !Object.prototype.hasOwnProperty.call(e, "properties") && Object.prototype.hasOwnProperty.call(k, e.id) && (! function(e) {
                                    var t = k[e];
                                    t.dom && (t.dom.parentNode.removeChild(t.dom), t.dom = null)
                                }(e.id), delete k[e.id], P() || (E.style.display = "none"), M());
                                break;
                            case "edgetype_create":
                                Object.prototype.hasOwnProperty.call(C, e.id) || (C[e.id] = {
                                    id: e.id,
                                    name: e.name,
                                    color: e.color,
                                    count: 0
                                }, B(C[e.id]), E.style.display = "inline-block", M());
                                break;
                            case "edgetype_update":
                                Object.prototype.hasOwnProperty.call(C, e.id) && (Object.prototype.hasOwnProperty.call(e, "name") && (C[e.id].name = e.name, function(e, t) {
                                    for (var n = O.getElementsByTagName("li"), r = 0; r < n.length; r += 1) {
                                        var o = n[r];
                                        if (o.getAttribute("edgetype-id") === e) {
                                            o.querySelector("a").innerHTML = t;
                                            break
                                        }
                                    }
                                }(e.id, e.name)), Object.prototype.hasOwnProperty.call(e, "color") && (C[e.id].color = e.color));
                                break;
                            case "edgetype_delete":
                                !Object.prototype.hasOwnProperty.call(e, "properties") && Object.prototype.hasOwnProperty.call(C, e.id) && (n = e.id, (o = C[n]).dom && (o.dom.parentNode.removeChild(o.dom), o.dom = null), delete C[e.id], P() || (E.style.display = "none"), M());
                                break;
                            case "node_create":
                                if (Object.prototype.hasOwnProperty.call(k, e.type_id)) k[e.type_id].count += 1, I(e.type_id), r || (r = e.type_id, A(r, N = !0), s.emit(p, "onTypeFocused", r, N));
                                break;
                            case "node_update":
                                var a, i = !1;
                                if (Object.prototype.hasOwnProperty.call(e, "type") || Object.prototype.hasOwnProperty.call(e, "type_id"))
                                    if (i = !0, Object.prototype.hasOwnProperty.call(e, "type")) {
                                        if (!(a = p.getNodeTypeByName(e.type))) return void console.log("node_update: type value does not have a corresponding node type");
                                        e.type_id = a.id
                                    } else {
                                        if (!(a = p.getNodeTypeById(e.type_id))) return void console.log("node_update: type_id value does not have a corresponding node type");
                                        e.type = a.name
                                    }
                                i && (k[e.type_id].count += 1, I(e.type_id), k[e.prev.type_id].count -= 1, I(e.prev.type_id));
                                break;
                            case "node_delete":
                                if (Object.prototype.hasOwnProperty.call(k, e.type_id)) {
                                    k[e.type_id].count -= 1, I(e.type_id);
                                    var c = p.getEdgeCounts();
                                    for (t in c) Object.prototype.hasOwnProperty.call(c, t) && R(t, c[t].count)
                                }
                                break;
                            case "edge_create":
                                Object.prototype.hasOwnProperty.call(C, e.name_id) && (C[e.name_id].count += 1, R(e.name_id), r || (r = e.name_id, A(r, N = !1), s.emit(p, "onTypeFocused", r, N)));
                                break;
                            case "edge_update":
                                e.prev && e.prev.name && p.getEdgeTypes().forEach((function(e) {
                                    C[e.id].count = e.count, R(e.id, e.count)
                                }));
                                break;
                            case "edge_delete":
                                Object.prototype.hasOwnProperty.call(C, e.name_id) && (C[e.name_id].count -= 1, R(e.name_id))
                        }
                    }), this), s.bind("editModeUpdated", (function(e) {
                        h = e;
                        var t = O.getElementsByTagName("li");
                        if (t)
                            for (var n = 0; n < t.length; n += 1) {
                                var r = t[n].querySelector(".edge-count");
                                if ("[x]" === r.innerHTML) {
                                    var o = "hidden";
                                    h != u.a.VIEW && (c.get("belongsToHub") ? c.get("user").is_admin && (o = "visible") : o = "visible"), r.style.visibility = o
                                }
                            }
                    }), this), s.bind("onEdgeFocused", (function(e) {
                        var t = e[0].id,
                            n = p.getEdgeById(t);
                        n && (r = n.name_id, N = !1, A(r, !1))
                    }), this), s.bind("onDatatableClosed", (function() {
                        if (g && r) {
                            var e = !1;
                            N ? 0 === k[r].count && (e = !0) : 0 === C[r].count && (e = !0), e && G()
                        }
                    }), this), s.bind("clearGraph", (function(e) {
                        if (e) Object.keys(k).forEach((function(e) {
                            k[e].count = 0, I(e)
                        })), Object.keys(C).forEach((function(e) {
                            C[e].count = 0, R(e)
                        }));
                        else {
                            for (; O.firstChild;) O.removeChild(O.firstChild);
                            k = {}, C = {}
                        }
                    }), this), s.bind("refreshGraph", (function() {
                        F()
                    }), this)
                },
                ne = n(46),
                re = function(e, t) {
                    var n, r, o, a, i, s, c, p, f, h = this,
                        g = e.uiStore,
                        m = e.graphStore,
                        b = e.dispatcher,
                        v = e.GraphHistory,
                        _ = this,
                        w = .5,
                        O = t.allowSpreadsheet,
                        E = "min",
                        j = t,
                        S = function() {
                            var e = Object(y.I)();
                            s.parentNode.classList.remove("datatable-max"), s.parentNode.classList.remove("datatable-mid"), s.parentNode.classList.add("datatable-min"), s.parentNode.style.height = "0", Object(y.nb)(n, "with-datatable"), a && a.setSize("min"), r && (i.parentNode.style.height = e.y + "px", i.parentNode.classList.add("canvas-max"), i.parentNode.classList.remove("canvas-mid"), i.parentNode.classList.remove("canvas-min"), r.getForcePaused() || r.resetZoom(), v.requestFocus(r)), Object(y.yb)("show", null), E = "min"
                        },
                        x = function() {
                            E = "mid", s.parentNode.classList.remove("datatable-max"), s.parentNode.classList.add("datatable-mid"), s.parentNode.classList.remove("datatable-min");
                            var e = Object(y.I)();
                            "cards" === A && _.clearBar(), o && (N(), c.style.display = "inline-block", p.style.display = "none", f.style.display = "inline-block", Object(y.h)(n, "with-datatable")), r && (i.parentNode.style.height = e.y + "px", i.parentNode.classList.remove("canvas-max"), i.parentNode.classList.add("canvas-mid"), i.parentNode.classList.remove("canvas-min"), r.resetZoom()), Object(y.yb)("show", "datatable")
                        },
                        k = function() {
                            E = "max", s.parentNode.classList.add("datatable-max"), s.parentNode.classList.remove("datatable-mid"), s.parentNode.classList.remove("datatable-min");
                            var e = Object(y.I)();
                            o && (s.parentNode.style.height = e.y - 60 + "px", N(), c.style.display = "inline-block", p.style.display = "inline-block", f.style.display = "none", Object(y.h)(n, "with-datatable")), "cards" === A && _.clearBar(), r && (i.parentNode.style.height = "0", i.parentNode.classList.remove("canvas-max"), i.parentNode.classList.remove("canvas-mid"), i.parentNode.classList.add("canvas-min")), Object(y.yb)("show", "datatable")
                        },
                        C = function(e) {
                            68 === e.keyCode && (Object(y.W)(document.activeElement) ? e.returnValue = !0 : D <= 0 && _.toggleDatatable())
                        };

                    function N() {
                        if ("min" !== E) {
                            var e, t = Object(y.I)();
                            switch (s.parentNode.style.height = t.y - 60 + "px", E) {
                                case "mid":
                                    e = t.x * w;
                                    break;
                                case "max":
                                    e = t.x
                            }
                            g.get("editMode") !== u.a.VIEW && (e -= 62), o.resize(e, t.y), a && (a.setSize(E), a.adjust(e))
                        }
                    }
                    var T = !1;

                    function L(e) {
                        e ? document.addEventListener("keydown", C, !1) : document.removeEventListener("keydown", C, !1)
                    }
                    this.setCanvas = function(e) {
                        e && (i = (r = e).getContainer())
                    }, this.setDataTable = function(e) {
                        e && (o = e, s = e.getContainer())
                    }, this.setSwitcher = function(e) {
                        e && (a = e)
                    }, this.start = function() {
                        var e, t = Object(y.I)();
                        n = document.querySelector("div.graph-edit"), r && (w = 0, i.parentNode.classList.add("canvas-max"), i.parentNode.style.height = t.y + "px"), O && L(!0), e = null, window.addEventListener("resize", (function() {
                            e && clearTimeout(e), e = setTimeout((function() {
                                var e = Object(y.I)();
                                if (o) switch (E) {
                                    case "max":
                                        k();
                                        break;
                                    case "mid":
                                        e.x < 900 ? k() : x();
                                        break;
                                    case "min":
                                    default:
                                        S()
                                } else i.parentNode.style.height = e.y + "px";
                                r && "function" === typeof r.resize && r.resize(e.x, e.y)
                            }), 250)
                        }), !1)
                    }, this.cleanUp = function() {
                        L(!1)
                    };
                    var P, A, D = 0;

                    function M() {
                        _.clearBar(), b.emit(_, "onDatatableOpened")
                    }
                    this.toggleDatatable = function(t) {
                        if (O)
                            if (P && _.clearBar(), b.emit("updateFreezeMode", null), o) {
                                var n = E;
                                if (!t) switch (n) {
                                    case "min":
                                        t = "mid";
                                        break;
                                    case "mid":
                                        t = "max";
                                        break;
                                    case "max":
                                    default:
                                        t = "min"
                                }
                                if ("mid" === t) Object(y.I)().x < 900 && (t = "max");
                                switch (t) {
                                    case "min":
                                        S(), "min" !== n && b.emit(_, "onDatatableClosed");
                                        break;
                                    case "max":
                                        "min" === n && M(), k();
                                        break;
                                    case "mid":
                                        "min" === n && M(), x()
                                }
                            } else Object(l.showWaitMessage)(e, "Please wait", "Initializing Datatable...", (function(e) {
                                ! function() {
                                    w = .5;
                                    var e = new ee("#ssLinks", {
                                            uiStore: g,
                                            graphStore: m,
                                            dispatcher: b,
                                            GraphHistory: v
                                        }, m.get("isWebGL") ? u.a.VIEW : g.get("editMode"), m.get("isWebGL")),
                                        t = new te(".spreadsheet-switcher", {
                                            uiStore: g,
                                            graphStore: m,
                                            dispatcher: b,
                                            GraphHistory: v
                                        }, u.a.VIEW);
                                    t.selectFirstType(), _.setDataTable(e), _.setSwitcher(t), c = document.querySelector(".gc-switcher-minimum"), p = document.querySelector(".gc-switcher-medium"), f = document.querySelector(".gc-switcher-maximum"), c.addEventListener("click", (function() {
                                        S(), b.emit(_, "onDatatableClosed")
                                    }), !1), p.addEventListener("click", x), f.addEventListener("click", k), Object(y.h)(s.parentNode, "datatable-min"), g.get("editMode") !== u.a.VIEW && Object(y.h)(s.parentNode, "dt-editable")
                                }(), e(), _.toggleDatatable(t)
                            }))
                    }, this.getDatatableSize = function() {
                        return E
                    }, this.requestBar = function(o, a) {
                        var i = {};
                        "share" !== o && "stories" !== o || ("analysis" === A && g.get("isClusterColorsApplied") && (i.deferRevertingClusterColors = !0), "group" === A && (i.deferRevertingGroups = !0)), this.clearBar(i);
                        for (var s = document.querySelector("div.right-bar"); s.firstChild;) s.removeChild(s.firstChild);
                        switch (Object(y.nb)(s, "not-shown"), A = o, o) {
                            case "group":
                                if ("webgl-canvas" == r.getName()) {
                                    var c = Object(y.K)(Object(y.J)());
                                    c.webgl = "false", c.show = "groups", c.auto = "true";
                                    var p = "/graphs/" + m.get("id") + Object(y.l)(c);
                                    return void Object(y.lb)(p)
                                }
                                var f = {
                                    parent: s,
                                    canvas: r,
                                    onReady: function(e) {
                                        P = e, Object(y.h)(n, "with-right-bar"), b.emit(_, "onBarOpened", A), b.emit("updateFreezeMode", "group"), t.onReady && t.onReady.call(null, P)
                                    },
                                    onClose: function() {
                                        _.clearBar(), r && r.setRendererState(!1)
                                    }
                                };
                                b.emit("updateFreezeMode"), Object(ne.groupBarWrapper)(e, f);
                                break;
                            case "cards":
                                var h = {
                                    parent: s,
                                    onReady: function(e) {
                                        P = e, Object(y.h)(n, "with-right-bar"), b.emit(_, "onBarOpened", A), a.onReady && a.onReady.call(null, P)
                                    },
                                    onClose: function() {
                                        _.clearBar()
                                    }
                                };
                                r && (h.onShareRequested = function(e) {
                                    v.clearSelectedNodes(), v.selectNode(e), _.requestBar("share")
                                }), Object(ne.cardHolderBarWrapper)(e, h);
                                break;
                            case "filters":
                                Object(ne.filterBarWrapper)(e, s, (function(e) {
                                    P = e, Object(y.h)(n, "with-right-bar"), b.emit(_, "onBarOpened", A)
                                }), (function() {
                                    _.clearBar()
                                }), (function(t, n, r) {
                                    var o = v.getFilterManager(),
                                        a = Object(l.expandedRangeFilter)(e, t, n, r, (function() {
                                            o.setActiveExpandedFilter(null), _.requestBar("filters")
                                        }));
                                    o.setActiveExpandedFilter(a), _.clearBar()
                                }), t.with_composition_panel);
                                break;
                            case "comments":
                                P = Q(e, {
                                    commentsContainer: "div.right-bar",
                                    selected_comment: t.id,
                                    onShareRequested: function(e) {
                                        _.requestBar("share", {
                                            comment_text: e,
                                            comment_only: !0
                                        })
                                    }
                                }, (function() {
                                    _.clearBar()
                                })), Object(y.h)(n, "with-right-bar"), b.emit(_, "onBarOpened", A);
                                break;
                            case "analysis":
                                var w = {};
                                w.parent = s, w.onReady = function(e) {
                                    P = e, Object(y.h)(n, "with-right-bar"), b.emit(_, "onBarOpened", A)
                                }, w.onClose = function() {
                                    _.clearBar()
                                }, w.onShowCustomizeDialog = function() {
                                    j.onAnalysisCustomizeToggle()
                                }, w.highlightClustersOnStart = a.highlightClustersOnStart, w.showCompositionPanelOnStart = a.showCompositionPanelOnStart, w.runClusteringOnStart = a.runClusteringOnStart, Object(ne.analysisBarWrapper)(e, w);
                                break;
                            case "share":
                                if ("webgl-canvas" == r.getName()) {
                                    var O = Object(y.K)(Object(y.J)());
                                    O.webgl = "false", O.show = "share", O.auto = "true";
                                    var E = "/graphs/" + m.get("id") + Object(y.l)(O);
                                    return void Object(y.lb)(E)
                                }
                                g.get("editMode") !== u.a.VIEW && b.emit("updateEditMode", u.a.VIEW), Object(l.showWaitMessage)(e, "Preparing Capture", "Please wait, it will be an awesome image!", (function(t) {
                                    var o = {
                                        container: s,
                                        svg: r.getSVGData(),
                                        transform: r.getTransform(),
                                        onCommentRequested: function() {
                                            _.requestBar("comments")
                                        },
                                        onCollaboratorsClick: function() {
                                            m.get("belongsToHub") && !m.get("community") ? Object(l.showContributorsPanel)(e, null, (function() {
                                                _.requestBar("share")
                                            })) : Object(l.showCollaboratorsPanel)(e, (function() {
                                                _.requestBar("share")
                                            }))
                                        },
                                        onStatusClick: function() {
                                            Object(l.showGraphStatus)(e, (function(e, t) {
                                                Object(d.setGraphStatus)(m.get("id"), e, (function() {
                                                    m.set("status", e), t(), _.requestBar("share")
                                                }), (function(e) {
                                                    402 == e.status ? (b.emit(_, "onPaymentRequired", null, e.responseJSON), t({
                                                        msg: "Payment required"
                                                    })) : t(e.responseJSON)
                                                }))
                                            }), (function() {
                                                _.requestBar("share")
                                            }))
                                        }
                                    };
                                    a && (o.comment_text = a.comment_text, o.comment_only = a.comment_only, o.comment_only && (o.onComment = function() {
                                        _.requestBar("comments")
                                    })), P = Object(ne.ShareBar)(e, o, (function() {
                                        i.deferRevertingClusterColors && v.getAnalysisManager().removeClusterColors(), i.deferRevertingGroups && b.emit("updateFreezeMode", null), _.clearBar()
                                    })), Object(y.h)(n, "with-right-bar"), t()
                                }));
                                break;
                            case "stories":
                                var S = {
                                    container: s,
                                    canvas: r,
                                    storyId: a.storyId,
                                    withEdit: a.withEdit,
                                    newStory: a.newStory,
                                    skipNewStoryOnEmptyResults: a.skipNewOnEmpty,
                                    onReady: function() {
                                        Object(y.h)(n, "with-right-bar")
                                    }
                                };
                                P = Object(ne.StoriesBar)(e, S, (function() {
                                    i.deferRevertingClusterColors && v.getAnalysisManager().removeClusterColors(), _.clearBar()
                                }));
                                break;
                            case "info":
                                var x = {
                                    container: s,
                                    onEditClick: function() {
                                        Object(l.editGraphPanel)(e, (function() {
                                            _.requestBar("info")
                                        }))
                                    },
                                    onStatusClick: function() {
                                        Object(l.showGraphStatus)(e, (function(e, t) {
                                            Object(d.setGraphStatus)(m.get("id"), e, (function() {
                                                m.set("status", e), t(), _.requestBar("info")
                                            }), (function(e) {
                                                402 == e.status ? (b.emit(_, "onPaymentRequired", null, e.responseJSON), t({
                                                    msg: "Payment required"
                                                })) : t(e.responseJSON)
                                            }))
                                        }), (function() {
                                            _.requestBar("info")
                                        }))
                                    },
                                    onCollaboratorsClick: function() {
                                        m.get("belongsToHub") && !m.get("community") ? Object(l.showContributorsPanel)(e, null, (function() {
                                            _.requestBar("info")
                                        })) : Object(l.showCollaboratorsPanel)(e, (function() {
                                            _.requestBar("info")
                                        }))
                                    },
                                    onLicenseClick: function() {
                                        Object(l.showLicensingPanel)(e, (function(e, t) {
                                            Object(d.updateGraph)(m.get("id"), {
                                                graph: {
                                                    license_cc_by: e.cc_by,
                                                    license_cc_sa: e.cc_sa,
                                                    license_cc_nd: e.cc_nd,
                                                    license_cc_nc: e.cc_nc
                                                },
                                                id: m.get("id")
                                            }, (function() {
                                                m.set("license", e), t(), _.requestBar("info")
                                            }))
                                        }), (function() {
                                            _.requestBar("info")
                                        }))
                                    }
                                };
                                Object(y.h)(n, "with-right-bar"), v.clearSelectedNodes(), P = Object(ne.InfoBar)(e, x, (function() {
                                    _.clearBar()
                                }));
                                break;
                            default:
                                A = null
                        }
                    }, this.getTypeInBar = function() {
                        return A
                    }, this.clearBar = function(e) {
                        if (A) {
                            P && P.close && (P.close(e), P = null), b.emit(_, "onBarClosed", A), A = null;
                            for (var t = document.querySelector("div.right-bar"); t.firstChild;) t.removeChild(t.firstChild);
                            Object(y.h)(t, "not-shown"), Object(y.nb)(n, "with-right-bar")
                        }
                    }, b.bind("onNodeSelected", (function(e, t) {
                        var n;
                        (n = Array.isArray(e) ? e : [e], !o || "max" !== E && "mid" !== E) && ("search-module" === t && g.get("editMode") === u.a.EDIT || A && !("cards" == A || "info" == A) || ("info" == A && _.clearBar(), "cards" !== A ? h.requestBar("cards", {
                            onReady: function(e) {
                                e.addCard(n)
                            }
                        }) : P.addCard(n)))
                    }), this), b.bind("onSearchInitiated", (function() {
                        "share" === A && (_.clearBar(), T = !0)
                    }), this), b.bind("onSearchFinalized", (function() {
                        T && (T = !1, _.requestBar("share"))
                    }), this), b.bind("onNodesReleased", (function() {
                        "cards" === A && (P.clearCards(), _.clearBar())
                    }), this), b.bind("onNodeUnselected", (function(e) {
                        "cards" === A && (P.removeCard(e), 0 === v.getSelectedNodes().length && _.clearBar())
                    }), this), b.bind("editModeUpdated", (function(e) {
                        s && (e === u.a.VIEW ? s.parentNode.classList.remove("dt-editable") : s.parentNode.classList.add("dt-editable"), N()), e !== u.a.VIEW ? Object(y.h)(n, "with-left-bar") : Object(y.nb)(n, "with-left-bar")
                    }), this), b.bind("freezeModeUpdated", (function(e) {
                        e && o && !Object(y.N)(s.parentNode, "datatable-min") && (S(), b.emit(_, "onDatatableClosed")), L(!e)
                    }), this), b.bind("onModalOpened", (function(e) {
                        e && (o && !Object(y.N)(s.parentNode, "datatable-min") && (S(), b.emit(_, "onDatatableClosed")), P && h.clearBar()), D += 1
                    }), this), b.bind("onModalClosed", (function() {
                        D -= 1
                    }), this), b.bind("onCommentsOpened", (function() {
                        o && !Object(y.N)(s.parentNode, "datatable-min") && (S(), b.emit(_, "onDatatableClosed"))
                    }), this)
                },
                oe = function(e, t, n, r, o) {
                    var a = t.dispatcher,
                        i = t.uiStore,
                        s = t.graphStore,
                        c = t.GraphHistory,
                        p = this;
                    o = o || {};
                    var f = s.get("user");
                    e(".show-hub-members").click((function(e) {
                        return e.preventDefault(), Object(l.showHubMembersPanel)(s.get("id"), f), !1
                    }));
                    if (e(".show-hub-merge").click((function(n) {
                            return n.preventDefault(), e(".tpd-tooltip").css("display", "none"), s.get("isDirty") ? Object(l.displayMessage)(t, "Unsaved changes", "Please save your work to continue") : Object(l.showGraphMergePanel)(t, c.getNodeTypes(), c.getEdgeTypes(), c.getNodes(), c.getLinks(), (function(e) {
                                var n = {
                                    hub: {
                                        id: s.get("id"),
                                        history: e
                                    }
                                };
                                console.dir(e), Object(l.showWaitMessage)(t, "Please wait", "Updating graph", (function(e) {
                                    Object(d.saveHub)(s.get("id"), n, (function() {
                                        window.location.reload(), e()
                                    }), (function() {
                                        window.location.reload(), e()
                                    }))
                                }))
                            })), !1
                        })), !i.get("readOnly")) {
                        var g = "You have unsaved changes! Are you sure to navigate away from this page?";
                        e(".warn-before-leave").click((function(e) {
                            if (s.get("isDirty") && !confirm(g)) return e.preventDefault(), e.stopPropagation(), !1;
                            window.onbeforeunload = null, p.cleanUp()
                        }));
                        a.bind("onGraphSaved", (function() {
                            window.onbeforeunload = null
                        }), this), a.bind("onGraphSaveFailed", (function() {}), this), this.triggerSave = function() {
                            c.saveHub()
                        }, a.bind("graphStore.isDirty.updated", (function() {
                            window.onbeforeunload = function(e) {
                                return (e || window.event).returnValue = g, g
                            }
                        }), this), h(t, {
                            button: "#btnSave",
                            onSave: function() {
                                p.triggerSave()
                            }
                        })
                    }
                    var m = function(n) {
                        8 === n.keyCode && (Object(y.W)(document.activeElement) ? n.returnValue = !0 : n.returnValue = !1), 191 === n.keyCode && y.Y.isShiftPressed() && (Object(y.W)(document.activeElement) ? n.returnValue = !0 : (Object(l.helpPanel)(t), e(".drawer").removeClass("open")))
                    };
                    document.addEventListener("keydown", m, !1), this.cleanUp = function() {
                        document.removeEventListener("keydown", m, !1)
                    };
                    var b = function() {
                            o.graphHelp && Object(l.helpPanel)(t), a.emit("updateEditMode", u.a.EDIT)
                        },
                        v = e("#pnlGraphCover"),
                        _ = e("#btnEnterGraph"),
                        w = e("#btnGraphLoading");
                    o.graphBlank ? (v.hide({
                        complete: function() {
                            v.remove(), v = null
                        }
                    }), b()) : o.hideCoverOnLoad ? (v.fadeOut(1e3, (function() {
                        v.remove(), v = null
                    })), b()) : v.is(":hidden") || (v.addClass("graph-reveal"), w.addClass("not-shown"), _.removeClass("not-shown").removeAttr("disabled").click((function() {
                        v.fadeOut(1e3, (function() {
                            v.remove(), v = null
                        })), b()
                    })))
                },
                ae = function(e) {
                    var t, n, r, o, a, i, s, c, l, d = e.uiStore,
                        p = e.dispatcher,
                        f = 0,
                        h = function(e) {
                            (e = !!e) || p.emit("updateEditMode", u.a.EDIT);
                            var c = Object(y.I)();
                            t && (r.parentNode.style.height = c.y - 60 + "px", s.classList.remove("switcher-min"), s.classList.remove("switcher-mid"), s.classList.add("switcher-max"), o.style.display = "inline-block", a.style.display = "inline-block", i.style.display = "none", t.resize(c.x - f, c.y), n.adjust(c.x - f))
                        };
                    this.setCanvas = function() {}, this.setDataTable = function(e) {
                        e && (t = e, r = e.getContainer())
                    }, this.setSwitcher = function(e) {
                        e && (n = e)
                    }, this.start = function() {
                        var n, l = Object(y.I)(),
                            d = document.querySelector("div.right-bar");
                        c = Object(w.Card)(e, d), f = d.offsetWidth, t && (s = document.querySelector(".spreadsheet-switcher"), o = document.querySelector(".gc-switcher-minimum"), a = document.querySelector(".gc-switcher-medium"), i = document.querySelector(".gc-switcher-maximum"), r.parentNode.style.height = l.y - 60 + "px", s.classList.add("switcher-max"), h(!0), o.classList.add("hidden"), a.classList.add("hidden"), i.classList.add("hidden"), t.onDeselect((function() {
                            c && !c.hasMouseFocus() && c.clearCards()
                        })), t.onSheetChanged((function(e, t) {
                            c && (c.clearCards(), t ? c.addCard(e) : c.addEdgeCard(e))
                        }))), n = null, window.addEventListener("resize", (function() {
                            n && clearTimeout(n), n = setTimeout((function() {
                                h(!0)
                            }), 250)
                        }), !1)
                    }, p.bind("onNodeSelected", (function(e) {
                        var n, o, a;
                        if (n = Array.isArray(e) ? e : [e], (!t || !r.parentNode.classList.contains("datatable-max") && !r.parentNode.classList.contains("datatable-mid")) && d.get("editMode") != u.a.DELETE && c)
                            for (o = n.length - 1; o >= 0; o -= 1) a = n[o], c.isCardDisplayed(a) ? c.focusCard(a) : c.addCard(a)
                    }), this), p.bind("onNodesReleased", (function() {
                        var e = document.body.lastElementChild;
                        e.classList.contains("gc-exp-card") && document.body.removeChild(e), c && c.clearCards()
                    }), this), p.bind("onNodeUnselected", (function(e) {
                        c && c.removeCard(e)
                    }), this), p.bind("onEdgeFocused", (function(e) {
                        e && e.length > 0 && (l && (clearTimeout(l), l = null), l = setTimeout((function() {
                            c && (c.clearCards(), c.addEdgeCard(e.map((function(e) {
                                return e.id
                            })))), l = null
                        }), 200))
                    }), this), p.bind("onNodeFocused", (function(e) {
                        l && (clearTimeout(l), l = null), l = setTimeout((function() {
                            c && (c.clearCards(), c.addCard(e)), l = null
                        }), 200)
                    }), this), p.bind("editModeUpdated", (function(e) {
                        r && (e === u.a.VIEW ? r.parentNode.classList.remove("dt-editable") : r.parentNode.classList.add("dt-editable"))
                    }), this), p.bind("trigger", (function(e) {
                        switch (e.action) {
                            case "nodetype_create":
                                break;
                            case "nodetype_update":
                                c && c.updateNodeCards();
                                break;
                            case "nodetype_delete":
                            case "edgetype_create":
                                break;
                            case "edgetype_update":
                                c && c.updateEdgeCards();
                                break;
                            case "edgetype_delete":
                                break;
                            case "node_create":
                            case "node_update":
                                c && c.isCardDisplayed(e.id) && (c.clearCards(), c.addCard([e.id]));
                                break;
                            case "node_delete":
                                c && c.isCardDisplayed(e.id) && c.removeCard(e.id);
                                break;
                            case "edge_create":
                            case "edge_update":
                                c && c.isCardDisplayed(e.id) && (c.clearCards(), c.addEdgeCard([e.id]));
                                break;
                            case "edge_delete":
                                c && c.isCardDisplayed(e.id) && c.removeCard(e.id)
                        }
                    }), this)
                },
                ie = n(32),
                se = n.n(ie),
                ce = function(e) {
                    var t = e.GraphHistory;
                    return function(e, n) {
                        var r = new RegExp(Object(c.normalizeChars)(e), "i");
                        n(t.getNodes().filter((function(e) {
                            var n = t.nodeDisplayName(e.id);
                            return r.test(Object(c.normalizeChars)(n))
                        })).map((function(e) {
                            var n = t.getNodeTypeById(e.type_id);
                            return {
                                name: t.nodeDisplayName(e.id),
                                type: e.type,
                                typeFirstChar: e.type.charAt(0).toUpperCase(),
                                id: e.id,
                                color: n.color
                            }
                        })))
                    }
                };

            function le(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function de(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? le(Object(n), !0).forEach((function(t) {
                        ue(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : le(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function ue(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var pe = function(e) {
                    var t, n = e.dispatcher,
                        r = e.graphStore,
                        o = e.GraphHistory,
                        a = this,
                        i = document.querySelector(".search-module");
                    if (i) {
                        i.style.display = "inline-block";
                        i.querySelector("input")
                    }
                    var c, l = function() {
                            t && t.typeahead("val", ""), Object(y.nb)(document.body, "searching"), n.emit("onSearchFinalized")
                        },
                        d = "/site/quick_search.json?q=%QUERY&g=" + r.get("id");
                    r.get("belongsToHub") && (d = d + "&h=" + r.get("hub").id), r.get("isHub") || (c = new se.a({
                        datumTokenizer: function(e) {
                            se.a.tokenizers.obj.whitespace(e.node.name)
                        },
                        queryTokenizer: se.a.tokenizers.whitespace,
                        remote: {
                            url: d,
                            wildcard: "%QUERY",
                            prepare: function(e, t) {
                                return de(de({}, t), {}, {
                                    url: t.url.replace("%QUERY", e) + "&rand=r" + Math.floor(2e4 * Math.random())
                                })
                            },
                            transport: function(e, t, n) {
                                f.a.ajax(de(de({}, e), {}, {
                                    beforeSend: function(e, t) {
                                        searchInput.className += " loading";
                                        var n = r.get("belongsToHub") ? 1 : 3;
                                        if (Object(y.ib)(t.url.substring(12), "q").length < n) return e.abort(), searchInput.className = searchInput.className.replace(/\bloading\b/, "").trim(), !1
                                    }
                                })).done((function(e) {
                                    t(e)
                                })).fail((function(e, t, r) {
                                    searchInput.className = searchInput.className.replace(/\bloading\b/, "").trim(), n(r)
                                }))
                            },
                            transform: function(e) {
                                return searchInput.className = searchInput.className.replace(/\bloading\b/, "").trim(), e.filter((function(e) {
                                    return "Node" === e.obj
                                })).forEach((function(e) {
                                    e.typeFirstChar = e.type.charAt(0).toUpperCase(), e.graph_name = e.graphs && e.graphs.length > 0 ? e.graphs[0].name : "No Graph"
                                })), e
                            }
                        },
                        limit: 10
                    })).initialize(), (t = Object(f.a)(".search .typeahead")).typeahead(y.b, de(de({}, y.c), {}, {
                        name: "nodes-local",
                        displayKey: "name",
                        source: ce(e),
                        templates: {
                            suggestion: s.a["graphs/search_result_local"]
                        }
                    })).on("typeahead:cursorchanged", (function(e, t) {
                        Object.prototype.hasOwnProperty.call(t, "type_id") || o.focusNode([t.id])
                    })).on("typeahead:selected", (function(e, t, n) {
                        var r;
                        if ("nodes-db" === n) {
                            switch (t.obj) {
                                case "Node":
                                    r = "/nodes/" + t.id;
                                    break;
                                case "Graph":
                                    r = "/graphs/" + t.id;
                                    break;
                                case "User":
                                    r = "/users/" + t.id;
                                    break;
                                case "Story":
                                    r = "/stories/" + t.id;
                                    break;
                                case "Hub":
                                    r = "/hubs/" + t.id
                            }
                            r && window.open(r)
                        } else o.clearSelectedNodes(), o.selectNode(t.id, a);
                        return l(), e.stopPropagation(), e.preventDefault(), !1
                    })).on("typeahead:closed", l), n.bind("editModeUpdated", (function() {}), this), this.getTypeAheadObj = function() {
                        return t
                    }, this.getRemoteDataSource = function() {
                        return c
                    };
                    var u = function(e) {
                        27 === e.keyCode && Object(y.N)(document.body, "searching") && (t.typeahead("close"), l())
                    };
                    this.cleanUp = function() {
                        document.removeEventListener("keydown", u, !1)
                    }, this.getName = function() {
                        return "search-module"
                    }, document.addEventListener("keydown", u, !1);
                    var p = document.body.querySelector("a.toggle-search");
                    p && (p.addEventListener("click", (function(e) {
                        e.preventDefault(), Object(y.h)(document.body, "searching"), setTimeout((function() {
                            return Object(f.a)(".search .typeahead").focus()
                        }), 10), n.emit(a, "onSearchInitiated")
                    })), document.body.querySelector("a.close-search").addEventListener("click", (function(e) {
                        e.preventDefault(), l()
                    })))
                },
                fe = function() {
                    var e, t, n, r, o, a, i, s, c, l = ["#ifdef GL_OES_standard_derivatives", "#extension GL_OES_standard_derivatives : enable", "#endif", "", "precision mediump float;", "varying float selected_flag;", "varying vec4 body_color;", "varying vec4 ring_color;", "void main(void) {", "   #ifndef GL_OES_standard_derivatives", "   float r = (gl_PointCoord.x - 0.5) * (gl_PointCoord.x - 0.5) + (gl_PointCoord.y - 0.5) * (gl_PointCoord.y - 0.5);", "   if (r < 0.25) {", "       if (r < 0.20) {", "           gl_FragColor = body_color;", "       }", "       else {", "           gl_FragColor = ring_color;", "       }", "   }", "   else {", "       gl_FragColor = vec4(0);", "   }", "   #endif", "   #ifdef GL_OES_standard_derivatives", "   if (selected_flag > 0.0) {", "       vec2 cxy = 2.0 * gl_PointCoord - 1.0;", "       float r = dot(cxy, cxy);", "       float t = 1.0;", "       float alpha = 1.0;", "       float delta = 0.0;", "       delta = fwidth(r);", "       t = 1.0 + smoothstep(1.0, 1.0 + delta, r) - smoothstep(0.75, 0.75 + delta, r);", "       alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);", "       gl_FragColor = mix(ring_color, body_color, t) * alpha;", "   }", "   else {", "       vec2 cxy = 2.0 * gl_PointCoord - 1.0;", "       float r = dot(cxy, cxy) + 0.25;", "       float alpha = 1.0;", "       float delta = 0.0;", "", "       delta = fwidth(r);", "       alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);", "       gl_FragColor = body_color * alpha;", "   }", "   #endif", "", "}"].join("\n"),
                        d = ["attribute vec2 a_vertexPos;", "attribute vec3 a_customAttributes;", "attribute float a_selected;", "uniform vec2 u_screenSize;", "uniform mat4 u_transform;", "varying vec4 body_color;", "varying vec4 ring_color;", "varying float selected_flag;", "void main(void) {", "   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0, 1);", "   gl_PointSize = a_customAttributes[1] * u_transform[0][0];", "   float c = a_customAttributes[0];", "   if (a_selected > 0.0) {", "     ring_color.b = mod(c, 256.0); c = floor(c/256.0);", "     ring_color.g = mod(c, 256.0); c = floor(c/256.0);", "     ring_color.r = mod(c, 256.0); c = floor(c/256.0); ring_color /= 255.0;", "     ring_color.a = a_customAttributes[2];", "     body_color.b = 1.0;", "     body_color.g = 1.0;", "     body_color.r = 1.0;", "     body_color.a = a_customAttributes[2];", "     selected_flag = 1.0;", "   }", "   else {", "     body_color.b = mod(c, 256.0); c = floor(c/256.0);", "     body_color.g = mod(c, 256.0); c = floor(c/256.0);", "     body_color.r = mod(c, 256.0); c = floor(c/256.0); body_color /= 255.0;", "     body_color.a = a_customAttributes[2];", "     ring_color.b = 1.0;", "     ring_color.g = 1.0;", "     ring_color.r = 1.0;", "     ring_color.a = a_customAttributes[2];", "     selected_flag = 0.0;", "   }", "}"].join("\n"),
                        u = new Float32Array(64),
                        p = 0;
                    return {
                        load: function(o) {
                            (t = o).getExtension("OES_standard_derivatives"), c = T.a.Graph.webgl(o), e = c.createProgram(d, l), t.useProgram(e), r = c.getLocations(e, ["a_vertexPos", "a_customAttributes", "a_selected", "u_screenSize", "u_transform"]), t.enableVertexAttribArray(r.vertexPos), t.enableVertexAttribArray(r.customAttributes), t.enableVertexAttribArray(r.selected), n = t.createBuffer()
                        },
                        position: function(e, t) {
                            var n = e.id;
                            u[6 * n] = t.x, u[6 * n + 1] = -t.y, u[6 * n + 2] = e.color, u[6 * n + 3] = e.size, u[6 * n + 4] = e.alpha, u[6 * n + 5] = e.selected
                        },
                        render: function() {
                            t.useProgram(e), t.bindBuffer(t.ARRAY_BUFFER, n), t.bufferData(t.ARRAY_BUFFER, u, t.DYNAMIC_DRAW), s && (s = !1, t.uniformMatrix4fv(r.transform, !1, i), t.uniform2f(r.screenSize, o, a)), t.vertexAttribPointer(r.vertexPos, 2, t.FLOAT, !1, 6 * Float32Array.BYTES_PER_ELEMENT, 0), t.vertexAttribPointer(r.customAttributes, 3, t.FLOAT, !1, 6 * Float32Array.BYTES_PER_ELEMENT, 8), t.vertexAttribPointer(r.selected, 1, t.FLOAT, !1, 6 * Float32Array.BYTES_PER_ELEMENT, 20), t.drawArrays(t.POINTS, 0, p)
                        },
                        updateTransform: function(e) {
                            i = e, s = !0
                        },
                        updateSize: function(e, t) {
                            o = e, a = t, s = !0
                        },
                        createNode: function() {
                            u = c.extendArray(u, p, 6), p += 1
                        },
                        removeNode: function(e) {
                            p > 0 && (p -= 1), e.id < p && p > 0 && c.copyArrayPart(u, 6 * e.id, 6 * p, 6)
                        },
                        replaceProperties: function() {}
                    }
                },
                he = function() {
                    var e, t, n, r, o, a, i, s, c, l, d = 27,
                        u = 9 * (2 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT),
                        p = ["precision mediump float;", "varying vec4 color;", "void main(void) {", "   gl_FragColor = color;", "}"].join("\n"),
                        f = ["attribute vec2 a_vertexPos;", "attribute vec4 a_color;", "uniform vec2 u_screenSize;", "uniform mat4 u_transform;", "varying vec4 color;", "void main(void) {", "  gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);", "  color = a_color.abgr;", "}"].join("\n"),
                        h = 0,
                        g = new ArrayBuffer(16 * u),
                        m = new Float32Array(g),
                        y = new Uint32Array(g);
                    return {
                        load: function(a) {
                            t = a, r = T.a.Graph.webgl(a), e = r.createProgram(f, p), t.useProgram(e), o = r.getLocations(e, ["a_vertexPos", "a_color", "u_screenSize", "u_transform"]), t.enableVertexAttribArray(o.vertexPos), t.enableVertexAttribArray(o.color), n = t.createBuffer()
                        },
                        position: function(e, t, n) {
                            var r = e.id * d,
                                o = n.x - t.x,
                                a = n.y - t.y,
                                i = Math.sqrt(Math.pow(o, 2) + Math.pow(a, 2)),
                                s = o / i,
                                c = a / i,
                                l = .5 * e.from.size,
                                u = .5 * e.to.size,
                                p = t.x + s * l,
                                f = t.y + c * l,
                                h = n.x - s * u,
                                g = n.y - c * u,
                                b = h - p,
                                v = g - f;
                            if (0 === e.index)
                                for (var _ = b / 8, w = v / 8, O = 0; O <= 8; O += 1) {
                                    var E = r + 3 * O;
                                    switch (O) {
                                        case 0:
                                            m[E] = p, m[E + 1] = f, y[E + 2] = e.color;
                                            break;
                                        case 8:
                                            m[E] = h, m[E + 1] = g, y[E + 2] = e.color;
                                            break;
                                        default:
                                            m[E] = p + O * _, m[E + 1] = f + O * w, y[E + 2] = e.color
                                    }
                                } else
                                    for (var j = {
                                            x: .5 * (t.x + n.x),
                                            y: .5 * (t.y + n.y)
                                        }, S = Math.atan(-1 / (a / o)), x = (20 + 20 * Math.abs(e.index)) * (e.index < 0 ? -1 : 1), k = Math.cos(S) * x, C = Math.sin(S) * x, N = {
                                            x: j.x + k,
                                            y: j.y + C
                                        }, T = 0; T <= 8; T += 1) {
                                        var L = r + 3 * T;
                                        switch (T) {
                                            case 0:
                                                m[L] = t.x, m[L + 1] = t.y, y[L + 2] = e.color;
                                                break;
                                            case 8:
                                                m[L] = n.x, m[L + 1] = n.y, y[L + 2] = e.color;
                                                break;
                                            default:
                                                var P = T / 8,
                                                    A = Math.pow(1 - P, 2) * t.x + 2 * (1 - P) * P * N.x + Math.pow(P, 2) * n.x,
                                                    D = Math.pow(1 - P, 2) * t.y + 2 * (1 - P) * P * N.y + Math.pow(P, 2) * n.y;
                                                m[L] = A, m[L + 1] = D, y[L + 2] = e.color
                                        }
                                    }
                        },
                        createLink: function(e) {
                            ! function() {
                                if ((h + 1) * u > g.byteLength) {
                                    var e = new ArrayBuffer(2 * g.byteLength),
                                        t = new Float32Array(e),
                                        n = new Uint32Array(e);
                                    n.set(y), m = t, y = n, g = e
                                }
                            }(), h += 1, a = e.id
                        },
                        removeLink: function(e) {
                            h > 0 && (h -= 1), e.id < h && h > 0 && r.copyArrayPart(y, e.id * d, h * d, d)
                        },
                        updateTransform: function(e) {
                            l = !0, c = e
                        },
                        updateSize: function(e, t) {
                            i = e, s = t, l = !0
                        },
                        render: function() {
                            t.useProgram(e);
                            for (var r = 0; r < h; r += 1) {
                                t.bindBuffer(t.ARRAY_BUFFER, n);
                                var d = new Float32Array(g.slice(r * u, (r + 1) * u));
                                t.bufferData(t.ARRAY_BUFFER, d, t.DYNAMIC_DRAW), l && (l = !1, t.uniformMatrix4fv(o.transform, !1, c), t.uniform2f(o.screenSize, i, s)), t.vertexAttribPointer(o.vertexPos, 2, t.FLOAT, !1, 3 * Float32Array.BYTES_PER_ELEMENT, 0), t.vertexAttribPointer(o.color, 4, t.UNSIGNED_BYTE, !0, 3 * Float32Array.BYTES_PER_ELEMENT, 8), t.drawArrays(t.LINE_STRIP, 0, 9)
                            }
                            a = h - 1
                        },
                        bringToFront: function(e) {
                            a > e.id && r.swapArrayPart(m, e.id * d, a * d, d), a > 0 && (a -= 1)
                        },
                        getFrontLinkId: function() {
                            return a
                        }
                    }
                },
                ge = function(e) {
                    var t, n, r, o, a, i, s, c, l, d, u = 153,
                        p = 51 * (2 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT),
                        f = ["precision mediump float;", "varying vec4 color;", "void main(void) {", "   gl_FragColor = color;", "}"].join("\n"),
                        h = ["attribute vec2 a_vertexPos;", "attribute vec4 a_color;", "uniform vec2 u_screenSize;", "uniform mat4 u_transform;", "varying vec4 color;", "void main(void) {", "   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);", "   color = a_color.abgr;", "}"].join("\n"),
                        g = 0,
                        m = new ArrayBuffer(16 * p),
                        y = new Float32Array(m),
                        b = new Uint32Array(m),
                        v = e.useCurvedEdges,
                        _ = new Float32Array(new ArrayBuffer(36 * Float32Array.BYTES_PER_ELEMENT)),
                        w = function(e) {
                            var t = .5 * (e.fromX + e.toX),
                                n = .5 * (e.fromY + e.toY),
                                r = t + e.midXOffset,
                                o = n + e.midYOffset;
                            e.data[e.startWith] = e.fromX, e.data[e.startWith + 1] = e.fromY, e.data[e.startWith + 16] = e.toX, e.data[e.startWith + 16 + 1] = e.toY;
                            for (var a = 7; a > 0; a -= 1) {
                                var i = a / 8;
                                e.data[e.startWith + 2 * a] = Math.pow(1 - i, 2) * e.fromX + 2 * (1 - i) * i * r + Math.pow(i, 2) * e.toX, e.data[e.startWith + 2 * a + 1] = Math.pow(1 - i, 2) * e.fromY + 2 * (1 - i) * i * o + Math.pow(i, 2) * e.toY
                            }
                        },
                        O = function(e) {
                            var t = (e.toX - e.fromX) / 8,
                                n = (e.toY - e.fromY) / 8;
                            e.data[e.startWith] = e.fromX, e.data[e.startWith + 1] = e.fromY, e.data[e.startWith + 16] = e.toX, e.data[e.startWith + 16 + 1] = e.toY;
                            for (var r = 7; r > 0; r -= 1) e.data[e.startWith + 2 * r] = e.fromX + r * t, e.data[e.startWith + 2 * r + 1] = e.fromY + r * n
                        };
                    return {
                        load: function(e) {
                            n = e, o = T.a.Graph.webgl(e), t = o.createProgram(h, f), n.useProgram(t), a = o.getLocations(t, ["a_vertexPos", "a_color", "u_screenSize", "u_transform"]), n.enableVertexAttribArray(a.vertexPos), n.enableVertexAttribArray(a.color), r = n.createBuffer()
                        },
                        position: function(e) {
                            var t = e.id * u,
                                n = .4 * e.size,
                                r = e.adj.yDist < 0 ? -1 : 1,
                                o = e.adj.dist,
                                a = Math.atan(-1 / e.adj.distRatio),
                                i = e.adj.from.x,
                                s = e.adj.from.y,
                                c = e.adj.to.x,
                                l = e.adj.to.y,
                                d = Math.cos(a) * n,
                                p = Math.sin(a) * n;
                            if (v || 0 !== e.index) {
                                var f = .15 * o,
                                    h = (f + f * Math.abs(e.index)) * (e.index < 0 ? -1 : 1),
                                    g = Math.cos(a) * h * r,
                                    m = Math.sin(a) * h * r;
                                w({
                                    data: _,
                                    fromX: i - d,
                                    fromY: s - p,
                                    toX: c - d,
                                    toY: l - p,
                                    midXOffset: g,
                                    midYOffset: m,
                                    startWith: 0
                                }), w({
                                    data: _,
                                    fromX: i + d,
                                    fromY: s + p,
                                    toX: c + d,
                                    toY: l + p,
                                    midXOffset: g,
                                    midYOffset: m,
                                    startWith: 18
                                })
                            } else O({
                                data: _,
                                fromX: i - d,
                                fromY: s - p,
                                toX: c - d,
                                toY: l - p,
                                startWith: 0
                            }), O({
                                data: _,
                                fromX: i + d,
                                fromY: s + p,
                                toX: c + d,
                                toY: l + p,
                                startWith: 18
                            });
                            for (var E = 0; E < 8; E += 1) {
                                var j = t + 18 * E;
                                y[j] = _[2 * E], y[j + 1] = _[2 * E + 1], b[j + 2] = e.color, y[j + 3] = _[2 * E + 2], y[j + 4] = _[2 * E + 3], b[j + 5] = e.color, y[j + 6] = _[18 + 2 * E], y[j + 7] = _[18 + 2 * E + 1], b[j + 8] = e.color, y[j + 9] = _[2 * E + 2], y[j + 10] = _[2 * E + 3], b[j + 11] = e.color, y[j + 12] = _[18 + 2 * E], y[j + 13] = _[18 + 2 * E + 1], b[j + 14] = e.color, y[j + 15] = _[18 + 2 * E + 2], y[j + 16] = _[18 + 2 * E + 3], b[j + 17] = e.color
                            }
                            var S = t + 144;
                            if (e.directed) {
                                var x, k, C, N, T = .5 * (_[14] + _[28]),
                                    L = c,
                                    P = l,
                                    A = P - .5 * (_[15] + _[29]),
                                    D = L - T,
                                    M = Math.sqrt(Math.pow(D, 2) + Math.pow(A, 2)),
                                    q = L - 6 * (D / M),
                                    I = P - 6 * (A / M);
                                if (v || 0 === e.index) x = Math.cos(a) * (n + 3), k = Math.sin(a) * (n + 3), C = Math.cos(a) * n, N = Math.sin(a) * n;
                                else {
                                    var R = Math.atan(-1 / (A / D));
                                    x = Math.cos(R) * (n + 3), k = Math.sin(R) * (n + 3), C = Math.cos(R) * n, N = Math.sin(R) * n
                                }
                                y[S + 0] = L, y[S + 1] = P, b[S + 2] = e.color, y[S + 3] = q - x, y[S + 4] = I - k, b[S + 5] = e.color, y[S + 6] = q + x, y[S + 7] = I + k, b[S + 8] = e.color, y[S - 15] = q - C, y[S - 14] = I - N, y[S - 9] = q - C, y[S - 8] = I - N, y[S - 3] = q + C, y[S - 2] = I + N
                            } else y[S + 0] = 0, y[S + 1] = 0, b[S + 2] = 0, y[S + 3] = 0, y[S + 4] = 0, b[S + 5] = 0, y[S + 6] = 0, y[S + 7] = 0, b[S + 8] = 0
                        },
                        createLink: function(e) {
                            ! function() {
                                if ((g + 1) * p > m.byteLength) {
                                    var e = new ArrayBuffer(2 * m.byteLength),
                                        t = new Float32Array(e),
                                        n = new Uint32Array(e);
                                    n.set(b), y = t, b = n, m = e
                                }
                            }(), g += 1, i = e.id
                        },
                        removeLink: function(e) {
                            g > 0 && (g -= 1), e.id < g && g > 0 && o.copyArrayPart(b, e.id * u, g * u, u)
                        },
                        updateTransform: function(e) {
                            d = !0, l = e
                        },
                        updateSize: function(e, t) {
                            s = e, c = t, d = !0
                        },
                        render: function() {
                            n.useProgram(t), n.bindBuffer(n.ARRAY_BUFFER, r), n.bufferData(n.ARRAY_BUFFER, m, n.DYNAMIC_DRAW), d && (d = !1, n.uniformMatrix4fv(a.transform, !1, l), n.uniform2f(a.screenSize, s, c)), n.vertexAttribPointer(a.vertexPos, 2, n.FLOAT, !1, 3 * Float32Array.BYTES_PER_ELEMENT, 0), n.vertexAttribPointer(a.color, 4, n.UNSIGNED_BYTE, !0, 3 * Float32Array.BYTES_PER_ELEMENT, 8), n.drawArrays(n.TRIANGLES, 0, 51 * g), i = g - 1
                        },
                        bringToFront: function(e) {
                            i > e.id && o.swapArrayPart(y, e.id * u, i * u, u), i > 0 && (i -= 1)
                        },
                        getFrontLinkId: function() {
                            return i
                        }
                    }
                },
                me = function() {
                    var e, t, n, r, o, a, i, s, c, l, d = 18,
                        u = 6 * (2 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT),
                        p = ["precision mediump float;", "varying vec4 color;", "void main(void) {", "   gl_FragColor = color;", "}"].join("\n"),
                        f = ["attribute vec2 a_vertexPos;", "attribute vec4 a_color;", "uniform vec2 u_screenSize;", "uniform mat4 u_transform;", "varying vec4 color;", "void main(void) {", "   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);", "   color = a_color.abgr;", "}"].join("\n"),
                        h = 0,
                        g = new ArrayBuffer(16 * u),
                        m = new Float32Array(g),
                        y = new Uint32Array(g);
                    return {
                        load: function(a) {
                            t = a, r = T.a.Graph.webgl(a), e = r.createProgram(f, p), t.useProgram(e), o = r.getLocations(e, ["a_vertexPos", "a_color", "u_screenSize", "u_transform"]), t.enableVertexAttribArray(o.vertexPos), t.enableVertexAttribArray(o.color), n = t.createBuffer()
                        },
                        position: function(e, t, n) {
                            var r = e.id * d,
                                o = n.x - t.x,
                                a = n.y - t.y,
                                i = Math.sqrt(Math.pow(o, 2) + Math.pow(a, 2)),
                                s = o / i,
                                c = a / i,
                                l = .5 * e.from.size,
                                u = .5 * e.to.size,
                                p = t.x + s * l,
                                f = t.y + c * l,
                                h = n.x - s * u,
                                g = n.y - c * u;
                            if (m[r] = p, m[r + 1] = f, y[r + 2] = e.color, m[r + 3] = h, m[r + 4] = g, y[r + 5] = e.color, e.directed) {
                                var b = Math.atan(-1 / (a / o)),
                                    v = 3 * Math.cos(b),
                                    _ = 3 * Math.sin(b),
                                    w = h - 6 * s,
                                    O = g - 6 * c;
                                m[r + 6] = w - v, m[r + 7] = O - _, y[r + 8] = e.color, m[r + 9] = h, m[r + 10] = g, y[r + 11] = e.color, m[r + 12] = w + v, m[r + 13] = O + _, y[r + 14] = e.color, m[r + 15] = h, m[r + 16] = g, y[r + 17] = e.color
                            } else m[r + 6] = 0, m[r + 7] = 0, y[r + 8] = 0, m[r + 9] = 0, m[r + 10] = 0, y[r + 11] = 0, m[r + 12] = 0, m[r + 13] = 0, y[r + 14] = 0, m[r + 15] = 0, m[r + 16] = 0, y[r + 17] = 0
                        },
                        createLink: function(e) {
                            ! function() {
                                if ((h + 1) * u > g.byteLength) {
                                    var e = new ArrayBuffer(2 * g.byteLength),
                                        t = new Float32Array(e),
                                        n = new Uint32Array(e);
                                    n.set(y), m = t, y = n, g = e
                                }
                            }(), h += 1, a = e.id
                        },
                        removeLink: function(e) {
                            h > 0 && (h -= 1), e.id < h && h > 0 && r.copyArrayPart(y, e.id * d, h * d, d)
                        },
                        updateTransform: function(e) {
                            l = !0, c = e
                        },
                        updateSize: function(e, t) {
                            i = e, s = t, l = !0
                        },
                        render: function() {
                            t.useProgram(e), t.bindBuffer(t.ARRAY_BUFFER, n), t.bufferData(t.ARRAY_BUFFER, g, t.DYNAMIC_DRAW), l && (l = !1, t.uniformMatrix4fv(o.transform, !1, c), t.uniform2f(o.screenSize, i, s)), t.vertexAttribPointer(o.vertexPos, 2, t.FLOAT, !1, 3 * Float32Array.BYTES_PER_ELEMENT, 0), t.vertexAttribPointer(o.color, 4, t.UNSIGNED_BYTE, !0, 3 * Float32Array.BYTES_PER_ELEMENT, 8), t.drawArrays(t.LINES, 0, 6 * h), a = h - 1
                        },
                        bringToFront: function(e) {
                            a > e.id && r.swapArrayPart(m, e.id * d, a * d, d), a > 0 && (a -= 1)
                        },
                        getFrontLinkId: function() {
                            return a
                        }
                    }
                },
                ye = function() {
                    var e, t, n, r, o, a, i, s, c, l, d = 27,
                        u = 9 * (2 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT),
                        p = ["precision mediump float;", "varying vec4 color;", "void main(void) {", "   gl_FragColor = color;", "}"].join("\n"),
                        f = ["attribute vec2 a_vertexPos;", "attribute vec4 a_color;", "uniform vec2 u_screenSize;", "uniform mat4 u_transform;", "varying vec4 color;", "void main(void) {", "   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);", "   color = a_color.abgr;", "}"].join("\n"),
                        h = 0,
                        g = new ArrayBuffer(16 * u),
                        m = new Float32Array(g),
                        y = new Uint32Array(g);
                    return {
                        load: function(a) {
                            t = a, r = T.a.Graph.webgl(a), e = r.createProgram(f, p), t.useProgram(e), o = r.getLocations(e, ["a_vertexPos", "a_color", "u_screenSize", "u_transform"]), t.enableVertexAttribArray(o.vertexPos), t.enableVertexAttribArray(o.color), n = t.createBuffer()
                        },
                        position: function(e) {
                            var t = e.id * d,
                                n = .4 * e.size,
                                r = Math.atan(-1 / e.adj.distRatio),
                                o = e.adj.from.x,
                                a = e.adj.from.y,
                                i = e.adj.to.x,
                                s = e.adj.to.y,
                                c = e.adj.unitX,
                                l = e.adj.unitY;
                            e.directed && (i -= 6 * c, s -= 6 * l);
                            var u = Math.cos(r) * n,
                                p = Math.sin(r) * n,
                                f = o - u,
                                h = a - p,
                                g = i - u,
                                b = s - p,
                                v = o + u,
                                _ = a + p,
                                w = i + u,
                                O = s + p;
                            if (m[t] = f, m[t + 1] = h, y[t + 2] = e.color, m[t + 3] = g, m[t + 4] = b, y[t + 5] = e.color, m[t + 6] = v, m[t + 7] = _, y[t + 8] = e.color, m[t + 9] = g, m[t + 10] = b, y[t + 11] = e.color, m[t + 12] = v, m[t + 13] = _, y[t + 14] = e.color, m[t + 15] = w, m[t + 16] = O, y[t + 17] = e.color, e.directed) {
                                var E = e.adj.to.x,
                                    j = e.adj.to.y,
                                    S = Math.cos(r) * (n + 3),
                                    x = Math.sin(r) * (n + 3);
                                m[t + 18] = E, m[t + 19] = j, y[t + 20] = e.color, m[t + 21] = i - S, m[t + 22] = s - x, y[t + 23] = e.color, m[t + 24] = i + S, m[t + 25] = s + x, y[t + 26] = e.color
                            } else m[t + 18] = 0, m[t + 19] = 0, y[t + 20] = 0, m[t + 21] = 0, m[t + 22] = 0, y[t + 23] = 0, m[t + 24] = 0, m[t + 25] = 0, y[t + 26] = 0
                        },
                        createLink: function(e) {
                            ! function() {
                                if ((h + 1) * u > g.byteLength) {
                                    var e = new ArrayBuffer(2 * g.byteLength),
                                        t = new Float32Array(e),
                                        n = new Uint32Array(e);
                                    n.set(y), m = t, y = n, g = e
                                }
                            }(), h += 1, a = e.id
                        },
                        removeLink: function(e) {
                            h > 0 && (h -= 1), e.id < h && h > 0 && r.copyArrayPart(y, e.id * d, h * d, d)
                        },
                        updateTransform: function(e) {
                            l = !0, c = e
                        },
                        updateSize: function(e, t) {
                            i = e, s = t, l = !0
                        },
                        render: function() {
                            t.useProgram(e), t.bindBuffer(t.ARRAY_BUFFER, n), t.bufferData(t.ARRAY_BUFFER, g, t.DYNAMIC_DRAW), l && (l = !1, t.uniformMatrix4fv(o.transform, !1, c), t.uniform2f(o.screenSize, i, s)), t.vertexAttribPointer(o.vertexPos, 2, t.FLOAT, !1, 3 * Float32Array.BYTES_PER_ELEMENT, 0), t.vertexAttribPointer(o.color, 4, t.UNSIGNED_BYTE, !0, 3 * Float32Array.BYTES_PER_ELEMENT, 8), t.drawArrays(t.TRIANGLES, 0, 9 * h), a = h - 1
                        },
                        bringToFront: function(e) {
                            a > e.id && r.swapArrayPart(m, e.id * d, a * d, d), a > 0 && (a -= 1)
                        },
                        getFrontLinkId: function() {
                            return a
                        }
                    }
                },
                be = function(e, t) {
                    var n = e.uiStore,
                        r = e.graphStore,
                        o = e.GraphHistory,
                        a = e.dispatcher,
                        i = t.map;

                    function s(e, t) {
                        this.size = e, this.color = t, this.alpha = 1, this.selected = 0
                    }
                    var c = function(e) {
                        this.id = e.id, this.data = e, this.nodeType = o.getNodeTypeById(e.type_id), this.neighborSelected = 0, this.selected = !1, this.keepNodesHidden = !0
                    };
                    c.HOVER_CARD_WAIT = 1200, c.prototype.getNodeData = function() {
                        return this.data
                    }, c.prototype.uiInit = function(e) {
                        return this.viva = e, this.ui = new s(12, (this.data.color || this.nodeType.color).replace("#", "0x")), this.uiInitLabel(), r.get("layout").lock_node_positions || this.data.properties && Object.prototype.hasOwnProperty.call(this.data.properties, "LatLng") ? i.getLayout().pinNode(e, !0) : this.lockNode(this.data.is_locked), this.ui
                    }, c.prototype.updateNodeType = function(e) {
                        var t = !1;
                        if (e.id === this.data.type_id) {
                            if (this.data.properties = this.data.properties || {}, Array.isArray(e.properties))
                                for (var n = 0; n < e.properties.length; n += 1) {
                                    var r = e.prev.properties[n].name,
                                        o = e.prev.properties[n].name_alias;
                                    (r || o) && Object.prototype.hasOwnProperty.call(this.data.properties, e.prev.properties[n].name) && (this.data.properties[e.properties[n].name] = this.data.properties[e.prev.properties[n].name], delete this.data.properties[e.prev.properties[n].name])
                                }
                            e.color && (this.data.color = e.color, t = !0)
                        }
                        return t
                    }, c.prototype.lockNode = function(e) {
                        this.is_locked = e, i.getLayout().pinNode(this.viva, e), n.get("readOnly") && (this.disable_drag = e)
                    }, c.prototype.uiUpdate = function() {
                        this.ui.size = 2 * i.getNodeSizeInterpolator().getValueFor(this.viva), this.ui.color = (this.data.color || this.nodeType.color).replace("#", "0x"), c.prototype.uiUpdateText.call(this, this.ui.size)
                    }, c.prototype.uiUpdateText = function() {
                        this.uiUseShortText(!r.get("layoutNodeFullname")), this.uiLabel.color = this.data.color || this.nodeType.color
                    }, c.prototype.uiUseShortText = function(e) {
                        var t = o.nodeDisplayName(this.id);
                        e && this.data.name.length > 12 ? this.uiLabel.text = [t.substring(0, 9), "..."].join("") : this.uiLabel.text = t
                    }, c.prototype.uiInitLabel = function() {
                        this.uiLabel = {
                            color: this.nodeType.color
                        }, this.uiUseShortText(!r.get("layoutNodeFullname"))
                    }, c.prototype.getUIBounds = function(e) {
                        var n = i.getGraphEngine(),
                            r = n.layout,
                            o = n.graphics,
                            a = n.renderer,
                            s = r.getNodePosition(this.id),
                            c = .5 * this.ui.size,
                            l = s.x - c,
                            d = s.x + c,
                            u = s.y - c,
                            p = s.y + c,
                            f = {
                                x: l,
                                y: u
                            };
                        if (o.transformGraphToClientCoordinates(f), e) {
                            var h = {
                                x: d,
                                y: p
                            };
                            return o.transformGraphToClientCoordinates(h), {
                                left: f.x,
                                top: f.y,
                                right: h.x,
                                bottom: h.y
                            }
                        }
                        var g = a.getZoom() * this.ui.size;
                        t.labelContext.font = g + "px Apercu Regular Pro";
                        var m = 1.05 * t.labelContext.measureText(this.uiLabel.text).width;
                        return {
                            left: f.x,
                            top: f.y,
                            right: f.x + .7 * g + m,
                            bottom: f.y + g
                        }
                    }, c.prototype.drawLabel = function() {
                        var e = i.getGraphEngine(),
                            n = e.renderer,
                            r = e.graphics,
                            o = n.getZoom() * Math.floor(1.2 * this.ui.size);
                        if (this.peeked || i.getForceDisplaySmallNodeNames() || !(o < 10)) {
                            var a = {
                                x: this.ui.position.x,
                                y: this.ui.position.y
                            };
                            r.transformGraphToClientCoordinates(a);
                            var s = a.x + n.getZoom() * (.7 * this.ui.size),
                                c = Math.ceil(a.y);
                            t.labelContext.fillStyle = this.uiLabel.color, t.labelContext.font = o + "px Apercu Regular Pro", t.labelContext.fillText(this.uiLabel.text, s, c)
                        }
                    }, c.prototype.reset = function() {
                        this.selected = !1, this.muted = !1, this.peeked = !1, this.neighborSelected = 0, this.ui.selected = 0, this.ui.alpha = 1, this.uiLabel.color = this.data.color || this.nodeType.color
                    }, c.prototype.highlightNode = function(e) {
                        this.ui.selected = 1, this.ui.alpha = 1, this.uiLabel.color = this.data.color || this.nodeType.color, this.selected = !0, e || i.getRenderer().rerender()
                    }, c.prototype.selectNode = function(e, t) {
                        var n = i.getSelectedNodes().length;
                        this.ui.selected = 1, this.ui.alpha = 1, this.uiLabel.color = this.data.color || this.nodeType.color, this.selected = !0;
                        var r = this.id,
                            o = i.getGraph();
                        n > 1 ? this.viva.links.forEach((function(e) {
                            i.getGraphics().bringLinkToFront(e.data.ui);
                            var n = r == e.fromId ? e.toId : e.fromId,
                                a = o.getNode(n).data;
                            t && !a.selected || (e.data.selectedEnd += 1, e.data.highlighted || e.data.unmute(), a.neighborSelected += 1, a.selected || 1 !== a.neighborSelected || a.unmute())
                        })) : (this.viva.links.forEach((function(e) {
                            i.getGraphics().bringLinkToFront(e.data.ui);
                            var n = r == e.fromId ? e.toId : e.fromId,
                                a = o.getNode(n).data;
                            t && !a.selected || (e.data.selectedEnd += 1, e.data.highlight(), a.neighborSelected += 1)
                        })), o.forEachNode((function(e) {
                            !e.data.selected && e.data.neighborSelected < 1 && e.data.mute()
                        })), o.forEachLink((function(e) {
                            e.data.selectedEnd < 1 && e.data.mute()
                        }))), e || i.getRenderer().rerender()
                    }, c.prototype.unselectNode = function() {
                        var e = i.getSelectedNodes() > 0,
                            t = this.id,
                            n = i.getGraph();
                        e ? (this.selected = !1, this.ui.selected = 0, 0 === this.neighborSelected && this.mute(), this.viva.links.forEach((function(r) {
                            var o;
                            r.data.selectedEnd -= 1, 0 === r.data.selectedEnd && r.data.mute(), r.fromId !== t && ((o = n.getNode(r.fromId).data).neighborSelected -= 1, e && (o.selected || 0 !== o.neighborSelected || o.mute())), r.toId !== t && ((o = n.getNode(r.toId).data).neighborSelected -= 1, e && (o.selected || 0 !== o.neighborSelected || o.mute()))
                        }))) : (n.forEachNode((function(e) {
                            e.data.reset()
                        })), n.forEachLink((function(e) {
                            e.data.reset()
                        }))), i.getRenderer().rerender()
                    }, c.prototype.onNodeClicked = function(e) {
                        this.clearHoverCard(), this.mouseDownX === e.clientX && this.mouseDownY === e.clientY && (e.shiftKey || o.clearSelectedNodes(), this.selected || o.selectNode(this.id))
                    }, c.prototype.onMouseOver = function() {
                        c.waitingForLongMouseOver = !0, clearTimeout(c.longMouseOverTimeout), c.longMouseOverTimeout = setTimeout(this.handleLongMouseOver.bind(this), c.HOVER_CARD_WAIT), Object(y.rb)("pointer");
                        var e = i.getGraph(),
                            t = i.getSelectedNodes().length > 0,
                            n = this.id;
                        r.get("layoutNodeFullname") || this.uiUseShortText(!1), e.forEachNode((function(e) {
                            e.data.peeked = !1
                        })), t ? (this.selected || 0 !== this.neighborSelected || this.unmute(), this.viva.links.forEach((function(t) {
                            if (i.getGraphics().bringLinkToFront(t.data.ui), 0 !== t.data.selectedEnd || t.data.highlighted || t.data.unmute(!0), t.fromId !== n) {
                                var r = e.getNode(t.fromId).data;
                                r.selected || 0 !== r.neighborSelected || r.unmute()
                            }
                            if (t.toId !== n) {
                                var o = e.getNode(t.toId).data;
                                o.selected || 0 !== o.neighborSelected || o.unmute()
                            }
                        }))) : (e.forEachNode((function(e) {
                            e.data.mute()
                        })), e.forEachLink((function(e) {
                            e.data.mute()
                        })), this.unmute(), this.viva.links.forEach((function(t) {
                            t.data.unmute(!0), i.getGraphics().bringLinkToFront(t.data.ui), t.fromId !== n && e.getNode(t.fromId).data.unmute(), t.toId !== n && e.getNode(t.toId).data.unmute()
                        }))), this.peeked = !0, i.getRenderer().rerender()
                    }, c.prototype.handleLongMouseOver = function() {
                        c.waitingForLongMouseOver && (c.uiHoverCard && c.uiHoverCard.destroy(), c.uiHoverCard = M(e, this, function() {
                            a.emit("openExpandPanel", {
                                nodes: [this.data],
                                position: i.getLayout().getNodePosition(this.id)
                            })
                        }.bind(this), function() {
                            o.clearSelectedNodes(), o.addToSelectedNodes(this.data.id)
                        }.bind(this)))
                    }, c.prototype.clearHoverCard = function() {
                        c.uiHoverCard && c.uiHoverCard.scheduleDestroy(), c.waitingForLongMouseOver = !1, clearTimeout(c.longMouseOverTimeout), c.longMouseOverTimeout = null
                    }, c.prototype.onMouseOut = function() {
                        this.clearHoverCard(), Object(y.rb)("default");
                        var e = i.getSelectedNodes().length > 0;
                        r.get("layoutNodeFullname") || this.uiUseShortText(!0);
                        var t = i.getGraph(),
                            n = this.id;
                        e ? (this.selected || 0 !== this.neighborSelected || this.mute(), this.viva.links.forEach((function(e) {
                            if (0 !== e.data.selectedEnd || e.data.highlighted || e.data.mute(), e.fromId !== n) {
                                var r = t.getNode(e.fromId).data;
                                r.selected || 0 !== r.neighborSelected || r.mute()
                            }
                            if (e.toId !== n) {
                                var o = t.getNode(e.toId).data;
                                o.selected || 0 !== o.neighborSelected || o.mute()
                            }
                        }))) : (t.forEachNode((function(e) {
                            e.data.reset()
                        })), t.forEachLink((function(e) {
                            e.data.reset()
                        }))), this.peeked = !1, i.getRenderer().rerender()
                    }, c.prototype.onMouseDown = function(e) {
                        this.mouseDownX = e.clientX, this.mouseDownY = e.clientY
                    }, c.prototype.mute = function() {
                        this.ui.alpha = .5, this.uiLabel.color = k()(this.data.color || this.nodeType.color).setAlpha(.2).toRgbString(), this.ui.selected = 0, this.muted = !0
                    }, c.prototype.unmute = function() {
                        this.ui.alpha = 1, this.uiLabel.muted = !1, this.uiLabel.color = this.data.color || this.nodeType.color, this.muted = !1
                    }, c.prototype.delete = function() {
                        var e, t = this.viva.links;
                        for (e = t.length - 1; e >= 0; e -= 1) t[e].data.delete(!0, !0);
                        var n = i.getGraph();
                        n.removeNode(this.id), i.getWeightInterpolator().calculate(n, !0), i.getNodeSizeInterpolator().calculate(n, o.getNodeTypes(), !0)
                    };
                    var l = function(e) {
                        c.call(this, e)
                    };
                    return (l.prototype = Object.create(c.prototype)).constructor = c, l.prototype.uiInit = function(e) {
                        return this.viva = e, this.ui = new s(1, "0xFFFFFF"), this.ui.text_size = 36 + Math.round(e.data.data.nodes.length / 8), this.uiInitLabel(), i.getLayout().pinNode(e, !0), this.ui
                    }, l.prototype.uiInitLabel = function() {
                        var e;
                        this.uiLabel = {
                            color: (e = this.data.color, k()(e).darken(10).toString()),
                            text: this.data.name.toUpperCase()
                        }
                    }, l.prototype.onMouseOver = function() {
                        Object(y.rb)("pointer");
                        var e = i.getGraph(),
                            t = i.getSelectedNodes().length > 0,
                            n = this.id;
                        i.getGraphics().bringLinkToFront(this.ui), t ? (this.unmute(), this.data.nodes.forEach((function(t) {
                            var r = e.getNode(t);
                            (r.data.selected || r.data.neighborSelected > 0) && r.data.unmute(), r.links.forEach((function(t) {
                                i.getGraphics().bringLinkToFront(t.data.ui), 0 !== t.data.selectedEnd || t.data.highlighted || t.data.unmute();
                                var r = t.fromId !== n ? t.fromId : t.toId,
                                    o = e.getNode(r).data;
                                o.selected || 0 !== o.neighborSelected || o.unmute()
                            }))
                        }))) : (e.forEachNode((function(e) {
                            e.data.mute()
                        })), e.forEachLink((function(e) {
                            e.data.mute()
                        })), this.unmute(), this.data.nodes.forEach((function(t) {
                            var n = e.getNode(t);
                            n && (n.data.unmute(), n.links.forEach((function(n) {
                                var r = n.fromId !== t ? n.fromId : n.toId;
                                e.getNode(r).data.muted || n.data.unmute()
                            })))
                        }))), i.getRenderer().rerender()
                    }, l.prototype.onMouseOut = function() {
                        Object(y.rb)("default");
                        var e = i.getSelectedNodes().length > 0,
                            t = i.getGraph();
                        e ? (this.mute(), this.data.nodes.forEach((function(e) {
                            var n = t.getNode(e);
                            n.data.selected || 0 !== n.data.neighborSelected || n.data.mute(), n.links.forEach((function(n) {
                                0 !== n.data.selectedEnd || n.data.highlighted || n.data.mute();
                                var r = n.fromId !== e ? n.fromId : n.toId,
                                    o = t.getNode(r).data;
                                o.selected || 0 !== o.neighborSelected || o.mute()
                            }))
                        }))) : (t.forEachNode((function(e) {
                            e.data.reset()
                        })), t.forEachLink((function(e) {
                            e.data.reset()
                        }))), i.getRenderer().rerender()
                    }, l.prototype.getUIBounds = function(e) {
                        var n = i.getGraphEngine(),
                            o = n.layout,
                            a = n.graphics,
                            s = n.renderer,
                            c = o.getNodePosition(this.id),
                            l = c.x,
                            d = c.x,
                            u = c.y,
                            p = c.y,
                            f = {
                                x: l,
                                y: u
                            };
                        if (a.transformGraphToClientCoordinates(f), e) {
                            var h = {
                                x: d,
                                y: p
                            };
                            return a.transformGraphToClientCoordinates(h), {
                                left: f.x,
                                top: f.y,
                                right: h.x,
                                bottom: h.y
                            }
                        }
                        var g = r.get("clusterLabelNameSizeFactor") / 2.4,
                            m = Math.floor(s.getZoom() * this.ui.text_size * 2 * g);
                        t.labelContext.font = m + "px Apercu Regular Pro";
                        var b = Object(y.i)(this.uiLabel.text, 10),
                            v = b.map((function(e) {
                                return t.labelContext.measureText(e).width
                            })).sort((function(e, t) {
                                return e < t ? -1 : e > t ? 1 : 0
                            })).reverse()[0],
                            _ = b.length;
                        return {
                            left: f.x - 6,
                            right: f.x + v + 6,
                            top: f.y + 25 - .5 * m - 6,
                            bottom: f.y + 25 - .5 * m + m * _ + 6
                        }
                    }, l.prototype.drawLabel = function() {
                        var e = i.getGraphEngine(),
                            n = e.renderer,
                            o = e.graphics,
                            a = r.get("clusterLabelNameSizeFactor") / 2.4,
                            s = Math.floor(n.getZoom() * this.ui.text_size * 2 * a);
                        if (this.peeked || i.getForceDisplaySmallNodeNames() || !(s < 10)) {
                            var c = {
                                x: this.ui.position.x,
                                y: this.ui.position.y
                            };
                            o.transformGraphToClientCoordinates(c);
                            var l = c.x,
                                d = Math.ceil(c.y);
                            t.labelContext.fillStyle = this.uiLabel.color, t.labelContext.font = s + "px Apercu Bold Pro", t.labelContext.strokeStyle = "#FFF", t.labelContext.strokeWidth = "3px", Object(y.i)(this.uiLabel.text, 10).forEach((function(e, n) {
                                t.labelContext.strokeText(e, l, d + s * n + 25), t.labelContext.fillText(e, l, d + s * n + 25)
                            }))
                        }
                    }, {
                        WebGLDefaultNode: c,
                        WebGLClusterLabelNode: l
                    }
                };

            function ve(e, t) {
                return (ve = Object.setPrototypeOf || function(e, t) {
                    return e.__proto__ = t, e
                })(e, t)
            }

            function _e(e) {
                var t = function() {
                    if ("undefined" === typeof Reflect || !Reflect.construct) return !1;
                    if (Reflect.construct.sham) return !1;
                    if ("function" === typeof Proxy) return !0;
                    try {
                        return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
                    } catch (e) {
                        return !1
                    }
                }();
                return function() {
                    var n, r = Oe(e);
                    if (t) {
                        var o = Oe(this).constructor;
                        n = Reflect.construct(r, arguments, o)
                    } else n = r.apply(this, arguments);
                    return we(this, n)
                }
            }

            function we(e, t) {
                if (t && ("object" === typeof t || "function" === typeof t)) return t;
                if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined");
                return function(e) {
                    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                    return e
                }(e)
            }

            function Oe(e) {
                return (Oe = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                    return e.__proto__ || Object.getPrototypeOf(e)
                })(e)
            }

            function Ee(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function je(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function Se(e, t, n) {
                return t && je(e.prototype, t), n && je(e, n), e
            }
            var xe = function(e, t) {
                    var n = e.graphStore,
                        r = e.GraphHistory,
                        o = function(e) {
                            return e && "url" === e.substring(0, 3) ? e : k()(e).lighten(15).toString()
                        },
                        a = function(e) {
                            return "".concat(e, "ff")
                        },
                        i = function(e) {
                            return "".concat(e, "bb")
                        },
                        s = t.map,
                        c = t.linkMaps,
                        l = function() {
                            function e(t) {
                                Ee(this, e), this.data = t, this.id = t.id, this.selectedEnd = 0
                            }
                            return Se(e, [{
                                key: "getEdgeData",
                                value: function() {
                                    return this.data
                                }
                            }, {
                                key: "updateWeight",
                                value: function(e) {
                                    this.weight = e
                                }
                            }, {
                                key: "getWeight",
                                value: function() {
                                    return this.weight
                                }
                            }, {
                                key: "uiInit",
                                value: function(e) {
                                    return this.vivaParent = e, c.addLink(this.vivaParent), this.data.color = this.edgeType.color, this.base_color = "0x".concat(o(this.data.color).substring(1)), this.ui = {
                                        color: a(this.base_color),
                                        index: 0,
                                        directed: this.edgeType.directed,
                                        from: s.getGraph().getNode(e.fromId).data.ui,
                                        to: s.getGraph().getNode(e.toId).data.ui,
                                        size: this.weight
                                    }, this.display_name = this.buildEdgeName(), this.uiActionInit(), this.ui
                                }
                            }, {
                                key: "buildEdgeName",
                                value: function() {
                                    return n.get("layout").show_edge_weights ? [this.edgeType.name, " (", parseFloat(this.data.weight.toFixed(2)), ")"].join("") : this.edgeType.name
                                }
                            }, {
                                key: "uiDOMInit",
                                value: function() {}
                            }, {
                                key: "uiActionInit",
                                value: function() {}
                            }, {
                                key: "onMouseOver",
                                value: function() {}
                            }, {
                                key: "onMouseOut",
                                value: function() {}
                            }, {
                                key: "onMouseDown",
                                value: function() {}
                            }, {
                                key: "select",
                                value: function() {}
                            }, {
                                key: "unselect",
                                value: function() {}
                            }, {
                                key: "reset",
                                value: function() {
                                    this.highlighted = !1, this.ui.color = a(this.base_color), this.ui.text_color = this.data.color, this.ui.size = this.weight, this.selectedEnd = 0, this.withText = !1
                                }
                            }, {
                                key: "mute",
                                value: function() {
                                    this.ui.color = i(this.base_color), this.ui.text_color = k()(this.data.color).setAlpha(.3).toRgbString(), this.ui.size = this.weight, this.withText = !1
                                }
                            }, {
                                key: "unmute",
                                value: function(e) {
                                    this.ui.color = a(this.base_color), this.ui.text_color = this.data.color, this.ui.size = this.weight + 1, this.withText = e
                                }
                            }, {
                                key: "highlight",
                                value: function() {
                                    this.highlighted = !0, this.ui.color = a(this.base_color), this.ui.text_color = this.data.color, this.ui.size = this.weight + 1, this.withText = !0
                                }
                            }, {
                                key: "dehighlight",
                                value: function() {
                                    this.highlighted = !1, this.ui.color = i(this.base_color), this.ui.text_color = k()(this.data.color).setAlpha(.3).toRgbString(), this.ui.size = this.weight, this.withText = !1
                                }
                            }, {
                                key: "uiUpdate",
                                value: function() {}
                            }, {
                                key: "uiUpdateText",
                                value: function() {}
                            }, {
                                key: "delete",
                                value: function(e, t) {
                                    var n = s.getGraph();
                                    c.removeLink(this.vivaParent), n.removeLink(this.vivaParent), t || (s.getWeightInterpolator().calculate(n, !0), s.getNodeSizeInterpolator().updateForMetrics(n, !0))
                                }
                            }]), e
                        }();
                    return {
                        BaseWebGLEdge: l,
                        DefaultWebGLEdge: function(e) {
                            ! function(e, t) {
                                if ("function" !== typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                                e.prototype = Object.create(t && t.prototype, {
                                    constructor: {
                                        value: e,
                                        writable: !0,
                                        configurable: !0
                                    }
                                }), t && ve(e, t)
                            }(n, e);
                            var t = _e(n);

                            function n(e) {
                                var o;
                                return Ee(this, n), (o = t.call(this, e)).edgeType = r.getEdgeTypeById(e.name_id), o
                            }
                            return Se(n, [{
                                key: "uiDOMInit",
                                value: function() {}
                            }, {
                                key: "uiDOMInitText",
                                value: function() {}
                            }, {
                                key: "uiUpdate",
                                value: function() {
                                    this.display_name = this.buildEdgeName(), this.base_color = "0x".concat(o(this.data.color).substring(1)), this.ui.color = a(this.base_color), this.ui.text_color = this.data.color, this.ui.size = this.weight
                                }
                            }, {
                                key: "uiUpdateText",
                                value: function() {}
                            }]), n
                        }(l)
                    }
                },
                ke = function(e, t, n, r) {
                    var o, a, i, s, c, l, p, f = t.uiStore,
                        h = t.graphStore,
                        g = t.dispatcher,
                        m = t.GraphHistory,
                        b = 380,
                        v = this,
                        _ = [],
                        w = [],
                        O = !1,
                        E = 1,
                        j = !h.get("layoutNodeFullname"),
                        S = !h.get("layout").hide_small_node_labels,
                        x = [],
                        k = function() {
                            var e = {},
                                t = function(t) {
                                    var n;
                                    return n = t.fromId < t.toId ? t.fromId + "-" + t.toId : t.toId + "-" + t.fromId, e[n]
                                };
                            return {
                                addLink: function(t) {
                                    var n;
                                    n = t.fromId < t.toId ? t.fromId + "-" + t.toId : t.toId + "-" + t.fromId, void 0 === e[n] && (e[n] = []), e[n].push(t.id)
                                },
                                getSiblings: t,
                                removeLink: function(t) {
                                    var n, r;
                                    if (n = t.fromId < t.toId ? t.fromId + "-" + t.toId : t.toId + "-" + t.fromId, e[n]) {
                                        for (r = 0; r < e[n].length; r += 1) e[n][r] === t.id && e[n].splice(r, 1);
                                        0 == e[n].length && (e[n] = void 0)
                                    }
                                },
                                removeIndex: function(t) {
                                    var n;
                                    n = t.fromId < t.toId ? t.fromId + "-" + t.toId : t.toId + "-" + t.fromId, e[n] = void 0
                                },
                                updateSiblingIndices: function(e) {
                                    e.forEachLink((function(e) {
                                        var n = t(e),
                                            r = Math.floor(n.length / 2),
                                            o = n.indexOf(e.id) - r;
                                        n.length % 2 === 0 && o >= 0 && (o += 1), e.data.ui.index = o
                                    }))
                                },
                                reset: function() {
                                    e = {}
                                }
                            }
                        }(),
                        N = function() {
                            l.getPaused() && (!se && te && m.getAnalysisManager().getClusters().forEach((function(e) {
                                var t = p.getNode(e.id);
                                if (t) {
                                    var n = t.data.pivotNode;
                                    if (n) {
                                        var r = R.getNodePosition(n.id);
                                        e.pos_x = Math.cos(e.angle) * e.dist + r.x, e.pos_y = Math.sin(e.angle) * e.dist + r.y, R.setNodePosition(e.id, e.pos_x, e.pos_y)
                                    }
                                }
                            })), i.setTransform(1, 0, 0, 1, 0, 0), i.clearRect(0, 0, a.width, a.height), i.textBaseline = "middle", i.textAlign = "start", i.letterSpacing = "-0.02em", p.forEachNode((function(e) {
                                e.data.drawLabel()
                            })))
                        };
                    this.getForcePaused = function() {
                            return O
                        }, this.getForceDisplaySmallNodeNames = function() {
                            return S
                        }, this.getRenderer = function() {
                            return l
                        }, this.getGraph = function() {
                            return p
                        }, this.getLayout = function() {
                            return R
                        }, this.getGraphics = function() {
                            return F
                        }, this.getNodeSizeInterpolator = function() {
                            return s
                        }, this.getWeightInterpolator = function() {
                            return c
                        }, this.getSelectedNodes = function() {
                            return x
                        }, this.getNodePosition = function(e) {
                            return R.getNodePosition(e)
                        }, this.isLocked = function(e) {
                            var t = p.getNode(e);
                            if (t) return t.data.is_locked;
                            console.log("isLocked: node ".concat(e, " not found"))
                        },
                        function(e) {
                            var t = e.getBoundingClientRect();
                            (a = document.createElement("canvas")).className = "webgl-label-canvas", a.setAttribute("width", t.width), a.setAttribute("height", t.height), e.appendChild(a), i = a.getContext("2d")
                        }(o = "string" == typeof e ? document.querySelector(e) : e);
                    var D = be(t, {
                            map: v,
                            container: o,
                            labelContext: i
                        }),
                        M = D.WebGLClusterLabelNode,
                        q = D.WebGLDefaultNode,
                        I = xe(t, {
                            map: v,
                            linkMaps: k
                        }).DefaultWebGLEdge;
                    p = T.a.Graph.graph(), s = P(t, {
                        graph: p
                    }), c = A({
                        graph: p
                    });
                    var R, B = h.get("layout");
                    R = "force_directed" === B.algorithm ? T.a.Graph.Layout.forceDirected(p, B) : L(p, B);
                    var F = T.a.Graph.View.webglGraphics({
                        clearColor: !0,
                        preserveDrawingBuffer: !1,
                        clearColorValue: {
                            r: 1,
                            g: 1,
                            b: 1,
                            a: 1
                        }
                    });
                    F.setNodeProgram(fe()), !f.get("readOnly") || h.get("layout").use_curved_edges || m.hasMultiEdges() ? F.setLinkProgram(ge({
                        useCurvedEdges: h.get("layout").use_curved_edges
                    })) : F.setLinkProgram(ye()), F.node((function(e) {
                        return e.data.uiInit(e)
                    })).link((function(e) {
                        return e.data.uiInit(e)
                    })).placeLink((function(e, t, n) {
                        var r = n.x - t.x,
                            o = n.y - t.y,
                            a = Math.sqrt(Math.pow(r, 2) + Math.pow(o, 2)),
                            i = r / a,
                            s = o / a,
                            c = .5 * e.from.size,
                            l = .5 * e.to.size,
                            d = t.x + i * c,
                            u = t.y + s * c,
                            p = n.x - i * l,
                            f = n.y - s * l;
                        e.adj = {
                            from: {
                                x: d,
                                y: u
                            },
                            to: {
                                x: p,
                                y: f
                            },
                            distRatio: o / r,
                            xDist: p - d,
                            yDist: f - u,
                            dist: Math.sqrt(Math.pow(p - d, 2) + Math.pow(f - u, 2)),
                            unitX: i,
                            unitY: s
                        }
                    })), (l = T.a.Graph.View.renderer(p, {
                        container: o,
                        layout: R,
                        graphics: F,
                        prerender: r ? 0 : "force_directed" === B.algorithm ? 800 : 10
                    })).on("container-drag", (function(e) {
                        e ? y.d.isActive() || Object(y.rb)("move") : f.get("editMode") != u.a.VIEW ? Object(y.rb)("crosshair") : Object(y.rb)("default"), O && m.triggerSnapshot(!0, v)
                    })), l.on("scale", (function(e) {
                        O && m.triggerSnapshot(!0, v), E = e
                    })), l.on("drag", (function(e, t) {
                        var n, r, o = p.getNode(e).data;
                        if ("function" == typeof o.clearHoverCard && o.clearHoverCard(), O)
                            for (m.triggerSnapshot(!0, v), n = 0; n < x.length; n += 1) e !== x[n] && (r = R.getNodePosition(x[n]), R.setNodePosition(x[n], r.x + t.x, r.y + t.y))
                    })), l.on("render", (function() {
                        N(),
                            function() {
                                if (l.getPaused()) {
                                    i.textAlign = "center", i.textBaseline = "middle";
                                    var e = 12 * l.getZoom();
                                    i.font = e + "px Apercu Regular Pro", p.forEachLink((function(t) {
                                        var n = t.data;
                                        if (h.get("layout").always_show_edge_names || n.withText) {
                                            var r = n.ui.adj.from,
                                                o = n.ui.adj.to,
                                                a = n.ui.adj.dist * l.getZoom(),
                                                s = Math.atan(-n.ui.adj.distRatio);
                                            if (!h.get("layout").use_curved_edges && 0 === n.ui.index) {
                                                var c = {
                                                    x: .5 * (r.x + o.x),
                                                    y: -.5 * (r.y + o.y)
                                                };
                                                F.transformGraphToClientCoordinates(c), i.save(), i.fillStyle = n.ui.text_color, i.setTransform(1, 0, 0, 1, c.x, c.y), i.rotate(s), i.measureText(n.display_name).width > a ? i.fillText(n.display_name[0], 0, -.5 * e) : i.fillText(n.display_name, 0, -.5 * e), i.restore()
                                            }
                                        }
                                    }))
                                }
                            }()
                    }));
                    var G, H, U, z, W = function(e) {
                        var t, n = {
                            x: 0,
                            y: 0
                        };
                        return {
                            down: function(e) {
                                t && clearTimeout(t), n.x = e.clientX, n.y = e.clientY, t = setTimeout((function() {
                                    t = null
                                }), 400)
                            },
                            up: function(r) {
                                t && n.x === r.clientX && n.y === r.clientY && e.onClick()
                            }
                        }
                    }({
                        onClick: function() {
                            m.clearSelectedNodes()
                        }
                    });
                    T.a.Graph.webglInputEvents(F, p).mouseEnter((function(e, t) {
                        e.data.onMouseOver(t)
                    })).mouseLeave((function(e, t) {
                        e.data.onMouseOut(t)
                    })).click((function(e, t) {
                        t.stopPropagation(), e.data.onNodeClicked(t)
                    })).canvasMouseDown((function(e) {
                        y.d.isActive() || (e.shiftKey ? (l.pinGraph(!0), m.clearSelectedNodes(), y.d.create(null, (function(e) {
                            l.pinGraph(!1);
                            var t = F.transformClientToGraphCoordinates({
                                    x: Number(e.left),
                                    y: Number(e.top)
                                }),
                                n = F.transformClientToGraphCoordinates({
                                    x: Number(e.left) + Number(e.width),
                                    y: Number(e.top) + Number(e.height)
                                }),
                                r = [];
                            return p.forEachNode((function(e) {
                                (function(e, t, n) {
                                    var r = e.data.ui.position;
                                    return t.x < r.x && r.x < n.x && t.y < r.y && r.y < n.y
                                })(e, t, n) && r.push(e.id)
                            })), void m.selectNode(r)
                        }))) : W.down(e))
                    })).canvasMouseUp((function(e) {
                        W.up(e)
                    })).mouseDown((function(e, t) {
                        t.stopPropagation(), e.data.onMouseDown(t)
                    })), G = m.getNodeTypes(), H = m.getEdgeTypes(), U = m.getNodes(), z = m.getLinks(), G && function(e) {
                        for (var t = 0; t < e.length; t += 1) _[e[t].id] = {
                            color: e[t].color,
                            id: e[t].id,
                            name: e[t].name,
                            image_as_icon: e[t].image_as_icon,
                            size: e[t].size,
                            size_limit: e[t].size_limit,
                            hide_name: e[t].hide_name
                        }
                    }(G), H && function(e) {
                        for (var t = 0; t < e.length; t += 1) w[e[t].id] = {
                            color: e[t].color,
                            weighted: e[t].weighted,
                            directed: e[t].directed,
                            id: e[t].id,
                            name: e[t].name
                        }
                    }(H), U && function(e) {
                        for (var t = 0; t < e.length; t += 1) {
                            var n = e[t],
                                r = {
                                    id: n.id,
                                    type: n.type,
                                    name: n.name,
                                    type_id: n.type_id,
                                    size: n.size,
                                    image: n.image,
                                    reference: n.reference,
                                    pos_x: n.pos_x,
                                    pos_y: n.pos_y,
                                    is_locked: n.is_locked,
                                    properties: {},
                                    color: _[n.type_id].color
                                },
                                o = void 0,
                                a = m.getNodeTypeById(n.type_id).properties;
                            if (a && n.properties)
                                for (o = 0; o < a.length; o += 1) Object.prototype.hasOwnProperty.call(n.properties, a[o].name) && (r.properties[a[o].name] = n.properties[a[o].name]);
                            p.addNode(n.id, new q(r))
                        }
                    }(U), z && (function(e) {
                        for (var t = 0; t < e.length; t += 1) {
                            var n = e[t];
                            p.addLink(n.from, n.to, new I({
                                name: n.name,
                                name_id: n.name_id,
                                weight: n.weight || 1,
                                id: n.id,
                                from: n.from,
                                to: n.to,
                                color: w[n.name_id].color,
                                properties: n.properties ? Object(y.p)(n.properties) : null
                            }))
                        }
                    }(z), c.calculate(p), p.forEachLink((function(e) {
                        e.data.updateWeight(c.getValueFor(e.data))
                    }))), l.run(), s.calculate(p, _, !0), k.updateSiblingIndices(p), this.onScaleChanged = function() {}, this.getContainer = function() {
                        return o
                    };
                    this.lockNodes = function(e) {
                        p.forEachNode((function(e) {
                            e.data.lockNode(!1)
                        })), e.forEach((function(e) {
                            p.getNode(e).data.lockNode(!0)
                        }))
                    }, this.updateSnapshot = function(e, t) {
                        var n = t;
                        l.zoomTo(n), p.forEachNode((function(t) {
                            var n = e[t.id];
                            if (n) {
                                var r = {
                                    x: n.pos_x,
                                    y: n.pos_y
                                };
                                F.transformClientToGraphCoordinates(r), R.setNodePosition(t.id, r.x, r.y)
                            }
                        })), l.rerender()
                    }, this.showSnapshot = function(e, t) {
                        l.pause(), !e && h.get("layout").old_snapshot ? function() {
                            p.forEachNode((function(e) {
                                e && void 0 !== e.data.data.pos_x && void 0 !== e.data.data.pos_y && R.setNodePosition(e.id, e.data.data.pos_x, e.data.data.pos_y)
                            }));
                            var e = h.get("layout").layoutTransform.split(",").map((function(e) {
                                return parseFloat(e)
                            }));
                            F.setTransform(e), E = parseFloat(e[0])
                        }() : function(e, t) {
                            var n = t || h.get("layout").zoom;
                            l.zoomTo(n), e ? p.forEachNode((function(t) {
                                var n = e[t.id],
                                    r = {
                                        x: n.pos_x,
                                        y: n.pos_y
                                    };
                                F.transformClientToGraphCoordinates(r), R.setNodePosition(t.id, r.x, r.y)
                            })) : p.forEachNode((function(e) {
                                if (e && void 0 !== e.data.data.pos_x && void 0 !== e.data.data.pos_y) {
                                    var t = {
                                        x: e.data.data.pos_x,
                                        y: e.data.data.pos_y
                                    };
                                    F.transformClientToGraphCoordinates(t), R.setNodePosition(e.id, t.x, t.y)
                                }
                            }))
                        }(e, t), O = !0, g.emit("updateEditMode", u.a.VIEW), m.triggerSnapshot(!1, v), te && (he(), pe()), l.rerender()
                    };
                    var Y = function() {
                            l.pause(), l.rerender()
                        },
                        V = function() {
                            i.clearRect(0, 0, a.width, a.height), l.resume()
                        };
                    this.setRendererState = function(e) {
                        e ? (V(), O = !1) : (Y(), O = !0)
                    };
                    var X = function(e) {
                        var t = null !== Q ? b : 0,
                            n = p.getNode(e).data.getUIBounds(!O),
                            r = o.getBoundingClientRect(),
                            a = r.width,
                            i = r.height;
                        if (n.top < 0 || n.left < 0 || n.right > a - t || n.bottom > i) {
                            var s = {
                                x: .5 * (n.left + n.right + t),
                                y: .5 * (n.top + n.bottom)
                            };
                            F.transformClientToGraphCoordinates(s), l.moveTo(s.x, s.y)
                        }
                    };
                    this.takeSnapshot = function() {
                        var e, t = {};
                        return p.forEachNode((function(n) {
                            if (n) {
                                var r = {
                                    x: (e = R.getNodePosition(n.data.id)).x,
                                    y: e.y
                                };
                                F.transformGraphToClientCoordinates(r), t[n.data.id] = {
                                    pos_x: r.x,
                                    pos_y: r.y
                                }, n.data.data.pos_x = r.x, n.data.data.pos_y = r.y
                            }
                        })), t
                    };
                    var K, $ = function() {
                        var e = F.getTransform();
                        F.resetScale(), F.setTransform(e), l.rerender()
                    };
                    this.resize = function() {
                        var e = o.getBoundingClientRect();
                        a.setAttribute("width", e.width), a.setAttribute("height", e.height), $()
                    }, this.resetZoom = function() {}, this.getTransform = function() {
                        return "[" + F.getTransform().join(",") + "]"
                    }, this.fixNodeOverlaps = function() {
                        var e = !S;
                        e && v.hideSmallText(!1);
                        var t = new Array(p.getNodesCount()),
                            n = 0;
                        p.forEachNode((function(e) {
                            var r = e.data.getUIBounds(),
                                o = .05 * (r.bottom - r.top),
                                a = r.left,
                                i = r.right,
                                s = r.top - o,
                                c = r.bottom + o;
                            t[n] = new C.Rectangle(a, i, s, c), n += 1
                        })), C.removeOverlaps(t), n = 0, p.forEachNode((function(e) {
                            var r = t[n];
                            F.transformClientToGraphCoordinates(r), R.setNodePosition(e.id, r.x, r.y), n += 1
                        })), l.rerender(), e && v.hideSmallText(!0)
                    }, this.zoomIn = function() {
                        l.zoomIn()
                    }, this.zoomOut = function() {
                        l.zoomOut()
                    }, this.scaleToShowEntireGraph = function() {
                        var e = o.getBoundingClientRect(),
                            t = e.width,
                            n = e.height,
                            r = null !== Q ? b : 0,
                            a = ee ? .5 * t : 0,
                            i = 1 / 0,
                            s = -1 / 0,
                            c = 1 / 0,
                            d = -1 / 0;
                        p.forEachNode((function(e) {
                            var t = e.data.getUIBounds(!O);
                            i > t.left && (i = t.left), s < t.right && (s = t.right), c > t.top && (c = t.top), d < t.bottom && (d = t.bottom)
                        }));
                        var u = {
                            x: .5 * (i + s + r) + a,
                            y: .5 * (c + d - 30)
                        };
                        F.transformClientToGraphCoordinates(u), l.moveTo(u.x, u.y);
                        var f = (t - 120 - r) / (s - i),
                            h = (n - 120) / (d - c),
                            g = Math.min(f, h);
                        void 0 !== g && l.zoomTo(E * g)
                    }, this.getGraphEngine = function() {
                        return {
                            graph: p,
                            renderer: l,
                            graphics: F,
                            layout: R
                        }
                    }, this.hideSmallText = function(e) {
                        S = !e, N()
                    }, this.resumeFor = function(e) {
                        V(), setTimeout((function() {
                            Y()
                        }), e)
                    }, this.calculateCentralitiesForFilter = function() {
                        var e = {},
                            t = T.a.Graph.centrality(),
                            n = t.betweennessCentrality(p),
                            r = t.degreeCentrality(p);
                        return m.getNodeTypes().forEach((function(t) {
                            e[t.id] = {}
                        })), n.forEach((function(t) {
                            var n = t.key,
                                r = p.getNode(n).data.getNodeData().type_id;
                            Object.prototype.hasOwnProperty.call(e[r], n) || (e[r][n] = {}), e[r][n].betweenness = parseFloat(t.value)
                        })), r.forEach((function(t) {
                            var n = t.key,
                                r = p.getNode(n).data.getNodeData().type_id;
                            Object.prototype.hasOwnProperty.call(e[r], n) || (e[r][n] = {}), e[r][n].degree = parseFloat(t.value)
                        })), p.forEachNode((function(t) {
                            var n = t.id,
                                r = t.data.getNodeData().type_id,
                                o = R.getNodePosition(n);
                            Object.prototype.hasOwnProperty.call(e[r], n) || (e[r][n] = {}), e[r][n].x = o.x, e[r][n].y = o.y
                        })), e
                    }, this.addNode = function(e, t) {
                        var n = m.getNodeById(e);
                        n.color = m.getNodeTypeById(n.type_id).color, p.addNode(n.id, new q(n)), t && R.setNodePosition(e, t.x, t.y)
                    }, this.addLink = function(e) {
                        var t;
                        (t = "string" === typeof e ? m.getEdgeById(e) : e).color = m.getEdgeTypeById(t.name_id).color;
                        var n = new I(t);
                        n.updateWeight(c.getValueFor(n)), p.addLink(t.from, t.to, n)
                    }, this.removeNode = function(e) {
                        (Array.isArray(e) ? e : [e]).forEach((function(e) {
                            p.removeNode(e)
                        }))
                    }, this.removeLink = function(e) {
                        (Array.isArray(e) ? e : [e]).forEach((function(e) {
                            var t, n, r, o = p.getLinks(e.from);
                            if (o)
                                for (n = o.length - 1; n >= 0; n -= 1)
                                    if ((r = o[n]).data.id === e.id) {
                                        t = r.data;
                                        break
                                    }
                            if (t) {
                                var a = t.vivaParent;
                                p.removeLink(a), k.removeLink(a)
                            }
                        }))
                    };
                    var Z, J = 0,
                        Q = null,
                        ee = !1;
                    this.placeFixedGeoPositions = function() {
                        var e = -1 / 0,
                            t = 1 / 0,
                            n = -1 / 0,
                            r = 1 / 0;
                        p.forEachNode((function(o) {
                            if (Object.prototype.hasOwnProperty.call(o.data.data.properties, "LatLng")) {
                                var a = o.data.data.properties.LatLng.split(" "),
                                    i = {
                                        x: parseFloat(a[1]),
                                        y: parseFloat(a[0])
                                    };
                                i.x > e && (e = i.x), i.x < t && (t = i.x), i.y > n && (n = i.y), i.y < r && (r = i.y)
                            }
                        }));
                        var a = e - t,
                            i = n - r,
                            s = 120,
                            c = null !== Q ? b : 0,
                            d = o.getBoundingClientRect(),
                            u = d.width - s - c,
                            f = d.height - s,
                            h = Math.min(f / i, u / a);
                        p.forEachNode((function(e) {
                            if (e) {
                                if (!Object.prototype.hasOwnProperty.call(e.data.data.properties, "LatLng")) return;
                                var n = e.data.data.properties.LatLng.split(" "),
                                    o = {
                                        x: parseFloat(n[1]),
                                        y: parseFloat(n[0])
                                    };
                                o.x = (o.x - t) * h + 60, o.y = (i - o.y + r) * h + .25 * f + 60, F.transformClientToGraphCoordinates(o), R.setNodePosition(e.id, o.x, o.y), R.pinNode(e, !0)
                            }
                        })), l.moveTo(0, 0)
                    }, this.zoomOutFixedNodes = function() {
                        var e = v.takeSnapshot();
                        v.zoomOut(), v.updateSnapshot(e, E), m.triggerSnapshot(!0, v)
                    }, this.zoomInFixedNodes = function() {
                        var e = v.takeSnapshot();
                        v.zoomIn(), v.updateSnapshot(e, E), m.triggerSnapshot(!0, v)
                    };
                    this.getCurrentZoom = function() {
                        return E
                    };
                    var te = !1;
                    this.revertToNodeTypeColors = function(e) {
                        Object.keys(oe).forEach((function(e) {
                            clearTimeout(oe[e])
                        })), Object.keys(ae).forEach((function(e) {
                            "function" === typeof ae[e] && ae[e].call()
                        })), he(), p.forEachNode((function(e) {
                            e.data.getNodeData().color = e.data.nodeType.color, e.data.uiUpdate()
                        })), p.forEachLink((function(e) {
                            e.data.getEdgeData().color = e.data.edgeType.color, e.data.uiUpdate()
                        })), te = !1, e || l.rerender()
                    };
                    var ne, re, oe = {},
                        ae = {},
                        ie = function(e) {
                            oe[e] && (clearTimeout(oe[e]), oe[e] = null), ae[e] || (ae[e] = function(e) {
                                return function() {
                                    var t = m.getAnalysisManager().getClusters().find((function(t) {
                                        return t.id === e
                                    }));
                                    Object(d.updateCluster)(h.get("id"), t.id, {
                                        angle: t.angle,
                                        dist: t.dist
                                    }), oe[e] = null, ae[e] = null
                                }
                            }(e)), oe[e] = setTimeout(ae[e], 2e3)
                        },
                        se = !1,
                        ce = !1,
                        le = function(e) {
                            var t = m.getAnalysisManager().getClusters().find((function(t) {
                                var n = p.getNode(t.id);
                                if (n) {
                                    var r = n.data.getUIBounds();
                                    return e.x >= r.left && e.x <= r.right && e.y >= r.top && e.y <= r.bottom
                                }
                            }));
                            t ? ne && ne.id === t.id || (p.getNode(t.id).data.onMouseOver(), ne = t) : ne && (p.getNode(ne.id).data.onMouseOut(), ne = null);
                            if (ce && re) {
                                var n = R.getNodePosition(re.id);
                                R.setNodePosition(re.id, n.x + e.movementX / l.getZoom(), n.y + e.movementY / l.getZoom()), f.get("readOnly") || ie(re.id)
                            }
                        },
                        de = function(e) {
                            var t = m.getAnalysisManager().getClusters().find((function(t) {
                                var n = p.getNode(t.id);
                                if (n) {
                                    var r = n.data.getUIBounds();
                                    return e.x >= r.left && e.x <= r.right && e.y >= r.top && e.y <= r.bottom
                                }
                            }));
                            se = !0, (ce = !!t) ? (re = t, l.pinGraph(!0)) : l.pinGraph(!1)
                        },
                        ue = function() {
                            ! function(e) {
                                if (e) {
                                    var t = p.getNode(e.id).data.pivotNode;
                                    if (t) {
                                        var n = R.getNodePosition(t.id),
                                            r = R.getNodePosition(e.id);
                                        e.dist = Math.sqrt(Math.pow(r.x - n.x, 2) + Math.pow(r.y - n.y, 2)), e.angle = Math.PI + Math.atan2(n.y - r.y, n.x - r.x)
                                    }
                                }
                            }(re), ce = !1, se = !1, re = null, l.pinGraph(!1), N()
                        };

                    function pe() {
                        var e = m.getAnalysisManager().getClusters();
                        (e = e.filter((function(e) {
                            return 100 * e.nodes.length / m.getNodes().length > 1
                        }))).forEach((function(e) {
                            var t = Object(y.p)(e);
                            t.is_locked = !0;
                            var n = new M(t);
                            p.addNode(e.id, n);
                            var r = e.nodes.map((function(e) {
                                return m.getNodeById(e)
                            })).filter((function(e) {
                                return e
                            })).sort((function(e, t) {
                                return e.edges.length < t.edges.length ? 1 : e.edges.length > t.edges.length ? -1 : 0
                            }))[0];
                            if (r) {
                                n.pivotNode = r;
                                var o = R.getNodePosition(r.id);
                                if (null === e.angle || null === e.dist)
                                    if (null !== e.pos_x && null !== e.pos_y) e.dist = Math.sqrt(Math.pow(e.pos_x - o.x, 2) + Math.pow(e.pos_y - o.y, 2)), e.angle = Math.PI + Math.atan2(o.y - e.pos_y, o.x - e.pos_x);
                                    else {
                                        var a = p.getNode(r.id).data.getUIBounds(!0),
                                            i = a.bottom - a.top;
                                        e.dist = 2 * i, e.angle = Math.PI / 2
                                    }
                                e.pos_x = Math.cos(e.angle) * e.dist + o.x, e.pos_y = Math.sin(e.angle) * e.dist + o.y, R.setNodePosition(e.id, e.pos_x, e.pos_y)
                            }
                        })), o.addEventListener("mousedown", de), o.addEventListener("mouseup", ue), o.addEventListener("mousemove", le)
                    }

                    function he() {
                        p.forEachNode((function(e) {
                            e.data instanceof M && p.removeNode(e.id)
                        })), o.removeEventListener("mousedown", de), o.removeEventListener("mouseup", ue), o.removeEventListener("mousemove", le), ne = null, re = null
                    }
                    this.applyClusterColors = function() {
                        te && v.revertToNodeTypeColors(!0), m.getAnalysisManager().getClusters().forEach((function(e) {
                            e.nodes.forEach((function(t) {
                                var n = p.getNode(t);
                                n && (n.data.getNodeData().color = e.color, n.data.uiUpdate())
                            }))
                        })), p.forEachLink((function(e) {
                            var t = e.data.getEdgeData(),
                                n = p.getNode(e.fromId).data.getNodeData().color;
                            t.color = n, e.data.uiUpdate()
                        })), te = !0, pe(), l.rerender()
                    }, this.getName = function() {
                        return "webgl-canvas"
                    }, document.addEventListener("keydown", (function(e) {
                        16 === e.which && Object(y.rb)("crosshair")
                    })), document.addEventListener("keyup", (function(e) {
                        16 === e.which && Object(y.rb)("default")
                    })), g.bind("onNodeFocused", (function(e) {
                        var t, n;
                        t = !0, x = [], p.forEachNode((function(e) {
                            e.data.reset()
                        })), p.forEachLink((function(e) {
                            e.data.reset()
                        })), t || l.rerender(), n = Array.isArray(e) ? e : [e], x = n, n.forEach((function(e) {
                            var t = p.getNode(e);
                            t && t.data.selectNode(!0)
                        })), x.length > 1 && (p.forEachNode((function(e) {
                            !e.data.selected && e.data.neighborSelected < 1 && e.data.mute()
                        })), p.forEachLink((function(e) {
                            e.data.selectedEnd < 1 && e.data.mute()
                        }))), l.rerender()
                    }), this), g.bind("onClusterSelected", (function(e, t) {
                        if (x = [], p.forEachNode((function(e) {
                                e.data.reset(), e.data.mute()
                            })), p.forEachLink((function(e) {
                                e.data.reset(), e.data.mute()
                            })), te) {
                            var n = p.getNode(e);
                            n && n.data.unmute()
                        }
                        var r = t;
                        r.forEach((function(e) {
                            var t = p.getNode(e);
                            t.data.unmute(), t.links.forEach((function(t) {
                                var n = e !== t.fromId ? t.fromId : t.toId;
                                p.getNode(n).data.muted || t.data.unmute()
                            }))
                        })), X(r[0]), l.rerender()
                    }), this), g.bind("onClustersUpdated", (function() {
                        te && (he(), pe(), l.rerender())
                    }), this), g.bind("onNodeSelected", (function(e) {
                        var t, n = x.length;
                        t = Array.isArray(e) ? e : [e], x = x.concat(t), t.forEach((function(e) {
                            var t = p.getNode(e);
                            t && t.data.selectNode(!0)
                        })), 0 === n && x.length > 1 && (p.forEachNode((function(e) {
                            !e.data.selected && e.data.neighborSelected < 1 && e.data.mute()
                        })), p.forEachLink((function(e) {
                            e.data.selectedEnd < 1 && !e.data.highlighted && e.data.mute()
                        }))), X(t[0]), l.rerender()
                    }), this), g.bind("onNodeFocused", (function(e) {
                        var t;
                        p.forEachNode((function(e) {
                            e.data.reset()
                        })), p.forEachLink((function(e) {
                            e.data.reset()
                        })), t = Array.isArray(e) ? e : [e], x = t, t.forEach((function(e) {
                            p.getNode(e).data.selectNode(!0)
                        })), p.forEachNode((function(e) {
                            !e.data.selected && e.data.neighborSelected < 1 && e.data.mute()
                        })), p.forEachLink((function(e) {
                            e.data.selectedEnd < 1 && !e.data.highlighted && e.data.mute()
                        })), X(t[0]), l.rerender()
                    }), this), g.bind("onNodesReleased", (function() {
                        x = [], p.forEachNode((function(e) {
                            e.data.reset()
                        })), p.forEachLink((function(e) {
                            e.data.reset()
                        })), l.rerender()
                    }), this), g.bind("onEdgeFocused", (function(e) {
                        x = [], p.forEachNode((function(e) {
                                e.data.reset()
                            })), p.forEachLink((function(e) {
                                e.data.reset()
                            })), e.forEach((function(e) {
                                var t, n, r = p.getNode(e.from),
                                    o = p.getNode(e.to);
                                for (r.data.highlightNode(!0), o.data.highlightNode(!0), x.push(e.from), x.push(e.to), t = r.links.length - 1; t >= 0; t -= 1)
                                    if ((n = r.links[t]).data.id === e.id) {
                                        n.data.highlight();
                                        break
                                    }
                            })), p.forEachNode((function(e) {
                                !e.data.selected && e.data.neighborSelected < 1 && e.data.mute()
                            })), p.forEachLink((function(e) {
                                e.data.selectedEnd < 1 && !e.data.highlighted && e.data.mute()
                            })),
                            function(e, t) {
                                var n = null !== Q ? b : 0,
                                    r = p.getNode(e).data.getUIBounds(!0),
                                    a = p.getNode(t).data.getUIBounds(!0),
                                    i = o.getBoundingClientRect(),
                                    s = i.width,
                                    c = i.height,
                                    d = r.top < 0 || r.left < 0 || r.right > s - n || r.bottom > c,
                                    u = a.top < 0 || a.left < 0 || a.right > s - n || a.bottom > c;
                                if (d || u) {
                                    var f = {
                                        x: .25 * (r.left + r.right + a.left + a.right) + .5 * n,
                                        y: .25 * (r.top + r.bottom + a.top + a.bottom)
                                    };
                                    F.transformClientToGraphCoordinates(f), l.moveTo(f.x, f.y)
                                }
                            }(e[0].from, e[0].to), l.rerender()
                    }), this), g.bind("graphStore.layoutNodeFullname.updated", (function(e) {
                        j != !e && (j = !e, p.forEachNode((function(e) {
                            e.data.uiUseShortText(j)
                        })), N())
                    }), this), g.bind("onBeforeFilterApplied", (function() {
                        K = F.getTransform()
                    }), this), g.bind("onFilterApplied", (function() {
                        p.forEachNode((function(e) {
                            e.data.uiUpdate()
                        })), K && F.setTransform(K), l.rerender()
                    }), this), g.bind("onBarOpened", (function(e) {
                        Q = e, 1 === (J += 1) && (Z = O, O = !0, Y())
                    }), this), g.bind("onBarClosed", (function() {
                        Q = null, 0 === (J -= 1) && ((O = Z) ? Y() : V())
                    }), this), g.bind("onDatatableOpened", (function() {
                        J += 1, ee = !0, $(), 1 === J && (Z = O, O = !0, Y())
                    }), this), g.bind("onDatatableClosed", (function() {
                        ee = !1, $(), f.get("freezeMode") || 0 === (J -= 1) && ((O = Z) ? Y() : V())
                    }), this), g.bind("trigger", (function(e) {
                        switch (e.action) {
                            case "nodetype_create":
                                ! function(e) {
                                    s.introduceNewType(e.id)
                                }(e);
                                break;
                            case "nodetype_update":
                                ! function(e) {
                                    var t = m.getNodeTypeById(e.id);
                                    t ? (e.color && (t.color = e.color), e.size && (t.size = e.size), e.properties && e.properties.length !== e.prev.properties.length ? console.log("signal.properties and signal.properties_prev should be the same length") : (p.forEachNode((function(t) {
                                        t.data.updateNodeType(e) && t.data.uiUpdate()
                                    })), l.rerender())) : console.log("could not find nodetype for the id: " + e.id)
                                }(e);
                                break;
                            case "nodetype_delete":
                                ! function(e) {
                                    var t, n = !1;
                                    for (t in e)
                                        if (Object.prototype.hasOwnProperty.call(e, t)) {
                                            if ("id" === t || "action" === t) continue;
                                            n = !0
                                        }
                                    if (!n) {
                                        var r;
                                        for (t in _) Object.prototype.hasOwnProperty.call(_, t) && _[t].id === e.id && (r = t, delete _[t]);
                                        r && p.forEachNode((function(e) {
                                            var t = e.data.getNodeData();
                                            t.type === r && p.removeNode(t.id)
                                        }))
                                    }
                                }(e);
                                break;
                            case "edgetype_create":
                                break;
                            case "edgetype_update":
                                ! function(e) {
                                    var t = !1;
                                    m.getEdgeTypeById(e.id) ? (e.color && (w[e.id].color = e.color, t = !0), e.name && (t = !0, p.forEachLink((function(t) {
                                        t && t.data && (t.data.edgeType.id, e.id)
                                    }))), t && p.forEachLink((function(t) {
                                        t.data.getEdgeData().name_id === e.id && t.data.uiUpdate()
                                    }))) : console.log("could not find Vector Order for the id: " + e.id)
                                }(e);
                                break;
                            case "edgetype_delete":
                                ! function(e) {
                                    var t, n = !1;
                                    for (t in e)
                                        if (Object.prototype.hasOwnProperty.call(e, t)) {
                                            if ("id" === t || "action" === t) continue;
                                            n = !0
                                        }
                                    n || p.forEachLink((function(t) {
                                        t.data.getEdgeData().name_id === e.id && p.removeLink(t)
                                    }))
                                }(e);
                                break;
                            case "node_create":
                                ! function(e) {
                                    var t;
                                    if (Object.prototype.hasOwnProperty.call(e, "type_id")) t = m.getNodeTypeById(e.type_id);
                                    else {
                                        var n, r = m.getNodeTypes();
                                        for (n = 0; n < r.length; n += 1)
                                            if (r[n].name === e.type) {
                                                t = r[n];
                                                break
                                            }
                                    }
                                    if (t) {
                                        var o, a = {
                                                id: e.id,
                                                name: e.name,
                                                type: t.name,
                                                type_id: t.id,
                                                size: e.size,
                                                image: e.image,
                                                reference: e.reference,
                                                pos_x: e.pos_x,
                                                pos_y: e.pos_y,
                                                properties: {},
                                                color: t.color
                                            },
                                            i = t.properties;
                                        if (i && e.properties)
                                            for (o = 0; o < i.length; o += 1) Object.prototype.hasOwnProperty.call(e.properties, i[o].name) && (a.properties[i[o].name] = e.properties[i[o].name]);
                                        var c = p.addNode(e.id, new q(a));
                                        e.pos && R.setNodePosition(c.id, e.pos.x, e.pos.y), s.addNewValue(p.getNode(e.id), p), l.rerender()
                                    } else console.log("nodetype is not defined")
                                }(e);
                                break;
                            case "node_update":
                                ! function(e) {
                                    var t = p.getNode(e.id);
                                    if (t) {
                                        var n, r, o, a = t.data.getNodeData(),
                                            i = !1;
                                        if (Object.prototype.hasOwnProperty.call(e, "type") || Object.prototype.hasOwnProperty.call(e, "type_id"))
                                            if (i = !0, Object.prototype.hasOwnProperty.call(e, "type")) {
                                                if (!(o = m.getNodeTypeByName(e.type))) return void console.log("node_update: type value does not have a corresponding node type");
                                                e.type_id = o.id, t.data.nodeType = o
                                            } else {
                                                if (!(o = m.getNodeTypeById(e.type_id))) return void console.log("node_update: type_id value does not have a corresponding node type");
                                                e.type = o.name, t.data.nodeType = o
                                            }
                                        else o = t.data.nodeType;
                                        for (n in i && (a.properties = {}, a.color = o.color), e)
                                            if (Object.prototype.hasOwnProperty.call(e, n)) {
                                                if ("id" === n || "action" === n || "prev" === n) continue;
                                                if ("properties" === n)
                                                    for (r in e.properties) Object.prototype.hasOwnProperty.call(e.properties, r) && (a.properties[r] = e.properties[r]);
                                                else a[n] = e[n]
                                            }(Object.prototype.hasOwnProperty.call(e, o.size) || Object.prototype.hasOwnProperty.call(e, "properties") && Object.prototype.hasOwnProperty.call(e.properties, o.size)) && s.calculateForType(p, o.id), Object.prototype.hasOwnProperty.call(e, "type_id") && s.calculate(p, m.getNodeTypes(), !0), Object.prototype.hasOwnProperty.call(e, "properties") && Object.prototype.hasOwnProperty.call(e.properties, "LatLng") && R.pinNode(t, !0), t.data.uiUpdate(), l.rerender()
                                    } else console.log("node does not exist")
                                }(e);
                                break;
                            case "node_delete":
                                ! function(e) {
                                    var t;
                                    "string" === typeof e ? t = p.getNode(e) : "object" === typeof e && (t = p.getNode(e.id)), t.data.delete(), l.rerender()
                                }(e);
                                break;
                            case "edge_create":
                                ! function(e) {
                                    var t;
                                    if (t = Object.prototype.hasOwnProperty.call(e, "name_id") ? m.getEdgeTypeById(e.name_id) : m.getEdgeTypeById(e.name)) {
                                        e.name_id = t.id;
                                        var n = p.addLink(e.from, e.to, new I({
                                            name: e.name,
                                            name_id: t.id,
                                            weight: e.weight || 1,
                                            id: e.id,
                                            from: e.from,
                                            to: e.to,
                                            color: t.color,
                                            properties: e.properties ? Object(y.p)(e.properties) : null
                                        }));
                                        c.addNewValue(n.data, p), s.updateForMetrics(p, !0), O && v.resumeFor(100)
                                    } else console.log(e.type + " is not defined")
                                }(e);
                                break;
                            case "edge_update":
                                ! function(e) {
                                    var t, n, r, o, a, i;
                                    if (e.prev) {
                                        if (Object.prototype.hasOwnProperty.call(e.prev, "from") || Object.prototype.hasOwnProperty.call(e.prev, "to")) {
                                            var d = e.prev.from || e.prev.to;
                                            if (!(t = p.getNode(d))) return void console.log("Could not find vivanode with the id: " + d);
                                            for (n = t.links, r = 0; r < n.length; r += 1)
                                                if (n[r].data.id === e.id) {
                                                    i = {};
                                                    var u = n[r].data.getEdgeData();
                                                    for (o in u)
                                                        if (Object.prototype.hasOwnProperty.call(u, o))
                                                            if ("properties" === o)
                                                                for (a in u.properties) Object.prototype.hasOwnProperty.call(u.properties, a) && (i.properties || (i.properties = {}), i.properties[a] = u.properties[a]);
                                                            else i[o] = u[o];
                                                    p.removeLink(n[r]);
                                                    break
                                                }
                                            if (!i) return void console.log("could not find the link to update");
                                            for (o in e)
                                                if (Object.prototype.hasOwnProperty.call(e, o)) {
                                                    if ("id" === o || "action" === o || "prev" === o) continue;
                                                    if ("properties" === o)
                                                        for (a in e.properties) Object.prototype.hasOwnProperty.call(e.properties, a) && (i.properties || (i.properties = {}), i.properties[a] = e.properties[a]);
                                                    else i[o] = e[o]
                                                }
                                            p.addLink(e.from, e.to, new I(i))
                                        } else {
                                            if (!(t = p.getNode(e.from))) return void console.log("Could not find vivanode with the id: " + e.from);
                                            for (n = t.links, r = 0; r < n.length; r += 1)
                                                if (n[r].data.id === e.id) {
                                                    var f = n[r].data.getEdgeData();
                                                    for (o in e)
                                                        if (Object.prototype.hasOwnProperty.call(e, o)) {
                                                            if ("id" === o || "action" === o || "prev" === o) continue;
                                                            if ("properties" === o)
                                                                for (a in e.properties) Object.prototype.hasOwnProperty.call(e.properties, a) && (f.properties || (f.properties = {}), f.properties[a] = e.properties[a]);
                                                            else f[o] = e[o]
                                                        }
                                                    c.calculate(p, !0), Object.prototype.hasOwnProperty.call(e, "weight") && s.updateForMetrics(p, !0), n[r].data.uiUpdate();
                                                    break
                                                }
                                        }
                                        l.rerender()
                                    } else console.log("signal does not contain prev key")
                                }(e);
                                break;
                            case "edge_delete":
                                ! function(e) {
                                    var t, n, r = p.getLinks(e.from);
                                    for (n = r.length - 1; n >= 0; n -= 1)
                                        if (r[n].data.id === e.id) {
                                            t = r[n];
                                            break
                                        }
                                    t && (t.data.delete(), l.rerender())
                                }(e)
                        }
                    }), this), m.setRenderingController(this)
                },
                Ce = n(57);

            function Ne(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Te(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Ne(Object(n), !0).forEach((function(t) {
                        Le(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Ne(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function Le(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var Pe = function(e) {
                var t, n = e.dataLoader,
                    r = e.metrics,
                    o = {
                        description: r[0].description
                    },
                    a = s.a["site/single_stats"](o);
                e.insertBefore ? (e.insertBefore.parentNode.insertBefore(a.trim().toDOM(), e.insertBefore), t = e.insertBefore.parentNode.querySelector('div[data-component-name="stats"]')) : e.appendChild && (e.insertChild.appendChild(a.trim().toDOM()), t = e.insertChild.lastElementChild);
                var i, d = {
                        current: {
                            properties: {},
                            colors: [],
                            nodeType: null,
                            aggregate: "sum",
                            zoom: "day",
                            momentTimeFormat: Object(Ce.setMomentTimeFormat)("day"),
                            timezone: "GMT",
                            time_range: {
                                min: X()(e.minFromDate).toDate().getTime(),
                                max: X()(e.maxToDate).toDate().getTime()
                            },
                            globalTemporalRange: {
                                min: X()(e.extremeFromDate).toDate().getTime(),
                                max: X()(e.maxToDate).toDate().getTime()
                            },
                            tooltip: function(e) {
                                var t = {
                                    time: X.a.utc(e[0].x).format(d.current.momentTimeFormat),
                                    name: d.selected_metric.name,
                                    color: "#000",
                                    value: null !== e[0].value ? Number(e[0].value.toFixed(2)) : ""
                                };
                                return s.a["graphs/stats_timeline_tooltip"](t)
                            }
                        },
                        selected_metric: r[0],
                        time_range_str: {
                            min: e.minFromDate,
                            max: e.maxToDate
                        }
                    },
                    u = t.querySelector("#metric_selector"),
                    p = Object(f.a)(u).typeahead(Te(Te({}, y.b), {}, {
                        autoselect: !0
                    }), Te(Te({}, y.c), {}, {
                        name: "properties",
                        displayKey: "name",
                        source: function(e, t) {
                            var n = new RegExp(e, "i");
                            t(r.filter((function(e) {
                                return n.test(e.name)
                            })))
                        }
                    })).on("typeahead:selected", (function(e, t) {
                        t.name !== d.selected_metric.name ? (d.selected_metric = t, i.innerHTML = d.selected_metric.description, this.blur(), E()) : this.blur()
                    })).on("focus", (function() {
                        var e, t;
                        p.typeahead("val", ""), e = "", (t = p.data("ttTypeahead")) && t._onQueryChanged(null, e)
                    })).on("blur", (function() {
                        p.typeahead("val", d.selected_metric.name)
                    }));
                p.typeahead("val", d.selected_metric.name), i = t.querySelector("span.field-description");
                var h = t.querySelector("#btn-zoom-day"),
                    g = t.querySelector("#btn-zoom-week"),
                    m = t.querySelector("#btn-zoom-month"),
                    b = t.querySelector("#btn-zoom-year"),
                    v = h,
                    _ = function(e, t) {
                        d.current.zoom = e, d.current.momentTimeFormat = Object(Ce.setMomentTimeFormat)(d.current.zoom), Object(c.removeClass)(v, "zoom-selected"), v = t, Object(c.addClass)(t, "zoom-selected")
                    };
                h.addEventListener("click", (function() {
                    _("day", this), E()
                })), g.addEventListener("click", (function() {
                    _("week", this), E()
                })), m.addEventListener("click", (function() {
                    _("month", this), E()
                })), b.addEventListener("click", (function() {
                    _("year", this), E()
                }));
                var w = Object(c.TimelineChart)({
                        height: "240",
                        container: t.querySelector("div.c3-timeline__chart"),
                        elemCalendar: t.querySelector("div.c3-timeline__calendar"),
                        animationDisabled: !0,
                        noCalendarCompare: !0,
                        disableChartClick: !0,
                        skipDragComponent: !0,
                        yAxisHandler: Ce.StatsYAxisHandler,
                        onTimeMarkChanged: function() {},
                        onRangeChanged: function(e, t) {
                            d.current.time_range.min = e, d.current.time_range.max = t, d.time_range_str.min = X.a.tz(e, "GMT").format("YYYY-MM-DD"), d.time_range_str.max = X.a.tz(t, "GMT").format("YYYY-MM-DD"),
                                function(e, t) {
                                    for (var n = !1; !n;) switch (d.current.zoom) {
                                        case "year":
                                            X()(e).add(1, "year").isBefore(X()(t)) ? n = !0 : _("month", m);
                                            break;
                                        case "month":
                                            X()(e).add(1, "month").isBefore(X()(t)) ? n = !0 : _("week", g);
                                            break;
                                        case "week":
                                            X()(e).add(1, "week").isBefore(X()(t)) ? n = !0 : _("day", h);
                                            break;
                                        default:
                                            n = !0
                                    }
                                }(e, t), E()
                        },
                        onDateRangePickerOpened: function() {},
                        onDateRangePickerClosed: function() {}
                    }),
                    O = function(e) {
                        var t, n, r = ["ts"],
                            o = ["x"];
                        e.forEach((function(e) {
                            r.push(X()(e.time).toDate().getTime()), o.push(e.value)
                        })), w.updateData([r, o], d.current), t = r[1], n = r[r.length - 1], X.a.tz(t, d.current.timezone).add(1, "year").toDate().getTime() > n ? Object(c.addClass)(b, "not-shown") : Object(c.removeClass)(b, "not-shown"), "year" != d.current.zoom && (X.a.tz(t, d.current.timezone).add(1, "month").toDate().getTime() > n ? Object(c.addClass)(m, "not-shown") : Object(c.removeClass)(m, "not-shown"), "month" != d.current.zoom && (X.a.tz(t, d.current.timezone).add(1, "week").toDate().getTime() > n ? Object(c.addClass)(g, "not-shown") : Object(c.removeClass)(g, "not-shown"), X.a.tz(t, d.current.timezone).add(1, "day").toDate().getTime() > n ? Object(c.addClass)(h, "not-shown") : Object(c.removeClass)(h, "not-shown")))
                    };

                function E() {
                    Object(l.showWaitMessage)(null, "Loading Stats", "Please wait...", (function(e) {
                        var t = {
                            field: d.selected_metric.value,
                            from: d.time_range_str.min,
                            to: d.time_range_str.max,
                            zoom: d.current.zoom,
                            aggregate: d.current.aggregate
                        };
                        Object(c.updateUrlParam)("from", t.from), Object(c.updateUrlParam)("to", t.to), n(t, (function(t) {
                            O(t), 0 === t.length && Object(l.displayMessage)(null, "No data", "We don't have statistics for this time range. Try a different interval."), e()
                        }), (function() {
                            e()
                        }))
                    }))
                }
                return E(), {
                    triggerUpdate: E,
                    setDataLoader: function(e) {
                        n = e
                    }
                }
            }
        },
        28: function(e, t, n) {
            "use strict";
            n.d(t, "b", (function() {
                return O
            })), n.d(t, "a", (function() {
                return E
            }));
            var r = n(1),
                o = n.n(r),
                a = n(79),
                i = n(16);

            function s(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function c(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? s(Object(n), !0).forEach((function(t) {
                        l(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : s(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function l(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var d = ["clearGraph", "onBarClosed", "onBarOpened", "onBeforeFilterApplied", "onCanvasPauseStateChanged", "onCaptureToggled", "onClusterSelected", "onClustersUpdated", "onCommentCountUpdated", "onCommentsOpened", "onDatatableClosed", "onDatatableOpened", "onEdgeFocused", "onEdgeSelected", "onExplorePanelOpened", "onFilterApplied", "onGraphCreated", "onGraphFocused", "onGraphSaveFailed", "onGraphSaveStarted", "onGraphSaved", "onGraphUserChanged", "onModalClosed", "onModalOpened", "onNodeFocused", "onNodeSelected", "onNodeUnselected", "onNodesReleased", "onOnboardCompleted", "onPaymentRequired", "onSearchFinalized", "onSearchInitiated", "onSignal", "onSomeEvent", "onTypeFocused", "onUndo", "refreshGraph", "releaseFocus", "requestFocus", "trigger", "triggerSnapshot", "updateEditMode", "editModeUpdated", "updateFreezeMode", "freezeModeUpdated", "openExpandPanel"].reduce((function(e, t) {
                return c(c({}, e), {}, l({}, t, !0))
            }), {});

            function u(e) {
                return "string" === typeof e && (!!e.match(/^(\w+\.)+\w+$/) || !!d[e])
            }

            function p(e) {
                return function(e) {
                    if (Array.isArray(e)) return g(e)
                }(e) || function(e) {
                    if ("undefined" !== typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                }(e) || h(e) || function() {
                    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function f(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || h(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function h(e, t) {
                if (e) {
                    if ("string" === typeof e) return g(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? g(e, t) : void 0
                }
            }

            function g(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }

            function m(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }
            var y = function() {
                    function e() {
                        ! function(e, t) {
                            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                        }(this, e), this.handlers = {}
                    }
                    var t, n, r;
                    return t = e, (n = [{
                        key: "cleanEmptyCollections",
                        value: function() {
                            return this.handlers = Object(i.pickBy)(this.handlers, (function(e) {
                                return e.length
                            })), this
                        }
                    }, {
                        key: "bind",
                        value: function(e, t, n) {
                            if (u(e) || console.warn('Dispatcher#bind: Event "'.concat(e, '" is not registered yet.')), "function" !== typeof t) throw new TypeError("Dispatcher#bind: Second argument should be a function");
                            if ("object" !== typeof n && "undefined" !== typeof n) throw new TypeError("Dispatcher#bind: Third argument should be either undefined, null or an object");
                            return this.handlers[e] = this.handlers[e] || [], this.handlers[e].push(n ? [t, n] : [t]), this
                        }
                    }, {
                        key: "unbindTarget",
                        value: function(e) {
                            if ("object" !== typeof e || !e) throw new TypeError("Dispatcher#unbindTarget: First argument should be a non-null object");
                            for (var t in this.handlers) this.handlers[t] = this.handlers[t].filter((function(t) {
                                var n = f(t, 2)[1];
                                return !n || n !== e
                            }));
                            return this.cleanEmptyCollections()
                        }
                    }, {
                        key: "unbindEvent",
                        value: function(e) {
                            return u(e) || console.warn('Dispatcher#unbindEvent: Event "'.concat(e, '" is not registered yet.')), this.handlers = Object(i.omit)(this.handlers, [e]), this
                        }
                    }, {
                        key: "unbindHandler",
                        value: function(e) {
                            if ("function" !== typeof e) throw new TypeError("Dispatcher#unbindHandler: First argument should be a function");
                            for (var t in this.handlers) this.unbind(t, e);
                            return this
                        }
                    }, {
                        key: "unbind",
                        value: function(e, t) {
                            if (u(e) || console.warn('Dispatcher#unbind: Event "'.concat(e, '" is not registered yet.')), "function" !== typeof t) throw new TypeError("Dispatcher#unbind: Second argument should be a function");
                            return this.handlers[e] && (this.handlers[e] = this.handlers[e].filter((function(e) {
                                return f(e, 1)[0] !== t
                            }))), this
                        }
                    }, {
                        key: "emit",
                        value: function() {
                            for (var e, t, n, r = arguments.length, o = new Array(r), a = 0; a < r; a++) o[a] = arguments[a];
                            if ("string" === typeof o[0] ? (t = o.shift(), n = o) : "string" === typeof o[1] && (e = o.shift(), t = o.shift(), n = o), u(t) || console.warn('Dispatcher#emit: Event "'.concat(t, '" is not registered yet.')), "object" !== typeof e && "undefined" !== typeof e) throw new TypeError("Dispatcher#emit: First argument should be either undefined, null or an object");
                            return (this.handlers[t] || []).forEach((function(t) {
                                var r = f(t, 2),
                                    o = r[0],
                                    a = r[1];
                                a && e && a === e || o.apply(void 0, p(n))
                            })), this
                        }
                    }]) && m(t.prototype, n), r && m(t, r), e
                }(),
                b = n(67);

            function v(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function _(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? v(Object(n), !0).forEach((function(t) {
                        w(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : v(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function w(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function O(e) {
                var t = new y,
                    n = new a.a("graphStore", t),
                    r = {
                        uiStore: new a.a("uiStore", t),
                        graphStore: n,
                        dispatcher: t
                    };
                return _(_({}, r), {}, {
                    GraphHistory: Object(b.GraphMediator)(r, e.readOnly, e.forHub, e.exploreOnly)
                })
            }
            var E = o.a.createContext(null)
        },
        3: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return r
            }));
            var r = window.HandlebarsTemplates
        },
        33: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "downloadCSVFile", (function() {
                return y
            })), n.d(t, "downloadSVGFile", (function() {
                return b
            })), n.d(t, "downloadPNGFile", (function() {
                return v
            })), n.d(t, "downloadPDFFile", (function() {
                return w
            })), n.d(t, "cleanSVG", (function() {
                return O
            })), n.d(t, "getPNGDataURL", (function() {
                return E
            })), n.d(t, "getPNGDataURLViaCanvg", (function() {
                return j
            })), n.d(t, "getSVGDataURL", (function() {
                return x
            }));
            var r = n(35),
                o = n.n(r),
                a = n(344),
                i = n.n(a),
                s = n(345),
                c = n.n(s),
                l = n(91),
                d = n(346),
                u = n.n(d);

            function p(e, t, n, r, o, a, i) {
                try {
                    var s = e[a](i),
                        c = s.value
                } catch (l) {
                    return void n(l)
                }
                s.done ? t(c) : Promise.resolve(c).then(r, o)
            }

            function f(e) {
                return function() {
                    var t = this,
                        n = arguments;
                    return new Promise((function(r, o) {
                        var a = e.apply(t, n);

                        function i(e) {
                            p(a, r, o, i, s, "next", e)
                        }

                        function s(e) {
                            p(a, r, o, i, s, "throw", e)
                        }
                        i(void 0)
                    }))
                }
            }
            var h = "image/png;base64";

            function g(e, t) {
                var n = document.createElement("a");
                return n.href = e, n.download = t, document.body.appendChild(n), n.click(), document.body.removeChild(n), Promise.resolve()
            }

            function m(e, t) {
                return g(URL.createObjectURL(e), t)
            }

            function y(e, t) {
                var n = t.fileName;
                return m(new Blob([e], {
                    type: "text/csv;charset=utf-8;"
                }), n + ".csv")
            }

            function b(e, t) {
                var n = t.fileName;
                return m(new Blob([O(e)], {
                    type: "image/svg+xml;charset=utf-8"
                }), n + ".svg")
            }

            function v(e, t) {
                return _.apply(this, arguments)
            }

            function _() {
                return (_ = f(o.a.mark((function e(t, n) {
                    var r, a, i;
                    return o.a.wrap((function(e) {
                        for (;;) switch (e.prev = e.next) {
                            case 0:
                                return r = n.fileName, a = n.width, i = n.height, e.t0 = g, e.next = 4, E(t, {
                                    width: a,
                                    height: i
                                });
                            case 4:
                                return e.t1 = e.sent, e.t2 = r + ".png", e.abrupt("return", (0, e.t0)(e.t1, e.t2));
                            case 7:
                            case "end":
                                return e.stop()
                        }
                    }), e)
                })))).apply(this, arguments)
            }

            function w(e, t) {
                var n = t.fileName,
                    r = t.width,
                    o = t.height,
                    a = "Apercu";
                return new Promise((function(t) {
                    var s = new u.a({
                            size: [.72 * r, .72 * o],
                            margins: {
                                top: 0,
                                bottom: 0,
                                left: 0,
                                right: 0
                            }
                        }),
                        l = s.pipe(i()());
                    fetch("/assets/gc_apercu_regular.ttf").then((function(e) {
                        return e.arrayBuffer()
                    })).then((function(i) {
                        s.registerFont(a, i), c()(s, e, 0, 0, {
                            width: r,
                            height: o,
                            fontCallback: function() {
                                return a
                            }
                        }), l.on("finish", (function() {
                            m(l.toBlob("application/pdf"), n + ".pdf").then((function() {
                                return t()
                            }))
                        })), s.end()
                    }))
                }))
            }

            function O(e) {
                return e.replace(/&nbsp;/g, "&#160;").replace(new RegExp("/assets/gc_apercu_(regular|bold)-[0-9a-f]+", "g"), "".concat(location.origin, "/assets/gc_apercu_$1"))
            }

            function E(e, t) {
                return j(e, {
                    width: t.width,
                    height: t.height
                })
            }

            function j(e, t) {
                return S.apply(this, arguments)
            }

            function S() {
                return (S = f(o.a.mark((function e(t, n) {
                    var r, a, i, s, c, d;
                    return o.a.wrap((function(e) {
                        for (;;) switch (e.prev = e.next) {
                            case 0:
                                return r = n.width, a = n.height, i = O(t), (s = document.getElementById("canvas")).width = r, s.height = a, c = s.getContext("2d"), e.next = 8, l.Canvg.fromString(c, i);
                            case 8:
                                return d = e.sent, e.next = 11, d.render();
                            case 11:
                                return c.globalCompositeOperation = "destination-over", c.fillStyle = "white", c.fillRect(0, 0, r, a), e.abrupt("return", s.toDataURL(h));
                            case 15:
                            case "end":
                                return e.stop()
                        }
                    }), e)
                })))).apply(this, arguments)
            }

            function x(e) {
                return new Promise((function(t) {
                    t("data:image/svg+xml;base64,".concat(btoa(e)))
                }))
            }
        },
        4: function(e, t, n) {
            "use strict";
            var r = n(60),
                o = n.n(r),
                a = n(343),
                i = n.n(a);

            function s(e, t) {
                t.fn[e] || (t.fn[e] = function() {
                    for (var t = this, n = arguments.length, r = new Array(n), o = 0; o < n; o++) r[o] = arguments[o];
                    setTimeout((function() {
                        t[e].apply(t, r)
                    }), 100)
                })
            }
            window.$ = o.a, window.jQuery = o.a, s("foundation", window.$), s("slick", window.$), n.e(6).then(n.t.bind(null, 1009, 7)), n.e(13).then(n.t.bind(null, 1010, 7)), n.e(9).then(n.t.bind(null, 1011, 7)), n.e(8).then(n.t.bind(null, 1012, 7)), Promise.resolve().then(n.t.bind(null, 32, 7)), n.e(10).then(n.t.bind(null, 1013, 7)), n.e(12).then(n.t.bind(null, 1014, 7)), n.e(11).then(n.t.bind(null, 1015, 7)), n.e(7).then(n.t.bind(null, 1008, 7)), n.e(14).then(n.t.bind(null, 1016, 7)), i()(o.a),
                function(e) {
                    e.fn.fitVids = function(t) {
                        var n = {
                            customSelector: null,
                            ignore: null
                        };
                        if (!document.getElementById("fit-vids-style")) {
                            var r = document.head || document.getElementsByTagName("head")[0],
                                o = document.createElement("div");
                            o.innerHTML = '<p>x</p><style id="fit-vids-style">'.concat("\n        .fluid-width-video-wrapper {\n          width: 100%;\n          position: relative;\n          padding: 0;\n        }\n        .fluid-width-video-wrapper iframe,\n        .fluid-width-video-wrapper object,\n        .fluid-width-video-wrapper embed {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n        }", "</style>"), r.appendChild(o.childNodes[1])
                        }
                        return t && e.extend(n, t), this.each((function() {
                            var t = ['iframe[src*="player.vimeo.com"]', 'iframe[src*="youtube.com"]', 'iframe[src*="youtube-nocookie.com"]', 'iframe[src*="kickstarter.com"][src*="video.html"]', "object", "embed"];
                            n.customSelector && t.push(n.customSelector);
                            var r = ".fitvidsignore";
                            n.ignore && (r = r + ", " + n.ignore);
                            var o = e(this).find(t.join(","));
                            (o = (o = o.not("object object")).not(r)).each((function(t) {
                                var n = e(this);
                                if (!(n.parents(r).length > 0) && !("embed" === this.tagName.toLowerCase() && n.parent("object").length || n.parent(".fluid-width-video-wrapper").length)) {
                                    n.css("height") || n.css("width") || !isNaN(n.attr("height")) && !isNaN(n.attr("width")) || (n.attr("height", 9), n.attr("width", 16));
                                    var o = ("object" === this.tagName.toLowerCase() || n.attr("height") && !isNaN(parseInt(n.attr("height"), 10)) ? parseInt(n.attr("height"), 10) : n.height()) / (isNaN(parseInt(n.attr("width"), 10)) ? n.width() : parseInt(n.attr("width"), 10));
                                    if (!n.attr("id")) {
                                        var a = "fitvid" + t;
                                        n.attr("id", a)
                                    }
                                    n.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top", 100 * o + "%"), n.removeAttr("height").removeAttr("width")
                                }
                            }))
                        }))
                    }
                }(o.a);
            t.a = o.a
        },
        45: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "edgeCard", (function() {
                return a
            })), n.d(t, "embedNodeCard", (function() {
                return s
            })), n.d(t, "graphCard", (function() {
                return f
            })), n.d(t, "nodeCard", (function() {
                return m
            }));
            var r = n(0),
                o = n(3),
                a = function(e, t, n, a) {
                    var i = e.GraphHistory,
                        s = e.graphStore,
                        c = i.getEdgeById(n);
                    if (c) {
                        var l = {
                            rel: {},
                            from: {},
                            to: {},
                            dont_focus: a
                        };
                        s.get("isHub") && (l.hub_id = s.get("id"));
                        var d = i.getEdgeTypeById(c.name_id),
                            u = i.getNodeById(c.from),
                            p = i.getNodeTypeById(u.type_id),
                            f = i.getNodeById(c.to),
                            h = i.getNodeTypeById(f.type_id);
                        for (var g in l.rel.id = c.id, c.graph_count && (l.rel.graph_count = "Found in " + c.graph_count + (c.graphs_count > 1 ? " graphs" : " graph")), l.rel.name = c.name, l.rel.weight = c.weight || 1, l.rel.dir = d.directed, l.rel.color = d.color, l.rel.properties = [], c.properties) Object.prototype.hasOwnProperty.call(c.properties, g) && l.rel.properties.push({
                            value: c.properties[g],
                            name: g
                        });
                        l.from.name = u.name, l.from.color = p.color, l.from.typeChar = u.type.charAt(0).toUpperCase(), l.to.name = f.name, l.to.color = h.color, l.to.typeChar = f.type.charAt(0).toUpperCase();
                        var m = o.a["graphs/edge_card"](l);
                        t.insertBefore(m.toDOM(), t.firstChild);
                        var y = t.children[0];
                        y.querySelector(".gc-card-header").addEventListener("click", (function() {
                            this.parentNode.classList.contains("gc-card-focused") || (y.parentNode.querySelector(".gc-card-focused").classList.remove("gc-card-focused"), y.classList.add("gc-card-focused"))
                        }), !1);
                        var b = y.querySelector(".gc-card-reference");
                        Object(r.ab)(b);
                        var v = y.querySelectorAll(".gc-card-prop-kv");
                        if (v)
                            for (var _ = 0; _ < v.length; _ += 1) {
                                var w = v[_].querySelector("label");
                                w && Object(r.ab)(w)
                            }
                        for (var O = function(e) {
                                return e.preventDefault(), i.clearSelectedNodes(), i.selectNode(u.id), !1
                            }, E = y.querySelector(".gc-div-from-node").querySelectorAll("span"), j = 0; j < E.length; j += 1) E[j].addEventListener("click", O, !1);
                        for (var S = function(e) {
                                return e.preventDefault(), i.clearSelectedNodes(), i.selectNode(f.id), !1
                            }, x = y.querySelector(".gc-div-to-node").querySelectorAll("span"), k = 0; k < E.length; k += 1) x[k].addEventListener("click", S, !1);
                        return y
                    }
                    console.log("edge does not exist")
                },
                i = n(2),
                s = function(e) {
                    var t, n = e.parent;
                    e.graph || (e.graph = {}), e.hub || (e.hub = {}), e.node || (e.node = {}), e.nodeType || (e.nodeType = {});
                    var r, a = function(e) {
                            var t = Object(i.cloneObj)(e);
                            return t.nodes_count > 3 && (t.toggle_more = t.nodes_count > 3, t.to_nodes = t.to_nodes.slice(0, 3)), t
                        },
                        s = function(e) {
                            return {
                                graph_count: e.length,
                                toggle_more: e.length > 3,
                                graphs: e.slice(0, 3)
                            }
                        },
                        c = e.node,
                        l = e.graph.id,
                        d = e.nodeType,
                        u = e.properties,
                        p = e.edge_types || [],
                        f = e.graphs || [],
                        h = {
                            graph_id: l,
                            hub_or_graph_name: e.hub.name || e.graph.name,
                            hub_or_graph_url: e.hub.id ? "/hubs/" + e.hub.id : "/graphs/" + e.graph.id,
                            id: c.id,
                            name: c.name,
                            type: d.name,
                            image: c.image,
                            description: Object(i.transformMarkdown)(c.description),
                            color: d.color,
                            properties: u,
                            edge_types: p.map(a),
                            graphs: s(f)
                        },
                        g = o.a["graphs/embed_node_card"](h);
                    n ? (n.insertBefore(g.toDOM(), n.firstChild), r = n.children[0]) : r = g.toDOM();
                    var m = r.querySelector(".gc-card-description");
                    m && (Object(i.linkifyDOM)(m), Object(i.moreorlessify2)(document, m));
                    var y = r.querySelectorAll(".gc-card-prop-kv");
                    if (y)
                        for (t = 0; t < y.length; t += 1) {
                            var b = y[t].querySelector("span");
                            b && Object(i.linkifyDOM)(b)
                        }
                    var v, _ = function(e, t) {
                            if (t.nodes_count > 3) {
                                var n = e.querySelector("a.toggle-more"),
                                    r = e.querySelector("ul");
                                n.addEventListener("click", (function(e) {
                                    if (e.preventDefault(), Object(i.hasClass)(r, "expanded")) {
                                        Object(i.removeClass)(r, "expanded"), n.innerHTML = "+ More";
                                        for (var a = r.querySelectorAll("li"), s = a.length - 1; s > 2; s -= 1) r.removeChild(a[s])
                                    } else {
                                        Object(i.addClass)(r, "expanded"), n.innerHTML = "- Less";
                                        for (var c = 3; c < t.to_nodes.length; c += 1) {
                                            var l = o.a["graphs/embed_node_card_edgetype_node_item"](t.to_nodes[c]).toDOM();
                                            r.appendChild(l)
                                        }
                                    }
                                    return !1
                                }))
                            }
                        },
                        w = function(e) {
                            if (f.length > 3) {
                                var t = e.querySelector(".toggle-more"),
                                    n = e.querySelector("ul");
                                t.addEventListener("click", (function() {
                                    if (Object(i.hasClass)(n, "expanded")) {
                                        Object(i.removeClass)(n, "expanded"), t.innerHTML = "+ More";
                                        for (var e = n.querySelectorAll("li"), r = e.length - 1; r > 2; r -= 1) n.removeChild(e[r])
                                    } else {
                                        Object(i.addClass)(n, "expanded"), t.innerHTML = "- Less";
                                        for (var a = 3; a < f.length; a += 1) {
                                            var s = o.a["graphs/embed_node_card_graphs_li"](f[a]).toDOM();
                                            n.appendChild(s)
                                        }
                                    }
                                }))
                            }
                        },
                        O = r.querySelectorAll("div.gc-card-relation-group");
                    if (O)
                        for (t = 0; t < O.length; t += 1) _(O[t], p[t]);
                    var E = r.querySelector("div.gc-card-graphs-group");
                    E && w(E);
                    var j = r.parentNode.getBoundingClientRect().height,
                        S = r.querySelector("div.gc-card-top");
                    return S.style.height = j + "px", S.style.minHeight = j + "px", S.classList.add("gc-custom-scrollbar"), {
                        elem: r,
                        insertProperty: function(e, t) {
                            var n = v.querySelectorAll("div.node-properties");
                            v = r.querySelector(".section-properties");
                            var a = o.a["graphs/embed_node_card_property_item"]({
                                name: e.name,
                                value: e.value
                            }).trim().toDOM();
                            n.length >= t ? (v.insertBefore(a, n[t]), a = v.querySelectorAll("div.node-properties")[t]) : (v.appendChild(a), a = v.lastElementChild), Object(i.removeClass)(v, "not-shown"), Object(i.linkifyDOM)(a)
                        },
                        removeProperty: function(e) {
                            var t, n = r.querySelectorAll("div.node-properties");
                            if (n)
                                for (t = 0; t < n.length; t += 1)
                                    if (n[t].getAttribute("data-prop-name") === e) return n[t].parentNode.removeChild(n[t]), void(1 === n.length && Object(i.addClass)(v, "not-shown"))
                        },
                        insertEdgeType: function(e, t) {
                            var n = r.querySelectorAll("div.gc-card-relation-group"),
                                i = a(e),
                                s = o.a["graphs/embed_node_card_edgetype_item"](i).trim().toDOM();
                            v = r.querySelector(".gc-card-body"), p.length > t ? (p.splice(t, 0, e), v.insertBefore(s, n[t]), s = r.querySelectorAll("div.gc-card-relation-group")[t]) : (p.splice(t, 0, e), v.appendChild(s), s = v.lastElementChild), _(s, e)
                        },
                        removeEdgeType: function(e) {
                            var t, n, o = r.querySelectorAll("div.gc-card-relation-group");
                            if (o)
                                for (t = o.length - 1; t >= 0; t -= 1)
                                    if ((n = o[t]).getAttribute("data-id") === e) return void n.parentNode.removeChild(n)
                        },
                        insertGraphs: function(e) {
                            var t = r.querySelector("div.gc-card-graphs-group"),
                                n = {
                                    graphs: s(e)
                                };
                            f = e;
                            var a = o.a["graphs/embed_node_card_graphs_item"](n).trim().toDOM();
                            t.appendChild(a);
                            var c = t.lastElementChild;
                            w(c), Object(i.removeClass)(t, "not-shown")
                        },
                        removeGraphs: function() {
                            for (var e = r.querySelector("div.gc-card-graphs-group"); e.firstChild;) e.removeChild(e.firstChild);
                            Object(i.addClass)(e, "not-shown")
                        }
                    }
                },
                c = n(6),
                l = n.n(c),
                d = n(12),
                u = n.n(d),
                p = n(5),
                f = function(e, t, n, r, a, s) {
                    var c, d = e.uiStore,
                        f = e.graphStore,
                        h = e.GraphHistory,
                        g = {
                            id: f.get("id"),
                            title: f.get("title"),
                            subtitle: f.get("subtitle"),
                            description: Object(i.transformMarkdown)(f.get("description")),
                            references: Object(i.transformMarkdown)(f.get("references")),
                            updated_at: l()(f.get("updatedAt")).fromNow(),
                            created_at: l()(f.get("createdAt")).format("MMM Do, YYYY"),
                            image: f.get("image").url,
                            has_image: !f.get("image").url.endsWith("/graphs/missing.png"),
                            license: f.get("license"),
                            nodetypes: [],
                            edgetypes: [],
                            users: f.get("users"),
                            share_url: window.location.origin + "/graphs/" + f.get("id"),
                            editable: !d.get("readOnly"),
                            is_admin: !d.get("readOnly") && f.get("user").is_admin,
                            status: f.get("status"),
                            logged_in: f.get("user").id,
                            hub: f.get("hub").name,
                            hub_id: f.get("hub").id,
                            blocked_nodes_statement: f.get("blockedNodesStatement"),
                            graph_created: !!f.get("id")
                        };
                    g.title || (f.get("id") ? g.title = "Untitled Graph" : g.title = "New Graph"), g.license.type = "Creative Commons " + (g.license.cc_by ? "Attribution" : "") + (g.license.cc_nc ? "-NonCommercial" : "") + (g.license.cc_sa ? "-ShareAlike" : "") + (g.license.cc_nd ? "-NoDerivatives" : "") + " 4.0 International", g.license.type_short = "Creative Commons " + (g.license.cc_by ? "BY" : "") + (g.license.cc_nc ? "-NC" : "") + (g.license.cc_sa ? "-SA" : "") + (g.license.cc_nd ? "-ND" : "") + " 4.0 International", g.license.link = "http://creativecommons.org/licenses/by" + (g.license.cc_nc ? "-nc" : "") + (g.license.cc_sa ? "-sa" : "") + (g.license.cc_nd ? "-nd" : "") + "/4.0/", g.recommended = f.get("isUserRecommended") ? {
                        class: "graph-recommended",
                        text: "click to unrecommend"
                    } : {
                        class: "graph-not-recommended",
                        text: "click to recommend"
                    };
                    var m = h.getNodeTypes();
                    for (f.get("belongsToHub") && (m = m.filter((function(e) {
                            return e.count > 0
                        }))), c = 0; c < m.length; c += 1) {
                        var y = m[c].size;
                        switch (y) {
                            case "metric_degree":
                                y = "Degree Centrality";
                                break;
                            case "metric_betweenness":
                                y = "Betweenness Centrality";
                                break;
                            case "neutral":
                                y = "Neutral"
                        }
                        g.nodetypes.push({
                            color: m[c].color,
                            name: m[c].name,
                            count: m[c].count,
                            size: y
                        })
                    }
                    g.nodetypes = g.nodetypes.sort((function(e, t) {
                        return t.count - e.count
                    }));
                    var b = h.getEdgeTypes();
                    for (f.get("belongsToHub") && (b = b.filter((function(e) {
                            return e.count > 0
                        }))), c = 0; c < b.length; c += 1) g.edgetypes.push({
                        color: b[c].color,
                        name: b[c].name,
                        count: b[c].count
                    });
                    g.edgetypes = g.edgetypes.sort((function(e, t) {
                        return t.count - e.count
                    }));
                    var v = o.a["graphs/graph_card"](g);
                    document.body.appendChild(v.trim().toDOM());
                    var _ = Object(i.modalize)({
                            element: document.body.lastElementChild,
                            url_param: "graph",
                            close_others: !0
                        }, e),
                        w = document.body.lastElementChild,
                        O = w.querySelector(".gc-pnl"),
                        E = w.querySelector(".gc-dlg-cancel");
                    _.closeButton(E);
                    var j = O.querySelector(".description");
                    Object(i.linkifyDOM)(j);
                    var S = O.querySelector(".references");
                    Object(i.linkifyDOM)(S);
                    var x = O.querySelector(".graph-settings-menu");
                    if (g.is_admin && g.graph_created) {
                        if (O.querySelector(".gc-pnl-edit").addEventListener("click", (function(e) {
                                return e.stopPropagation(), _.close(), n && n.call(), !1
                            }), !1), !f.get("community")) O.querySelector(".open-license-dialogue").addEventListener("click", (function(e) {
                            return e.preventDefault(), _.close(), a && a.call(), !1
                        }), !1);
                        u.a.create(x, {
                            position: "bottomright",
                            size: "small",
                            hideOnClickOutside: !0
                        }), x.addEventListener("click", (function() {
                            return _.close(), t(".tpd-tooltip").css("display", "none"), s && s.call(), !1
                        }), !1)
                    }
                    g.editable && g.graph_created && O.querySelector(".open-collaborations-panel").addEventListener("click", (function(e) {
                        return e.preventDefault(), _.close(), r && r.call(), !1
                    }), !1);
                    if (f.get("user").id && g.graph_created && (x.addEventListener("click", (function(e) {
                            return e.preventDefault(), t(".tpd-tooltip").css("display", "none"), !1
                        })), !g.editable)) {
                        var k = O.querySelector(".request-membership");
                        k && Object(p.GraphMembershipStatus)(f.get("id"), (function(e) {
                            1 == e.status ? (console.log("graph membership accepted"), k.style.display = "none") : 2 == e.status ? (console.log("graph membership pending"), k.disabled = !0, k.innerHTML = "Membership pending...") : 3 == e.status ? (console.log("graph membership rejected"), k.style.display = "none") : 0 == e.status && (console.log("no graph membership requested"), k.addEventListener("click", (function(e) {
                                e.preventDefault(), this.disabled = !0;
                                return Object(p.requestGraphMembership)(f.get("id"), "", (function(e) {
                                    console.log(e.msg), k.innerHTML = e.msg
                                })), !1
                            })))
                        }))
                    }
                    return _
                },
                h = n(7),
                g = n(72),
                m = function(e, t, n, r, a, s, c, l, d, u, p, f, m) {
                    var y = e.uiStore,
                        b = e.graphStore,
                        v = e.GraphHistory,
                        _ = !1;
                    y.get("freezeMode") || !1 !== y.get("readOnly") || y.get("isOnlyExploreAllowed") || (_ = !0);
                    var w, O = {
                            graph_id: n,
                            graph_name: r,
                            id: a.id,
                            name: v.nodeDisplayName(a.id),
                            type: s.name,
                            image: a.image,
                            description: Object(i.transformMarkdown)(a.description),
                            reference: a.reference,
                            color: s.color,
                            properties: [],
                            edge_types: [],
                            dont_focus: p,
                            allow_edit: !y.get("readOnly") && !y.get("isOnlyExploreAllowed"),
                            editable: _,
                            node_saved: !0,
                            degree: a.degree
                        },
                        E = y.get("historySinceLastSave");
                    for (w = 0; w < E.length; w += 1) E[w].id === a.id && "node_create" === E[w].action && (Object.prototype.hasOwnProperty.call(E[w], "exists_in_hub") && E[w].exists_in_hub || (O.node_saved = !1));
                    if (O.node_saved && (O.allow_share = 2 !== v.getNodeStatus(a.id)), b.get("isHubGraph")) {
                        O.hub_id = b.get("hub").id;
                        var j = b.get("user") || {},
                            S = s.properties.find((function(e) {
                                return e.name_alias === g.a
                            }));
                        j.is_hub_member && S && j.email === a.properties[S.name] && (O.self_edit_link = "/hubs/".concat(O.hub_id, "/nodes/").concat(a.id))
                    }
                    if (a.graph_count)
                        if (b.get("isHubGraph")) O.graph_count = "In " + a.graph_count + " graph" + (1 !== a.graph_count ? "s" : "");
                        else {
                            var x = a.graph_count - 1;
                            x > 0 && (O.graph_count = "In " + x + " other graph" + (1 !== x ? "s" : ""))
                        }
                    var k = !1;
                    b.get("isEmbed") && ("false" === Object(i.getUrlParamValue)("topbar") && (k = !0));
                    O.hideFooterLinks = k;
                    var C, N, T, L = [];
                    for (C in Object.prototype.hasOwnProperty.call(a, "properties") && Array.isArray(s.properties) && (s.properties.forEach((function(e) {
                            s.display_name !== e.name && a.properties[e.name] && O.properties.push({
                                name: e.name_alias,
                                value: a.properties[e.name]
                            })
                        })), s.display_name && O.properties.push({
                            name: "Vertex Object",
                            value: a.name
                        })), c)
                        if (Object.prototype.hasOwnProperty.call(c, C)) {
                            for (T = c[C].to_nodes.length, N = {
                                    id: c[C].id,
                                    color: c[C].color,
                                    name: c[C].name,
                                    to_nodes: [],
                                    nodes_count: T,
                                    toggle_more: T > 3
                                }, w = 0; w < T; w += 1) N.to_nodes.push({
                                edge_id: c[C].to_nodes[w].link_id,
                                from_id: c[C].to_nodes[w].other,
                                to_id: c[C].to_nodes[w].id,
                                name: c[C].to_nodes[w].name,
                                type: c[C].to_nodes[w].type,
                                typeChar: c[C].to_nodes[w].type.charAt(0).toUpperCase(),
                                color: c[C].to_nodes[w].color,
                                degree: c[C].to_nodes[w].node_degree,
                                degree_text: Object(i.buildNumericText)(c[C].to_nodes[w].node_degree, "edge", "edges", "{quantity} {item}")
                            });
                            N.to_nodes = N.to_nodes.sort((function(e, t) {
                                return t.degree - e.degree
                            })), L.push(N)
                        }
                    O.edge_types = L.map((function(e) {
                        var t = Object(i.cloneObj)(e);
                        return t.to_nodes = t.to_nodes.slice(0, 3), t
                    })), O.edge_types = O.edge_types.sort((function(e, t) {
                        return t.nodes_count - e.nodes_count
                    }));
                    var P = o.a["graphs/node_card"](O);
                    t.insertBefore(P.toDOM(), t.firstChild);
                    var A = t.children[0].querySelector("div.gc-card"),
                        D = function() {
                            if (Object(i.hasClass)(A, "gc-card-focused"))
                                if (f) f();
                                else {
                                    var t = Object(i.cloneObj)(O);
                                    t.edge_types = L, Object(h.expandedNodeCard)(e, t, m)
                                }
                        },
                        M = A.querySelector(".gc-card-header");
                    M.addEventListener("click", (function() {
                        if (!Object(i.hasClass)(A, "gc-card-focused")) {
                            var e = A.parentNode.querySelector(".gc-card-focused");
                            e && Object(i.removeClass)(e, "gc-card-focused"), Object(i.addClass)(A, "gc-card-focused")
                        }
                    }), !1), 0 == O.hideFooterLinks && (M.querySelector(".inner").addEventListener("click", (function() {
                        D()
                    })), A.querySelector("button.expand-card").addEventListener("click", (function() {
                        D()
                    })));
                    var q = function(e) {
                        var t = e.getAttribute("data-id"),
                            n = c[t].to_nodes;
                        if (!(n.length < 4)) {
                            n = n.sort((function(e, t) {
                                return t.node_degree - e.node_degree
                            }));
                            var r, a, s, l, d = e.querySelector("ul"),
                                u = e.querySelector(".toggle-more");
                            u.addEventListener("click", (function() {
                                if (Object(i.hasClass)(d, "expanded"))
                                    for (Object(i.removeClass)(d, "expanded"), u.innerHTML = "+ More", a = d.querySelectorAll("li"), r = a.length - 1; r > 2; r -= 1) d.removeChild(a[r]);
                                else
                                    for (Object(i.addClass)(d, "expanded"), u.innerHTML = "- Less", r = 3; r < n.length; r += 1) {
                                        l = n[r], s = o.a["graphs/node_card_edgetype_node_li"]({
                                            edge_id: l.link_id,
                                            from_id: l.other,
                                            to_id: l.id,
                                            name: l.name,
                                            type: l.type,
                                            typeChar: l.type.charAt(0).toUpperCase(),
                                            color: l.color,
                                            degree: l.node_degree,
                                            degree_text: Object(i.buildNumericText)(l.node_degree, "edge", "edges", "{quantity} {item}")
                                        }).toDOM(), d.appendChild(s), I((s = d.lastElementChild).querySelector(".gc-card-relation-node"))
                                    }
                            }), !1)
                        }
                    };

                    function I(e) {
                        var t = null;
                        e.addEventListener("click", (function(e) {
                            t && (clearTimeout(t), t = null), l.call(this, e)
                        })), d && (e.addEventListener("mouseover", (function(e) {
                            console.log("mouseover"), t && (clearTimeout(t), t = null);
                            var n = this;
                            t = setTimeout((function() {
                                d.call(n, e)
                            }), 500)
                        })), e.addEventListener("mouseout", (function() {
                            console.log("mouseout"), t && (clearTimeout(t), t = null)
                        })))
                    }
                    var R = A.querySelectorAll(".gc-card-relation-group");
                    if (R)
                        for (w = 0; w < R.length; w += 1) q.call(null, R[w]);
                    var B = A.querySelectorAll(".gc-card-relation-node");
                    if (B)
                        for (w = 0; w < B.length; w += 1) I(B[w]);
                    Array.from(A.querySelectorAll(".linkify")).forEach((function(e) {
                        Object(i.linkifyDOM)(e)
                    }));
                    var F = A.querySelector(".gc-card-description");
                    (F && Object(i.moreorlessify2)(document, F), O.editable) && A.querySelector(".edit-card").addEventListener("click", (function(t) {
                        return t.preventDefault(), u ? u.call(null, a.id) : Object(h.editNodePanel)(e, a.id), !1
                    }));
                    return v.isOnboardEnabled() && setTimeout((function() {
                        v.triggerOnboardAction("node_card_opened")
                    }), 150), A
                }
        },
        46: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "AllTypesFilterBlock", (function() {
                return a
            })), n.d(t, "BaseRangeFilterBlock", (function() {
                return l
            })), n.d(t, "DistinctPropsFilterBlock", (function() {
                return d
            })), n.d(t, "EdgeTypeWeightRangeFilterBlock", (function() {
                return u
            })), n.d(t, "InfoBar", (function() {
                return h
            })), n.d(t, "NodeTypeCentralityRangeFilterBlock", (function() {
                return g
            })), n.d(t, "NumericPropsRangeFilterBlock", (function() {
                return m
            })), n.d(t, "ShareBar", (function() {
                return x
            })), n.d(t, "StoriesBar", (function() {
                return C
            })), n.d(t, "analysisBar", (function() {
                return Y
            })), n.d(t, "analysisBarWrapper", (function() {
                return V
            })), n.d(t, "cardHolderBarWrapper", (function() {
                return K
            })), n.d(t, "clusterAnalysisBlock", (function() {
                return L
            })), n.d(t, "defaultAnalysisBlock", (function() {
                return A
            })), n.d(t, "filterBar", (function() {
                return $
            })), n.d(t, "filterBarWrapper", (function() {
                return Z
            })), n.d(t, "groupBar", (function() {
                return ee
            })), n.d(t, "groupBarList", (function() {
                return J
            })), n.d(t, "groupBarWrapper", (function() {
                return te
            })), n.d(t, "groupByPropertyBlock", (function() {
                return Q
            })), n.d(t, "nominalAnalysisBlock", (function() {
                return P
            }));
            var r = n(3),
                o = n(0),
                a = function(e, t) {
                    var n = e.graphStore,
                        a = e.GraphHistory,
                        i = t.filter,
                        s = t.parent,
                        c = t.asyncRuleCallback,
                        l = function(e, t) {
                            var n = e[t],
                                r = {
                                    type: i.type,
                                    id: u.types[t].id
                                };
                            a.getFilterManager().getRules().filter((function(e) {
                                return e.type === i.type && e.id === u.types[t].id
                            })).length > 0 && (n.checked = !1), n.addEventListener("change", (function() {
                                var e = {
                                    rule: r
                                };
                                n.checked ? e.remove = !0 : e.add = !0, c([e])
                            }))
                        },
                        d = function(e) {
                            var t, n = [];
                            for (t = g.length - 1; t >= 0; t -= 1) e || g[t].checked || n.push({
                                remove: !0,
                                rule: {
                                    type: i.type,
                                    id: u.types[t].id
                                }
                            }), g[t].checked = !0;
                            n.length > 0 && c(n)
                        },
                        u = {};
                    if ("nt" === i.type ? (u.filteredPropName = "Node Type", u.filteredTypeName = "All Node Types", u.color = "#000", u.types = a.getNodeTypes().map((function(e) {
                            return {
                                id: e.id,
                                name: e.name,
                                color: e.color,
                                count: e.count
                            }
                        })).sort((function(e, t) {
                            return t.count - e.count
                        }))) : (u.filteredPropName = "Edge Type", u.filteredTypeName = "All Vector Orders", u.color = "#000", u.types = a.getEdgeTypes().map((function(e) {
                            return {
                                id: e.id,
                                name: e.name,
                                color: e.color,
                                count: e.count
                            }
                        })).sort((function(e, t) {
                            return t.count - e.count
                        }))), n.get("isHubGraph") && (u.types = u.types.filter((function(e) {
                            return e.count > 0
                        }))), u.show_more = u.types.length > 5, u.show_more)
                        for (var p = 5; p < u.types.length; p += 1) u.types[p].hide = !0;
                    var f = r.a["graphs/all_types_filter_block"](u).trim().toDOM();
                    s.appendChild(f);
                    for (var h, g = (f = s.lastElementChild).querySelectorAll("input[type=checkbox]"), m = g.length - 1; m >= 0; m -= 1) l(g, m);
                    return f.querySelector("button.toggle-all").addEventListener("click", (function() {
                        d()
                    })), f.querySelector("button.toggle-none").addEventListener("click", (function() {
                        var e, t = [];
                        for (e = g.length - 1; e >= 0; e -= 1) g[e].checked && t.push({
                            add: !0,
                            rule: {
                                type: i.type,
                                id: u.types[e].id
                            }
                        }), g[e].checked = !1;
                        t.length > 0 && c(t)
                    })), u.show_more && (h = f.querySelector("button.show-more")).addEventListener("click", (function() {
                        var e, t = f.querySelector("ul"),
                            n = t.querySelectorAll("li.bar-block__list-item");
                        if (Object(o.N)(t, "expanded")) {
                            for (e = 5; e < n.length; e += 1) Object(o.h)(n[e], "not-shown");
                            Object(o.nb)(t, "expanded"), h.textContent = "+ MORE"
                        } else {
                            for (e = 5; e < n.length; e += 1) Object(o.nb)(n[e], "not-shown");
                            Object(o.h)(t, "expanded"), h.textContent = "- LESS"
                        }
                    })), {
                        clear: d
                    }
                },
                i = n(12),
                s = n.n(i),
                c = n(2),
                l = function(e, t) {
                    var n, a, i, l = e.GraphHistory,
                        d = t.filter,
                        u = t.parent,
                        p = t.asyncRuleCallback,
                        f = t.propRange,
                        h = t.context,
                        g = function(e) {
                            if (a && (a.setRange(f.min, f.max), i && (i.checked = !0)), !e) {
                                var t = {
                                    type: d.type,
                                    centrality: d.centrality,
                                    prop: d.prop,
                                    id: d.id,
                                    max_range: !0
                                };
                                p([{
                                    remove: !0,
                                    rule: t
                                }])
                            }
                        },
                        m = r.a["graphs/filter_numeric_properties_svg_li"](h).trim().toDOM();
                    if (u.appendChild(m), m = u.lastElementChild, f.max === f.min) {
                        var y = m.querySelector("div.filter-no-values");
                        Object(o.nb)(y, "not-shown");
                        var b = m.querySelector("div.filter-numeric__svg");
                        Object(o.h)(b, "not-shown")
                    } else {
                        var v = m.querySelector("svg.bar-chart");
                        a = Object(c.BarChart)(e, {
                            container: v,
                            filter: d,
                            onRangeChanged: function() {
                                var e, t;
                                e = a.getMin(), (t = a.getMax()) === f.max && e === f.min ? p([{
                                    remove: !0,
                                    rule: {
                                        type: d.type,
                                        id: d.id,
                                        centrality: d.centrality,
                                        prop: d.prop,
                                        max_range: !0
                                    }
                                }]) : p([{
                                    add: !0,
                                    rule: {
                                        type: d.type,
                                        id: d.id,
                                        centrality: d.centrality,
                                        prop: d.prop,
                                        range: {
                                            min: e,
                                            max: t
                                        }
                                    }
                                }])
                            }
                        });
                        var _ = l.getFilterManager().getRules().filter((function(e) {
                            return e.type === d.type && e.id === d.id && Object.prototype.hasOwnProperty.call(e, "range")
                        }));
                        _.length > 0 && a.setRange(_[0].range.min, _[0].range.max), t.context.with_missing && ((i = m.querySelector('input[type="checkbox"]')).addEventListener("change", (function() {
                            var e, t;
                            e = !this.checked, t = {
                                rule: {
                                    type: d.type,
                                    id: d.id,
                                    centrality: d.centrality,
                                    prop: d.prop,
                                    hide_empty: !0
                                }
                            }, e ? t.add = !0 : t.remove = !0, p([t])
                        })), (_ = l.getFilterManager().getRules().filter((function(e) {
                            return e.type === d.type && e.id == d.id && Object.prototype.hasOwnProperty.call(e, "hide_empty")
                        }))).length > 0 && (i.checked = !1));
                        var w, O, E, j, S = m.querySelector(".filtered-count");
                        n = function() {
                            j = E(), S.innerHTML = j > 0 ? ["Showing", O - j, w, "out of", O].join(" ") : O
                        }, "nt" === d.type.substring(0, 2) ? "nt_all" === d.id ? (w = "Nodes", O = l.getNodes().length, E = function() {
                            return l.getFilterManager().getTotalFilteredNodeCount()
                        }) : (w = l.getNodeTypeById(d.id).name, O = l.getNodeTypeById(d.id).count, E = function() {
                            return l.getFilterManager().getFilteredNodeCountForType(d.id)
                        }) : "et_all" === d.id ? (w = "Edges", O = l.getLinks().length, E = function() {
                            return l.getFilterManager().getTotalFilteredEdgeCount()
                        }) : (w = l.getEdgeTypeById(d.id).name, O = l.getEdgeTypeById(d.id).count, E = function() {
                            return l.getFilterManager().getFilteredEdgeCountForType(d.id)
                        }), n(), m.querySelector("button.btn-expand-range").addEventListener("click", (function() {
                            t.requestExpandedRange(d, f, h)
                        }))
                    }
                    if (h.type_names) {
                        var x = m.querySelector("span.all-types");
                        s.a.create(x, m.querySelector("ul.type_names"), {
                            position: "left"
                        })
                    }
                    return m.querySelector("button.toggle-reset").addEventListener("click", (function() {
                        g()
                    })), {
                        clear: g,
                        updateFilteredCount: n
                    }
                },
                d = function(e, t) {
                    var n, a = e.GraphHistory,
                        i = t.filter,
                        c = t.parent,
                        l = t.typeSummaries,
                        d = t.asyncRuleCallback,
                        u = function(e) {
                            var t = v[e],
                                r = t.parentNode.textContent.trim(),
                                o = {
                                    type: i.type,
                                    id: i.id,
                                    prop: i.prop,
                                    value: r
                                };
                            v[n].getAttribute("data-empty") && (o.hide_empty = !0), a.getFilterManager().getRules().filter((function(e) {
                                return e.type == i.type && e.id === i.id && e.prop === i.prop && e.value === r
                            })).length > 0 && (t.checked = !1), t.addEventListener("change", (function() {
                                var e = {
                                    rule: o
                                };
                                t.checked ? e.remove = !0 : e.add = !0, d([e])
                            }))
                        },
                        p = function(e) {
                            var t, n = [];
                            for (t = v.length - 1; t >= 0; t -= 1) {
                                if (!e && !v[t].checked) {
                                    var r = {
                                        type: i.type,
                                        id: i.id,
                                        prop: i.prop,
                                        value: v[t].parentNode.textContent.trim()
                                    };
                                    v[t].getAttribute("data-empty") && (r.hide_empty = !0), n.push({
                                        remove: !0,
                                        rule: r
                                    })
                                }
                                v[t].checked = !0
                            }
                            n.length > 0 && d(n)
                        },
                        f = l[i.id],
                        h = f.properties[i.prop],
                        g = ("nt_prop" === i.type || "et_prop" === i.type) && ("nt_all" === i.id || "et_all" === i.id),
                        m = {
                            filteredPropName: i.prop,
                            filteredTypeName: f.name,
                            color: f.color,
                            types: h.values.map((function(e) {
                                return {
                                    name: e.name,
                                    color: f.color,
                                    count: e.count,
                                    empty: e.empty
                                }
                            }))
                        };
                    if (g && (m.filteredTypeName = f.properties[i.prop].msg, m.type_names = f.properties[i.prop].type_list, m.all_types = !0), m.show_more = m.types.length > 5, m.show_more)
                        for (n = 5; n < m.types.length; n += 1) m.types[n].hide = !0;
                    var y = r.a["graphs/filter_distinct_properties_li"](m).trim().toDOM();
                    c.appendChild(y);
                    var b, v = (y = c.lastElementChild).querySelectorAll("input[type=checkbox]");
                    for (n = v.length - 1; n >= 0; n -= 1) u(n);
                    (y.querySelector("button.toggle-all").addEventListener("click", (function() {
                        p()
                    })), y.querySelector("button.toggle-none").addEventListener("click", (function() {
                        var e, t = [];
                        for (e = v.length - 1; e >= 0; e -= 1) {
                            if (v[e].checked) {
                                var n = {
                                    type: i.type,
                                    id: i.id,
                                    prop: i.prop,
                                    value: v[e].parentNode.textContent.trim()
                                };
                                v[e].getAttribute("data-empty") && (n.hide_empty = !0), t.push({
                                    rule: n,
                                    add: !0
                                })
                            }
                            v[e].checked = !1
                        }
                        t.length > 0 && d(t)
                    })), m.show_more) && y.querySelector("button.show-more").addEventListener("click", (function() {
                        var e, t = y.querySelector("ul"),
                            n = t.querySelectorAll("li.bar-block__list-item");
                        if (Object(o.N)(t, "expanded")) {
                            for (e = 5; e < n.length; e += 1) Object(o.h)(n[e], "not-shown");
                            Object(o.nb)(t, "expanded"), b.textContent = "+ MORE"
                        } else {
                            for (e = 5; e < n.length; e += 1) Object(o.nb)(n[e], "not-shown");
                            Object(o.h)(t, "expanded"), b.textContent = "- LESS"
                        }
                    }));
                    if (m.type_names) {
                        var _ = y.querySelector("span.bar-block__secondary-title");
                        s.a.create(_, y.querySelector("ul.type_names"), {
                            position: "left"
                        })
                    }
                    return {
                        clear: p
                    }
                },
                u = function(e, t) {
                    var n = t.filter,
                        r = t.typeSummaries[n.id],
                        o = r.weight,
                        a = {
                            filteredPropName: "Weight",
                            filteredTypeName: r.name,
                            color: r.color,
                            count: r.count,
                            all_types: "et_all" === n.id
                        };
                    return l(e, {
                        filter: t.filter,
                        parent: t.parent,
                        context: a,
                        asyncRuleCallback: t.asyncRuleCallback,
                        propRange: o.range,
                        requestExpandedRange: t.requestExpandedRange
                    })
                },
                p = n(6),
                f = n.n(p),
                h = function(e, t, n) {
                    var o, a, i, s = e.dispatcher,
                        l = e.uiStore,
                        d = e.graphStore,
                        u = e.GraphHistory,
                        p = !1,
                        h = t.container,
                        g = function(e) {
                            27 === e.keyCode && ("function" === typeof n ? n() : m())
                        };

                    function m() {
                        if (p) {
                            for (document.removeEventListener("keydown", g), window.removeEventListener("resize", y); h.firstChild;) h.removeChild(h.firstChild);
                            Object(c.addClass)(h, "not-shown"), p = !1, s.emit("onBarClosed", "info"), Object(c.updateUrlParam)("show", null)
                        }
                    }

                    function y() {
                        var e = a.getBoundingClientRect().top,
                            t = i.getBoundingClientRect().top;
                        a.style.height = t - e + "px"
                    }
                    return function() {
                        s.emit("onBarOpened", "info");
                        var e = t.container,
                            h = t.onEditClick,
                            m = t.onCollaboratorsClick,
                            b = t.onStatusClick,
                            v = t.onLicenseClick,
                            _ = d.get("image").url || d.get("image").path,
                            w = {
                                id: d.get("id"),
                                title: d.get("title"),
                                subtitle: d.get("subtitle"),
                                description: Object(c.transformMarkdown)(d.get("description")),
                                references: Object(c.transformMarkdown)(d.get("references")),
                                updated_at: f()(d.get("updatedAt")).fromNow(),
                                created_at: f()(d.get("createdAt")).format("MMM Do, YYYY"),
                                image: _,
                                has_image: !_.endsWith("/graphs/missing.png"),
                                license: d.get("license"),
                                nodetypes: [],
                                edgetypes: [],
                                users: d.get("users"),
                                share_url: window.location.origin + "/graphs/" + d.get("id"),
                                editable: !l.get("readOnly"),
                                is_admin: !l.get("readOnly") && d.get("user").is_admin,
                                status: d.get("status"),
                                logged_in: d.get("user").id,
                                hub: d.get("hub").name,
                                hub_id: d.get("hub").id,
                                blocked_nodes_statement: d.get("blockedNodesStatement"),
                                graph_created: !!d.get("id")
                            };
                        w.license.type = "Creative Commons " + (w.license.cc_by ? "Attribution" : "") + (w.license.cc_nc ? "-NonCommercial" : "") + (w.license.cc_sa ? "-ShareAlike" : "") + (w.license.cc_nd ? "-NoDerivatives" : "") + " 4.0 International", w.license.type_short = (w.license.cc_by ? "BY" : "") + (w.license.cc_nc ? "-NC" : "") + (w.license.cc_sa ? "-SA" : "") + (w.license.cc_nd ? "-ND" : "") + " 4.0 International", w.license.link = "http://creativecommons.org/licenses/by" + (w.license.cc_nc ? "-nc" : "") + (w.license.cc_sa ? "-sa" : "") + (w.license.cc_nd ? "-nd" : "") + "/4.0/";
                        var O = w.users;
                        w.last_user = O[O.length - 1], w.users = O.slice(0, O.length - 1);
                        var E = u.getNodeTypes();
                        d.get("belongsToHub") && (E = E.filter((function(e) {
                            return e.count > 0
                        })));
                        for (var j = 0; j < E.length; j += 1) {
                            var S = E[j].size;
                            switch (S) {
                                case "metric_degree":
                                    S = "Degree Centrality";
                                    break;
                                case "metric_betweenness":
                                    S = "Betweenness Centrality";
                                    break;
                                case "neutral":
                                    S = "Neutral"
                            }
                            w.nodetypes.push({
                                color: E[j].color,
                                name: E[j].name,
                                count: E[j].count,
                                size: S
                            })
                        }
                        w.nodetypes = w.nodetypes.sort((function(e, t) {
                            return t.count - e.count
                        }));
                        var x = u.getEdgeTypes();
                        d.get("belongsToHub") && (x = x.filter((function(e) {
                            return e.count > 0
                        })));
                        for (var k = 0; k < x.length; k += 1) w.edgetypes.push({
                            color: x[k].color,
                            name: x[k].name,
                            count: x[k].count
                        });
                        w.edgetypes = w.edgetypes.sort((function(e, t) {
                            return t.count - e.count
                        }));
                        var C = r.a["graphs/graph_info_bar"](w);
                        e.appendChild(C.trim().toDOM()), p = !0, Object(c.removeClass)(e, "not-shown"), Object(c.updateUrlParam)("show", "info"), a = e.querySelector("div.bar-content__body"), o = e.querySelector("div.bar-content__header"), i = e.querySelector("div.bar-content__footer"), Array.from(a.querySelectorAll(".linkify")).forEach((function(e) {
                            Object(c.linkifyDOM)(e)
                        }));
                        var N = a.querySelector(".gc-card-description");
                        if (N && Object(c.moreorlessify2)(document, N), w.is_admin || w.editable) {
                            o.querySelector(".edit-card").addEventListener("click", (function(e) {
                                return e.preventDefault(), h && h.call(), !1
                            }));
                            var T = a.querySelector(".graph-collaborators");
                            T && T.addEventListener("click", (function(e) {
                                return e.preventDefault(), m && m.call(), !1
                            }));
                            var L = a.querySelector(".graph-status");
                            L && L.addEventListener("click", (function(e) {
                                return e.preventDefault(), b && b.call(), !1
                            }));
                            var P = a.querySelector(".graph-license");
                            P && P.addEventListener("click", (function(e) {
                                return e.preventDefault(), v && v.call(), !1
                            }))
                        }
                        window.addEventListener("resize", y), a.classList.add("gc-custom-scrollbar"), document.addEventListener("keydown", g), i.querySelector(".gc-dlg-cancel").addEventListener("click", (function() {
                            n()
                        })), y()
                    }(), {
                        close: m
                    }
                },
                g = function(e, t) {
                    var n = t.filter,
                        r = t.typeSummaries[n.id],
                        o = r[n.centrality],
                        a = {
                            filteredPropName: {
                                degree: "Degree Centrality",
                                betweenness: "Betweenness Centrality"
                            }[n.centrality],
                            filteredTypeName: r.name,
                            color: r.color,
                            count: r.count
                        };
                    return l(e, {
                        filter: t.filter,
                        parent: t.parent,
                        context: a,
                        asyncRuleCallback: t.asyncRuleCallback,
                        propRange: o.range,
                        requestExpandedRange: t.requestExpandedRange
                    })
                },
                m = function(e, t) {
                    var n = t.filter,
                        r = t.typeSummaries[n.id],
                        a = r.properties[n.prop],
                        i = ("nt_prop" === n.type || "et_prop" === n.type) && ("nt_all" === n.id || "et_all" === n.id),
                        s = {
                            filteredPropName: n.prop,
                            filteredTypeName: r.name,
                            color: r.color,
                            count: r.count
                        };
                    return i && (r.isNodeType ? s.filteredTypeName = Object(o.k)(r.properties[n.prop].found_in, "Node Type", "Node Types") : s.filteredTypeName = Object(o.k)(r.properties[n.prop].found_in, "Edge Type", "Edge Types"), s.type_names = r.properties[n.prop].type_list, s.all_types = !0), a.missing > 0 && (s.with_missing = !0, s.missing_label = Object(o.k)(a.missing, "empty value", "empty values", "{quantity} {item}")), l(e, {
                        filter: t.filter,
                        parent: t.parent,
                        context: s,
                        asyncRuleCallback: t.asyncRuleCallback,
                        propRange: a.range,
                        requestExpandedRange: t.requestExpandedRange
                    })
                },
                y = n(92),
                b = n.n(y),
                v = n(4),
                _ = n(5),
                w = n(21),
                O = n(66),
                E = n(54),
                j = n(7),
                S = n(33),
                x = function(e, t, n) {
                    var o, a, i, l, d, u, p, f, h, g, m, y, x, k, C, N = e.dispatcher,
                        T = e.uiStore,
                        L = e.graphStore,
                        P = e.GraphHistory,
                        A = !0,
                        D = !1,
                        M = t.container,
                        q = t.svg,
                        I = t.comment_only,
                        R = t.onComment,
                        B = t.onCommentRequested,
                        F = {
                            selection: null,
                            comment: null,
                            private: 2 == L.get("status")
                        },
                        G = 2 == L.get("status"),
                        H = function(t) {
                            Object(c.copyToClipboard)(t) ? c.notify.infoWithLink("Link copied to clipboard", t, !0) : (A = !1, Object(j.copyToClipboardDialog)(e, t, (function() {
                                A = !0
                            })))
                        },
                        U = function() {
                            F = {
                                selection: null,
                                comment: null,
                                png: null,
                                pdf: null,
                                private: 2 == L.get("status")
                            }
                        },
                        z = function(e) {
                            if (27 === e.keyCode) {
                                if (!A) return;
                                "function" === typeof n ? n() : W()
                            }
                        };

                    function W() {
                        if (D) {
                            for (document.removeEventListener("keydown", z), window.removeEventListener("resize", J), C.parentNode.removeChild(C); M.firstChild;) M.removeChild(M.firstChild);
                            Object(c.addClass)(M, "not-shown"), D = !1, Object(c.updateUrlParam)("show", null)
                        }
                    }
                    var Y = null,
                        V = function() {
                            Y || clearTimeout(Y), Y = setTimeout((function() {
                                Object(c.removeClass)(p, "updating"), Y = null
                            }), 1e3)
                        },
                        X = function() {
                            console.log("full");
                            var e = C.getBoundingClientRect();
                            g = e.height - 60, h = e.width - 380, x = g, y = h, u.hide();
                            var t = p.getBoundingClientRect();
                            p.style.height = Math.floor(t.width * g / h) + "px", k = h / (t.width - 1);
                            var n = function() {
                                var e = l.getPan();
                                d.pan({
                                    x: e.x / k,
                                    y: (e.y - 60) / k
                                }), d.zoom(l.getZoom() / k), U(), Object(c.addClass)(p, "updating"), V()
                            };
                            l.setOnZoom(n), l.setOnPan(n), l.zoomIn(), l.zoomOut()
                        },
                        K = function() {
                            console.log("square");
                            var e = C.getBoundingClientRect();
                            g = e.height - 60, h = e.width - 380, m = Math.floor(.9 * Math.min(h, g)), y = m, x = m;
                            var t = m,
                                n = m;
                            u.resize(h, g, n, t);
                            var r = p.getBoundingClientRect();
                            p.style.height = r.width + "px", k = m / (r.width - 1);
                            var o = function() {
                                var e = l.getPan();
                                d.pan({
                                    x: (e.x - (h - m) / 2) / k,
                                    y: (e.y - (60 + (g - m) / 2)) / k
                                }), d.zoom(l.getZoom() / k), U(), Object(c.addClass)(p, "updating"), V()
                            };
                            l.setOnZoom(o), l.setOnPan(o), l.zoomIn(), l.zoomOut()
                        },
                        $ = function() {
                            console.log("rect");
                            var e = C.getBoundingClientRect();
                            h = e.width - 380, g = e.height - 60;
                            var t, n, r = Math.floor(.9 * h),
                                o = Math.floor(.5 * r);
                            o < g ? (t = r, n = o) : (n = Math.floor(.9 * g), t = Math.floor(n / .5)), y = t, x = n, u.resize(h, g, t, n);
                            var a = t,
                                i = p.getBoundingClientRect();
                            p.style.height = Math.floor(i.width / 2) + "px", k = a / (i.width - 1);
                            var s = function() {
                                var e = l.getPan();
                                d.pan({
                                    x: (e.x - (h - t) / 2) / k,
                                    y: (e.y - (60 + (g - n) / 2)) / k
                                }), d.zoom(l.getZoom() / k), U(), Object(c.addClass)(p, "updating"), V()
                            };
                            l.setOnZoom(s), l.setOnPan(s), l.zoomIn(), l.zoomOut()
                        },
                        Z = function() {
                            var e = C.getBoundingClientRect();
                            g = e.height - 60, h = e.width - 380, m = Math.floor(.9 * Math.min(h, g));
                            var t = parent.querySelector("div.capture-bounds-top"),
                                n = parent.querySelector("div.capture-bounds-left"),
                                r = parent.querySelector("div.capture-bounds-right"),
                                o = parent.querySelector("div.capture-bounds-bottom");
                            t.style.top = 0, t.style.height = 60 + (g - m) / 2 + "px", t.style.width = h + "px", o.style.top = 60 + (g - m) / 2 + m + "px", o.style.height = (g - m) / 2 + "px", o.style.width = h + "px", n.style.top = 60 + (g - m) / 2 + "px", n.style.left = 0, n.style.height = m + "px", n.style.width = (h - m) / 2 + "px", r.style.top = 60 + (g - m) / 2 + "px", r.style.left = m + (h - m) / 2 + "px", r.style.height = m + "px", r.style.width = (h - m) / 2 + "px";
                            var a = p.getBoundingClientRect();
                            p.style.height = a.width + "px", k = m / (a.width - 1)
                        };

                    function J() {
                        var e = a.getBoundingClientRect().top,
                            t = i.getBoundingClientRect().top;
                        a.style.height = t - e + "px", Z()
                    }
                    var Q = function(e) {
                            for (var t = [], n = /\[[#]([^\]]+)\]\((\w{8}-\w{4}-\w{4}-\w{4}-\w{12})\)/gi;;) {
                                var r = n.exec(e);
                                if (!r) break;
                                t.push(r[2])
                            }
                            return t
                        },
                        ee = function(t, n, r) {
                            var o = f.getText(),
                                a = {
                                    selection: {
                                        image: t,
                                        description: E.addIdsForNodeReferences(e, o),
                                        node_ids: Q(o)
                                    },
                                    graph: L.get("id")
                                };
                            Object(_.createSelection)(a, (function(e) {
                                F.selection = e, "function" === typeof n && n(F)
                            }), (function() {
                                "function" === typeof r && r("Unable to create selection")
                            }))
                        };

                    function te() {
                        var e = {
                                width: y,
                                height: x,
                                left: (h - y) / 2,
                                top: 60 + (g - x) / 2
                            },
                            t = C.querySelector("svg");
                        return Object(c.exportSVG2)(t, e, !0)
                    }

                    function ne(t) {
                        w.a.getUser() ? Object(j.showWaitMessage)(e, "Saving comment with image", "Please wait", (function(n) {
                            Object(S.getPNGDataURL)(te(), {
                                width: y,
                                height: x
                            }).then((function(r) {
                                return function(t, n, r, o) {
                                    var a = {
                                        image: n,
                                        text: Object(E.addIdsForNodeReferences)(e, t)
                                    };
                                    Object(_.postComment)(L.get("id"), a, (function(e) {
                                        F.comment = e.comment, F.comment.url += "?auto=true", T.set("lastCommentText", null), N.emit("onCommentCountUpdated", e.comment_count), "function" === typeof r && r(F)
                                    }), (function() {
                                        "function" === typeof o && o("Unable to create selection")
                                    }))
                                }(t, r, (function() {
                                    n(), f.clear(), R ? (R(), c.notify.info("Comment added to graph", !0)) : c.notify.infoWithCallback("Comment added to graph", (function() {
                                        B()
                                    }), !0)
                                }), (function(e) {
                                    n(), f.clear(), console.error("Error while commenting with image", e)
                                }))
                            }))
                        })) : Object(c.showAuthentication)(e, {
                            onSignedIn: null,
                            onSignUp: null
                        })
                    }
                    var re = function(e) {
                            return e.replace(/\[[#]([^\]]+)\]\((\w{8}-\w{4}-\w{4}-\w{4}-\w{12})\)/gi, "$1")
                        },
                        oe = function() {
                            Object(j.showWaitMessage)(e, "Setting as graph cover", "Please wait", (function(e) {
                                Object(S.getPNGDataURL)(te(), {
                                    width: y,
                                    height: x
                                }).then((function(t) {
                                    return function(e, t, n) {
                                        Object(_.updateGraph)(L.get("id"), {
                                            graph: {
                                                image: e
                                            }
                                        }, (function() {
                                            Object(v.a)("#pnlGraphCover").css("background-image", "url('" + e + "')"), "function" === typeof t && t(F)
                                        }), (function() {
                                            "function" === typeof n && n("Failed to save graph cover")
                                        }))
                                    }(t, (function() {
                                        e(), c.notify.infoWithCallback("Image saved as graph cover", (function() {
                                            Object(v.a)("#btnEnterGraph").removeAttr("disabled"), Object(v.a)("#btnEnterGraph").removeClass("not-shown"), Object(v.a)("#btnGraphLoading").addClass("not-shown"), Object(v.a)("#pnlGraphCover").fadeIn()
                                        }), !0)
                                    }), (function(t) {
                                        e(), console.log("Image cover handling error", t)
                                    }))
                                }))
                            }))
                        },
                        ae = function() {
                            a.querySelector(".for-selection a.png-share").addEventListener("click", (function(t) {
                                return t.preventDefault(), Object(j.showWaitMessage)(e, "Creating PDF Document", "Please wait", (function(e) {
                                    Object(S.downloadPNGFile)(te(), {
                                        fileName: L.get("title") || "Untitled Graph",
                                        width: y,
                                        height: x
                                    }).then(e)
                                })), !1
                            })), a.querySelector(".for-selection a.pdf-share").addEventListener("click", (function(t) {
                                return t.preventDefault(), Object(j.showWaitMessage)(e, "Creating PDF Document", "Please wait", (function(e) {
                                    Object(S.downloadPDFFile)(te(), {
                                        fileName: L.get("title") || "Untitled Graph",
                                        width: y,
                                        height: x
                                    }).then(e)
                                })), !1
                            })), a.querySelector(".for-selection a.tw-share").addEventListener("click", (function(t) {
                                return t.preventDefault(), F.selection ? Object(c.shareOnTwitter)({
                                    url: F.selection.url,
                                    text: re(F.selection.description) || ""
                                }) : F.comment ? Object(c.shareOnTwitter)({
                                    url: F.comment.url,
                                    text: re(F.comment.text) || ""
                                }) : Object(j.showWaitMessage)(e, "Saving Selection", "Please wait", (function(e) {
                                    Object(S.getPNGDataURL)(te(), {
                                        width: y,
                                        height: x
                                    }).then((function(t) {
                                        return ee(t, (function() {
                                            e(), F.selection && Object(c.shareOnTwitter)({
                                                url: F.selection.url,
                                                text: re(F.selection.description) || ""
                                            })
                                        }), (function(t) {
                                            e(), console.error("Twitter handling error", t)
                                        }))
                                    }))
                                })), !1
                            })), a.querySelector(".for-selection a.fb-share").addEventListener("click", (function(t) {
                                return t.preventDefault(), F.selection ? Object(c.shareOnFacebook)({
                                    url: F.selection.url
                                }) : F.comment ? Object(c.shareOnFacebook)({
                                    url: F.comment.url
                                }) : Object(j.showWaitMessage)(e, "Saving Selection", "Please wait", (function(e) {
                                    Object(S.getPNGDataURL)(te(), {
                                        width: y,
                                        height: x
                                    }).then((function(t) {
                                        return ee(t, (function() {
                                            e(), Object(c.shareOnFacebook)({
                                                url: F.selection.url
                                            })
                                        }), (function(t) {
                                            e(), console.error("Facebook handling error", t)
                                        }))
                                    }))
                                })), !1
                            })), a.querySelector(".for-selection a.link-share").addEventListener("click", (function(t) {
                                return t.preventDefault(), F.selection ? G ? Object(j.shareableLink)(e, {
                                    fnLinkGenerator: Object(c.PrivateSelectionLinkBuilder)(F.selection)
                                }) : H(F.selection.url) : F.comment ? G ? Object(j.shareableLink)(e, {
                                    fnLinkGenerator: Object(c.PrivateCommentLinkBuilder)(F.comment)
                                }) : H(F.comment.url) : Object(j.showWaitMessage)(e, "Saving Selection", "Please wait", (function(t) {
                                    Object(S.getPNGDataURL)(te(), {
                                        width: y,
                                        height: x
                                    }).then((function(n) {
                                        return ee(n, (function() {
                                            t(), G ? Object(j.shareableLink)(e, {
                                                fnLinkGenerator: Object(c.PrivateSelectionLinkBuilder)(F.selection)
                                            }) : H(F.selection.url)
                                        }), (function(e) {
                                            t(), console.error("Error while saving selection", e)
                                        }))
                                    }))
                                })), !1
                            })), a.querySelector(".for-selection a.svg-share").addEventListener("click", (function(t) {
                                return t.preventDefault(), Object(j.showWaitMessage)(e, "Exporting SVG", "Please wait", (function(e) {
                                    Object(S.downloadSVGFile)(te(), {
                                        fileName: L.get("title") || "Untitled Graph"
                                    }).then(e)
                                })), !1
                            })), T.get("readOnly") || a.querySelector(".for-selection a.set-cover-image").addEventListener("click", (function(e) {
                                return e.preventDefault(), oe(), !1
                            }))
                        },
                        ie = function() {
                            var t, n, r = (t = [Object(c.getBaseURL)(), "/graphs/", L.get("id")], (n = P.getSelectedNodes()).length > 0 && (t.push("/selections/"), t.push(n.join(","))), t.join(""));
                            o.querySelector(".for-graph a.link-share").addEventListener("click", (function(t) {
                                return t.preventDefault(), 2 != L.get("status") ? H(r) : Object(j.shareableLink)(e), !1
                            })), o.querySelector(".for-graph a.embed-share").addEventListener("click", (function(t) {
                                return t.preventDefault(), A = !1, Object(j.embedDialog)(e, L.get("id"), (function() {
                                    A = !0, Object(c.updateUrlParam)("show", "share")
                                })), !1
                            }))
                        };

                    function se() {
                        var e = C.querySelector("svg g").getBoundingClientRect();
                        return {
                            width: e.width,
                            height: e.height,
                            top: e.top,
                            left: e.left
                        }
                    }
                    return function() {
                        N.emit("onBarOpened", "share");
                        var m = t.container,
                            v = t.onCollaboratorsClick,
                            _ = t.onStatusClick,
                            w = {
                                svg: q,
                                allow_set_cover_image: !T.get("readOnly"),
                                comment_only: I,
                                is_admin: !T.get("readOnly") && L.get("user").is_admin,
                                status: L.get("status")
                            },
                            E = r.a["graphs/share_bar"](w);
                        m.appendChild(E.trim().toDOM()), E = r.a["graphs/svg_capture_panel"]({
                            svg: q
                        }), document.body.appendChild(E.trim().toDOM()), (C = document.querySelector("div#svg-capture")).style.zIndex = 0, C.querySelector("svg g").setAttribute("transform", "matrix(1, 0, 0, 1, 0, 0)");
                        var j = C.querySelector("style");
                        C.querySelector("defs").appendChild(j);
                        var S = C.querySelector("svg rect");
                        S.parentNode.removeChild(S), l = b()(C.querySelector("svg"), {
                            minZoom: 0,
                            maxZoom: 100,
                            fit: !1,
                            contain: !1
                        });
                        var k = t.transform.replace("matrix(", "").replace(")", "").split(",");
                        (l.zoom(Number(k[0].trim())), l.pan({
                            x: Number(k[4].trim()),
                            y: Number(k[5].trim())
                        }), u = Object(O.a)(C), (p = m.querySelector("div.share-preview")).querySelector("svg g").setAttribute("transform", "matrix(1, 0, 0, 1, 0, 0)"), (d = b()(p.querySelector("svg"), {
                            panEnabled: !1,
                            zoomEnabled: !1,
                            dblClickZoomEnabled: !1,
                            fit: !1,
                            contain: !1,
                            minZoom: 0,
                            maxZoom: 100,
                            beforePan: function() {
                                V()
                            },
                            beforeZoom: function() {
                                V()
                            }
                        })).setOnZoom((function() {
                            V()
                        })), d.setOnPan((function() {
                            V()
                        })), d.setBeforeZoom((function() {
                            V()
                        })), d.setBeforePan((function() {
                            V()
                        })), (Z = K)(), D = !0, Object(c.removeClass)(m, "not-shown"), Object(c.updateUrlParam)("show", "share"), a = m.querySelector("div.bar-content__body"), o = m.querySelector("div.bar-content__header"), i = m.querySelector("div.bar-content__footer"), w.is_admin && o) && (o.querySelector(".graph-collaborators").addEventListener("click", (function(e) {
                            return e.preventDefault(), v && v.call(), !1
                        })), o.querySelector(".graph-status").addEventListener("click", (function(e) {
                            return e.preventDefault(), _ && _.call(), !1
                        })));
                        window.addEventListener("resize", J), a.classList.add("gc-custom-scrollbar"), document.addEventListener("keydown", z), i.querySelector(".gc-dlg-cancel").addEventListener("click", (function() {
                            n()
                        }));
                        var A = "",
                            M = P.getSelectedNodes();
                        M && (A += M.map((function(e) {
                            return "[#" + P.getNodeById(e).name + "]"
                        })).join(" "));
                        (t.comment_text && (A += t.comment_text), (f = Object(c.CommentEntry)(e, {
                            root: a.querySelector("div.comment-entry"),
                            initial_text: A,
                            onSubmit: function(e) {
                                ne(e)
                            },
                            onTextUpdated: function() {
                                F.selection = null, F.comment = null
                            }
                        })).focus(), !I && w.is_admin) && (ae(), ie(), o && o.querySelectorAll(".toggle-tip").forEach((function(e) {
                            s.a.create(e, {
                                position: "bottom",
                                hideOnClickOutside: !0
                            })
                        })));
                        ! function() {
                            C.querySelector("button.reset").addEventListener("click", (function() {
                                var e = se(),
                                    t = e.height + 30,
                                    n = x / t;
                                e.width * n > y && (t = e.width + 30, n = y / t), l.zoom(l.getZoom() * n), setTimeout((function() {
                                    var e = se(),
                                        t = l.getPan(),
                                        n = Math.floor((h - y) / 2),
                                        r = Math.floor((g - x) / 2);
                                    l.pan({
                                        x: t.x + (n - e.left + .5 * (y - e.width)),
                                        y: t.y + (60 + r - e.top + .5 * (x - e.height))
                                    })
                                }), 10)
                            })), C.querySelector("button.zoom-in").addEventListener("click", (function() {
                                l.zoomIn()
                            })), C.querySelector("button.zoom-out").addEventListener("click", (function() {
                                l.zoomOut()
                            }));
                            var e = C.querySelector("button.capture-square");
                            e.addEventListener("click", (function() {
                                Z = $, $(), Object(c.addClass)(n, "not-shown"), Object(c.addClass)(e, "not-shown"), Object(c.removeClass)(t, "not-shown")
                            }));
                            var t = C.querySelector("button.capture-rectangle");
                            t.addEventListener("click", (function() {
                                Z = X, X(), Object(c.addClass)(t, "not-shown"), Object(c.addClass)(e, "not-shown"), Object(c.removeClass)(n, "not-shown")
                            }));
                            var n = C.querySelector("button.capture-full");
                            n.addEventListener("click", (function() {
                                Z = K, K(), Object(c.addClass)(t, "not-shown"), Object(c.addClass)(n, "not-shown"), Object(c.removeClass)(e, "not-shown")
                            }))
                        }(), J()
                    }(), {
                        close: W
                    }
                },
                k = n(55),
                C = function(e, t, o) {
                    var a, i, l, d, u, p, h = e.dispatcher,
                        g = e.uiStore,
                        m = e.graphStore,
                        y = function() {
                            document.removeEventListener("keydown", v), Object(c.updateUrlParam)("show", null)
                        },
                        b = !1;

                    function v(e) {
                        if (27 === e.keyCode) {
                            if (b) return;
                            "function" === typeof o ? o() : y()
                        }
                    }
                    var w, O = function() {
                            var e = a.querySelector(".bar-content__body-empty");
                            Array.from(d.querySelectorAll("li")).length > 0 ? Object(c.addClass)(e, "not-shown") : Object(c.removeClass)(e, "not-shown")
                        },
                        E = function(e) {
                            if (Object(c.removeClass)(a, "not-shown"), b = !1, e) {
                                "featured" !== w && "published" !== w || C();
                                var t = d.querySelector('li[data-id="' + e.id + '"]');
                                t ? function(e, t) {
                                    e.querySelector(".story-title").innerHTML = t.title, e.querySelector('span[data-name="slides-count"]').innerHTML = Object(c.buildNumericText)(t.slides.length - 1, "Slide", "Slides");
                                    var n = e.querySelector(".view-story"),
                                        r = e.querySelector("div.no-image");
                                    t.image ? (n.src = t.image, Object(c.removeClass)(n, "not-shown"), Object(c.addClass)(r, "not-shown")) : (Object(c.addClass)(n, "not-shown"), Object(c.removeClass)(r, "not-shown"))
                                }(t, e) : (T(e, !0), B.unshift(e))
                            }
                            O()
                        },
                        S = function(e) {
                            if (b = !1, e) o();
                            else {
                                var t = B.find((function(e) {
                                    return 1 == e.status
                                }));
                                if (m.get("belongsToHub") && t) switch (Object(c.removeClass)(p, "not-shown"), w) {
                                    case "published":
                                        w = "", x();
                                        break;
                                    default:
                                        w = "", C()
                                } else Object(c.addClass)(p, "not-shown"), w = "", C()
                            }
                        };

                    function x() {
                        if ("published" !== w) {
                            for (w = "published"; d.firstChild;) d.removeChild(d.firstChild);
                            B.filter((function(e) {
                                return 1 == e.status
                            })).forEach((function(e) {
                                T(e)
                            })), Object(c.removeClass)(u, "underlined"), Object(c.addClass)(p, "underlined")
                        }
                    }

                    function C() {
                        if ("all" !== w) {
                            for (null, w = "all"; d.firstChild;) d.removeChild(d.firstChild);
                            B.forEach((function(e) {
                                T(e)
                            })), Object(c.addClass)(u, "underlined"), Object(c.removeClass)(p, "underlined")
                        }
                    }
                    var N = function(e, t) {
                        Object(c.addClass)(a, "not-shown"), b = !0, M({
                            storyId: e,
                            selectedSlide: t,
                            onClose: function(e) {
                                E(e), P(e.id)
                            },
                            start_with_help: m.get("user").need_story_help
                        })
                    };

                    function T(t, n) {
                        var o = Object.prototype.hasOwnProperty.call(t, "slides_count") ? t.slides_count : t.slides.length - 1,
                            a = {
                                id: t.id,
                                title: t.title,
                                image: t.image,
                                slides_count: Object(c.buildNumericText)(o, "Slide", "Slides"),
                                created_at: f()(t.created_at).fromNow(),
                                allow_delete: t.allow_edit,
                                allow_feature_update: !g.get("readOnly"),
                                featured: t.featured
                            },
                            i = r.a["graphs/story_block"](a);
                        n ? d.insertBefore(i.trim().toDOM(), d.firstChild) : d.appendChild(i.trim().toDOM());
                        var s = d.querySelector('li[data-id="' + t.id + '"]');
                        a.allow_delete && (s.querySelector(".delete-story").addEventListener("click", (function(t) {
                            var n;
                            return t.preventDefault(), this.blur(), n = a.id, Object(j.confirm)(e, "Are you sure to delete this story?", "", (function() {
                                var e = d.querySelector('li[data-id="' + n + '"]');
                                d.removeChild(e), Object(_.deleteStory)(n, (function() {
                                    c.notify.info("Deleted story", !0)
                                }), (function() {
                                    c.notify.error("Failed to delete story", !0)
                                })), B = B.filter((function(e) {
                                    return e.id !== n
                                })), O()
                            })), !1
                        })), s.querySelector(".edit-story").addEventListener("click", (function(e) {
                            return e.preventDefault(), this.blur(), I(a.id), !1
                        })));
                        Array.from(s.querySelectorAll(".view-story")).forEach((function(e) {
                            e.addEventListener("click", (function(e) {
                                return e.preventDefault(), P(a.id), !1
                            }))
                        }))
                    }
                    var L = function(e) {
                        P(e)
                    };

                    function P(t) {
                        b = !0, Object(k.ReadOnlyStoryView)(e, {
                            storyId: t,
                            onRequestEdit: N,
                            onClose: S,
                            onRelatedStoryRequested: L,
                            onGraphRequested: function() {
                                S(!0)
                            },
                            parent: document.body,
                            disableClose: !1,
                            updateUrl: !0,
                            onPublishChanged: D
                        })
                    }
                    var A = function(e, n) {
                        var r;
                        (B = e, m.get("belongsToHub") && (r = B.find((function(e) {
                            return 1 == e.status
                        }))), r ? (x(), Object(c.removeClass)(p, "not-shown")) : (Object(c.addClass)(p, "not-shown"), Object(c.addClass)(u, "not-shown"), C()), 0 != e.length || g.get("readOnly")) && (t.storyId ? B.find((function(e) {
                            return e.id === t.storyId
                        })) && (b = !0, t.withEdit ? I(t.storyId) : P(t.storyId)) : t.newStory && !g.get("readOnly") && q());
                        O(), Object(c.addClass)(a, "loaded"), n()
                    };

                    function D(e, t) {
                        if (m.get("belongsToHub")) {
                            var n = B.find((function(t) {
                                return t.id = e
                            }));
                            n && (n.status = t)
                        }
                    }

                    function M(t) {
                        t.belongs_to_hub = m.get("belongsToHub"), t.onPublishChanged = D, Object(k.StoryView)(e, t), m.get("user").need_story_help && (Object(_.updateUser)(m.get("user").id, {
                            need_story_help: !1
                        }), m.get("user").need_story_help = !1)
                    }

                    function q(e) {
                        if (m.get("isWebGL")) {
                            var r = Object(c.getURLParamsHash)(Object(c.getURLParams)());
                            r.webgl = "false", r.show = "stories", Promise.resolve().then(n.bind(null, 55)), r.auto = "true", r.new = "true";
                            var o = "/graphs/" + m.get("id") + Object(c.buildUrlParams)(r);
                            Object(c.redirectTo)(o)
                        } else {
                            Object(c.addClass)(a, "not-shown"), b = !0;
                            var i = {
                                svg_data: t.canvas.getSVGData(!0),
                                transform: t.canvas.getTransform(),
                                onClose: E,
                                start_with_help: m.get("user").need_story_help || e
                            };
                            m.get("belongsToHub") && (i.hub = {
                                id: m.get("hub").id,
                                name: m.get("hub").name
                            }), M(i)
                        }
                    }

                    function I(e, t) {
                        Object(c.addClass)(a, "not-shown"), b = !0, M({
                            storyId: e,
                            onClose: function(n) {
                                E(n), t && P(e)
                            },
                            start_with_help: m.get("user").need_story_help
                        })
                    }
                    var R = function(e, t) {
                        h.emit("onBarOpened", "stories"), Object(c.updateUrlParam)("show", "stories"), Promise.resolve().then(n.bind(null, 55));
                        var f = e.container,
                            b = {
                                allow_create: !g.get("readOnly")
                            },
                            w = r.a["graphs/stories_bar"](b);
                        (f.appendChild(w.trim().toDOM()), a = f.querySelector(".bar__stories"), i = a.querySelector(".bar-content__body"), (u = a.querySelector(".btnShowAll")).addEventListener("click", (function(e) {
                            return e.preventDefault(), C(), !1
                        })), (p = a.querySelector(".btnShowPublished")).addEventListener("click", (function(e) {
                            return e.preventDefault(), x(), !1
                        })), d = i.querySelector("ul"), (l = a.querySelector(".bar-content__footer")).querySelector(".gc-dlg-cancel").addEventListener("click", (function() {
                            "function" === typeof o ? o() : y()
                        })), b.allow_create) && (a.querySelector("#btnStartStory").addEventListener("click", (function(e) {
                            return e.preventDefault(), this.blur(), q(), !1
                        })), s.a.create(a.querySelector(".toggle-tip"), {
                            size: "medium",
                            maxWidth: 150
                        }), a.querySelector(".btnStartGuidedStory").addEventListener("click", (function(e) {
                            return e.preventDefault(), Object(c.hideTipped)(), q(!0), !1
                        })));
                        i.classList.add("gc-custom-scrollbar"),
                            function() {
                                var e = i.getBoundingClientRect().top,
                                    t = l.getBoundingClientRect().top;
                                i.style.height = t - e + "px"
                            }(), document.addEventListener("keydown", v), Object(_.getStories)(m.get("id"), null, (function(e) {
                                A(e, t)
                            }), (function() {
                                t()
                            }))
                    };
                    Object(j.showWaitMessage)(e, "Retrieving Stories", "Please wait", (function(e) {
                        R(t, (function() {
                            t.onReady && t.onReady(), e()
                        }))
                    }));
                    var B = null;
                    return {
                        close: y
                    }
                },
                N = n(35),
                T = n.n(N),
                L = function(e, t) {
                    var n, a, i, l, d = e.dispatcher,
                        u = e.uiStore,
                        p = e.graphStore,
                        f = e.GraphHistory,
                        h = u.get("readOnly"),
                        g = f.getAnalysisManager(),
                        m = g.getClusters(),
                        y = t.parent;
                    m && m.length > 0 ? (a = {
                        clusters: m.map((function(e, t) {
                            return {
                                id: e.id,
                                count: e.nodes.length,
                                percentage: Math.ceil(e.nodes.length / f.getNodes().length * 100),
                                name: e.name,
                                index: t,
                                color: e.color || "#000",
                                hide: t >= 5
                            }
                        })),
                        show_more: m.length > 5,
                        resolution: g.getClusteringResolution()
                    }, n = h ? r.a["graphs/readonly_cluster_analysis_block"](a).trim().toDOM() : r.a["graphs/cluster_analysis_block"](a).trim().toDOM()) : n = r.a["graphs/empty_cluster_analysis_block"](a).trim().toDOM(), y.childNodes.length > 0 ? (y.insertBefore(n, y.childNodes[0]), l = y.querySelector("li")) : (y.appendChild(n), l = y.lastElementChild);
                    var b = function(e) {
                        var n = e.getAttribute("data-id"),
                            r = e.getAttribute("data-index"),
                            a = e.querySelector("input.bar-block__cluster-name-input");
                        a.addEventListener("focus", (function() {
                                var e = this.parentNode.parentNode;
                                return i !== e && (i = e, f.clearSelectedNodes(), f.selectCluster(m[parseInt(r)]), t.onNodeBlockClicked && t.onNodeBlockClicked(e)), !1
                            })),
                            function(e, t) {
                                var n, r = p.get("id");
                                e.addEventListener("focus", (function() {
                                    n = e.value.trim()
                                })), e.addEventListener("blur", (function() {
                                    var o = e.value.trim();
                                    n !== o && (Object(_.updateCluster)(r, t, {
                                        name: o
                                    }), f.getAnalysisManager().getClusters().find((function(e) {
                                        return e.id === t
                                    })).name = o, d.emit("onClustersUpdated"))
                                }))
                            }(a, n),
                            function(e) {
                                var n = p.get("id"),
                                    r = e.getAttribute("data-id"),
                                    a = e.querySelector("svg"),
                                    i = e.querySelector('input[type="color"]'),
                                    s = e.querySelector('input[type="text"].bar-block__cluster-name-input'),
                                    c = e.querySelector("span.bar-block__lit-item-count");
                                a.addEventListener("click", (function() {
                                    i.click()
                                }));
                                var l = null,
                                    u = function(e) {
                                        a.querySelector("g#Group").setAttribute("fill", e), c.style.color = e, s.style.color = e, Object(_.updateCluster)(n, r, {
                                            color: e
                                        });
                                        var o = f.getAnalysisManager().getClusters();
                                        o && o.filter((function(e) {
                                            return e.id === r
                                        })).forEach((function(t) {
                                            t.color = e
                                        })), d.emit("onClustersUpdated"), t.onClusterColorChanged && t.onClusterColorChanged(), l = null
                                    };
                                i.addEventListener("change", (function() {
                                    var e = this.value;
                                    l ? clearTimeout(l) : l = setTimeout((function() {
                                        u(e)
                                    }), 1e3)
                                })), Array.from(e.querySelectorAll("ul li a.btnUpdateClusterColor")).forEach((function(e) {
                                    e.addEventListener("click", (function(e) {
                                        return e.preventDefault(), Object(o.P)(), i.click(), !1
                                    }))
                                }))
                            }(e), Array.from(e.querySelectorAll("ul li a.btnListClusterNodes")).forEach((function(e) {
                                e.addEventListener("click", (function(e) {
                                    return e.preventDefault(), Object(o.P)(), t.onListClusterNodesRequested(n), !1
                                }))
                            }))
                    };
                    if (m && m.length > 0) {
                        var v = l.querySelectorAll("li.bar-block__list-item");
                        if (h)
                            for (var w = 0; w < v.length; w += 1) {
                                v[w].querySelector("a.bar-block__list-item-name").addEventListener("click", (function(e) {
                                    e.preventDefault();
                                    var n = this.getAttribute("data-index");
                                    f.clearSelectedNodes(), f.selectCluster(m[parseInt(n)]);
                                    var r = this.parentNode.parentNode.parentNode;
                                    return r !== i && (i = r, t.onNodeBlockClicked && t.onNodeBlockClicked(r)), !1
                                }))
                            } else {
                                for (var O = 0; O < v.length; O += 1) b(v[O]);
                                s.a.create(".toggle-clustering-color-tip", {
                                    position: "bottomleft",
                                    size: "small",
                                    hideOnClickOutside: !0
                                }), s.a.create(".toggle-clustering-tip", {
                                    position: "bottom",
                                    size: "small",
                                    hideOnClickOutside: !0
                                }), s.a.create(l.querySelector(".toggle-tip"), {
                                    position: "bottom",
                                    size: "small",
                                    hideOnClickOutside: !0
                                })
                            }
                        var E = l.querySelector("button.highlight-clusters"),
                            j = l.querySelector(".cluster-label-size-adjust");
                        j.querySelector("#btnIncreaseClusterLabelSize").addEventListener("click", (function(e) {
                            return e.preventDefault(), t.onClusterLabelSizeIncreaseRequested(), !1
                        })), j.querySelector("#btnDecreaseClusterLabelSize").addEventListener("click", (function(e) {
                            return e.preventDefault(), t.onClusterLabelSizeDecreaseRequested(), !1
                        }));
                        var S = function() {
                            Object(o.N)(E, "toggled-on") ? (E.innerHTML = "Show", Object(o.nb)(E, "toggled-on"), Object(o.h)(E, "toggled-off"), Object(o.h)(j, "not-shown"), t.onClusterColorsToggleRequested && t.onClusterColorsToggleRequested(!1)) : (E.innerHTML = "Hide", Object(o.h)(E, "toggled-on"), Object(o.nb)(E, "toggled-off"), Object(o.nb)(j, "not-shown"), Object(c.getFromLocalStorage)("seenClusterLabelScaleHelp") || window.requestAnimationFrame((function() {
                                Object(c.HelpDisplay)({
                                    target: j,
                                    position: "bottom",
                                    title: "Adjust Label Sizes",
                                    message: "You can change the size of cluster labels here"
                                }), Object(c.storeInLocalStorage)("seenClusterLabelScaleHelp", !0)
                            })), t.onClusterColorsToggleRequested && t.onClusterColorsToggleRequested(!0)), E.blur()
                        };
                        if (E.addEventListener("click", S), a.show_more) {
                            var x = l.querySelector("div.show-more button");
                            x.addEventListener("click", (function() {
                                var e, t = v[0].parentNode;
                                if (Object(o.N)(t, "expanded")) {
                                    for (e = 5; e < v.length; e += 1) Object(o.h)(v[e], "not-shown");
                                    Object(o.nb)(t, "expanded"), x.textContent = "+ MORE"
                                } else {
                                    for (e = 5; e < v.length; e += 1) Object(o.nb)(v[e], "not-shown");
                                    Object(o.h)(t, "expanded"), x.textContent = "- LESS"
                                }
                            }))
                        }
                        t.highlightClustersOnStart && S()
                    }
                    h || l.querySelector("button.run-cluster").addEventListener("click", (function() {
                        t.onClusterRunRequested && t.onClusterRunRequested()
                    }))
                },
                P = function(e, t) {
                    var n = e.GraphHistory,
                        o = n.getAnalysisManager(),
                        a = t.rule,
                        i = t.parent,
                        s = o.calculateTopForRule(a),
                        c = n.getNodeTypeById(a.id),
                        l = {
                            title: ["Top", s.length, a.prop].join(" "),
                            type: c.name,
                            headerColor: c.color,
                            types: s
                        },
                        d = r.a["graphs/nominal_analysis_block"](l).trim().toDOM();
                    i.appendChild(d), i.lastElementChild.querySelector("button.show-chart").addEventListener("click", (function() {
                        t.onChartRequested && t.onChartRequested()
                    }))
                },
                A = function(e, t) {
                    var n, o, a, i = e.GraphHistory,
                        s = i.getAnalysisManager(),
                        c = t.rule,
                        l = t.parent,
                        d = s.calculateTopForRule(c);
                    if ("All" === c.id) n = ["Top", d.length, "Nodes"].join(" "), a = "#333";
                    else {
                        var u = i.getNodeTypeById(c.id);
                        n = ["Top", d.length, u.name].join(" "), a = u.color
                    }
                    if (c.analysis) switch (c.analysis) {
                        case "Degree Centrality":
                            o = "Connections";
                            break;
                        case "Betweenness Centrality":
                            o = "Betweenness"
                    } else o = c.prop, d.forEach((function(e) {
                        e.count = e.value
                    }));
                    var p = {
                            title: n,
                            orderBy: o,
                            headerColor: a,
                            types: d
                        },
                        f = r.a["graphs/default_analysis_block"](p).trim().toDOM();
                    l.appendChild(f);
                    for (var h = l.lastElementChild.querySelectorAll("a.bar-block__list-item-name"), g = 0; g < h.length; g += 1) h[g].addEventListener("click", (function(e) {
                        e.preventDefault();
                        var n = this.getAttribute("data-node");
                        i.focusNode(n);
                        var r = this.parentNode.parentNode.parentNode;
                        return t.onNodeBlockClicked && t.onNodeBlockClicked(r), !1
                    }));
                    l.lastElementChild.querySelector("button.show-chart").addEventListener("click", (function() {
                        t.onChartRequested && t.onChartRequested()
                    }))
                },
                D = n(77),
                M = n(349),
                q = n.n(M),
                I = n(350),
                R = n.n(I),
                B = n(16);

            function F(e, t, n, r, o, a, i) {
                try {
                    var s = e[a](i),
                        c = s.value
                } catch (l) {
                    return void n(l)
                }
                s.done ? t(c) : Promise.resolve(c).then(r, o)
            }

            function G(e) {
                return function() {
                    var t = this,
                        n = arguments;
                    return new Promise((function(r, o) {
                        var a = e.apply(t, n);

                        function i(e) {
                            F(a, r, o, i, s, "next", e)
                        }

                        function s(e) {
                            F(a, r, o, i, s, "throw", e)
                        }
                        i(void 0)
                    }))
                }
            }

            function H(e) {
                var t = new q.a({
                        type: "directed",
                        multi: !0
                    }),
                    n = {};
                return e.getNodes().forEach((function(e) {
                    t.addNode(e.id, Object(B.omit)(e, ["id", "edges"])), (e.edges || []).forEach((function(e) {
                        return n[e.id] = e
                    }))
                })), Object(B.values)(n).forEach((function(e) {
                    t.addEdge(e.from, e.to, Object(B.omit)(e, ["id", "from", "to"]))
                })), t
            }

            function U(e, t) {
                return z.apply(this, arguments)
            }

            function z() {
                return (z = G(T.a.mark((function e(t, n) {
                    var r, o, a;
                    return T.a.wrap((function(e) {
                        for (;;) switch (e.prev = e.next) {
                            case 0:
                                return r = R()(t, n), o = {}, t.nodes().forEach((function(e) {
                                    var t = o[r[e]];
                                    t || (t = o[r[e]] = {
                                        name: "",
                                        nodes: [],
                                        head_node_id: null
                                    }), t.nodes.push(e)
                                })), (a = Object(B.values)(o)).forEach((function(e) {
                                    e.head_node_id = Object(B.sortBy)(e.nodes, (function(e) {
                                        return -t.degree(e)
                                    }))[0]
                                })), e.abrupt("return", Promise.resolve(a));
                            case 6:
                            case "end":
                                return e.stop()
                        }
                    }), e)
                })))).apply(this, arguments)
            }

            function W(e, t, n, r, o, a, i) {
                try {
                    var s = e[a](i),
                        c = s.value
                } catch (l) {
                    return void n(l)
                }
                s.done ? t(c) : Promise.resolve(c).then(r, o)
            }
            var Y = function(e, t) {
                    var n = e.dispatcher,
                        a = e.uiStore,
                        i = e.graphStore,
                        s = e.GraphHistory,
                        c = "" === i.get("id"),
                        l = t || {},
                        d = l.parent,
                        u = l.onClose,
                        p = !1,
                        f = !1,
                        h = !1,
                        g = !1,
                        m = function() {
                            s.getAnalysisManager().applyClusterColors(), h = !0, Object(o.yb)("show", "analysis-cluster")
                        },
                        y = function() {
                            s.getAnalysisManager().removeClusterColors(), h = !1, Object(o.yb)("show", "analysis")
                        },
                        b = function(e) {
                            window.removeEventListener("resize", w), document.removeEventListener("keydown", v), e && e.deferRevertingClusterColors || h && y(), Object(o.yb)("show", null), n.emit("updateFreezeMode", null), n.unbindTarget(this)
                        };

                    function v(e) {
                        p || f || 27 === e.keyCode && (u ? u() : b())
                    }

                    function w() {
                        var e = R.getBoundingClientRect().top,
                            t = B.getBoundingClientRect().top;
                        R.style.height = t - e + "px"
                    }
                    var O = function(t) {
                            p = !0, Object(j.showAnalysisChart)(e, t, (function() {
                                p = !1
                            }))
                        },
                        E = function() {
                            var t = s.getAnalysisManager();
                            Object(j.getClusteringResolution)(e, t.getClusteringResolution(), (function(t) {
                                Object(j.showWaitMessage)(e, "Calculating clusters...", "Please wait, as it may take a bit of time.", function() {
                                    var n, r = (n = T.a.mark((function n(r) {
                                        var o;
                                        return T.a.wrap((function(n) {
                                            for (;;) switch (n.prev = n.next) {
                                                case 0:
                                                    return n.next = 2, U(H(s), {
                                                        resolution: 1 / t
                                                    });
                                                case 2:
                                                    o = n.sent, Object(_.saveClustering)(i.get("id"), {
                                                        resolution: t,
                                                        clusters: o
                                                    }, (function() {
                                                        Object(_.getClusters)(i.get("id"), (function(e) {
                                                            var t = s.getAnalysisManager();
                                                            t.setClusters(e.clusters), t.setClusteringResolution(e.clustering_resolution), x(!0), r()
                                                        }), (function() {
                                                            return Object(j.displayMessage)(e, "Error Occurred", "Please try again")
                                                        }))
                                                    }), (function(t) {
                                                        console.dir(t), r(), Object(j.displayMessage)(e, "Error Occurred", "Please try again")
                                                    }));
                                                case 4:
                                                case "end":
                                                    return n.stop()
                                            }
                                        }), n)
                                    })), function() {
                                        var e = this,
                                            t = arguments;
                                        return new Promise((function(r, o) {
                                            var a = n.apply(e, t);

                                            function i(e) {
                                                W(a, r, o, i, s, "next", e)
                                            }

                                            function s(e) {
                                                W(a, r, o, i, s, "throw", e)
                                            }
                                            i(void 0)
                                        }))
                                    });
                                    return function(e) {
                                        return r.apply(this, arguments)
                                    }
                                }())
                            }))
                        };

                    function x(t) {
                        g && z.firstChild && z.removeChild(z.firstChild);
                        var r = s.getAnalysisManager().getClusters();
                        0 === (Array.isArray(r) ? r.length : 0) && a.get("readOnly") ? g = !1 : (L(e, {
                            parent: z,
                            onClusterRunRequested: function() {
                                E()
                            },
                            onClusterLabelSizeDecreaseRequested: function() {
                                i.update("clusterLabelNameSizeFactor", (function(e) {
                                    return Math.max(1, e - .1)
                                })), n.emit("onClustersUpdated")
                            },
                            onClusterLabelSizeIncreaseRequested: function() {
                                i.update("clusterLabelNameSizeFactor", (function(e) {
                                    return e + .1
                                })), n.emit("onClustersUpdated")
                            },
                            onClusterColorsToggleRequested: function(e) {
                                e ? m() : y()
                            },
                            onNodeBlockClicked: function(e) {
                                N(e)
                            },
                            highlightClustersOnStart: t,
                            onClusterColorChanged: function() {
                                h && m()
                            },
                            onListClusterNodesRequested: function(t) {
                                ! function(t, n) {
                                    var r = t.find((function(e) {
                                            return e.id == n
                                        })),
                                        o = Object(D.prepareData)(e, r.nodes);
                                    f = !0, Object(j.datatablePreviewPanel)(e, {
                                        title: r.name,
                                        subtitle: r.nodes.length + " nodes exist in this cluster.",
                                        data: o.data,
                                        columns: o.columns,
                                        columnHeaders: o.columnHeaders,
                                        onExportRequested: function() {
                                            var e = Object(D.exportData)(o);
                                            Object(S.downloadCSVFile)(e, {
                                                fileName: r.name
                                            }), f = !1
                                        },
                                        onCancel: function() {
                                            f = !1
                                        }
                                    })
                                }(r, t)
                            }
                        }), g = !0)
                    }
                    var k = function() {
                        var t, n = s.getAnalysisManager().getTypeSummaries(),
                            r = i.get("analysisItems");
                        for (C = null; z.firstChild;) z.removeChild(z.firstChild);
                        c || (x(), t = l.highlightClustersOnStart || a.get("isClusterColorsApplied"), Object(_.getClusters)(i.get("id"), (function(e) {
                            var n = s.getAnalysisManager();
                            n.setClusters(e.clusters), n.setClusteringResolution(e.clustering_resolution), i.set("clusterLabelNameSizeFactor", e.clustering_label_scale_factor), x(t || e.clusters.length > 0)
                        }))), (r || []).forEach((function(t) {
                            ("nt_prop" === t.type && "distinct" === n[t.id].properties[t.prop].type ? P : A)(e, {
                                rule: t,
                                parent: z,
                                onChartRequested: function() {
                                    O(t)
                                },
                                onNodeBlockClicked: function(e) {
                                    N(e)
                                }
                            })
                        }))
                    };
                    var C = null;

                    function N(e) {
                        C && Object(o.nb)(C, "analysis-bar__node-selected"), C = e, Object(o.h)(C, "analysis-bar__node-selected")
                    }
                    n.bind("onNodesReleased", (function() {
                        C && (Object(o.nb)(C, "analysis-bar__node-selected"), C = null)
                    }), this);
                    var M = {
                            allow_edit: !a.get("readOnly") && (i.get("user").is_admin || i.get("user").can_edit)
                        },
                        q = r.a["graphs/analysis_bar"](M);
                    d.appendChild(q.trim().toDOM());
                    var I = d.lastElementChild,
                        R = I.querySelector("div.bar-content__body");
                    I.querySelector(".show-chart-all").addEventListener("click", (function(e) {
                        e.preventDefault(), O({
                            type: "nt",
                            id: "All",
                            analysis: "Degree Centrality"
                        })
                    }));
                    var B = I.querySelector("div.bar-content__footer");
                    B.querySelector("button.gc-btn").addEventListener("click", (function() {
                        u ? u() : b()
                    }));
                    var F, G, z = I.querySelector("ul.analysis-blocks");
                    return M.allow_edit && (F = I.querySelector(".show-analysis")).addEventListener("click", (function(t) {
                        t.preventDefault(), Object(j.analysisCompositionPanel)(e, (function(e) {
                            c || Object(_.updateGraphAnalysisRules)(i.get("id"), e), i.set("analysisItems", e), k(), p = !1
                        }), (function() {
                            p = !1
                        })), p = !0, F.blur()
                    })), n.emit("updateFreezeMode", "analysis"), k(), window.addEventListener("resize", w), w(), R.classList.add("gc-custom-scrollbar"), Object(o.yb)("show", "analysis"), document.addEventListener("keydown", v), l.showCompositionPanelOnStart && (G.preventDefault(), t.onShowCustomizeDialog()), l.runClusteringOnStart && Object(_.getClusters)(i.get("id"), (function(t) {
                        console.dir(t), 0 !== t.status ? t.clustering_rendered_at !== t.signals_added_at || 2 === t.status ? t.clusters && t.clusters.length ? Object(j.confirm)(e, "Run Clustering", "Your current clustering settings will be lost.<br/>Are you sure to continue?", (function() {
                            E()
                        })) : E() : Object(j.displayMessage)(e, "Up to date", "Your cluster is already up to date") : Object(j.displayMessage)(e, "Currently running", "Clusters for your graph are being calculated right now.")
                    }), (function(t) {
                        console.dir(t), Object(j.displayMessage)(e, "Error Occurred", "Please try again")
                    })), {
                        close: b
                    }
                },
                V = function(e, t) {
                    var n;
                    e.GraphHistory.getAnalysisManager().isDirty() ? Object(j.showWaitMessage)(e, "Please wait...", "Preparing Analysis", (function(r) {
                        n = Y(e, {
                            parent: t.parent,
                            onClose: t.onClose,
                            highlightClustersOnStart: t.highlightClustersOnStart,
                            showCompositionPanelOnStart: t.showCompositionPanelOnStart,
                            runClusteringOnStart: t.runClusteringOnStart,
                            onShowCustomizeDialog: t.onShowCustomizeDialog
                        }), r(), t.onReady && t.onReady.call(null, n)
                    })) : (n = Y(e, {
                        parent: t.parent,
                        onClose: t.onClose,
                        highlightClustersOnStart: t.highlightClustersOnStart
                    }), t.onReady && t.onReady.call(null, n))
                },
                X = n(101),
                K = function(e, t) {
                    var n = t || {},
                        r = n.onClose,
                        o = n.onShareRequested,
                        a = n.onReady,
                        i = n.parent,
                        s = Object(X.a)(e, i, {
                            onClose: r,
                            onShareRequested: o
                        });
                    if (!a) return s;
                    a.call(null, s)
                },
                $ = function(e, t, n, i, s) {
                    var c = e.dispatcher,
                        l = e.uiStore,
                        p = e.graphStore,
                        f = e.GraphHistory,
                        h = function(t) {
                            var n = f.getFilterManager();
                            Object(j.showWaitMessage)(e, "Please wait...", "Applying filter", (function(e) {
                                c.emit("onBeforeFilterApplied"), t.forEach((function(e) {
                                    e.add ? n.addRule(e.rule, !0) : e.remove && n.removeRule(e.rule, !0)
                                })), c.emit("onFilterApplied", t.map((function(e) {
                                    return e.rule
                                }))), b(), e()
                            }))
                        },
                        y = function(e) {
                            K || 27 === e.keyCode && (n ? n() : E())
                        };

                    function b() {
                        var e = f.getFilterManager(),
                            t = e.getRules().length,
                            n = e.getTotalFilteredNodeCount(),
                            r = 0 === t;
                        1 === t && "hide_isolated" === e.getRules()[0].type && 0 === n && (r = !0), r ? Object(o.h)(D, "not-shown") : Object(o.nb)(D, "not-shown");
                        var a = f.getNodes().length;
                        F.textContent = Object(o.k)(a - n, "node", "nodes", "{quantity} {item}"), G.textContent = a, n > 0 ? Object(o.nb)(B, "hide-it") : Object(o.h)(B, "hide-it"), X.forEach((function(e) {
                            "function" === typeof e.updateFilteredCount && e.updateFilteredCount()
                        }))
                    }
                    var v = function() {
                            for (; P.firstChild;) P.removeChild(P.firstChild);
                            X = [], p.get("filters").forEach((function(t) {
                                var n = function(t) {
                                    var n = {
                                        filter: t,
                                        parent: P,
                                        typeSummaries: V,
                                        asyncRuleCallback: h,
                                        requestExpandedRange: S
                                    };
                                    try {
                                        switch (t.type) {
                                            case "nt":
                                            case "et":
                                                return a(e, n);
                                            case "et_weight":
                                                return u(e, n);
                                            case "nt_centrality":
                                                return g(e, n);
                                            case "et_prop":
                                            case "nt_prop":
                                                switch (V[t.id].properties[t.prop].type) {
                                                    case "range":
                                                        return m(e, n);
                                                    case "distinct":
                                                        return d(e, n);
                                                    default:
                                                        return
                                                }
                                        }
                                    } catch (r) {
                                        return void console.dir(r)
                                    }
                                }(t);
                                n && X.push(n)
                            })), 0 === X.length ? (Object(o.h)(L, "not-shown"), Object(o.h)(D, "not-shown"), Object(o.h)(M.parentNode, "not-shown"), x.allow_customize && (Object(o.nb)(N, "not-shown"), Object(o.h)(C, "not-shown"))) : (Object(o.nb)(L, "not-shown"), Object(o.nb)(D, "not-shown"), Object(o.nb)(M.parentNode, "not-shown"), M.checked = f.getFilterManager().shouldFilterIsolatedNodes(), x.allow_customize && (Object(o.h)(N, "not-shown"), Object(o.nb)(C, "not-shown")))
                        },
                        w = function(t) {
                            t.preventDefault();
                            var n = 0 == p.get("filters").length;
                            Object(j.filterCompositionPanel)(e, (function(e) {
                                Object(_.updateGraphFilters)(p.get("id"), e), p.set("filters", e), v(), K = !1,
                                    function(e) {
                                        var t = f.getFilterManager(),
                                            n = t.getRules();
                                        if (0 !== n.length) {
                                            if (0 === e.length) return c.emit("onBeforeFilterApplied"), t.clearFilter(), M.checked = !1, b(), void c.emit("onFilterApplied");
                                            var r, o;
                                            for (r = n.length - 1; r >= 0; r -= 1) {
                                                var a = !0;
                                                for (o = 0; o < e.length; o += 1)
                                                    if (n[r].type === e[o].type) {
                                                        switch (n[r].type) {
                                                            case "nt":
                                                            case "et":
                                                                a = !1;
                                                                break;
                                                            case "nt_prop":
                                                            case "et_prop":
                                                                n[r].id === e[o].id && n[r].prop === e[o].prop && (a = !1);
                                                                break;
                                                            case "nt_centrality":
                                                                n[r].id === e[o].id && n[r].centrality === e[o].centrality && (a = !1);
                                                                break;
                                                            case "et_weight":
                                                                n[r].id === e[o].id && (a = !1)
                                                        }
                                                        if (!a) break
                                                    }
                                                a && t.removeRule(n[r], !0)
                                            }
                                        }
                                    }(e), n && e.length > 0 && H(!0)
                            }), (function() {
                                K = !1
                            })), K = !0, C.blur()
                        },
                        O = function() {
                            var e = q.getBoundingClientRect().top,
                                t = I.getBoundingClientRect().top;
                            q.style.height = t - e + "px"
                        };

                    function E() {
                        window.removeEventListener("resize", O), document.removeEventListener("keydown", y), Object(o.yb)("show", null);
                        var e = f.getFilterManager();
                        if (!e.getActiveExpandedFilter()) {
                            var t = f.getFilterManager().getTotalFilteredNodeCount(),
                                n = f.getFilterManager().getTotalFilteredEdgeCount(),
                                r = e.getRules();
                            (1 === r.length && "hide_isolated" === r[0].type || 0 === t && 0 === n) && c.emit("updateFreezeMode", null)
                        }
                    }
                    var S = i,
                        x = {
                            allow_customize: !l.get("readOnly") && (p.get("user").is_admin || p.get("user").can_edit)
                        },
                        k = r.a["graphs/filters_bar"](x);
                    t.appendChild(k.trim().toDOM());
                    var C, N, T = t.lastElementChild,
                        L = T.querySelector(".bar-content__header h2"),
                        P = T.querySelector("ul.filters"),
                        A = T.querySelector("button.clear-filters"),
                        D = T.querySelector("div.reset-block"),
                        M = T.querySelector('input[type="checkbox"]#cbHideIsolated'),
                        q = T.querySelector("div.bar-content__body"),
                        I = T.querySelector("div.bar-content__footer"),
                        R = I.querySelector("button.gc-btn"),
                        B = T.querySelector(".notice"),
                        F = T.querySelector("span.node-count-filtered"),
                        G = T.querySelector("span.node-count-total");

                    function H(e) {
                        var t = f.getFilterManager();
                        c.emit("onBeforeFilterApplied"), t.setFilterIsolatedNodesFlag(e), c.emit("onFilterApplied"), b()
                    }
                    if (A.addEventListener("click", (function() {
                            Object(j.showWaitMessage)(e, "Please wait...", "Clearing filters", (function(e) {
                                c.emit("onBeforeFilterApplied"), f.getFilterManager().clearFilter(), M.checked = !1, X.forEach((function(e) {
                                    e.clear(!0)
                                })), c.emit("onFilterApplied"), b(), e()
                            }))
                        })), M.addEventListener("click", (function() {
                            H(M.checked)
                        })), x.allow_customize && ((C = T.querySelector(".show-filters")).addEventListener("click", w), (N = T.querySelector("div.bar-content__body-empty")).querySelector("button").addEventListener("click", w)), R.addEventListener("click", (function() {
                            n ? n() : E()
                        })), "filter" !== l.get("freezeMode")) {
                        var U = f.getFilterManager(),
                            z = null;
                        p.get("filters").length > 0 && (z = Object(o.F)(), Array.isArray(z) && 0 !== z.length || (z = [{
                            type: "hide_isolated"
                        }])), U.initializeWithRules(z), z && c.emit("onFilterApplied")
                    } else {
                        var W = f.getFilterManager(),
                            Y = W.getActiveExpandedFilter();
                        Y && (Y.close(), W.setActiveExpandedFilter(null))
                    }
                    var V, X = [],
                        K = !1;
                    return V = Object(o.j)(e), v(), b(), window.addEventListener("resize", O), O(), q.classList.add("gc-custom-scrollbar"), "filter" !== l.get("freezeMode") && c.emit("updateFreezeMode", "filter"), Object(o.yb)("show", "filter"), document.addEventListener("keydown", y), s && w(), {
                        close: E
                    }
                },
                Z = function(e, t, n, r, o, a) {
                    var i;
                    "filter" !== e.uiStore.get("freezeMode") ? Object(j.showWaitMessage)(e, "Please wait...", "Preparing filter", (function(s) {
                        i = $(e, t, r, o, a), s(), n && n.call(null, i)
                    })) : (i = $(e, t, r, o), n && n.call(null, i))
                },
                J = function(e, t) {
                    var n, a, i = t.groups,
                        s = t.parent;
                    a = {
                        groups: i.sort((function(e, t) {
                            return e.count < t.count
                        })).map((function(e, t) {
                            return {
                                id: e.id,
                                count: e.count,
                                name: e.name,
                                index: t,
                                color: e.color || "#000",
                                hide: t >= 5
                            }
                        })),
                        header: t.type,
                        show_more: i.length > 5
                    }, n = r.a["graphs/group_block"](a).trim().toDOM(), s.appendChild(n);
                    var c = s.lastElementChild,
                        l = c.querySelectorAll("li.bar-block__list-item");
                    if (a.show_more) {
                        var d = c.querySelector("div.show-more button");
                        d.addEventListener("click", (function() {
                            var e, t = l[0].parentNode;
                            if (Object(o.N)(t, "expanded")) {
                                for (e = 5; e < l.length; e += 1) Object(o.h)(l[e], "not-shown");
                                Object(o.nb)(t, "expanded"), d.textContent = "+ MORE"
                            } else {
                                for (e = 5; e < l.length; e += 1) Object(o.nb)(l[e], "not-shown");
                                Object(o.h)(t, "expanded"), d.textContent = "- LESS"
                            }
                        }))
                    }
                    var u = c.querySelector("button.trigger-group");
                    u && u.addEventListener("click", (function() {
                        this.blur(), t.onTrigger && t.onTrigger()
                    }))
                },
                Q = function(e, t) {
                    var n, o = e.graphStore,
                        a = e.GraphHistory,
                        i = t.parent,
                        s = {
                            types: [],
                            header: "By Property"
                        },
                        c = a.getNodeTypes();
                    o.get("belongsToHub") && (c = c.filter((function(e) {
                        return e.count > 0
                    }))), c.forEach((function(e) {
                        var n = {
                            name: e.name,
                            color: e.color,
                            id: e.id
                        };
                        Array.isArray(e.properties) && (n.properties = e.properties.map((function(n) {
                            var r = {
                                name: n.name
                            };
                            if (t.initialMapping) {
                                var o = t.initialMapping.filter((function(t) {
                                    return t.id === e.id
                                }));
                                o.length > 0 && (r.selected = o[0].prop === n.name)
                            }
                            return r
                        })), n.properties.length > 0 && n.properties.unshift({
                            name: "Property"
                        })), n.properties && n.properties.length > 0 ? s.types.unshift(n) : s.types.push(n)
                    })), n = r.a["graphs/group_by_property_block"](s).trim().toDOM(), i.appendChild(n);
                    var l = i.lastElementChild,
                        d = Array.from(l.querySelectorAll("li.bar-block__list-item"));
                    return d.forEach((function(e) {
                        var n = e.querySelector("select");
                        n && n.addEventListener("change", (function() {
                            var e;
                            this.blur(), e = d.map((function(e) {
                                var t = {
                                        id: e.getAttribute("data-node")
                                    },
                                    n = e.querySelector("select");
                                return n && "Property" !== n.value && (t.prop = n.value), t
                            })), t.triggerGrouping(e)
                        }))
                    })), {
                        clearSelection: function() {
                            d.forEach((function(e) {
                                var t = e.querySelector("select");
                                t && (t.querySelector("option").selected = "selected")
                            }))
                        }
                    }
                },
                ee = function(e, t) {
                    var n = e.dispatcher,
                        a = e.graphStore,
                        i = e.GraphHistory,
                        s = t || {},
                        c = s.parent,
                        l = s.onClose,
                        d = s.canvas,
                        u = function(e) {
                            window.removeEventListener("resize", f), document.removeEventListener("keydown", p), Object(o.yb)("show", null), Object(o.yb)("group-type", null), Object(o.yb)("group-property-mapping", null), e && e.deferRevertingGroups || n.emit("updateFreezeMode", null)
                        };

                    function p(e) {
                        27 === e.keyCode && (l ? l() : u())
                    }

                    function f() {
                        var e = j.getBoundingClientRect().top,
                            t = x.getBoundingClientRect().top;
                        j.style.height = t - e + "px"
                    }
                    var h, g = function(t) {
                        Object(_.getClusters)(a.get("id"), (function(n) {
                            i.getAnalysisManager().setClusters(n.clusters), n.clusters.length > 0 ? function(t) {
                                var n = i.buildClusterGroups();
                                n.type = "clusters", J(e, {
                                    groups: n.nodes,
                                    parent: S,
                                    type: "by Cluster",
                                    onTrigger: m
                                }), t && d.showGraphModel(n)
                            }(t) : t && y()
                        }))
                    };

                    function m() {
                        var e = i.buildClusterGroups();
                        e.type = "clusters", d.showGraphModel(e), h && h.clearSelection(), i.setCanvasAnimation(!0), Object(o.yb)("group-type", "cluster"), Object(o.yb)("group-property-mapping", null)
                    }

                    function y() {
                        var e = i.buildGraphModel();
                        e.type = "default", d.showGraphModel(e), h && h.clearSelection(), i.setCanvasAnimation(!0), Object(o.yb)("group-type", "type"), Object(o.yb)("group-property-mapping", null)
                    }

                    function b(e) {
                        var t = i.buildNodeTypePropertyGroups(e);
                        t.type = "properties", d.showGraphModel(t), i.setCanvasAnimation(!0), Object(o.yb)("group-type", "property"), Object(o.yb)("group-property-mapping", encodeURIComponent(JSON.stringify(e)))
                    }
                    var v = i.getAnalysisManager().getClusters(),
                        w = {
                            allow_edit: a.get("user").is_admin,
                            has_clusters: v && v.length > 0
                        },
                        O = r.a["graphs/groups_bar"](w);
                    c.appendChild(O.trim().toDOM());
                    var E = c.lastElementChild,
                        j = E.querySelector("div.bar-content__body"),
                        S = j.querySelector("ul"),
                        x = E.querySelector("div.bar-content__footer");
                    return x.querySelector("button.gc-btn").addEventListener("click", (function() {
                            l ? l() : u()
                        })),
                        function() {
                            for (; S.firstChild;) S.removeChild(S.firstChild);
                            var t, n, r = !1,
                                a = Object(o.K)(Object(o.J)());
                            try {
                                var s = a["group-property-mapping"];
                                s && (t = JSON.parse(decodeURIComponent(s)), Array.isArray(t) || (t = null))
                            } catch (c) {}
                            switch ((n = i.buildGraphModel()).type = "default", J(e, {
                                groups: n.nodes,
                                parent: S,
                                type: "by Type",
                                onTrigger: y
                            }), function(t) {
                                h = Q(e, {
                                    parent: S,
                                    triggerGrouping: b,
                                    initialMapping: t
                                })
                            }(t), a["group-type"]) {
                                case "cluster":
                                    r = !0;
                                    break;
                                case "property":
                                    t ? b(t) : y();
                                    break;
                                case "type":
                                default:
                                    y()
                            }
                            g(r)
                        }(), window.addEventListener("resize", f), f(), j.classList.add("gc-custom-scrollbar"), Object(o.yb)("show", "groups"), document.addEventListener("keydown", p), {
                            close: u
                        }
                },
                te = function(e, t) {
                    var n;
                    n = ee(e, {
                        parent: t.parent,
                        canvas: t.canvas,
                        onClose: t.onClose
                    }), t.onReady && t.onReady.call(null, n)
                }
        },
        486: function(e, t, n) {
            var r = {
                "./af": 193,
                "./af.js": 193,
                "./ar": 194,
                "./ar-dz": 195,
                "./ar-dz.js": 195,
                "./ar-kw": 196,
                "./ar-kw.js": 196,
                "./ar-ly": 197,
                "./ar-ly.js": 197,
                "./ar-ma": 198,
                "./ar-ma.js": 198,
                "./ar-sa": 199,
                "./ar-sa.js": 199,
                "./ar-tn": 200,
                "./ar-tn.js": 200,
                "./ar.js": 194,
                "./az": 201,
                "./az.js": 201,
                "./be": 202,
                "./be.js": 202,
                "./bg": 203,
                "./bg.js": 203,
                "./bm": 204,
                "./bm.js": 204,
                "./bn": 205,
                "./bn-bd": 206,
                "./bn-bd.js": 206,
                "./bn.js": 205,
                "./bo": 207,
                "./bo.js": 207,
                "./br": 208,
                "./br.js": 208,
                "./bs": 209,
                "./bs.js": 209,
                "./ca": 210,
                "./ca.js": 210,
                "./cs": 211,
                "./cs.js": 211,
                "./cv": 212,
                "./cv.js": 212,
                "./cy": 213,
                "./cy.js": 213,
                "./da": 214,
                "./da.js": 214,
                "./de": 215,
                "./de-at": 216,
                "./de-at.js": 216,
                "./de-ch": 217,
                "./de-ch.js": 217,
                "./de.js": 215,
                "./dv": 218,
                "./dv.js": 218,
                "./el": 219,
                "./el.js": 219,
                "./en-au": 220,
                "./en-au.js": 220,
                "./en-ca": 221,
                "./en-ca.js": 221,
                "./en-gb": 222,
                "./en-gb.js": 222,
                "./en-ie": 223,
                "./en-ie.js": 223,
                "./en-il": 224,
                "./en-il.js": 224,
                "./en-in": 225,
                "./en-in.js": 225,
                "./en-nz": 226,
                "./en-nz.js": 226,
                "./en-sg": 227,
                "./en-sg.js": 227,
                "./eo": 228,
                "./eo.js": 228,
                "./es": 229,
                "./es-do": 230,
                "./es-do.js": 230,
                "./es-mx": 231,
                "./es-mx.js": 231,
                "./es-us": 232,
                "./es-us.js": 232,
                "./es.js": 229,
                "./et": 233,
                "./et.js": 233,
                "./eu": 234,
                "./eu.js": 234,
                "./fa": 235,
                "./fa.js": 235,
                "./fi": 236,
                "./fi.js": 236,
                "./fil": 237,
                "./fil.js": 237,
                "./fo": 238,
                "./fo.js": 238,
                "./fr": 239,
                "./fr-ca": 240,
                "./fr-ca.js": 240,
                "./fr-ch": 241,
                "./fr-ch.js": 241,
                "./fr.js": 239,
                "./fy": 242,
                "./fy.js": 242,
                "./ga": 243,
                "./ga.js": 243,
                "./gd": 244,
                "./gd.js": 244,
                "./gl": 245,
                "./gl.js": 245,
                "./gom-deva": 246,
                "./gom-deva.js": 246,
                "./gom-latn": 247,
                "./gom-latn.js": 247,
                "./gu": 248,
                "./gu.js": 248,
                "./he": 249,
                "./he.js": 249,
                "./hi": 250,
                "./hi.js": 250,
                "./hr": 251,
                "./hr.js": 251,
                "./hu": 252,
                "./hu.js": 252,
                "./hy-am": 253,
                "./hy-am.js": 253,
                "./id": 254,
                "./id.js": 254,
                "./is": 255,
                "./is.js": 255,
                "./it": 256,
                "./it-ch": 257,
                "./it-ch.js": 257,
                "./it.js": 256,
                "./ja": 258,
                "./ja.js": 258,
                "./jv": 259,
                "./jv.js": 259,
                "./ka": 260,
                "./ka.js": 260,
                "./kk": 261,
                "./kk.js": 261,
                "./km": 262,
                "./km.js": 262,
                "./kn": 263,
                "./kn.js": 263,
                "./ko": 264,
                "./ko.js": 264,
                "./ku": 265,
                "./ku.js": 265,
                "./ky": 266,
                "./ky.js": 266,
                "./lb": 267,
                "./lb.js": 267,
                "./lo": 268,
                "./lo.js": 268,
                "./lt": 269,
                "./lt.js": 269,
                "./lv": 270,
                "./lv.js": 270,
                "./me": 271,
                "./me.js": 271,
                "./mi": 272,
                "./mi.js": 272,
                "./mk": 273,
                "./mk.js": 273,
                "./ml": 274,
                "./ml.js": 274,
                "./mn": 275,
                "./mn.js": 275,
                "./mr": 276,
                "./mr.js": 276,
                "./ms": 277,
                "./ms-my": 278,
                "./ms-my.js": 278,
                "./ms.js": 277,
                "./mt": 279,
                "./mt.js": 279,
                "./my": 280,
                "./my.js": 280,
                "./nb": 281,
                "./nb.js": 281,
                "./ne": 282,
                "./ne.js": 282,
                "./nl": 283,
                "./nl-be": 284,
                "./nl-be.js": 284,
                "./nl.js": 283,
                "./nn": 285,
                "./nn.js": 285,
                "./oc-lnc": 286,
                "./oc-lnc.js": 286,
                "./pa-in": 287,
                "./pa-in.js": 287,
                "./pl": 288,
                "./pl.js": 288,
                "./pt": 289,
                "./pt-br": 290,
                "./pt-br.js": 290,
                "./pt.js": 289,
                "./ro": 291,
                "./ro.js": 291,
                "./ru": 292,
                "./ru.js": 292,
                "./sd": 293,
                "./sd.js": 293,
                "./se": 294,
                "./se.js": 294,
                "./si": 295,
                "./si.js": 295,
                "./sk": 296,
                "./sk.js": 296,
                "./sl": 297,
                "./sl.js": 297,
                "./sq": 298,
                "./sq.js": 298,
                "./sr": 299,
                "./sr-cyrl": 300,
                "./sr-cyrl.js": 300,
                "./sr.js": 299,
                "./ss": 301,
                "./ss.js": 301,
                "./sv": 302,
                "./sv.js": 302,
                "./sw": 303,
                "./sw.js": 303,
                "./ta": 304,
                "./ta.js": 304,
                "./te": 305,
                "./te.js": 305,
                "./tet": 306,
                "./tet.js": 306,
                "./tg": 307,
                "./tg.js": 307,
                "./th": 308,
                "./th.js": 308,
                "./tk": 309,
                "./tk.js": 309,
                "./tl-ph": 310,
                "./tl-ph.js": 310,
                "./tlh": 311,
                "./tlh.js": 311,
                "./tr": 312,
                "./tr.js": 312,
                "./tzl": 313,
                "./tzl.js": 313,
                "./tzm": 314,
                "./tzm-latn": 315,
                "./tzm-latn.js": 315,
                "./tzm.js": 314,
                "./ug-cn": 316,
                "./ug-cn.js": 316,
                "./uk": 317,
                "./uk.js": 317,
                "./ur": 318,
                "./ur.js": 318,
                "./uz": 319,
                "./uz-latn": 320,
                "./uz-latn.js": 320,
                "./uz.js": 319,
                "./vi": 321,
                "./vi.js": 321,
                "./x-pseudo": 322,
                "./x-pseudo.js": 322,
                "./yo": 323,
                "./yo.js": 323,
                "./zh-cn": 324,
                "./zh-cn.js": 324,
                "./zh-hk": 325,
                "./zh-hk.js": 325,
                "./zh-mo": 326,
                "./zh-mo.js": 326,
                "./zh-tw": 327,
                "./zh-tw.js": 327
            };

            function o(e) {
                var t = a(e);
                return n(t)
            }

            function a(e) {
                if (!n.o(r, e)) {
                    var t = new Error("Cannot find module '" + e + "'");
                    throw t.code = "MODULE_NOT_FOUND", t
                }
                return r[e]
            }
            o.keys = function() {
                return Object.keys(r)
            }, o.resolve = a, e.exports = o, o.id = 486
        },
        491: function(e, t) {},
        492: function(e, t) {},
        5: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "ajaxCall", (function() {
                return r.a
            })), n.d(t, "recommend", (function() {
                return o.ib
            })), n.d(t, "unrecommend", (function() {
                return o.Kb
            })), n.d(t, "getGraph", (function() {
                return o.J
            })), n.d(t, "saveGraph", (function() {
                return o.vb
            })), n.d(t, "saveGraphLayout", (function() {
                return o.wb
            })), n.d(t, "updateGraph", (function() {
                return o.Pb
            })), n.d(t, "setGraphStatus", (function() {
                return o.Eb
            })), n.d(t, "deleteNodeType", (function() {
                return o.w
            })), n.d(t, "deleteEdgeType", (function() {
                return o.u
            })), n.d(t, "removeCollaborator", (function() {
                return o.jb
            })), n.d(t, "addCollaborator", (function() {
                return o.c
            })), n.d(t, "getRecommenders", (function() {
                return o.S
            })), n.d(t, "updateCollaboratorStatus", (function() {
                return o.Mb
            })), n.d(t, "signIn", (function() {
                return o.Ib
            })), n.d(t, "signUp", (function() {
                return o.Jb
            })), n.d(t, "requestInvite", (function() {
                return o.qb
            })), n.d(t, "getUserHubs", (function() {
                return o.X
            })), n.d(t, "createGraph", (function() {
                return o.o
            })), n.d(t, "getEmptyGraph", (function() {
                return o.I
            })), n.d(t, "saveNewGraph", (function() {
                return o.Ab
            })), n.d(t, "createNodeType", (function() {
                return o.q
            })), n.d(t, "destroyNodeType", (function() {
                return o.z
            })), n.d(t, "updateNodeType", (function() {
                return o.Tb
            })), n.d(t, "addNodeTypeProperty", (function() {
                return o.g
            })), n.d(t, "updateNodeTypeProperty", (function() {
                return o.Ub
            })), n.d(t, "removeNodeTypeProperty", (function() {
                return o.nb
            })), n.d(t, "createEdgeType", (function() {
                return o.n
            })), n.d(t, "destroyEdgeType", (function() {
                return o.y
            })), n.d(t, "updateEdgeType", (function() {
                return o.Nb
            })), n.d(t, "addEdgeTypeProperty", (function() {
                return o.e
            })), n.d(t, "updateEdgeTypeProperty", (function() {
                return o.Ob
            })), n.d(t, "removeEdgeTypeProperty", (function() {
                return o.lb
            })), n.d(t, "getHubMembers", (function() {
                return o.M
            })), n.d(t, "addHubMember", (function() {
                return o.f
            })), n.d(t, "inviteToHub", (function() {
                return o.db
            })), n.d(t, "inviteToGraph", (function() {
                return o.cb
            })), n.d(t, "removeHubMember", (function() {
                return o.mb
            })), n.d(t, "updateHubMemberStatus", (function() {
                return o.Sb
            })), n.d(t, "getHubTaxonomy", (function() {
                return o.O
            })), n.d(t, "saveHubTaxonomy", (function() {
                return o.zb
            })), n.d(t, "saveHubNode", (function() {
                return o.yb
            })), n.d(t, "getNode", (function() {
                return o.P
            })), n.d(t, "getNodes", (function() {
                return o.Q
            })), n.d(t, "graphContributors", (function() {
                return o.Z
            })), n.d(t, "graphCollaborators", (function() {
                return o.Y
            })), n.d(t, "getEdgesForNode", (function() {
                return o.H
            })), n.d(t, "getGraphsForNode", (function() {
                return o.K
            })), n.d(t, "getTypesGraphInHub", (function() {
                return o.V
            })), n.d(t, "searchNodes", (function() {
                return o.Bb
            })), n.d(t, "checkEdgesForNode", (function() {
                return o.l
            })), n.d(t, "checkEdgesForNodesInHub", (function() {
                return o.m
            })), n.d(t, "checkEdgeOwner", (function() {
                return o.k
            })), n.d(t, "getHub", (function() {
                return o.L
            })), n.d(t, "exploreHub", (function() {
                return o.D
            })), n.d(t, "saveHub", (function() {
                return o.xb
            })), n.d(t, "createHubGraph", (function() {
                return o.p
            })), n.d(t, "deleteInvitation", (function() {
                return o.v
            })), n.d(t, "setGraphAsExploreTemplate", (function() {
                return o.Db
            })), n.d(t, "editGraphDescription", (function() {
                return o.A
            })), n.d(t, "createSelection", (function() {
                return o.r
            })), n.d(t, "getSelection", (function() {
                return o.T
            })), n.d(t, "setHubDataStatus", (function() {
                return o.Gb
            })), n.d(t, "importHubData", (function() {
                return o.bb
            })), n.d(t, "requestGraphMembership", (function() {
                return o.pb
            })), n.d(t, "GraphMembershipStatus", (function() {
                return o.a
            })), n.d(t, "UpdateGraphMembershipRequest", (function() {
                return o.b
            })), n.d(t, "addCreditCard", (function() {
                return o.d
            })), n.d(t, "updatePlan", (function() {
                return o.Vb
            })), n.d(t, "retriveCards", (function() {
                return o.tb
            })), n.d(t, "retrievePayments", (function() {
                return o.sb
            })), n.d(t, "calculateProration", (function() {
                return o.j
            })), n.d(t, "applyCoupon", (function() {
                return o.h
            })), n.d(t, "ignoreBlockedNodeWarning", (function() {
                return o.ab
            })), n.d(t, "getShareableLink", (function() {
                return o.U
            })), n.d(t, "createShareableLink", (function() {
                return o.t
            })), n.d(t, "userStartedTour", (function() {
                return o.Yb
            })), n.d(t, "userUpdatedTour", (function() {
                return o.Zb
            })), n.d(t, "postComment", (function() {
                return o.gb
            })), n.d(t, "getComments", (function() {
                return o.G
            })), n.d(t, "removeComment", (function() {
                return o.kb
            })), n.d(t, "embedNodeDetails", (function() {
                return o.C
            })), n.d(t, "setNodeTypeEmbedDefaults", (function() {
                return o.Hb
            })), n.d(t, "embed", (function() {
                return o.B
            })), n.d(t, "updateGraphFilters", (function() {
                return o.Rb
            })), n.d(t, "getPathsInHub", (function() {
                return o.R
            })), n.d(t, "updateGraphAnalysisRules", (function() {
                return o.Qb
            })), n.d(t, "getClusters", (function() {
                return o.F
            })), n.d(t, "updateCluster", (function() {
                return o.Lb
            })), n.d(t, "saveClustering", (function() {
                return o.ub
            })), n.d(t, "queryAdvancedExplore", (function() {
                return o.hb
            })), n.d(t, "notifyNodeSelection", (function() {
                return o.eb
            })), n.d(t, "updateUser", (function() {
                return o.Wb
            })), n.d(t, "requestAuthentication", (function() {
                return o.ob
            })), n.d(t, "calculateCircularLayout", (function() {
                return o.i
            })), n.d(t, "uploadScreenshot", (function() {
                return o.Xb
            })), n.d(t, "retrieveActivityFeed", (function() {
                return o.rb
            })), n.d(t, "setGraphTag", (function() {
                return o.Fb
            })), n.d(t, "featureGraph", (function() {
                return o.E
            })), n.d(t, "openRightBar", (function() {
                return o.fb
            })), n.d(t, "getUserGraphs", (function() {
                return o.W
            })), n.d(t, "checkGraphQuality", (function() {
                return a
            })), n.d(t, "checkReferenceQuality", (function() {
                return i
            })), n.d(t, "updateClusterParams", (function() {
                return s
            })), n.d(t, "getAdminUserStats", (function() {
                return c
            })), n.d(t, "getTotalAdminUserStats", (function() {
                return l
            })), n.d(t, "getAdminStoryStats", (function() {
                return d
            })), n.d(t, "getTotalAdminStoryStats", (function() {
                return u
            })), n.d(t, "getAdminGraphStats", (function() {
                return p
            })), n.d(t, "getTotalAdminGraphStats", (function() {
                return f
            })), n.d(t, "GetAdminStats", (function() {
                return h
            })), n.d(t, "getGraphStats", (function() {
                return g
            })), n.d(t, "getTotalGraphStats", (function() {
                return m
            })), n.d(t, "getGraphNodeViews", (function() {
                return y
            })), n.d(t, "getUserGraphStats", (function() {
                return b
            })), n.d(t, "getTotalUserGraphStats", (function() {
                return v
            })), n.d(t, "getUserStoryStats", (function() {
                return _
            })), n.d(t, "getUserActionStats", (function() {
                return w
            })), n.d(t, "getTotalUserStoryStats", (function() {
                return O
            })), n.d(t, "getHubGraphStats", (function() {
                return E
            })), n.d(t, "getTotalHubGraphStats", (function() {
                return j
            })), n.d(t, "getHubStoryStats", (function() {
                return S
            })), n.d(t, "getTotalHubStoryStats", (function() {
                return x
            })), n.d(t, "getStoryForEdit", (function() {
                return k
            })), n.d(t, "getStory", (function() {
                return C
            })), n.d(t, "getStories", (function() {
                return N
            })), n.d(t, "createStory", (function() {
                return T
            })), n.d(t, "appendSlide", (function() {
                return L
            })), n.d(t, "updateSlide", (function() {
                return P
            })), n.d(t, "updateStory", (function() {
                return A
            })), n.d(t, "deleteStory", (function() {
                return D
            })), n.d(t, "deleteSlideFromStory", (function() {
                return M
            })), n.d(t, "reorderSlide", (function() {
                return q
            })), n.d(t, "notifyStoryStarted", (function() {
                return I
            })), n.d(t, "notifyStoryCompleted", (function() {
                return R
            })), n.d(t, "recommendStory", (function() {
                return B
            })), n.d(t, "unrecommendStory", (function() {
                return F
            })), n.d(t, "featuredStories", (function() {
                return G
            })), n.d(t, "emailStoryLink", (function() {
                return H
            })), n.d(t, "emailStoryLinkAsync", (function() {
                return U
            })), n.d(t, "notifyStoryTourStarted", (function() {
                return z
            })), n.d(t, "notifyStoryTourCompleted", (function() {
                return W
            })), n.d(t, "notifyStoryTourCancelled", (function() {
                return Y
            })), n.d(t, "publishStory", (function() {
                return V
            })), n.d(t, "unpublishStory", (function() {
                return X
            })), n.d(t, "checkStoryQuality", (function() {
                return K
            })), n.d(t, "getStoryStats", (function() {
                return $
            }));
            var r = n(8),
                o = n(10),
                a = function(e, t, n) {
                    var o = "/graphs/" + e + "/check_quality.json";
                    Object(r.a)("GET", o, null, t, n)
                },
                i = function(e, t, n) {
                    var o = "/graphs/" + e + "/reference_quality.json";
                    Object(r.a)("GET", o, null, t, n)
                },
                s = function(e, t, n, o) {
                    var a = ["/graphs/", e, "/update_cluster_params.json"].join(""),
                        i = t;
                    Object(r.a)("POST", a, i, n, o)
                },
                c = function(e, t, n) {
                    var o = e;
                    Object(r.a)("GET", "/stats/user_stats.json", o, t, n)
                },
                l = function(e, t, n) {
                    var o = e;
                    Object(r.a)("GET", "/stats/user_total_stats.json", o, t, n)
                },
                d = function(e, t, n) {
                    var o = e;
                    Object(r.a)("GET", "/stats/story_stats.json", o, t, n)
                },
                u = function(e, t, n) {
                    var o = e;
                    Object(r.a)("GET", "/stats/story_total_stats.json", o, t, n)
                },
                p = function(e, t, n) {
                    var o = e;
                    Object(r.a)("GET", "/stats/graph_stats.json", o, t, n)
                },
                f = function(e, t, n) {
                    var o = e;
                    Object(r.a)("GET", "/stats/graph_total_stats.json", o, t, n)
                },
                h = function(e, t, n, o) {
                    var a = {
                        from: e,
                        to: t
                    };
                    Object(r.a)("GET", "/stats.json", a, n, o)
                },
                g = function(e, t, n, o) {
                    var a = "/graphs/" + e + "/stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                },
                m = function(e, t, n, o) {
                    var a = "/graphs/" + e + "/total_stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                },
                y = function(e, t, n, o) {
                    var a = "/graphs/" + e + "/node_view_stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                },
                b = function(e, t, n, o) {
                    var a = "/users/" + e + "/graph_stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                },
                v = function(e, t, n, o) {
                    var a = "/users/" + e + "/graph_total_stats.json",
                        i = t;
                    Object(r.a)("POST", a, i, n, o)
                },
                _ = function(e, t, n, o) {
                    var a = "/users/" + e + "/story_stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                },
                w = function(e, t, n, o) {
                    var a = "/users/" + e + "/action_stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                },
                O = function(e, t, n, o) {
                    var a = "/users/" + e + "/story_total_stats.json",
                        i = t;
                    Object(r.a)("POST", a, i, n, o)
                },
                E = function(e, t, n, o) {
                    var a = "/hubs/" + e + "/graph_stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                },
                j = function(e, t, n, o) {
                    var a = "/hubs/" + e + "/graph_total_stats.json",
                        i = t;
                    Object(r.a)("POST", a, i, n, o)
                },
                S = function(e, t, n, o) {
                    var a = "/hubs/" + e + "/story_stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                },
                x = function(e, t, n, o) {
                    var a = "/hubs/" + e + "/story_total_stats.json",
                        i = t;
                    Object(r.a)("POST", a, i, n, o)
                },
                k = function(e, t, n) {
                    var o = "/stories/" + e + ".json?stage_svg=true&r=" + Math.floor(1e3 * Math.random());
                    Object(r.a)("GET", o, null, t, n)
                },
                C = function(e, t, n) {
                    var o = "/stories/" + e + ".json";
                    Object(r.a)("GET", o, null, t, n)
                },
                N = function(e, t, n, o) {
                    var a = "/graphs/" + e + "/stories.json";
                    Object(r.a)("GET", a, t, n, o)
                },
                T = function(e, t, n, o) {
                    var a = "/graphs/" + e + "/stories";
                    Object(r.a)("POST", a, t, n, o)
                },
                L = function(e, t, n, o) {
                    var a = "/stories/" + e + "/slides";
                    Object(r.a)("POST", a, t, n, o)
                },
                P = function(e, t, n, o) {
                    var a = "/slides/" + e + ".json";
                    Object(r.a)("PUT", a, t, n, o)
                },
                A = function(e, t, n, o) {
                    var a = "/stories/" + e + ".json";
                    Object(r.a)("PUT", a, t, n, o)
                },
                D = function(e, t, n) {
                    var o = "/stories/" + e + ".json";
                    Object(r.a)("DELETE", o, null, t, n)
                },
                M = function(e, t, n, o) {
                    var a = "/stories/" + e + "/slides/" + t;
                    Object(r.a)("DELETE", a, null, n, o)
                },
                q = function(e, t, n, o) {
                    var a = "/stories/" + e + "/reorder_slides.json",
                        i = {
                            slides_order: t.join(",")
                        };
                    Object(r.a)("PUT", a, i, n, o)
                },
                I = function(e, t, n, o) {
                    var a = "/stories/" + e + "/started.json";
                    Object(r.a)("POST", a, t, n, o)
                },
                R = function(e, t, n, o) {
                    var a = "/stories/" + e + "/completed.json";
                    Object(r.a)("POST", a, t, n, o)
                },
                B = function(e, t, n) {
                    var o = "/stories/" + e + "/recommend.json";
                    Object(r.a)("PUT", o, null, t, n)
                },
                F = function(e, t, n) {
                    var o = "/stories/" + e + "/unrecommend.json";
                    Object(r.a)("PUT", o, null, t, n)
                },
                G = function(e, t, n, o) {
                    var a = "/graphs/" + e + "/featured_stories.json",
                        i = {
                            stories: t.join(", ")
                        };
                    Object(r.a)("PUT", a, i, n, o)
                },
                H = function(e, t, n, o) {
                    var a = "/stories/" + e + "/email.json",
                        i = {
                            email: t
                        };
                    Object(r.a)("POST", a, i, n, o)
                },
                U = function(e, t, n, o) {
                    var a = "/stories/" + e + "/email_async.json",
                        i = {
                            email: t
                        };
                    Object(r.a)("POST", a, i, n, o)
                },
                z = function(e, t, n) {
                    var o = "/stories/" + e + "/tour_started.json";
                    Object(r.a)("POST", o, null, t, n)
                },
                W = function(e, t, n) {
                    var o = "/stories/" + e + "/tour_completed.json";
                    Object(r.a)("POST", o, null, t, n)
                },
                Y = function(e, t, n) {
                    var o = "/stories/" + e + "/tour_cancelled.json";
                    Object(r.a)("POST", o, null, t, n)
                },
                V = function(e, t, n, o) {
                    var a = "/stories/" + e + "/publish.json",
                        i = {};
                    t && (i.force = t.force), Object(r.a)("PUT", a, i, n, o)
                },
                X = function(e, t, n) {
                    var o = "/stories/" + e + "/unpublish.json";
                    Object(r.a)("PUT", o, null, t, n)
                },
                K = function(e, t, n) {
                    var o = "/stories/" + e + "/check_quality.json";
                    Object(r.a)("PUT", o, null, t, n)
                },
                $ = function(e, t, n, o) {
                    var a = "/stories/" + e + "/stats.json",
                        i = t;
                    Object(r.a)("GET", a, i, n, o)
                }
        },
        54: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "addIdsForNodeReferences", (function() {
                return o
            }));
            var r = n(0),
                o = function(e, t) {
                    for (var n = e.GraphHistory, o = /\[[#]([^\]]+)\](?!\(\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\))/gi, a = [];;) {
                        var i = o.exec(t);
                        if (!i) break;
                        a.push(i[1])
                    }
                    var s = Object(r.wb)(a),
                        c = t;
                    return s.forEach((function(e) {
                        var t, r, o = n.getNodeByName(e);
                        o ? (t = "[#" + e + "]", r = "[#" + e + "](" + o.id + ")") : (t = "[#" + e + "]", r = "#" + e), c = c.split(t).join(r)
                    })), c
                }
        },
        55: function(e, t, n) {
            "use strict";
            n.r(t);
            var r = n(61);
            n.d(t, "HeaderView", (function() {
                return r.a
            }));
            var o = n(120);
            n.d(t, "ReadOnlyStoryView", (function() {
                return o.a
            }));
            var a = n(62);
            n.d(t, "SlideView", (function() {
                return a.a
            }));
            var i = n(121);
            n.d(t, "StoryView", (function() {
                return i.a
            }));
            var s = n(76);
            n.d(t, "ThumbnailStripView", (function() {
                return s.a
            }))
        },
        57: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "AdminGraphStatsComponentWrapper", (function() {
                return d
            })), n.d(t, "AdminGraphStatsLoader", (function() {
                return u
            })), n.d(t, "AdminStoryStatsComponentWrapper", (function() {
                return h
            })), n.d(t, "AdminStoryStatsLoader", (function() {
                return g
            })), n.d(t, "AdminUserStatsComponentWrapper", (function() {
                return b
            })), n.d(t, "AdminUserStatsLoader", (function() {
                return v
            })), n.d(t, "AxisIncrementalTicks", (function() {
                return _
            })), n.d(t, "ContainsFloat", (function() {
                return w
            })), n.d(t, "DefaultYAxisHandler", (function() {
                return O
            })), n.d(t, "GraphStatsComponentWrapper", (function() {
                return E
            })), n.d(t, "GraphStatsLoader", (function() {
                return i
            })), n.d(t, "GraphStatsMetrics", (function() {
                return l
            })), n.d(t, "HubStatsLoader", (function() {
                return j
            })), n.d(t, "HubStoryStatsLoader", (function() {
                return S
            })), n.d(t, "StatsYAxisHandler", (function() {
                return k
            })), n.d(t, "StoryStatsComponentWrapper", (function() {
                return C
            })), n.d(t, "StoryStatsLoader", (function() {
                return p
            })), n.d(t, "StoryStatsMetrics", (function() {
                return f
            })), n.d(t, "UserActionStatsLoader", (function() {
                return m
            })), n.d(t, "UserGraphStatsLoader", (function() {
                return N
            })), n.d(t, "UserStatsMetrics", (function() {
                return y
            })), n.d(t, "UserStoryStatsLoader", (function() {
                return T
            })), n.d(t, "roundNumberToNextSignificant", (function() {
                return x
            })), n.d(t, "setMomentTimeFormat", (function() {
                return L
            }));
            var r = n(4),
                o = n(3),
                a = n(5),
                i = function(e, t) {
                    return function(n, r, o) {
                        Object(a.getGraphStats)(e, n, (function(e) {
                            r(e)
                        }), (function(e) {
                            "function" === typeof o && o(e)
                        })), "function" === typeof t && t(n)
                    }
                },
                s = n(0),
                c = n(22),
                l = [{
                    name: "Views",
                    value: "graph_viewed_count",
                    description: "Total number of views your graphs received"
                }, {
                    name: "Node Views",
                    value: "graph_node_viewed_count",
                    description: "Number of times your nodes selected on your graphs"
                }, {
                    name: "Recommends",
                    value: "graph_recommended_count",
                    description: "Number of recommends your graphs received"
                }, {
                    name: "Comments",
                    value: "graph_commented_count",
                    description: "Number of comments your graphs received"
                }, {
                    name: "Updates",
                    value: "graph_updated_count",
                    description: "Number of data updates on your graphs"
                }],
                d = function(e) {
                    var t = e.root,
                        n = e.Loader,
                        a = e.TotalLoader,
                        d = [],
                        u = t.querySelector(".tablesorter"),
                        p = {
                            min: null,
                            max: null
                        },
                        f = null,
                        h = "view_count",
                        g = function() {
                            w.triggerUpdate()
                        },
                        m = function(e) {
                            e ? w.setDataLoader(i(e, _)) : w.setDataLoader(n(_))
                        },
                        y = function(e) {
                            f != e && (function(e) {
                                var n = d.find((function(t) {
                                    return t.id === e
                                }));
                                if (!n) return;
                                var r = t.querySelector('section[data-for="all"]');
                                Object(s.h)(r, "not-shown");
                                var o = t.querySelector('section[data-for="graph"]');
                                o.querySelector('a[data-name="graph-name"]').innerHTML = n.name, o.querySelector('span[data-name="last-updated"]').innerHTML = n.last_updated_str, "Published" != n.status ? o.querySelector('span[data-name="status"]').innerHTML = "\u30fb " + n.status_str : o.querySelector('span[data-name="status"]').innerHTML = "";
                                o.querySelector('span[data-name="node-count"]').innerHTML = Object(s.k)(n.node_count, "node", "nodes"), o.querySelector('a[data-name="graph-link"]').href = "/graphs/" + n.id + "/stats";
                                var a = o.querySelector('a[data-name="hub-link"]');
                                n.hub_id ? (a.href = "/hubs/" + n.hub_id + "/stats", Object(s.nb)(a, "not-shown")) : Object(s.h)(a, "not-shown");
                                Object(s.nb)(o, "not-shown"), window.scrollTo(0, 0)
                            }(f = e), m(f), function(e) {
                                Object(s.h)(u, "with-selected"), Array.from(u.querySelectorAll("tbody tr")).forEach((function(t) {
                                    t.getAttribute("data-graph-id") == e ? Object(s.h)(t, "row-selected") : Object(s.nb)(t, "row-selected")
                                }))
                            }(e), g())
                        },
                        b = function() {
                            null != f && (f = null, function() {
                                var e = t.querySelector('section[data-for="all"]');
                                Object(s.nb)(e, "not-shown");
                                var n = t.querySelector('section[data-for="graph"]');
                                Object(s.h)(n, "not-shown")
                            }(), Object(s.nb)(u, "with-selected"), Array.from(u.querySelectorAll("tbody tr")).forEach((function(e) {
                                Object(s.nb)(e, "row-selected")
                            })), m(), g())
                        };
                    var v = function() {
                        var e = [
                            [0, 1]
                        ];
                        switch (h) {
                            case "view_count":
                                e = [
                                    [1, 1]
                                ];
                                break;
                            case "node_view_count":
                                e = [
                                    [2, 1]
                                ];
                                break;
                            case "recommendation_count":
                                e = [
                                    [3, 1]
                                ];
                                break;
                            case "comment_count":
                                e = [
                                    [4, 1]
                                ];
                                break;
                            case "update_count":
                                e = [
                                    [5, 1]
                                ]
                        }
                        setTimeout((function() {
                            Object(r.a)(u).trigger("sorton", [e])
                        }), 10)
                    };

                    function _(e) {
                        u.setAttribute("data-load-status", "loading");
                        var n = !1;
                        if (e.field !== h && (n = !0, h = e.field), p.min === e.from && p.max == e.to) return n && v(), void u.setAttribute("data-load-status", "done");
                        var i = Object(s.p)(e);
                        i.limit = 20, a(i, (function(e) {
                            var n, a, c;
                            d = e.graphs, n = e.total, a = e.total_count, (c = t.querySelector("tr.total-headers")).querySelector('th h4[data-name="graph-total"]').innerHTML = "Total (" + a + " graphs)", c.querySelector('th span[data-name="views"]').innerHTML = Object(s.fb)(n.view_count || 0), c.querySelector('th span[data-name="node-views"]').innerHTML = Object(s.fb)(n.node_view_count || 0), c.querySelector('th span[data-name="comments"]').innerHTML = Object(s.fb)(n.comment_count || 0), c.querySelector('th span[data-name="recommendations"]').innerHTML = Object(s.fb)(n.recommendation_count || 0), c.querySelector('th span[data-name="updates"]').innerHTML = Object(s.fb)(n.update_count || 0),
                                function() {
                                    for (var e = u.querySelector("tbody"); e.firstChild;) e.removeChild(e.firstChild)
                                }(),
                                function(e) {
                                    var t = u.querySelector("tbody");
                                    t.innerHTML = e.map((function(e) {
                                        return o.a["stats/graph_table_row"](e)
                                    })).join(""), Array.from(t.querySelectorAll("tr.graph")).forEach((function(e) {
                                        var t = e.getAttribute("data-graph-id");
                                        e.addEventListener("click", (function() {
                                            y(t)
                                        }))
                                    }))
                                }(e.graphs), p.min = i.from, p.max = i.to, Object(r.a)(u).trigger("update"), v(), u.setAttribute("data-load-status", "done")
                        }))
                    }
                    t.querySelector("tr.total-headers").addEventListener("click", (function() {
                        b()
                    })), t.querySelector("#showAllGraphs").addEventListener("click", (function() {
                        b()
                    })), Object(r.a)(u).tablesorter({
                        selectorHeaders: "thead tr:first-of-type th",
                        sortInitialOrder: "desc",
                        textExtraction: function(e) {
                            var t = e.getAttribute("data-sort-value");
                            return null != t ? t : e.textContent
                        }
                    });
                    var w = Object(c.statsComponent)({
                        insertBefore: t.querySelector("br.after-stats"),
                        minFromDate: e.minFromDate,
                        maxToDate: e.maxToDate,
                        extremeFromDate: e.extremeFromDate,
                        dataLoader: n(_),
                        metrics: l
                    });
                    u.setAttribute("data-initialized", !0)
                },
                u = function(e) {
                    return function(t, n, r) {
                        Object(a.getAdminGraphStats)(t, (function(e) {
                            n(e)
                        }), (function(e) {
                            "function" === typeof r && r(e)
                        })), "function" === typeof e && e(t)
                    }
                },
                p = function(e, t) {
                    return function(n, r, o) {
                        Object(a.getStoryStats)(e, n, (function(e) {
                            r(e)
                        }), (function(e) {
                            "function" === typeof o && o(e)
                        })), "function" == typeof t && t(n)
                    }
                },
                f = [{
                    name: "Views",
                    value: "story_viewed_count",
                    description: "Total number of times stories viewed"
                }, {
                    name: "Completed",
                    value: "story_completed_count",
                    description: "Number of times stories viewed until the end"
                }],
                h = function(e) {
                    var t = e.root,
                        n = e.Loader,
                        a = e.TotalLoader,
                        i = [],
                        l = t.querySelector(".tablesorter"),
                        d = {
                            min: null,
                            max: null
                        },
                        u = null,
                        h = "view_count",
                        g = function() {
                            w.triggerUpdate()
                        },
                        m = function(e) {
                            e ? w.setDataLoader(p(e, _)) : w.setDataLoader(n(_))
                        },
                        y = function(e) {
                            u != e && (function(e) {
                                var n = i.find((function(t) {
                                    return t.id === e
                                }));
                                if (!n) return;
                                var r = t.querySelector('section[data-for="all"]');
                                Object(s.h)(r, "not-shown");
                                var o = t.querySelector('section[data-for="story"]');
                                o.querySelector('a[data-name="story-title"]').innerHTML = n.title, o.querySelector('span[data-name="updated_at"]').innerHTML = n.updated_at_str, o.querySelector('span[data-name="slides-count"]').innerHTML = Object(s.k)(n.slides_count, "slide", "slides"), o.querySelector('a[data-name="graph-link"]').href = "/graphs/" + n.graph.id + "/stats";
                                var a = o.querySelector('a[data-name="hub-link"]');
                                n.hub ? (a.href = "/hubs/" + n.hub.id + "/stats", Object(s.nb)(a, "not-shown")) : Object(s.h)(a, "not-shown");
                                Object(s.nb)(o, "not-shown"), window.scrollTo(0, 0)
                            }(u = e), m(u), function(e) {
                                Object(s.h)(l, "with-selected"), Array.from(l.querySelectorAll("tbody tr")).forEach((function(t) {
                                    t.getAttribute("data-story-id") == e ? Object(s.h)(t, "row-selected") : Object(s.nb)(t, "row-selected")
                                }))
                            }(e), g())
                        },
                        b = function() {
                            null != u && (u = null, function() {
                                var e = t.querySelector('section[data-for="all"]');
                                Object(s.nb)(e, "not-shown");
                                var n = t.querySelector('section[data-for="story"]');
                                Object(s.h)(n, "not-shown")
                            }(), Object(s.nb)(l, "with-selected"), Array.from(l.querySelectorAll("tbody tr")).forEach((function(e) {
                                Object(s.nb)(e, "row-selected")
                            })), m(), g())
                        };
                    var v = function() {
                        var e = [
                            [0, 1]
                        ];
                        switch (h) {
                            case "view_count":
                                e = [
                                    [1, 1]
                                ];
                                break;
                            case "completed_count":
                                e = [
                                    [2, 1]
                                ]
                        }
                        setTimeout((function() {
                            Object(r.a)(l).trigger("sorton", [e])
                        }), 10)
                    };

                    function _(e) {
                        l.setAttribute("data-load-status", "loading");
                        var n = !1;
                        if (e.field !== h && (n = !0, h = e.field), d.min === e.from && d.max == e.to) return n && v(), void l.setAttribute("data-load-status", "done");
                        var c = Object(s.p)(e);
                        c.limit = 40, a(c, (function(e) {
                            var n, a, u;
                            i = e.stories, n = e.total, a = e.stories, (u = t.querySelector("tr.total-headers")).querySelector('th h4[data-name="story-total"]').innerHTML = "All Stories (" + a.length + ")", u.querySelector('th span[data-name="viewed"]').innerHTML = Object(s.fb)(n.view_count || 0), u.querySelector('th span[data-name="completed"]').innerHTML = Object(s.fb)(n.completed_count || 0), u.querySelector('th span[data-name="completed-percentage"]').innerHTML = n.percentage_completed_ratio,
                                function() {
                                    for (var e = l.querySelector("tbody"); e.firstChild;) e.removeChild(e.firstChild)
                                }(),
                                function(e) {
                                    var t = l.querySelector("tbody");
                                    t.innerHTML = e.map((function(e) {
                                        return o.a["stats/story_table_row"](e)
                                    })).join(""), Array.from(t.querySelectorAll("tr.story")).forEach((function(e) {
                                        var t = e.getAttribute("data-story-id");
                                        e.addEventListener("click", (function() {
                                            y(t)
                                        }))
                                    }))
                                }(e.stories), d.min = c.from, d.max = c.to, Object(r.a)(l).trigger("update"), v(), l.setAttribute("data-load-status", "done")
                        }))
                    }
                    t.querySelector("tr.total-headers").addEventListener("click", (function() {
                        b()
                    })), t.querySelector("#showAllStories").addEventListener("click", (function() {
                        b()
                    })), Object(r.a)(l).tablesorter({
                        selectorHeaders: "thead tr:first-of-type th",
                        sortInitialOrder: "desc",
                        textExtraction: function(e) {
                            var t = e.getAttribute("data-sort-value");
                            return null != t ? t : e.textContent
                        }
                    });
                    var w = Object(c.statsComponent)({
                        insertBefore: t.querySelector("br.after-stats"),
                        minFromDate: e.minFromDate,
                        maxToDate: e.maxToDate,
                        extremeFromDate: e.extremeFromDate,
                        dataLoader: n(_),
                        metrics: f
                    });
                    l.setAttribute("data-initialized", !0)
                },
                g = function(e) {
                    return function(t, n, r) {
                        Object(a.getAdminStoryStats)(t, (function(e) {
                            n(e)
                        }), (function(e) {
                            "function" === typeof r && r(e)
                        })), "function" === typeof e && e(t)
                    }
                },
                m = function(e, t) {
                    return function(n, r, o) {
                        Object(a.getUserActionStats)(e, n, (function(e) {
                            r(e)
                        }), (function(e) {
                            "function" === typeof o && o(e)
                        })), "function" === typeof t && t(n)
                    }
                },
                y = [{
                    name: "Actions",
                    value: "*",
                    description: "Total number of authenticated actions by members"
                }, {
                    name: "New Graphs",
                    value: "graph_created_count",
                    description: "Number of graphs created by members"
                }, {
                    name: "Updated Graphs",
                    value: "graph_updated_count",
                    description: "Number of graphs updated by members"
                }],
                b = function(e) {
                    var t = e.root,
                        n = e.Loader,
                        a = e.TotalLoader,
                        i = [],
                        l = t.querySelector(".tablesorter"),
                        d = {
                            min: null,
                            max: null
                        },
                        u = null,
                        p = "action_count",
                        f = function() {
                            w.triggerUpdate()
                        },
                        h = function(e) {
                            e ? w.setDataLoader(m(e, _)) : w.setDataLoader(n(_))
                        },
                        g = function(e) {
                            u != e && (function(e) {
                                var n = i.find((function(t) {
                                    return t.id === e
                                }));
                                if (!n) return;
                                var r = t.querySelector('section[data-for="all"]');
                                Object(s.h)(r, "not-shown");
                                var o = t.querySelector('section[data-for="user"]');
                                o.querySelector('a[data-name="user-name"]').innerHTML = n.display_name, o.querySelector('a[data-name="user-link"]').href = "/users/" + n.id, o.querySelector('span[data-name="member-since"]').innerHTML = n.created_at_str, o.querySelector('span[data-name="plan-name"]').innerHTML = n.plan, Object(s.nb)(o, "not-shown"), window.scrollTo(0, 0)
                            }(u = e), h(u), function(e) {
                                Object(s.h)(l, "with-selected"), Array.from(l.querySelectorAll("tbody tr")).forEach((function(t) {
                                    t.getAttribute("data-user-id") == e ? Object(s.h)(t, "row-selected") : Object(s.nb)(t, "row-selected")
                                }))
                            }(e), f())
                        },
                        b = function() {
                            null != u && (u = null, function() {
                                var e = t.querySelector('section[data-for="all"]');
                                Object(s.nb)(e, "not-shown");
                                var n = t.querySelector('section[data-for="user"]');
                                Object(s.h)(n, "not-shown")
                            }(), Object(s.nb)(l, "with-selected"), Array.from(l.querySelectorAll("tbody tr")).forEach((function(e) {
                                Object(s.nb)(e, "row-selected")
                            })), h(), f())
                        };
                    var v = function() {
                        var e = [
                            [0, 1]
                        ];
                        switch (p) {
                            case "action_count":
                                e = [
                                    [1, 1]
                                ];
                                break;
                            case "graphs_created_count":
                                e = [
                                    [2, 1]
                                ];
                                break;
                            case "graphs_updated_count":
                                e = [
                                    [3, 1]
                                ]
                        }
                        setTimeout((function() {
                            Object(r.a)(l).trigger("sorton", [e])
                        }), 10)
                    };

                    function _(e) {
                        l.setAttribute("data-load-status", "loading");
                        var t = !1;
                        if (e.field !== p && (t = !0, p = e.field), d.min === e.from && d.max == e.to) return t && v(), void l.setAttribute("data-load-status", "done");
                        var n = Object(s.p)(e);
                        n.limit = 20, a(n, (function(e) {
                            var t, a, c;
                            i = e.users, t = e.total, a = e.total_count, (c = document.querySelector("tr.total-headers")).querySelector('th span[data-name="action-count"]').innerHTML = Object(s.fb)(t.action_count || 0), c.querySelector('th span[data-name="graphs-created-count"]').innerHTML = Object(s.fb)(t.graphs_created_count || 0), c.querySelector('th span[data-name="graphs-updated-count"]').innerHTML = Object(s.fb)(t.graphs_updated_count || 0), c.querySelector('th [data-name="user-count"]').innerHTML = "All Users (" + a + ")",
                                function() {
                                    for (var e = l.querySelector("tbody"); e.firstChild;) e.removeChild(e.firstChild)
                                }(),
                                function(e) {
                                    var t = l.querySelector("tbody");
                                    t.innerHTML = e.map((function(e) {
                                        return o.a["stats/user_table_row"](e)
                                    })).join(""), Array.from(t.querySelectorAll("tr.user")).forEach((function(e) {
                                        var t = e.getAttribute("data-user-id");
                                        e.addEventListener("click", (function() {
                                            g(t)
                                        }))
                                    }))
                                }(e.users), d.min = n.from, d.max = n.to, Object(r.a)(l).trigger("update"), v(), l.setAttribute("data-load-status", "done")
                        }))
                    }
                    t.querySelector("tr.total-headers").addEventListener("click", (function() {
                        b()
                    })), t.querySelector("#showAllUsers").addEventListener("click", (function() {
                        b()
                    })), Object(r.a)(l).tablesorter({
                        selectorHeaders: "thead tr:first-of-type th",
                        sortInitialOrder: "desc",
                        textExtraction: function(e) {
                            var t = e.getAttribute("data-sort-value");
                            return null != t ? t : e.textContent
                        }
                    });
                    var w = Object(c.statsComponent)({
                        insertBefore: t.querySelector("br.after-stats"),
                        minFromDate: e.minFromDate,
                        maxToDate: e.maxToDate,
                        extremeFromDate: e.extremeFromDate,
                        dataLoader: n(_),
                        metrics: y
                    });
                    l.setAttribute("data-initialized", !0)
                },
                v = function(e) {
                    return function(t, n, r) {
                        Object(a.getAdminUserStats)(t, (function(e) {
                            n(e)
                        }), (function(e) {
                            "function" === typeof r && r(e)
                        })), "function" === typeof e && e(t)
                    }
                },
                _ = function(e, t) {
                    for (var n = e.reduce((function(e, t) {
                            var n = Math.max.apply(null, t.slice(1));
                            return Math.max(e, n)
                        }), Number.MIN_VALUE), r = e.reduce((function(e, t) {
                            var n = Math.min.apply(null, t.slice(1));
                            return Math.min(e, n)
                        }), Number.MAX_VALUE), o = (n - r) / 5, a = [r], i = 1; i < 5; i += 1) {
                        var s = r + o * i;
                        t && (s = Math.floor(s)), a.push(s)
                    }
                    return a.push(n), a
                },
                w = function(e) {
                    return e.find((function(e) {
                        return e.slice(1).find((function(e) {
                            return Number(e) === e && e % 1 !== 0
                        }))
                    }))
                },
                O = function(e) {
                    var t = w(e);
                    return {
                        tick: {
                            outer: !1,
                            values: _(e, !t),
                            format: t ? function(e) {
                                return e.toFixed(2)
                            } : function(e) {
                                return e
                            }
                        },
                        padding: {
                            bottom: 24
                        }
                    }
                },
                E = function(e) {
                    var t = e.id,
                        n = e.root || document,
                        a = e.graphs,
                        d = e.Loader,
                        u = e.TotalLoader,
                        p = n.querySelector(".tablesorter"),
                        f = a.map((function(e) {
                            return e.id
                        })),
                        h = {
                            min: null,
                            max: null
                        },
                        g = null,
                        m = "view_count",
                        y = function() {
                            E.triggerUpdate()
                        },
                        b = function(e) {
                            e ? E.setDataLoader(i(e, O)) : E.setDataLoader(d(t, O))
                        },
                        v = function(e) {
                            g != e && (function(e) {
                                var t = a.find((function(t) {
                                    return t.id === e
                                }));
                                if (!t) return;
                                var r = n.querySelector('section[data-for="all"]');
                                Object(s.h)(r, "not-shown");
                                var o = n.querySelector('section[data-for="graph"]');
                                o.querySelector('a[data-name="graph-name"]').innerHTML = t.name, o.querySelector('span[data-name="last-updated"]').innerHTML = t.last_updated_str, "Published" != t.status ? o.querySelector('span[data-name="status"]').innerHTML = "\u30fb " + t.status : o.querySelector('span[data-name="status"]').innerHTML = "";
                                o.querySelector('span[data-name="node-count"]').innerHTML = Object(s.k)(t.node_count, "node", "nodes"), o.querySelector('a[data-name="graph-link"]').href = "/graphs/" + t.id + "/stats";
                                var i = o.querySelector('a[data-name="hub-link"]');
                                t.hub_id ? (i.href = "/hubs/" + t.hub_id + "/stats", Object(s.nb)(i, "not-shown")) : Object(s.h)(i, "not-shown");
                                Object(s.nb)(o, "not-shown"), window.scrollTo(0, 0)
                            }(g = e), b(g), function(e) {
                                Object(s.h)(p, "with-selected"), Array.from(p.querySelectorAll("tbody tr")).forEach((function(t) {
                                    t.getAttribute("data-graph-id") == e ? Object(s.h)(t, "row-selected") : Object(s.nb)(t, "row-selected")
                                }))
                            }(e), y())
                        },
                        _ = function() {
                            null != g && (g = null, function() {
                                var e = n.querySelector('section[data-for="all"]');
                                Object(s.nb)(e, "not-shown");
                                var t = n.querySelector('section[data-for="graph"]');
                                Object(s.h)(t, "not-shown")
                            }(), Object(s.nb)(p, "with-selected"), Array.from(p.querySelectorAll("tbody tr")).forEach((function(e) {
                                Object(s.nb)(e, "row-selected")
                            })), b(), y())
                        };
                    var w = function() {
                        var e = [
                            [0, 1]
                        ];
                        switch (m) {
                            case "view_count":
                                e = [
                                    [1, 1]
                                ];
                                break;
                            case "node_view_count":
                                e = [
                                    [2, 1]
                                ];
                                break;
                            case "recommendation_count":
                                e = [
                                    [3, 1]
                                ];
                                break;
                            case "comment_count":
                                e = [
                                    [4, 1]
                                ];
                                break;
                            case "update_count":
                                e = [
                                    [5, 1]
                                ]
                        }
                        setTimeout((function() {
                            Object(r.a)(p).trigger("sorton", [e])
                        }), 10)
                    };

                    function O(e) {
                        var o = !1;
                        if (e.field !== m && (o = !0, m = e.field), h.min !== e.from || h.max != e.to) {
                            var a = Object(s.p)(e);
                            a.graphs = f, u(t, a, (function(e) {
                                var t, o;
                                t = e.total, (o = n.querySelector("tr.total-headers")).querySelector('th span[data-name="views"]').innerHTML = Object(s.fb)(t.view_count || 0), o.querySelector('th span[data-name="node-views"]').innerHTML = Object(s.fb)(t.node_view_count || 0), o.querySelector('th span[data-name="comments"]').innerHTML = Object(s.fb)(t.comment_count || 0), o.querySelector('th span[data-name="recommendations"]').innerHTML = Object(s.fb)(t.recommendation_count || 0), o.querySelector('th span[data-name="updates"]').innerHTML = Object(s.fb)(t.update_count || 0), f.forEach((function(t) {
                                    Object.prototype.hasOwnProperty.call(e, t) ? function(e, t) {
                                        var n = p.querySelector('tr[data-graph-id="' + e + '"]');
                                        if (n) {
                                            var r = Array.from(n.querySelectorAll("td")),
                                                o = r[1];
                                            o.setAttribute("data-sort-value", t.view_count), o.querySelector('span[data-name="views"]').innerHTML = Object(s.fb)(t.view_count || 0);
                                            var a = r[2];
                                            a.setAttribute("data-sort-value", t.node_view_count), a.querySelector('span[data-name="node-views"]').innerHTML = Object(s.fb)(t.node_view_count || 0);
                                            var i = r[3];
                                            i.setAttribute("data-sort-value", t.recommendation_count), i.querySelector('span[data-name="recommendations"]').innerHTML = Object(s.fb)(t.recommendation_count || 0);
                                            var c = r[4];
                                            c.setAttribute("data-sort-value", t.comment_count), c.querySelector('span[data-name="comments"]').innerHTML = Object(s.fb)(t.comment_count || 0);
                                            var l = r[5];
                                            l.setAttribute("data-sort-value", t.update_count), l.querySelector('span[data-name="updates"]').innerHTML = Object(s.fb)(t.update_count || 0), Object(s.nb)(n, "not-shown")
                                        }
                                    }(t, e[t]) : function(e) {
                                        var t = p.querySelector('tr[data-graph-id="' + e + '"]');
                                        Object(s.h)(t, "not-shown")
                                    }(t)
                                })), h.min = a.from, h.max = a.to, Object(r.a)(p).trigger("update"), w()
                            }))
                        } else o && w()
                    }
                    n.querySelector("tbody").innerHTML = a.map((function(e) {
                        return o.a["stats/graph_table_row"](e)
                    })).join(""), Array.from(n.querySelectorAll("tr.graph")).forEach((function(e) {
                        var t = e.getAttribute("data-graph-id");
                        e.addEventListener("click", (function() {
                            v(t)
                        }))
                    })), n.querySelector("tr.total-headers").addEventListener("click", (function() {
                        _()
                    })), n.querySelector("#showAllGraphs").addEventListener("click", (function() {
                        _()
                    })), Object(r.a)(p).tablesorter({
                        selectorHeaders: "thead tr:first-of-type th",
                        sortInitialOrder: "desc",
                        textExtraction: function(e) {
                            var t = e.getAttribute("data-sort-value");
                            return null != t ? t : e.textContent
                        }
                    });
                    var E = Object(c.statsComponent)({
                        insertBefore: n.querySelector("br.after-stats"),
                        minFromDate: e.minFromDate,
                        maxToDate: e.maxToDate,
                        extremeFromDate: e.extremeFromDate,
                        dataLoader: d(t, O),
                        metrics: l
                    });
                    p.setAttribute("data-initialized", !0)
                },
                j = function(e, t) {
                    return function(n, r, o) {
                        Object(a.getHubGraphStats)(e, n, (function(e) {
                            r(e)
                        }), (function(e) {
                            "function" === typeof o && o(e)
                        })), "function" === typeof t && t(n)
                    }
                },
                S = function(e, t) {
                    return function(n, r, o) {
                        Object(a.getHubStoryStats)(e, n, (function(e) {
                            r(e)
                        }), (function(e) {
                            "function" === typeof o && o(e)
                        })), "function" === typeof t && t(n)
                    }
                },
                x = function(e) {
                    if (e <= 10) return 10;
                    if (e < 100) return 10 * (Math.floor(e / 10) + 1);
                    var t = Math.log(e) * Math.LOG10E + 1 | 0,
                        n = Math.pow(10, t - 2);
                    return e % n === 0 ? e : (Math.floor(e / n) + 1) * n
                },
                k = function(e) {
                    var t = Math.max.apply(null, e[0].slice(1));
                    return {
                        min: 0,
                        max: t = x(t),
                        tick: {
                            outer: !1,
                            values: [0, .5 * t, t],
                            format: function(e) {
                                return e > 1e3 ? Number((e / 1e3).toFixed(1)) + "K" : e
                            }
                        },
                        padding: 0
                    }
                },
                C = function(e) {
                    var t = e.id,
                        n = e.root,
                        a = e.stories,
                        i = e.Loader,
                        l = e.TotalLoader,
                        d = n.querySelector(".tablesorter"),
                        u = a.map((function(e) {
                            return e.id
                        })),
                        h = {
                            min: null,
                            max: null
                        },
                        g = null,
                        m = "view_count",
                        y = function() {
                            E.triggerUpdate()
                        },
                        b = function(e) {
                            e ? E.setDataLoader(p(e, O)) : E.setDataLoader(i(t, O))
                        },
                        v = function(e) {
                            g != e && (function(e) {
                                var t = a.find((function(t) {
                                    return t.id === e
                                }));
                                if (!t) return;
                                var r = n.querySelector('section[data-for="all"]');
                                Object(s.h)(r, "not-shown");
                                var o = n.querySelector('section[data-for="story"]');
                                o.querySelector('a[data-name="story-title"]').innerHTML = t.title, o.querySelector('span[data-name="updated_at"]').innerHTML = t.updated_at_str, o.querySelector('span[data-name="slides-count"]').innerHTML = Object(s.k)(t.slides_count, "slide", "slides"), o.querySelector('a[data-name="graph-link"]').href = "/graphs/" + t.graph.id + "/stats";
                                var i = o.querySelector('a[data-name="hub-link"]');
                                t.hub ? (i.href = "/hubs/" + t.hub.id + "/stats", Object(s.nb)(i, "not-shown")) : Object(s.h)(i, "not-shown");
                                Object(s.nb)(o, "not-shown"), window.scrollTo(0, 0)
                            }(g = e), b(g), function(e) {
                                Object(s.h)(d, "with-selected"), Array.from(d.querySelectorAll("tbody tr")).forEach((function(t) {
                                    t.getAttribute("data-story-id") == e ? Object(s.h)(t, "row-selected") : Object(s.nb)(t, "row-selected")
                                }))
                            }(e), y())
                        },
                        _ = function() {
                            null != g && (g = null, function() {
                                var e = n.querySelector('section[data-for="all"]');
                                Object(s.nb)(e, "not-shown");
                                var t = n.querySelector('section[data-for="story"]');
                                Object(s.h)(t, "not-shown")
                            }(), Object(s.nb)(d, "with-selected"), Array.from(d.querySelectorAll("tbody tr")).forEach((function(e) {
                                Object(s.nb)(e, "row-selected")
                            })), b(), y())
                        };
                    var w = function() {
                        var e = [
                            [0, 1]
                        ];
                        switch (m) {
                            case "view_count":
                                e = [
                                    [1, 1]
                                ];
                                break;
                            case "completed_count":
                                e = [
                                    [2, 1]
                                ]
                        }
                        setTimeout((function() {
                            Object(r.a)(d).trigger("sorton", [e])
                        }), 10)
                    };

                    function O(e) {
                        d.setAttribute("data-load-status", "loading");
                        var o = !1;
                        if (e.field !== m && (o = !0, m = e.field), h.min === e.from && h.max == e.to) return o && w(), void d.setAttribute("data-load-status", "done");
                        var a = Object(s.p)(e);
                        a.stories = u, l(t, a, (function(e) {
                            var t, o;
                            t = e.total, (o = n.querySelector("tr.total-headers")).querySelector('th span[data-name="viewed"]').innerHTML = Object(s.fb)(t.view_count || 0), o.querySelector('th span[data-name="completed"]').innerHTML = Object(s.fb)(t.completed_count || 0), o.querySelector('th span[data-name="completed-percentage"]').innerHTML = t.percentage_completed_ratio, u.forEach((function(t) {
                                Object.prototype.hasOwnProperty.call(e, t) ? function(e, t) {
                                    var n = d.querySelector('tr[data-story-id="' + e + '"]');
                                    if (n) {
                                        var r = Array.from(n.querySelectorAll("td")),
                                            o = r[1];
                                        o.setAttribute("data-sort-value", t.view_count), o.querySelector('span[data-name="viewed"]').innerHTML = Object(s.fb)(t.view_count || 0);
                                        var a = r[2];
                                        a.setAttribute("data-sort-value", t.completed_count), a.querySelector('span[data-name="completed"]').innerHTML = Object(s.fb)(t.completed_count || 0);
                                        var i = r[3];
                                        i.setAttribute("data-sort-value", t.completed_ratio), i.querySelector('span[data-name="completed-percentage"]').innerHTML = t.percentage_completed_ratio, Object(s.nb)(n, "not-shown")
                                    }
                                }(t, e[t]) : function(e) {
                                    var t = d.querySelector('tr[data-story-id="' + e + '"]');
                                    Object(s.h)(t, "not-shown")
                                }(t)
                            })), h.min = a.from, h.max = a.to, Object(r.a)(d).trigger("update"), w(), d.setAttribute("data-load-status", "done")
                        }))
                    }
                    n.querySelector("tbody").innerHTML = a.map((function(e) {
                        return o.a["stats/story_table_row"](e)
                    })).join(""), Array.from(n.querySelectorAll("tr.story")).forEach((function(e) {
                        var t = e.getAttribute("data-story-id");
                        e.addEventListener("click", (function() {
                            v(t)
                        }))
                    })), n.querySelector("tr.total-headers").addEventListener("click", (function() {
                        _()
                    })), n.querySelector("#showAllStories").addEventListener("click", (function() {
                        _()
                    })), Object(r.a)(d).tablesorter({
                        selectorHeaders: "thead tr:first-of-type th",
                        sortInitialOrder: "desc",
                        textExtraction: function(e) {
                            var t = e.getAttribute("data-sort-value");
                            return null != t ? t : e.textContent
                        }
                    });
                    var E = Object(c.statsComponent)({
                        insertBefore: n.querySelector("br.after-stats"),
                        minFromDate: e.minFromDate,
                        maxToDate: e.maxToDate,
                        extremeFromDate: e.extremeFromDate,
                        dataLoader: i(t, O),
                        metrics: f
                    });
                    d.setAttribute("data-initialized", !0)
                },
                N = function(e, t) {
                    return function(n, r, o) {
                        Object(a.getUserGraphStats)(e, n, (function(e) {
                            r(e)
                        }), (function(e) {
                            "function" === typeof o && o(e)
                        })), "function" === typeof t && t(n)
                    }
                },
                T = function(e, t) {
                    return function(n, r, o) {
                        Object(a.getUserStoryStats)(e, n, (function(e) {
                            r(e)
                        }), (function(e) {
                            "function" === typeof o && o(e)
                        })), "function" === typeof t && t(n)
                    }
                },
                L = function(e) {
                    switch (e) {
                        case "year":
                            return "YYYY";
                        case "month":
                            return "MMM YYYY";
                        case "week":
                        case "day":
                            return "MMM D, YYYY";
                        case "hour":
                            return "HH:00 MMM D, YYYY";
                        case "minute":
                            return "HH:mm MMM D, YYYY";
                        case "second":
                            return "HH:mm:ss MMM D, YYYY";
                        case "millisecond":
                            return "HH:mm:ss.SSS MMM D, YYYY";
                        default:
                            return "HH:00 MMM D, YYYY"
                    }
                }
        },
        61: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return a
            }));
            var r = n(4),
                o = n(0),
                a = function(e) {
                    var t, n, a, i, s, c = e || {},
                        l = c.rootEl,
                        d = e.isEditMode,
                        u = c.onStoryViewClosed,
                        p = c.onEditRequested,
                        f = c.onHelpRequested,
                        h = c.onPublishRequested,
                        g = c.onQualityCheckRequested,
                        m = l.querySelector("nav");
                    c.disableClose || m.querySelector("a.close-story-view").addEventListener("click", (function(e) {
                        return e.preventDefault(), this.blur(), u(), !1
                    }));
                    (c.show_edit_button && ((t = m.querySelector("#btnBackToEdit")).addEventListener("click", (function(e) {
                        return e.preventDefault(), this.blur(), p(), !1
                    })), d && Object(o.h)(t.parentNode, "not-shown")), c.show_save_notification && (n = m.querySelector(".notify-story-saved")), c.onGraphRequested) && m.querySelector("#graph-name").addEventListener("click", (function(e) {
                        return e.preventDefault(), c.onGraphRequested(), !1
                    }));
                    return c.show_help_button && (a = m.querySelector("#btnShowStoryHelp")).addEventListener("click", (function(e) {
                        return e.preventDefault(), f(), !1
                    })), c.show_publish_button && (i = m.querySelector("#btnPublishStory")).addEventListener("click", (function(e) {
                        return e.preventDefault(), h(), !1
                    })), c.show_quality_check_button && (s = m.querySelector("#btnCheckQuality")).addEventListener("click", (function(e) {
                        return e.preventDefault(), g(), !1
                    })), {
                        enterPresentationMode: function() {
                            Object(o.nb)(t.parentNode, "not-shown"), Object(o.h)(a.parentNode, "not-shown"), i && Object(o.h)(i.parentNode, "not-shown"), s && Object(o.h)(s.parentNode, "not-shown")
                        },
                        exitPresentationMode: function() {
                            Object(o.h)(t.parentNode, "not-shown"), Object(o.nb)(a.parentNode, "not-shown"), i && Object(o.nb)(i.parentNode, "not-shown"), s && Object(o.nb)(s.parentNode, "not-shown")
                        },
                        setSelectedSlide: function() {},
                        notifySaveStart: function() {
                            Object(r.a)(n).find("span").text("Saving story..."), Object(r.a)(n).show()
                        },
                        notifyStorySaved: function() {
                            Object(r.a)(n).find("span").text("Story saved"), Object(r.a)(n).fadeOut(1e3)
                        },
                        setPublishStatus: function(e) {
                            i && (0 == e ? (i.innerHTML = "Publish", Object(o.h)(i, "prominent")) : (i.innerHTML = "Unpublish", Object(o.nb)(i, "prominent")))
                        },
                        setReviewButtonVisibility: function(e) {
                            s && (e ? Object(o.nb)(s.parentNode, "not-shown") : Object(o.h)(s.parentNode, "not-shown"))
                        },
                        setPublishButtonVisibility: function(e) {
                            i && (e ? Object(o.nb)(i.parentNode, "not-shown") : Object(o.h)(i.parentNode, "not-shown"))
                        }
                    }
                }
        },
        62: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return s
            }));
            var r = n(4),
                o = n(6),
                a = n.n(o),
                i = n(0),
                s = function(e) {
                    var t, n, o, s, c, l = e || {},
                        d = l.root,
                        u = l.captureController,
                        p = l.onNextSlideRequested,
                        f = l.onPreviousSlideRequested,
                        h = l.onRemoveImageRequested,
                        g = l.onViewGraphRequested,
                        m = l.noThumbnailStrip,
                        y = l.onRestartStory,
                        b = l.onRecommendRequested,
                        v = l.onStoryShareRequested,
                        _ = l.onEmailRequested,
                        w = l.onTextChanged,
                        O = l.readOnly,
                        E = O,
                        j = !1,
                        S = d.querySelector(".story-slide-container");
                    m && Object(i.nb)(S, "with-bottom-strip");
                    var x = d.querySelector("div.story-slide"),
                        k = d.querySelector("div.story-slide.last-slide"),
                        C = k.querySelector("div.content-holder"),
                        N = C.querySelector(".text-content");
                    N.classList.add("gc-custom-scrollbar");
                    var T = k.querySelector("div.svg-area");
                    Array.from(k.querySelectorAll("a.restart-story")).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), y(), !1
                        }))
                    })), k.querySelector("a#btn-view-graph").addEventListener("click", (function(e) {
                        return e.preventDefault(), g(), !1
                    }));
                    var L = Array.from(k.querySelectorAll("a.story-recommend"));
                    L.forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), b(), !1
                        }))
                    })), Array.from(k.querySelectorAll("a.tw-share")).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), v("twitter"), !1
                        }))
                    })), Array.from(k.querySelectorAll("a.fb-share")).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), v("facebook"), !1
                        }))
                    })), Array.from(k.querySelectorAll("a.link-share")).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), v("link"), !1
                        }))
                    })), k.querySelector("a.submit-email").addEventListener("click", (function(e) {
                        return e.preventDefault(), _(), !1
                    }));
                    var P, A, D = x.querySelector("div.svg-area");
                    l.show_upload_remove && (P = D.querySelector("a")).addEventListener("click", (function(e) {
                        return e.preventDefault(), h(), !1
                    })), l.show_upload_image && ((A = D.querySelector("span.upload-image")).addEventListener("mouseover", (function() {
                        Object(i.h)(D, "show-upload-help")
                    })), A.addEventListener("mouseleave", (function() {
                        Object(i.nb)(D, "show-upload-help")
                    })));
                    var M = x.querySelector("div.content-holder"),
                        q = M.querySelector(".text-content"),
                        I = M.querySelector(".slide-text"),
                        R = M.querySelector(".story-title"),
                        B = M.querySelector(".story-subtitle");
                    if (!O) {
                        var F = function(e) {
                            27 == e.keyCode && (this.blur(), window.getSelection().removeAllRanges())
                        };
                        I.addEventListener("keyup", F), R.addEventListener("keyup", F), B.addEventListener("keyup", F)
                    }
                    var G = M.querySelector(".slide-footer"),
                        H = M.querySelector("footer");
                    R.addEventListener("click", (function(e) {
                        return e.preventDefault(), e.stopPropagation(), !1
                    }));
                    var U = M.querySelector("ul.story-share");
                    E ? Object(i.nb)(U, "not-shown") : Object(i.h)(U, "not-shown"), U.querySelector("a.tw-share").addEventListener("click", (function(e) {
                        return e.preventDefault(), v("twitter"), !1
                    })), U.querySelector("a.fb-share").addEventListener("click", (function(e) {
                        return e.preventDefault(), v("facebook"), !1
                    })), U.querySelector("a.link-share").addEventListener("click", (function(e) {
                        return e.preventDefault(), v("link"), !1
                    }));
                    var z = function() {
                            B.focus()
                        },
                        W = function() {
                            I.focus()
                        },
                        Y = function() {};
                    q.addEventListener("click", (function() {
                        Y()
                    }));
                    var V = Array.from(d.querySelectorAll(".next-slide"));
                    V.forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), p(), !1
                        }))
                    }));
                    var X = Array.from(d.querySelectorAll(".prev-slide"));
                    X.forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), f(), !1
                        }))
                    }));
                    var K, $ = (K = p, function(e) {
                            13 === e.keyCode && e.ctrlKey && K()
                        }),
                        Z = function(e) {
                            return function(t) {
                                13 === t.keyCode && (e(), t.returnValue = !1)
                            }
                        }(z),
                        J = function(e) {
                            e.addEventListener("keydown", $)
                        },
                        Q = function(e) {
                            e.removeEventListener("keydown", $)
                        };
                    I.addEventListener("focus", (function() {
                        J(this)
                    })), I.addEventListener("blur", (function() {
                        Q(this)
                    })), B.addEventListener("focus", (function() {
                        J(this)
                    })), B.addEventListener("blur", (function() {
                        Q(this)
                    })), R.addEventListener("focus", (function() {
                        this.addEventListener("keydown", Z)
                    })), R.addEventListener("blur", (function() {
                        this.removeEventListener("keydown", Z)
                    })), [R, B, I].forEach((function(e) {
                        e.addEventListener("paste", (function(e) {
                            e.preventDefault();
                            var t = e.clipboardData.getData("text/plain");
                            document.execCommand("insertHTML", !1, t)
                        }))
                    }));
                    var ee = u.getBoundController(),
                        te = u.getControllerButtons(),
                        ne = [],
                        re = !1;
                    u.onMove((function() {
                        re = !0
                    }));
                    var oe, ae = function(e, t) {
                        e.image || e.is_back_cover || e.zoom && (E && !t.noAnimation ? u.animate(e.transform, e.zoom / u.getZoomScale(), e.pan) : (u.zoom(e.zoom / u.getZoomScale()), u.pan(e.pan)))
                    };

                    function ie(e) {
                        e.image ? (Object(i.h)(D, "with-image"), Object(i.nb)(D, "no-image"), D.style.backgroundImage = "url(" + e.image + ")", Object(i.nb)(P, "not-shown")) : (Object(i.nb)(D, "with-image"), Object(i.h)(D, "no-image"), D.style.backgroundImage = null, Object(i.h)(P, "not-shown"))
                    }
                    var se = function(e, t, n) {
                            if (Object(i.I)().x <= 640) N.style.height = o + "px";
                            else {
                                k.style.marginLeft = e + "px", k.style.marginRight = e + "px", k.style.marginTop = t + "px", C.style.height = n + "px", T.style.width = n + "px", T.style.height = n + "px";
                                var r = C.querySelector(".related-stories-title").getBoundingClientRect().bottom,
                                    a = C.querySelector("footer").getBoundingClientRect().top;
                                N.style.height = a - r + "px"
                            }
                        },
                        ce = function() {
                            E = !0, Object(i.nb)(S, "with-bottom-strip"), I.removeAttribute("contenteditable"), R.removeAttribute("contenteditable"), B.removeAttribute("contenteditable"), Object(i.h)(D, "present"), Object(i.h)(M, "present"), ee.setOpaque(!0), P && Object(i.h)(P, "not-shown"), A && Object(i.h)(A, "not-shown")
                        },
                        le = function(e) {
                            E = !1, Object(i.h)(S, "with-bottom-strip"), I.setAttribute("contenteditable", !0), R.setAttribute("contenteditable", !0), B.setAttribute("contenteditable", !0), Object(i.nb)(D, "present"), Object(i.nb)(M, "present"), e && e.image && Object(i.nb)(P, "not-shown"), A && Object(i.nb)(A, "not-shown"), ee.setOpaque(!1)
                        },
                        de = function(e) {
                            e ? ce() : le()
                        };
                    return de(l.readOnly || !1), {
                        setSlideData: function(e, t) {
                            var a = t || {};
                            if (I.textContent = "", R.textContent = "", B.textContent = "", G.textContent = "", O || function(e) {
                                    s && (console.log("clearing save timeout"), clearTimeout(s), s = null), I.removeEventListener("keyup", c), R.removeEventListener("keyup", c), B.removeEventListener("keyup", c), c = function() {
                                        s && (clearTimeout(s), s = null), s = setTimeout((function() {
                                            console.log("trigger text change for", e.remote_id), w(e.remote_id)
                                        }), 1e3)
                                    }, I.addEventListener("keyup", c), R.addEventListener("keyup", c), B.addEventListener("keyup", c)
                                }(e), Object(i.N)(q, "expanded-content") && (Object(i.nb)(q, "expanded-content"), q.style.height = o - n + "px"), q.removeEventListener("click", oe), oe = function() {
                                    O && j && (! function() {
                                        if (!j) return;
                                        Object(i.N)(q, "expanded-content") ? (Object(i.nb)(q, "expanded-content"), q.style.height = o - n + "px") : (u.stopAnimation(), Object(i.h)(q, "expanded-content"), q.style.height = o + "px")
                                    }(), e.image || ae(e, {
                                        noAnimation: !0
                                    }))
                                }, e.is_cover) q.addEventListener("click", oe), R.textContent = e.title || "", B.innerHTML = (e.subtitle || "").split("\n").filter((function(e) {
                                return e.trim().length > 0
                            })).map((function(e) {
                                return "<p>" + e + "</p>"
                            })).join(""), G.textContent = e.footer, O && Object(i.ab)(B), Object(i.h)(I, "not-shown"), Object(i.nb)(R, "not-shown"), Object(i.nb)(B, "not-shown"), Object(i.nb)(x, "not-shown"), Object(i.h)(k, "not-shown"), Object(i.h)(H, "cover-view"), B.scrollTop = 0, ae(e, a);
                            else if (e.is_back_cover) Object(i.h)(x, "not-shown"), Object(i.nb)(k, "not-shown"), Object(i.nb)(H, "cover-view");
                            else {
                                if (q.addEventListener("click", oe), E && Object(r.a)(I).hide(), I.innerHTML = (e.text || "").split("\n").filter((function(e) {
                                        return e.trim().length > 0
                                    })).map((function(e) {
                                        return "<p>" + e + "</p>"
                                    })).join(""), G.textContent = e.footer, O && Object(i.ab)(I), Object(i.nb)(I, "not-shown"), Object(i.h)(R, "not-shown"), Object(i.h)(B, "not-shown"), E) {
                                    var l = null;
                                    a.noAnimation ? ae(e, a) : l = function() {
                                        ae(e, a)
                                    }, Object(r.a)(I).fadeIn(250, l)
                                } else ae(e);
                                Object(i.nb)(x, "not-shown"), Object(i.h)(k, "not-shown"), I.blur(), R.blur(), B.blur(), I.scrollTop = 0, Object(i.nb)(H, "cover-view")
                            }
                            ie(e),
                                function(e) {
                                    e.is_cover ? X.forEach((function(e) {
                                        Object(i.h)(e, "not-shown")
                                    })) : X.forEach((function(e) {
                                        Object(i.nb)(e, "not-shown")
                                    })), e.is_last ? V.forEach((function(e) {
                                        Object(i.h)(e, "not-shown")
                                    })) : V.forEach((function(e) {
                                        Object(i.nb)(e, "not-shown")
                                    })), O && (e.is_back_cover ? V.forEach((function(e) {
                                        Object(i.nb)(e, "not-shown"), Object(i.h)(e, "back-cover")
                                    })) : V.forEach((function(e) {
                                        Object(i.nb)(e, "back-cover")
                                    })))
                                }(e), E || (Y = e.is_cover ? z : W), re = !1
                        },
                        getSlideData: function() {
                            return {
                                captureRegionUpdated: re,
                                zoom: u.getZoom() * u.getZoomScale(),
                                pan: u.getPan(),
                                transform: u.getTransform(),
                                title: R.innerHTML.trim().replace(/<br(\s*)\/*>/gi, "\n").replace(/<(p|div)\.*>/gi, "\n").replace(/(<([^>]+)>)/gi, ""),
                                subtitle: B.innerHTML.trim().replace(/<br(\s*)\/*>/gi, "\n").replace(/<(p|div)\.*>/gi, "\n").replace(/(<([^>]+)>)/gi, ""),
                                text: I.innerHTML.trim().replace(/<br(\s*)\/*>/gi, "\n").replace(/<(p|div)\.*>/gi, "\n").replace(/(<([^>]+)>)/gi, "")
                            }
                        },
                        updateImage: ie,
                        resize: function(e, r) {
                            if (t = e.height, n = e.width, e.width <= 640) ! function(e) {
                                o = t - x.querySelector(".user-profile").offsetHeight - H.offsetHeight, q.style.height = o - e.width + "px", se(0, 0, e.width), u.resize(), te.resize(0, 0, e.width, e.width), j = !0
                            }(e);
                            else {
                                j = !1;
                                var a = r ? 0 : 124,
                                    i = e.width - 380,
                                    s = e.height - 80 - a;
                                r && (s *= .8);
                                var c = Math.min(i, s),
                                    l = Math.round((e.width - c - 380) / 2);
                                x.style.marginLeft = l + "px", x.style.marginRight = l + "px";
                                var d = Math.round((e.height - 60 - c - a) / 2);
                                x.style.marginTop = d + "px", M.style.height = c + "px", D.style.width = c + "px", D.style.height = c + "px";
                                var p = H.getBoundingClientRect().top,
                                    f = q.getBoundingClientRect().top;
                                o = p - f, q.style.height = o + "px", ee.resize(e.width, e.height - 60 - a, c + 380, c), u.resize(), te.resize(l, d + 60, c + 380, c), ne = [Math.floor((e.width - c - 380) / 2), Math.floor((e.height - 60 - a - c) / 2), c, c], V.forEach((function(t) {
                                    t.style.right = l - 60 + "px", t.style.top = r ? 70 + (e.height - 80) / 2 + "px" : 70 + c / 2 + "px"
                                })), X.forEach((function(t) {
                                    t.style.left = l - 60 + "px", t.style.top = r ? 70 + (e.height - 80) / 2 + "px" : 70 + c / 2 + "px"
                                })), se(l, d, c)
                            }
                        },
                        getViewBox: function() {
                            return {
                                width: ne[2],
                                height: ne[3],
                                left: ne[0],
                                top: ne[1] + 60
                            }
                        },
                        updateFooter: function(e) {
                            G.innerHTML = e.footer
                        },
                        enterPresentationMode: ce,
                        exitPresentationMode: le,
                        focus: function(e) {
                            e.is_cover ? "" == e.title.trim() ? Object(i.jb)(R) : Object(i.jb)(B) : Object(i.jb)(I)
                        },
                        setReadOnly: de,
                        setLoading: function(e) {
                            var t = D.querySelector(".uploading");
                            e ? (ie({
                                image: null
                            }), Object(i.nb)(t, "not-shown")) : Object(i.h)(t, "not-shown")
                        },
                        hideRemoveImageButton: function() {
                            Object(i.h)(P, "not-shown")
                        },
                        showRemoveImageButton: function() {
                            Object(i.nb)(P, "not-shown")
                        },
                        setRecommended: function(e) {
                            L.forEach((function(t) {
                                var n = t.querySelector(".recommend-empty"),
                                    r = t.querySelector(".recommend-filled");
                                e ? (Object(i.nb)(r, "not-shown"), Object(i.h)(n, "not-shown")) : (Object(i.h)(r, "not-shown"), Object(i.nb)(n, "not-shown"))
                            }))
                        },
                        updateRecommendCount: function(e) {
                            L.forEach((function(t) {
                                t.querySelector("#recommend-count").innerHTML = e
                            }))
                        },
                        notifyDragOver: function() {
                            Object(i.h)(D, "dragging")
                        },
                        notifyDragOverEnd: function() {
                            Object(i.nb)(D, "dragging")
                        },
                        setSlideHeader: function(e) {
                            var t = x.querySelector("section.user-profile"),
                                n = t.querySelector("a"),
                                r = t.querySelector("img.avatar"),
                                o = t.querySelector(".user-name"),
                                i = t.querySelector(".created-at");
                            e.hub ? (n.setAttribute("href", e.hub.url), n.title = e.hub.name, r.src = e.hub.img_path, o.innerHTML = e.hub.display_name) : (n.href = e.user.url, n.title = e.user.username, r.src = e.user.img_path, o.innerHTML = e.user.display_name), i.innerHTML = a()(e.created_at).format("MMM d, YYYY")
                        }
                    }
                }
        },
        63: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return a
            }));
            var r = n(4);
            n(485);
            r.a.notify.addStyle("gc-notify", {
                html: "<div><span data-notify-text='text'/></div>",
                classes: {}
            }), r.a.notify.addStyle("gc-notify-linked", {
                html: "<div><span class='toast-text' data-notify-text='text'/> <span class='action' data-notify-html='link'/></div>",
                classes: {}
            });
            var o = function() {
                    document.body.querySelector(".notifyjs-corner").style.right = "380px"
                },
                a = {
                    info: function(e, t) {
                        r.a.notify({
                            text: e
                        }, {
                            style: "gc-notify",
                            globalPosition: "right bottom"
                        }), t && o()
                    },
                    infoWithLink: function(e, t, n) {
                        var a = "<a href='" + t + "' target='_blank'>VIEW</a>";
                        r.a.notify({
                            text: e,
                            link: a
                        }, {
                            style: "gc-notify-linked",
                            globalPosition: "right bottom",
                            autoHideDelay: 9e3
                        }), n && o()
                    },
                    infoWithCallback: function(e, t, n) {
                        r.a.notify({
                            text: e,
                            link: '<button class="text">VIEW</a>'
                        }, {
                            style: "gc-notify-linked",
                            globalPosition: "right bottom",
                            autoHideDelay: 9e3
                        }), n && o(), document.querySelector(".notifyjs-gc-notify-linked-base").addEventListener("click", (function() {
                            t()
                        }))
                    },
                    error: function(e, t) {
                        r.a.notify(e, {
                            className: t ? "with-right-bar" : "",
                            globalPosition: "right bottom"
                        })
                    }
                }
        },
        65: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return u
            }));
            var r = n(94),
                o = n.n(r),
                a = n(92),
                i = n.n(a),
                s = n(66),
                c = n(100),
                l = n(0),
                d = n(3),
                u = function(e, t) {
                    var n = t.parent || document.body,
                        r = d.a["graphs/svg_capture_panel"]({
                            svg: t.svg,
                            svg_url: t.svg_url,
                            noPadding: !0
                        });
                    n.appendChild(r.trim().toDOM());
                    var a = document.querySelector("div#svg-capture");
                    if (!t.skipTransform) {
                        a.querySelector("svg g").setAttribute("transform", "matrix(1, 0, 0, 1, 0, 0)");
                        var u = a.querySelector("style");
                        a.querySelector("defs").appendChild(u)
                    }
                    var p, f = a.querySelector("svg"),
                        h = {
                            haltEventListeners: ["touchstart", "touchend", "touchmove", "touchleave", "touchcancel"],
                            init: function(e) {
                                var t = e.instance,
                                    n = 1,
                                    r = 0,
                                    a = 0;
                                this.hammer = o()(e.svgElement, {
                                    inputClass: o.a.SUPPORT_POINTER_EVENTS ? o.a.PointerEventInput : o.a.TouchInput
                                }), this.hammer.get("pinch").set({
                                    enable: !0
                                }), this.hammer.on("doubletap", (function() {
                                    t.zoomIn()
                                })), this.hammer.on("panstart panmove", (function(e) {
                                    "panstart" === e.type && (r = 0, a = 0), t.panBy({
                                        x: e.deltaX - r,
                                        y: e.deltaY - a
                                    }), r = e.deltaX, a = e.deltaY
                                })), this.hammer.on("pinchstart pinchmove", (function(e) {
                                    "pinchstart" === e.type && (n = t.getZoom(), t.zoom(n * e.scale)), t.zoom(n * e.scale)
                                })), e.svgElement.addEventListener("touchmove", (function(e) {
                                    e.preventDefault()
                                }))
                            },
                            destroy: function() {
                                this.hammer.destroy()
                            }
                        },
                        g = i()(f, {
                            minZoom: 0,
                            maxZoom: 100,
                            fit: !1,
                            contain: !1,
                            customEventsHandler: h
                        });
                    if (t.skipTransform) {
                        var m = a.querySelector("svg g").getAttribute("transform").replace("matrix(", "").replace(")", "").split(",");
                        p = Number(m[0].trim())
                    } else {
                        var y = t.transform.replace("matrix(", "").replace(")", "").split(",");
                        g.zoom(Number(y[0].trim())), g.pan({
                            x: Number(y[4].trim()),
                            y: Number(y[5].trim())
                        })
                    }
                    var b, v = Object(s.a)(a, {
                            hide_borders: t.hide_borders,
                            pointerEvents: t.pointerEvents
                        }),
                        _ = function() {
                            g.fit(), g.center()
                        },
                        w = Object(c.a)(a.querySelector("#capture-controller-buttons"), {
                            hide_resize: !0,
                            onCaptureZoomInClicked: function() {
                                g.zoomIn()
                            },
                            onCaptureZoomOutClicked: function() {
                                g.zoomOut()
                            },
                            onCaptureResetClicked: function() {
                                "function" === typeof t.onSVGReset ? t.onSVGReset() : _()
                            }
                        }),
                        O = function(e) {
                            return --e * e * e + 1
                        };
                    return {
                        getBoundController: function() {
                            return v
                        },
                        getControllerButtons: function() {
                            return w
                        },
                        getZoom: function() {
                            return g.getZoom()
                        },
                        getZoomScale: function() {
                            return p || 1
                        },
                        zoom: function(e) {
                            return g.zoom(e)
                        },
                        getPan: function() {
                            return g.getPan()
                        },
                        pan: function(e) {
                            return g.pan(e)
                        },
                        stopAnimation: function(e, t) {
                            b && (clearInterval(b), b = null), t && e && setTimeout((function() {
                                g.zoom(e), g.pan(t)
                            }), 10)
                        },
                        animate: function(e, t, n) {
                            var r, o, i, s, c, l, d, u, p, f, h, m, y, v, _;
                            b && (clearInterval(b), b = null), r = e, o = function() {
                                setTimeout((function() {
                                    g.zoom(t), g.pan(n)
                                }))
                            }, i = a.querySelector("svg g").getAttribute("transform").replace("matrix(", "").replace(")", "").split(","), s = Number(i[0].trim()), c = Number(i[4].trim()), l = Number(i[5].trim()), d = r.replace("matrix(", "").replace(")", "").split(","), u = Number(d[0].trim()), p = Number(d[4].trim()), f = Number(d[5].trim()), h = 0, m = u - s, y = p - c, v = f - l, _ = function() {
                                if (h++ < 30) {
                                    var e = O(h / 30),
                                        t = s + e * m,
                                        n = "matrix(" + [t, 0, 0, t, c + e * y, l + e * v].join(",") + ")";
                                    a.querySelector("svg g").setAttribute("transform", n)
                                } else clearInterval(b), b = null, o()
                            }, b = setInterval(_, 15), _()
                        },
                        getSvgEl: function() {
                            return a.querySelector("svg")
                        },
                        getTransform: function() {
                            return a.querySelector("svg g").getAttribute("transform")
                        },
                        disable: function() {
                            g.disableZoom(), g.disablePan()
                        },
                        enable: function() {
                            g.enableZoom(), g.enablePan()
                        },
                        destroy: function() {
                            a.parentNode.removeChild(a)
                        },
                        onMove: function(e) {
                            g.setOnPan(e), g.setOnZoom(e)
                        },
                        resize: function() {
                            g.resize()
                        },
                        zoomAt: function(e, t) {
                            g.zoomAtPoint(e, t)
                        },
                        setViewBox: function(e, t, n, r) {
                            f.setAttribute("viewBox", [e, t, n, r].join(" "))
                        },
                        getViewBox: function() {
                            return f.getAttribute("viewBox")
                        },
                        setSvgSize: function(e, t) {
                            f.setAttribute("width", e), f.setAttribute("height", t)
                        },
                        setTransform: function(e) {
                            a.querySelector("svg g").setAttribute("transform", e)
                        },
                        updateBBox: function() {
                            g.updateBBox()
                        },
                        reset: function() {
                            _()
                        },
                        getSVGDimensions: function() {
                            var e = a.querySelector("svg g").getBoundingClientRect();
                            return {
                                width: e.width,
                                height: e.height,
                                top: e.top,
                                left: e.left
                            }
                        },
                        hideSVG: function() {
                            Object(l.h)(a.querySelector("div"), "not-shown")
                        },
                        showSVG: function() {
                            Object(l.nb)(a.querySelector("div"), "not-shown")
                        }
                    }
                }
        },
        66: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return o
            }));
            var r = n(0),
                o = function(e, t) {
                    var n = t || {},
                        o = e.querySelector("div.capture-bounds-top-left"),
                        a = e.querySelector("div.capture-bounds-top"),
                        i = e.querySelector("div.capture-bounds-top-right"),
                        s = e.querySelector("div.capture-bounds-left"),
                        c = e.querySelector("div.capture-bounds-right"),
                        l = e.querySelector("div.capture-bounds-bottom-left"),
                        d = e.querySelector("div.capture-bounds-bottom"),
                        u = e.querySelector("div.capture-bounds-bottom-right");
                    n.hide_borders && (Object(r.h)(o, "no-border"), Object(r.h)(a, "no-border"), Object(r.h)(i, "no-border"), Object(r.h)(s, "no-border"), Object(r.h)(c, "no-border"), Object(r.h)(l, "no-border"), Object(r.h)(d, "no-border"), Object(r.h)(u, "no-border")), n.pointerEvents && (o.style.pointerEvents = n.pointerEvents, a.style.pointerEvents = n.pointerEvents, i.style.pointerEvents = n.pointerEvents, s.style.pointerEvents = n.pointerEvents, c.style.pointerEvents = n.pointerEvents, l.style.pointerEvents = n.pointerEvents, d.style.pointerEvents = n.pointerEvents, u.style.pointerEvents = n.pointerEvents);
                    return {
                        resize: function(e, t, n, r) {
                            var p = (e - n) / 2,
                                f = (t - r) / 2;
                            o.style.top = 0, o.style.left = 0, o.style.height = 60 + f + "px", o.style.width = p + "px", a.style.top = 0, a.style.left = p + "px", a.style.width = n + "px", a.style.height = 60 + f + "px", i.style.top = 0, i.style.left = e - p + "px", i.style.width = p + "px", i.style.height = 60 + f + "px", s.style.top = 60 + f + "px", s.style.left = 0, s.style.width = p + "px", s.style.height = r + "px", c.style.top = 60 + f + "px", c.style.left = e - p + "px", c.style.width = p + "px", c.style.height = r + "px", l.style.top = 60 + f + r + "px", l.style.left = 0, l.style.height = f + "px", l.style.width = p + "px", d.style.top = 60 + f + r + "px", d.style.left = p + "px", d.style.height = f + "px", d.style.width = n + "px", u.style.top = 60 + f + r + "px", u.style.left = e - p + "px", u.style.height = f + "px", u.style.width = p + "px"
                        },
                        hide: function() {
                            o.style.top = 0, o.style.left = 0, o.style.height = 0, o.style.width = 0, a.style.top = 0, a.style.left = 0, a.style.width = 0, a.style.height = 0, i.style.top = 0, i.style.left = 0, i.style.width = 0, i.style.height = 0, s.style.top = 0, s.style.left = 0, s.style.width = 0, s.style.height = 0, c.style.top = 0, c.style.left = 0, c.style.width = 0, c.style.height = 0, l.style.top = 0, l.style.left = 0, l.style.height = 0, l.style.width = 0, d.style.top = 0, d.style.left = 0, d.style.height = 0, d.style.width = 0, u.style.top = 0, u.style.left = 0, u.style.height = 0, u.style.width = 0
                        },
                        setOpaque: function(e) {
                            e ? (Object(r.h)(o, "opaque"), Object(r.h)(a, "opaque"), Object(r.h)(i, "opaque"), Object(r.h)(s, "opaque"), Object(r.h)(c, "opaque"), Object(r.h)(l, "opaque"), Object(r.h)(d, "opaque"), Object(r.h)(u, "opaque")) : (Object(r.nb)(o, "opaque"), Object(r.nb)(a, "opaque"), Object(r.nb)(i, "opaque"), Object(r.nb)(s, "opaque"), Object(r.nb)(c, "opaque"), Object(r.nb)(l, "opaque"), Object(r.nb)(d, "opaque"), Object(r.nb)(u, "opaque"))
                        }
                    }
                }
        },
        67: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "AnalysisManager", (function() {
                return i
            })), n.d(t, "AutoSaver", (function() {
                return c
            })), n.d(t, "AutoSaverDisplay", (function() {
                return d
            })), n.d(t, "FilterManager", (function() {
                return u
            })), n.d(t, "GraphMediator", (function() {
                return _
            })), n.d(t, "GraphSignalProcessor", (function() {
                return g
            }));
            var r = n(13),
                o = n.n(r),
                a = n(0),
                i = function(e) {
                    var t, n, r, i, s, c, l, d = e.uiStore,
                        u = e.GraphHistory,
                        p = "Degree Centrality",
                        f = "Betweenness Centrality",
                        h = 1,
                        g = !0,
                        m = function(e) {
                            return ["From", e.min ? e.min % 1 !== 0 ? e.min.toFixed(2) : e.min : 0, "to", e.max ? e.max % 1 !== 0 ? e.max.toFixed(2) : e.max : 0].join(" ")
                        },
                        y = function(e, t) {
                            var n, r = {};
                            for (n = 0; n < t.length; n += 1)
                                if (u.getNodeById(t[n].key).type_id === e) {
                                    r.max = t[n].value;
                                    break
                                }
                            for (n = t.length - 1; n >= 0; n -= 1)
                                if (u.getNodeById(t[n].key).type_id === e) {
                                    r.min = t[n].value;
                                    break
                                }
                            return r.msg = m(r), r
                        },
                        b = function(e, t) {
                            var n, r, o, i = u.getNodesByTypeId(e);
                            switch (function(e, t) {
                                var n, r, o = !0,
                                    i = !0;
                                for (n = e.length - 1; n >= 0; n -= 1)
                                    if ((r = e[n].properties) && Object.prototype.hasOwnProperty.call(r, t)) {
                                        if (void 0 === r[t] || null === r[t]) continue;
                                        if ("string" === typeof r[t] && "" === r[t].trim()) continue;
                                        if (o = !1, Object(a.f)(r[t])) {
                                            i = !1;
                                            break
                                        }
                                    }
                                return o ? 0 : i ? 1 : 2
                            }(i, t)) {
                                case 2:
                                    return function(e, t) {
                                        var n, r, o = {},
                                            i = 0;
                                        for (n = e.length - 1; n >= 0; n -= 1)
                                            if ((r = e[n].properties) && Object.prototype.hasOwnProperty.call(r, t)) {
                                                if (void 0 === r[t] || null === r[t]) continue;
                                                o[r[t]] ? (o[r[t]].count += 1, o[r[t]].nodes.push({
                                                    id: e[n].id,
                                                    name: u.nodeDisplayName(e[n].id)
                                                })) : o[r[t]] = {
                                                    count: 1,
                                                    nodes: [{
                                                        id: e[n].id,
                                                        name: u.nodeDisplayName(e[n].id)
                                                    }]
                                                }, i += 1
                                            }
                                        var s = Object.keys(o).map((function(e) {
                                            return {
                                                name: e,
                                                count: o[e].count,
                                                nodes: o[e].nodes
                                            }
                                        })).sort((function(e, t) {
                                            return t.count - e.count
                                        }));
                                        return {
                                            msg: Object(a.k)(s.length, "Option", "Options", "{quantity} {item}"),
                                            type: "distinct",
                                            values: s,
                                            count: i
                                        }
                                    }(i, t);
                                case 1:
                                    return n = t, r = {
                                        min: void 0,
                                        max: void 0
                                    }, o = 0, i.forEach((function(e) {
                                        var t = e.properties && e.properties[n];
                                        Object(a.f)(t) || (t = parseFloat(t), (void 0 === r.min || r.min > t) && (r.min = t), (void 0 === r.max || r.max < t) && (r.max = t), o += 1)
                                    })), {
                                        msg: m(r),
                                        type: "range",
                                        range: {
                                            min: r.min,
                                            max: r.max
                                        },
                                        count: o
                                    };
                                case 0:
                                default:
                                    return {
                                        msg: "No Values",
                                        type: "empty"
                                    }
                            }
                        },
                        v = function() {
                            var e = {},
                                a = t.getGraphEngine().graph,
                                l = o.a.Graph.centrality(),
                                d = l.betweennessCentrality(a),
                                p = l.degreeCentrality(a);
                            d = d.sort((function(e, t) {
                                return t.value - e.value
                            })), p = p.sort((function(e, t) {
                                return t.value - e.value
                            }));
                            var f = function() {
                                    var e = {};
                                    u.getEdgeTypes().forEach((function(t) {
                                        e[t.id] = 1 == t.directed
                                    }));
                                    var t = {},
                                        n = {};
                                    return u.getNodes().forEach((function(e) {
                                        t[e.id] = 0, n[e.id] = 0
                                    })), u.getLinks().forEach((function(r) {
                                        e[r.name_id] && (n[r.from] += 1, t[r.to] += 1)
                                    })), { in: Object.keys(t).map((function(e) {
                                            return {
                                                key: e,
                                                value: t[e]
                                            }
                                        })).sort((function(e, t) {
                                            return t.value - e.value
                                        })),
                                        out: Object.keys(n).map((function(e) {
                                            return {
                                                key: e,
                                                value: n[e]
                                            }
                                        })).sort((function(e, t) {
                                            return t.value - e.value
                                        }))
                                    }
                                }(),
                                h = f.in,
                                v = f.out;
                            return e.allnodes = {
                                name: "All Node Types",
                                count: u.getNodes().length,
                                betweenness: {
                                    max: 0,
                                    min: 0
                                },
                                degree: {
                                    max: 0,
                                    min: 0
                                }
                            }, e.allnodes.count > 0 && (e.allnodes.betweenness = {
                                max: d[0].value,
                                min: d[d.length - 1].value
                            }, e.allnodes.betweenness.msg = m(e.allnodes.betweenness), e.allnodes.degree = {
                                max: p[0].value,
                                min: p[p.length - 1].value
                            }, e.allnodes.degree.msg = m(e.allnodes.degree), e.allnodes.indegree = {
                                max: h[0].value,
                                min: h[h.length - 1].value
                            }, e.allnodes.indegree.msg = m(e.allnodes.indegree), e.allnodes.outdegree = {
                                max: v[0].value,
                                min: v[v.length - 1].value
                            }, e.allnodes.outdegree.msg = m(e.allnodes.outdegree)), u.getNodeTypes().forEach((function(t) {
                                e[t.id] = {
                                    name: t.name,
                                    count: t.count,
                                    betweenness: {
                                        min: 0,
                                        max: 0
                                    },
                                    degree: {
                                        min: 0,
                                        max: 0
                                    },
                                    properties: {}
                                }, t.count > 0 && (e[t.id].betweenness = function(e, t) {
                                    var n, r = {};
                                    for (n = 0; n < t.length; n += 1)
                                        if (u.getNodeById(t[n].key).type_id === e) {
                                            r.max = t[n].value;
                                            break
                                        }
                                    for (n = t.length - 1; n >= 0; n -= 1)
                                        if (u.getNodeById(t[n].key).type_id === e) {
                                            r.min = t[n].value;
                                            break
                                        }
                                    return r.msg = m(r), r
                                }(t.id, d), e[t.id].degree = y(t.id, p), e[t.id].in_degree = y(t.id, h), e[t.id].out_degree = y(t.id, v)), Array.isArray(t.properties) && t.properties.map((function(e) {
                                    return e.name
                                })).forEach((function(n) {
                                    e[t.id].properties[n] = b(t.id, n)
                                }))
                            })), n = p, r = h, i = v, s = d, c = e, g = !1, e
                        },
                        _ = function(e) {
                            if (!c) return [];
                            var t = c[e.id];
                            if (!t) return [];
                            var n = t.properties[e.prop];
                            if (!n) return [];
                            if (!u.getNodeTypeById(e.id)) return [];
                            switch (n.type) {
                                case "range":
                                    return function(e) {
                                        var t = u.getNodesByTypeId(e.id),
                                            n = u.getNodeTypeById(e.id);
                                        return t.filter((function(t) {
                                            return !(!Object.prototype.hasOwnProperty.call(t, "properties") || !Object.prototype.hasOwnProperty.call(t.properties, e.prop) || Object(a.f)(t.properties[e.prop]))
                                        })).sort((function(t, n) {
                                            var r = parseFloat(t.properties[e.prop]);
                                            return parseFloat(n.properties[e.prop]) - r
                                        })).slice(0, 5).map((function(t) {
                                            return {
                                                id: t.id,
                                                name: u.nodeDisplayName(t.id),
                                                value: parseFloat(t.properties[e.prop]),
                                                color: n.color,
                                                typeChar: n.name.charAt(0).toUpperCase()
                                            }
                                        }))
                                    }(e);
                                case "distinct":
                                    return function(e) {
                                        return c[e.id].properties[e.prop].values.slice(0, 5).map((function(e) {
                                            return {
                                                value: e.name,
                                                frequency: e.count
                                            }
                                        }))
                                    }(e);
                                case "empty":
                                default:
                                    return []
                            }
                        };
                    return {
                        setCanvas: function(e) {
                            t = e
                        },
                        calculateTypeSummaries: v,
                        calculateTopForRule: function(e) {
                            switch (e.type) {
                                case "nt":
                                    if ("All" === e.id) switch (e.analysis) {
                                        case p:
                                            return Array.isArray(n) && 0 !== n.length ? n.slice(0, 5).map((function(e) {
                                                var t = u.getNodeById(e.key),
                                                    n = u.getNodeTypeById(t.type_id);
                                                return {
                                                    id: t.id,
                                                    name: u.nodeDisplayName(t.id),
                                                    count: e.value,
                                                    color: n.color,
                                                    typeChar: n.name.charAt(0).toUpperCase()
                                                }
                                            })) : [];
                                        case f:
                                            return Array.isArray(s) && 0 !== s.length ? s.slice(0, 5).map((function(e) {
                                                var t = u.getNodeById(e.key),
                                                    n = u.getNodeTypeById(t.type_id);
                                                return {
                                                    id: t.id,
                                                    name: u.nodeDisplayName(t.id),
                                                    count: e.value.toFixed(2),
                                                    color: n.color,
                                                    typeChar: n.name.charAt(0).toUpperCase()
                                                }
                                            })) : [];
                                        default:
                                            return []
                                    } else switch (e.analysis) {
                                        case p:
                                            return function(e) {
                                                if (!Array.isArray(n) || 0 === n.length) return [];
                                                var t = u.getNodeTypeById(e.id);
                                                if (!t) return [];
                                                var r, o, a, i = [];
                                                for (r = 0; r < n.length && (o = n[r], (a = u.getNodeById(o.key)).type_id !== e.id || (i.push({
                                                        id: a.id,
                                                        name: u.nodeDisplayName(a.id),
                                                        count: o.value,
                                                        color: t.color,
                                                        typeChar: t.name.charAt(0).toUpperCase()
                                                    }), 5 !== i.length)); r += 1);
                                                return i
                                            }(e);
                                        case f:
                                            return function(e) {
                                                if (!Array.isArray(s) || 0 === s.length) return [];
                                                var t = u.getNodeTypeById(e.id);
                                                if (!t) return [];
                                                var n, r, o, a = [];
                                                for (n = 0; n < s.length && (r = s[n], (o = u.getNodeById(r.key)).type_id !== e.id || (a.push({
                                                        id: o.id,
                                                        name: u.nodeDisplayName(o.id),
                                                        count: r.value.toFixed(2),
                                                        color: t.color,
                                                        typeChar: t.name.charAt(0).toUpperCase()
                                                    }), 5 !== a.length)); n += 1);
                                                return a
                                            }(e);
                                        default:
                                            return []
                                    }
                                case "nt_prop":
                                    return _(e);
                                default:
                                    return []
                            }
                        },
                        getDegreeCentralities: function() {
                            return n
                        },
                        getInDegreeCentralities: function() {
                            return r
                        },
                        getOutDegreeCentralities: function() {
                            return i
                        },
                        getBetweennessCentralities: function() {
                            return s
                        },
                        getTypeSummaries: function() {
                            return g && v(), c
                        },
                        setDirty: function() {
                            g = !0
                        },
                        isDirty: function() {
                            return g
                        },
                        setClusters: function(e) {
                            l = e
                        },
                        getClusters: function() {
                            return l
                        },
                        setClusteringResolution: function(e) {
                            h = e
                        },
                        getClusteringResolution: function() {
                            return h
                        },
                        applyClusterColors: function() {
                            d.set("isClusterColorsApplied", !0), t.applyClusterColors()
                        },
                        removeClusterColors: function() {
                            d.set("isClusterColorsApplied", !1), t.revertToNodeTypeColors()
                        }
                    }
                },
                s = n(7),
                c = function(e, t) {
                    var n = e.dispatcher,
                        r = t || {},
                        o = r.wait_time || 5e3,
                        a = 0;
                    "function" !== typeof r.handleSave && console.log("Warning: handleSave is not defined"), "function" !== typeof r.handleCheckSignalsNeedSaving && console.log("Warning: handleCheckSignalsNeedSaving is not defined"), "function" !== typeof r.handleCheckPositionsNeedSaving && console.log("Warning: handleCheckPositionsNeedSaving is not defined");
                    var i = null,
                        c = !1,
                        l = function() {
                            return !!i
                        },
                        d = function() {
                            clearInterval(i), i = null
                        },
                        u = function() {
                            return r.handleCheckSignalsNeedSaving() || r.handleCheckPositionsNeedSaving()
                        },
                        p = function() {
                            l() || c || (i = setInterval((function() {
                                u() ? r.handleSave() : d()
                            }), o))
                        },
                        f = function() {
                            if (c = !1, p(), 5 === (a += 1)) {
                                Object(s.displayMessage)(e, "Unable to save graph", "Sorry! We failed to save your graph 5 times in a row. Try refreshing the page to avoid data loss.")
                            }
                        };
                    n.bind("trigger", (function() {
                        p()
                    }), this), n.bind("triggerSnapshot", (function() {
                        r.handleCheckPositionsNeedSaving() && p()
                    }), this), n.bind("onUndo", (function() {
                        p()
                    }), this), n.bind("onGraphSaveStarted", (function() {
                        d(), c = !0
                    }), this), n.bind("onGraphSaved", (function() {
                        c = !1, u() && p(), a = 0
                    }), this), n.bind("onGraphSaveFailed", (function() {
                        f()
                    }), this), n.bind("onPaymentRequired", (function() {
                        f()
                    }), this), this.getName = function() {
                        return "auto-saver"
                    }, this.cleanUp = function() {
                        d()
                    }, this.isCurrentlySaving = function() {
                        return c
                    }, this.isTimerActive = function() {
                        return l()
                    }, this.startTimer = function() {
                        p()
                    }, this.stopTimer = function() {
                        d()
                    }
                },
                l = n(4),
                d = function(e, t) {
                    var n = e.dispatcher,
                        r = t || {},
                        o = Object(l.a)(r.el || ".graph-autosave-notify"),
                        a = function() {
                            o.text("Save failed!"), o.delay(1e3).fadeOut(1e3, (function() {
                                o.text("")
                            }))
                        };
                    n.bind("onGraphSaveStarted", (function() {
                        o.text("Saving..."), o.show()
                    }), this), n.bind("onGraphSaved", (function(e) {
                        ! function(e) {
                            o.text("Graph saved" + (e ? " with positions" : "")), o.delay(1e3).fadeOut(1e3, (function() {
                                o.text("")
                            }))
                        }(e)
                    }), this), n.bind("onGraphSaveFailed", (function() {
                        a()
                    }), this), n.bind("onPaymentRequired", (function() {
                        a()
                    }), this), this.getName = function() {
                        return "auto-saver-display"
                    }, this.cleanUp = function() {
                        o.text(""), o.hide()
                    }
                },
                u = function(e) {
                    var t, n, r, o, i = e.GraphHistory,
                        s = !0,
                        c = [],
                        l = {},
                        d = {},
                        u = {},
                        p = {},
                        f = {},
                        h = {},
                        g = {},
                        m = [],
                        y = !1,
                        b = function(e, n) {
                            var r, o = Object(a.p)(e);
                            o.ref = Object(a.M)();
                            var i = !1;
                            if (("nt_prop" === e.type || "et_prop" === e.type) && Object.prototype.hasOwnProperty.call(e, "range")) {
                                var s = e.type;
                                for (r = c.length - 1; r >= 0; r -= 1)
                                    if (c[r].type === s && Object.prototype.hasOwnProperty.call(c[r], "range") && c[r].id === e.id && c[r].prop === e.prop && c[r].range.min === e.range.min && c[r].range.max === e.range.max) {
                                        i = !0;
                                        break
                                    }
                            }
                            if ("nt_centrality" === e.type)
                                for (r = c.length - 1; r >= 0; r -= 1)
                                    if ("nt_centrality" === c[r].type && c[r].id === e.id && c[r].centrality === e.centrality && c[r].range.min === e.range.min && c[r].range.max === e.range.max) {
                                        i = !0;
                                        break
                                    }
                            if ("et_weight" === e.type)
                                for (r = c.length - 1; r >= 0; r -= 1)
                                    if ("et_weight" === c[r].type && c[r].id === e.id && c[r].range.min === e.range.min && c[r].range.max === e.range.max) {
                                        i = !0;
                                        break
                                    }
                            i || (c.push(o), l[o.ref] = [], u[o.ref] = [], n && (x(), function(e) {
                                t && "function" === typeof E[e.type] && E[e.type].call(this, e)
                            }(o), S()))
                        },
                        v = {
                            nt: function(e, t) {
                                return t && t.type_id === e.id
                            },
                            et: function(e, t) {
                                return t && t.name_id === e.id
                            },
                            nt_centrality: function(e, t) {
                                var n, r = parseFloat(e.range.min),
                                    o = parseFloat(e.range.max);
                                return ("nt_all" === e.id || e.id === t.type_id) && ("degree" === e.centrality ? n = f[t.type_id][t.id].degree : "betweenness" === e.centrality && (n = f[t.type_id][t.id].betweenness), void 0 !== n && (n > o || n < r))
                            },
                            nt_prop: function(e, t) {
                                if (!t || "nt_all" !== e.id && e.id !== t.type_id) return !1;
                                if (Object.prototype.hasOwnProperty.call(e, "hide_empty")) {
                                    if ("nt_all" === e.id) {
                                        var n = i.getNodeTypeById(t.type_id);
                                        if (!Array.isArray(n.properties) || n.properties.find((function(t) {
                                                return t.name === e.prop
                                            }))) return !1
                                    }
                                    return !(t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && t.properties[e.prop] && "" !== t.properties[e.prop].trim())
                                }
                                if (Object.prototype.hasOwnProperty.call(e, "range")) {
                                    var r, o = parseFloat(e.range.min),
                                        a = parseFloat(e.range.max);
                                    return t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && (r = t.properties[e.prop]), isNaN(r) ? !1 : (r = parseFloat(r)) > a || r < o
                                }
                                return t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && t.properties[e.prop].trim() === e.value.trim()
                            },
                            et_weight: function(e, t) {
                                if (!t || "et_all" !== e.id && e.id !== t.name_id) return !1;
                                var n = parseFloat(e.range.min),
                                    r = parseFloat(e.range.max),
                                    o = t.weight;
                                return !isNaN(o) && ((o = parseFloat(o)) > r || o < n)
                            },
                            et_prop: function(e, t) {
                                if (!t || "et_all" !== e.id && e.id !== t.name_id) return !1;
                                if (Object.prototype.hasOwnProperty.call(e, "hide_empty")) {
                                    if ("et_all" === e.id) {
                                        var n = i.getEdgeTypeById(t.name_id);
                                        if (!Array.isArray(n.properties) || n.properties.find((function(t) {
                                                return t.name === e.prop
                                            }))) return !1
                                    }
                                    return !(t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && t.properties[e.prop] && "" !== t.properties[e.prop].trim())
                                }
                                if (Object.prototype.hasOwnProperty.call(e, "range")) {
                                    var r, o = parseFloat(e.range.min),
                                        a = parseFloat(e.range.max);
                                    return t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && (r = t.properties[e.prop]), isNaN(r) ? !1 : (r = parseFloat(r)) > a || r < o
                                }
                                return t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && t.properties[e.prop] === e.value
                            }
                        },
                        _ = function(e, t) {
                            if ("function" === typeof v[e.type]) return v[e.type].call(null, e, t)
                        },
                        w = function(e, t) {
                            if ("function" === typeof v[e.type]) return v[e.type].call(null, e, t)
                        },
                        O = function(e, n) {
                            var r, o;
                            for (o = c.length - 1; o >= 0; o -= 1) {
                                var a = c[o];
                                if (e.type === a.type && e.id === a.id) {
                                    if ("nt" === e.type || "et" === e.type) {
                                        r = a;
                                        break
                                    }
                                    if ("nt_prop" !== e.type && "et_prop" !== e.type || e.prop !== a.prop) {
                                        if ("nt_centrality" === e.type && e.centrality === a.centrality) {
                                            if (Object.prototype.hasOwnProperty.call(e, "max_range")) {
                                                r = a;
                                                break
                                            }
                                            if (Object.prototype.hasOwnProperty.call(e, "range") && e.range.min === a.range.min && e.range.max === a.range.max) {
                                                r = a;
                                                break
                                            }
                                        } else if ("et_weight" === e.type) {
                                            if (Object.prototype.hasOwnProperty.call(e, "max_range")) {
                                                r = a;
                                                break
                                            }
                                            if (Object.prototype.hasOwnProperty.call(e, "range") && e.range.min === a.range.min && e.range.max === a.range.max) {
                                                r = a;
                                                break
                                            }
                                        }
                                    } else {
                                        if (Object.prototype.hasOwnProperty.call(e, "hide_empty") && Object.prototype.hasOwnProperty.call(a, "hide_empty")) {
                                            r = a;
                                            break
                                        }
                                        if (Object.prototype.hasOwnProperty.call(e, "value") && e.value.trim() === a.value.trim()) {
                                            r = a;
                                            break
                                        }
                                        if (Object.prototype.hasOwnProperty.call(e, "max_range")) {
                                            r = a;
                                            break
                                        }
                                        if (Object.prototype.hasOwnProperty.call(e, "range") && e.range.min === a.range.min && e.range.max === a.range.max) {
                                            r = a;
                                            break
                                        }
                                    }
                                }
                            }
                            r && (c.splice(o, 1), n && t && (x(), 0 === r.type.indexOf("nt") ? l[r.ref].forEach((function(e) {
                                var n, r = i.getNodeById(e.id),
                                    o = !0;
                                for (n = c.length - 1; n >= 0; n -= 1)
                                    if (0 === c[n].type.indexOf("nt") && _(c[n], r)) {
                                        l[c[n].ref].push(e), o = !1;
                                        break
                                    }
                                o && (t.addNode(e.id, f[r.type_id][e.id]), r.filtered = !1, e.links.forEach((function(r) {
                                    var o = i.getEdgeById(r),
                                        a = !1;
                                    if (e.id === o.from ? d[o.to] ? d[o.to].push(r) : a = !0 : d[o.from] ? d[o.from].push(r) : a = !0, a)
                                        for (n = c.length - 1; n >= 0; n -= 1)
                                            if (0 === c[n].type.indexOf("et") && w(c[n], o)) {
                                                u[c[n].ref].push(o.data.id), a = !1;
                                                break
                                            }
                                    if (a)
                                        for (t.addLink(o), o.filtered = !1, n = 0; n < p[o.name_id].length; n += 1)
                                            if (p[o.name_id][n] === o.id) {
                                                p[o.name_id].splice(n, 1);
                                                break
                                            }
                                })), d[e.id] = void 0)
                            })) : u[r.ref].forEach((function(e) {
                                var n, r = i.getEdgeById(e),
                                    o = !0;
                                if (d[r.from]) d[r.from].push(e), o = !1;
                                else if (d[r.to]) o = !1, d[r.to].push(e);
                                else
                                    for (n = c.length - 1; n >= 0; n -= 1)
                                        if (0 === c[n].type.indexOf("et") && w(c[n], r)) {
                                            u[c[n].ref].push(e), o = !1;
                                            break
                                        } if (o)
                                    for (t.addLink(r), r.filtered = !1, n = 0; n < p[r.name_id].length; n += 1)
                                        if (p[r.name_id][n] === e) {
                                            p[r.name_id].splice(n, 1);
                                            break
                                        }
                            })), l[r.ref] = void 0, u[r.ref] = void 0, S()))
                        },
                        E = {
                            nt_centrality: function(e) {
                                if (t) {
                                    var n, r = parseFloat(e.range.min),
                                        o = parseFloat(e.range.max),
                                        a = void 0,
                                        s = !1;
                                    for (n = c.length - 2; n >= 0; n -= 1)
                                        if ("nt_centrality" === c[n].type && c[n].centrality === e.centrality && c[n].id === e.id) {
                                            a = c[n], s = !(parseFloat(a.range.min) > parseFloat(e.range.min) || parseFloat(a.range.max) < parseFloat(e.range.max));
                                            break
                                        }
                                    a && s && (l[a.ref].forEach((function(t) {
                                        l[e.ref].push(t)
                                    })), l[a.ref] = void 0, c.splice(n, 1));
                                    var h = [],
                                        g = [];
                                    i.getNodes().filter((function(e) {
                                        return !e.filtered
                                    })).forEach((function(t) {
                                        var n;
                                        if (("nt_all" === e.id || t.type_id === e.id) && ("degree" === e.centrality ? n = f[t.type_id][t.id].degree : "betweenness" === e.centrality && (n = f[t.type_id][t.id].betweenness), void 0 !== n && !(n <= o && n >= r))) {
                                            var a = {
                                                id: t.id,
                                                links: []
                                            };
                                            t.filtered = !0, t.edges.forEach((function(t) {
                                                t.filtered || u[e.ref].indexOf(t.id) < 0 && (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), g.push(t), a.links.push(t.id), t.filtered = !0)
                                            })), l[e.ref].push(a), d[t.id] = a.links, h.push(t.id)
                                        }
                                    })), t.removeLink(g), t.removeNode(h), a && !s && O(a, !0)
                                }
                            },
                            nt: function(e) {
                                if (t) {
                                    var n = [],
                                        r = [];
                                    i.getNodes().filter((function(e) {
                                        return !e.filtered
                                    })).forEach((function(t) {
                                        if (t.type_id === e.id) {
                                            var o = {
                                                id: t.id,
                                                links: []
                                            };
                                            t.filtered = !0, t.edges.forEach((function(t) {
                                                t.filtered || u[e.ref].indexOf(t.id) < 0 && (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), r.push(t), o.links.push(t.id), t.filtered = !0)
                                            })), l[e.ref].push(o), d[t.id] = o.links, n.push(t.id)
                                        }
                                    })), t.removeLink(r), t.removeNode(n)
                                }
                            },
                            et: function(e) {
                                if (t) {
                                    var n = [];
                                    i.getLinks().filter((function(e) {
                                        return !e.filtered
                                    })).forEach((function(t) {
                                        t.filtered || t.name_id === e.id && (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), n.push({
                                            from: t.from,
                                            to: t.to,
                                            id: t.id
                                        }), t.filtered = !0)
                                    })), t.removeLink(n)
                                }
                            }
                        };
                    E.nt_prop = function(e) {
                        if (t)
                            if (Object.prototype.hasOwnProperty.call(e, "hide_empty")) {
                                var n, o = [],
                                    a = [];
                                if ("nt_all" == e.id) {
                                    n = i.getNodes();
                                    var s = i.getNodeTypes().filter((function(t) {
                                        return Array.isArray(t.properties) && t.properties.find((function(t) {
                                            return t.name === e.prop
                                        }))
                                    })).map((function(e) {
                                        return e.id
                                    }));
                                    n = n.filter((function(e) {
                                        return s.indexOf(e.type_id) >= 0
                                    }))
                                } else n = i.getNodesByTypeId(e.id);
                                (n = n.filter((function(e) {
                                    return !e.filtered
                                }))).forEach((function(t) {
                                    if (!t.properties || !Object.prototype.hasOwnProperty.call(t.properties, e.prop) || !t.properties[e.prop] || "" === t.properties[e.prop].trim()) {
                                        var n = {
                                            id: t.id,
                                            links: []
                                        };
                                        t.filtered = !0, t.edges.forEach((function(t) {
                                            t.filtered || u[e.ref].indexOf(t.id) < 0 && (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), a.push(t), n.links.push(t.id), t.filtered = !0)
                                        })), l[e.ref].push(n), d[t.id] = n.links, o.push(t.id)
                                    }
                                })), t.removeLink(a), t.removeNode(o)
                            } else if (Object.prototype.hasOwnProperty.call(e, "range")) ! function(e) {
                            var n, o = parseFloat(e.range.min),
                                a = parseFloat(e.range.max),
                                s = void 0;
                            for (n = c.length - 2; n >= 0; n -= 1)
                                if ("nt_prop" === c[n].type && Object.prototype.hasOwnProperty.call(c[n], "range") && c[n].id === e.id && c[n].prop === e.prop) {
                                    s = c[n], r = !(parseFloat(s.range.min) > parseFloat(e.range.min) || parseFloat(s.range.max) < parseFloat(e.range.max));
                                    break
                                }
                            s && r && (l[s.ref].forEach((function(t) {
                                l[e.ref].push(t)
                            })), u[s.ref].forEach((function(t) {
                                u[e.ref].push(t)
                            })), l[s.ref] = void 0, u[s.ref] = void 0, c.splice(n, 1));
                            var f = [],
                                h = [];
                            ("nt_all" === e.id ? i.getNodes() : i.getNodesByTypeId(e.id)).filter((function(e) {
                                return !e.filtered
                            })).forEach((function(t) {
                                var n;
                                if (t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && (n = t.properties[e.prop]), !isNaN(n) && !((n = parseFloat(n)) <= a && n >= o)) {
                                    var r = {
                                        id: t.id,
                                        links: []
                                    };
                                    t.filtered = !0, t.edges.forEach((function(t) {
                                        t.filtered || u[e.ref].indexOf(t.id) < 0 && (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), h.push(t), r.links.push(t.id), t.filtered = !0)
                                    })), l[e.ref].push(r), d[t.id] = r.links, f.push(t.id)
                                }
                            })), t.removeLink(h), t.removeNode(f), s && !r && O(s, !0)
                        }(e);
                        else {
                            var f = [],
                                h = [];
                            ("nt_all" === e.id ? i.getNodes() : i.getNodesByTypeId(e.id)).filter((function(e) {
                                return !e.filtered
                            })).forEach((function(t) {
                                if (t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && t.properties[e.prop].trim() === e.value.trim()) {
                                    var n = {
                                        id: t.id,
                                        links: []
                                    };
                                    t.filtered = !0, t.edges.forEach((function(t) {
                                        t.filtered || u[e.ref].indexOf(t.id) < 0 && (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), h.push(t), n.links.push(t.id), t.filtered = !0)
                                    })), l[e.ref].push(n), d[t.id] = n.links, f.push(t.id)
                                }
                            })), t.removeLink(h), t.removeNode(f)
                        }
                    }, E.et_weight = function(e) {
                        var n, r = parseFloat(e.range.min),
                            a = parseFloat(e.range.max),
                            s = void 0;
                        for (n = c.length - 2; n >= 0; n -= 1)
                            if ("et_weight" === c[n].type && c[n].id === e.id) {
                                s = c[n], o = !(parseFloat(s.range.min) > parseFloat(e.range.min) || parseFloat(s.range.max) < parseFloat(e.range.max));
                                break
                            }
                        s && o && (u[s.ref].forEach((function(t) {
                            u[e.ref].push(t)
                        })), u[s.ref] = void 0, c.splice(n, 1));
                        var l = [];
                        i.getLinks().filter((function(e) {
                            return !e.filtered
                        })).forEach((function(t) {
                            var n;
                            "et_all" !== e.id && t.name_id !== e.id || (n = t.weight || 1), isNaN(n) || (n = parseFloat(n)) <= a && n >= r || (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), l.push({
                                from: t.from,
                                to: t.to,
                                id: t.id
                            }), t.filtered = !0)
                        })), t.removeLink(l), s && !o && O(s, !0)
                    }, E.et_prop = function(e) {
                        if (t)
                            if (Object.prototype.hasOwnProperty.call(e, "hide_empty")) {
                                var n, r = [];
                                if ("et_all" === e.id) {
                                    n = i.getLinks();
                                    var a = i.getEdgeTypes().filter((function(t) {
                                        return Array.isArray(t.properties) && t.properties.find((function(t) {
                                            return t.name === e.prop
                                        }))
                                    })).map((function(e) {
                                        return e.id
                                    }));
                                    n = n.filter((function(e) {
                                        return a.indexOf(e.name_id) >= 0
                                    }))
                                } else n = i.getEdgesByTypeId(e.id);
                                (n = n.filter((function(e) {
                                    return !e.filtered
                                }))).forEach((function(t) {
                                    t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && t.properties[e.prop] && "" !== t.properties[e.prop].trim() || (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), r.push({
                                        from: t.from,
                                        to: t.to,
                                        id: t.id
                                    }), t.filtered = !0)
                                })), t.removeLink(r)
                            } else if (Object.prototype.hasOwnProperty.call(e, "range")) ! function(e) {
                            var n, r = parseFloat(e.range.min),
                                a = parseFloat(e.range.max),
                                s = void 0;
                            for (n = c.length - 2; n >= 0; n -= 1)
                                if ("et_prop" === c[n].type && Object.prototype.hasOwnProperty.call(c[n], "range") && c[n].id === e.id && c[n].prop === e.prop) {
                                    s = c[n], o = !(parseFloat(s.range.min) > parseFloat(e.range.min) || parseFloat(s.range.max) < parseFloat(e.range.max));
                                    break
                                }
                            s && o && (u[s.ref].forEach((function(t) {
                                u[e.ref].push(t)
                            })), u[s.ref] = void 0, c.splice(n, 1));
                            var l, d = [];
                            l = "et_all" === e.id ? i.getLinks() : i.getEdgesByTypeId(e.id);
                            (l = l.filter((function(e) {
                                return !e.filtered
                            }))).forEach((function(t) {
                                var n;
                                t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && (n = t.properties[e.prop]), isNaN(n) || (n = parseFloat(n)) <= a && n >= r || (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), d.push({
                                    from: t.from,
                                    to: t.to,
                                    id: t.id
                                }), t.filtered = !0)
                            })), t.removeLink(d), s && !o && O(s, !0)
                        }(e);
                        else {
                            var s = [];
                            ("et_all" === e.id ? i.getLinks() : i.getEdgesByTypeId(e.id)).filter((function(e) {
                                return !e.filtered
                            })).forEach((function(t) {
                                t.properties && Object.prototype.hasOwnProperty.call(t.properties, e.prop) && t.properties[e.prop] === e.value && (u[e.ref].push(t.id), Object.prototype.hasOwnProperty.call(p, t.name_id) || (p[t.name_id] = []), p[t.name_id].push(t.id), s.push({
                                    from: t.from,
                                    to: t.to,
                                    id: t.id
                                }), t.filtered = !0)
                            })), t.removeLink(s)
                        }
                    };
                    var j = function() {
                        s && (s = !1, t && (f = t.calculateCentralitiesForFilter()))
                    };

                    function S() {
                        if (y && t) {
                            var e = [];
                            i.getNodes().filter((function(e) {
                                return !e.filtered && 0 == e.edges.filter((function(e) {
                                    return !e.filtered
                                })).length
                            })).forEach((function(t) {
                                h[t.type_id] || (h[t.type_id] = []), h[t.type_id].push(t.id), g[t.id] = !0, m.indexOf(t.type_id) < 0 && e.push(t.id)
                            })), t.removeNode(e)
                        }
                    }

                    function x() {
                        if (t) {
                            for (var e in h)
                                if (Object.prototype.hasOwnProperty.call(h, e) && m.indexOf(e) < 0)
                                    for (var n = 0; n < h[e].length; n += 1) {
                                        var r = h[e][n];
                                        t.addNode(r, f[e][r])
                                    }
                            g = {}, h = {}
                        }
                    }
                    return {
                        setCanvas: function(e) {
                            t = e
                        },
                        addRule: b,
                        removeRule: O,
                        getRules: function() {
                            return c
                        },
                        clearFilter: function() {
                            t && (x(), y = !1, i.getNodes().filter((function(e) {
                                return e.filtered
                            })).forEach((function(e) {
                                t.addNode(e.id, f[e.type_id][e.id]), e.filtered = !1
                            })), i.getLinks().filter((function(e) {
                                return e.filtered
                            })).forEach((function(e) {
                                t.addLink(e), e.filtered = !1
                            })), c = [], l = {}, d = {}, u = {}, p = {}), n && (n.close(), n = null)
                        },
                        getTotalFilteredNodeCount: function() {
                            var e, t, n = 0;
                            for (e = c.length - 1; e >= 0; e -= 1) t = l[c[e].ref], Array.isArray(t) && (n += t.length);
                            for (e in h) Object.prototype.hasOwnProperty.call(h, e) && (n += h[e].length || 0);
                            return n
                        },
                        getTotalFilteredEdgeCount: function() {
                            var e, t = 0;
                            for (e in p) Object.prototype.hasOwnProperty.call(p, e) && (t += p[e].length || 0);
                            return t
                        },
                        getFilteredNodeCountForType: function(e) {
                            var t, n = 0;
                            for (t = c.length - 1; t >= 0; t -= 1) c[t].id === e && (n += l[c[t].ref].length);
                            return m.indexOf(e) < 0 && h[e] && (n += h[e].length), n
                        },
                        getFilteredEdgeCountForType: function(e) {
                            return Object.prototype.hasOwnProperty.call(p, e) ? p[e].length : 0
                        },
                        getIsolatedNodeCountForType: function(e) {
                            var t = 0;
                            return h[e] && (t += h[e].length), t
                        },
                        shouldFilterIsolatedNodes: function() {
                            return y
                        },
                        setFilterIsolatedNodesFlag: function(e) {
                            (y = e) ? (S(), 0 !== c.length && "hide_isolated" === c[0].type || c.unshift({
                                type: "hide_isolated"
                            })) : (x(), c = c.filter((function(e) {
                                return "hide_isolated" !== e.type
                            })))
                        },
                        calculateCentralities: j,
                        getCentralities: function() {
                            return f
                        },
                        setDirty: function() {
                            s = !0
                        },
                        initializeWithRules: function(e) {
                            (j(), Array.isArray(e)) && (Object(a.s)(e), e.filter((function(e) {
                                return "hide_isolated" === e.type
                            })).length > 0 && (c.unshift({
                                type: "hide_isolated"
                            }), y = !0, S()), e.filter((function(e) {
                                return "hide_isolated" !== e.type
                            })).forEach((function(e) {
                                b(e, !0)
                            })))
                        },
                        getActiveExpandedFilter: function() {
                            return n
                        },
                        setActiveExpandedFilter: function(e) {
                            n = e
                        }
                    }
                },
                p = n(5),
                f = n(2),
                h = n(21),
                g = function(e) {
                    var t = e.GraphHistory,
                        n = function(e) {
                            var t = {
                                action: "node_create"
                            };
                            return ["id", "ancestor_id", "name", "description", "image", "reference", "type", "type_id", "graph_count"].forEach((function(n) {
                                t[n] = e[n]
                            })), t.properties = Object(a.p)(e.properties), t
                        },
                        r = function(e) {
                            for (var t = Object(a.sb)(e), n = t.length - 1; n >= 0; n -= 1) {
                                var r = t[n];
                                if (Object.prototype.hasOwnProperty.call(r, "_referenced_batch_id"))
                                    for (var o = n - 1; o >= 0; o -= 1)
                                        if (t[o]._batch_id === r._referenced_batch_id) {
                                            t.splice(n, 1), t.splice(o, 1), n -= 1;
                                            break
                                        }
                            }
                            return t
                        },
                        o = function(e) {
                            var t, n, r, o, i = Object(a.sb)(e);
                            for (t = 0; t < i.length; t += 1) {
                                switch (o = !1, (r = i[t]).action) {
                                    case "edge_delete":
                                        for (n = t - 1; n >= 0; n -= 1) {
                                            var s = i[n];
                                            s.id === r.id && (i.splice(n, 1), t -= 1, "edge_create" === s.action && (o = !0))
                                        }
                                        break;
                                    case "node_delete":
                                        for (n = t - 1; n >= 0; n -= 1) {
                                            var c = i[n];
                                            c.id !== r.id && c.from !== r.id && c.to !== r.id || (i.splice(n, 1), t -= 1, "node_create" === c.action && (o = !0))
                                        }
                                }
                                o && (i.splice(t, 1), t -= 1)
                            }
                            return i
                        },
                        i = function(e) {
                            var t = [];
                            return e.forEach((function(e) {
                                t = t.concat(e.signals)
                            })), t
                        };
                    return {
                        registerBatch: function(e) {
                            var t = {};
                            return t._batch_id = Object(a.M)(), t.signals = [], t._undo = {
                                _batch_id: Object(a.M)(),
                                _referenced_batch_id: t._batch_id,
                                signals: []
                            }, e.forEach((function(e) {
                                t.signals.push(Object(a.p)(e))
                            })), t
                        },
                        createUndoSignal: function(e) {
                            switch (e.action) {
                                case "nodetype_create":
                                    return function(e) {
                                        return {
                                            action: "nodetype_delete",
                                            id: e.id
                                        }
                                    }(e);
                                case "nodetype_update":
                                    return function(e) {
                                        var n = {},
                                            r = t.getNodeTypeById(e.id),
                                            o = !1;
                                        return Object.prototype.hasOwnProperty.call(e.prev, "properties") && e.prev.properties.find((function(e) {
                                            return 0 === Object.keys(e).length
                                        })) && (o = !0), o ? (n.action = "nodetype_delete", n.id = e.id, n.properties = {}, e.prev.properties.forEach((function(t, r) {
                                            0 === Object.keys(t).length && (n.properties[e.properties[r].name] = !0)
                                        }))) : (n.action = "nodetype_update", n.id = e.id, n.prev = {}, Object.keys(e.prev).forEach((function(t) {
                                            if ("properties" === t) {
                                                var o = e.prev.properties;
                                                n.properties = [], n.prev.properties = [], o.forEach((function(t, r) {
                                                    var o = Object.keys(t);
                                                    if (o.length > 0) {
                                                        var a = {},
                                                            i = {};
                                                        o.forEach((function(n) {
                                                            a[n] = t[n], i[n] = e.properties[r][n]
                                                        })), n.properties.push(a), n.prev.properties.push(i)
                                                    } else console.log("this is a delete signal. Needs to be fixed")
                                                }))
                                            } else n[t] = r[t], n.prev[t] = e[t]
                                        }))), n
                                    }(e);
                                case "nodetype_delete":
                                    return function(e) {
                                        var r = {},
                                            o = t.getNodeTypeById(e.id);
                                        if (Object.prototype.hasOwnProperty.call(e, "properties")) {
                                            r.action = "nodetype_update", r.id = o.id, r.properties = [], r.prev = {
                                                properties: []
                                            }, Object.keys(e.properties).forEach((function(e) {
                                                var t = o.properties.find((function(t) {
                                                    return t.name === e
                                                }));
                                                r.properties.push(Object(a.p)(t)), r.prev.properties.push({})
                                            }));
                                            var i = t.getNodesByTypeId(o.id);
                                            i.length > 0 && (r.node_properties = {}, i.forEach((function(t) {
                                                Object.keys(e.properties).forEach((function(e) {
                                                    t.properties && Object.prototype.hasOwnProperty.call(t.properties, e) && (Object.prototype.hasOwnProperty.call(r.node_properties, t.id) || (r.node_properties[t.id] = {}), r.node_properties[t.id][e] = t.properties[e])
                                                }))
                                            })))
                                        } else {
                                            (r = Object(a.p)(o)).action = "nodetype_create";
                                            var s = t.getNodesByTypeId(o.id);
                                            if (s.length > 0 && (r.nodes = s.map((function(e) {
                                                    return n(e)
                                                }))), Array.isArray(r.nodes)) {
                                                var c = {};
                                                r.nodes.forEach((function(e) {
                                                    t.getNodeById(e.id).edges.forEach((function(e) {
                                                        var t = e.id;
                                                        c[t] || (c[t] = Object(a.p)(e))
                                                    }))
                                                })), r.edges = Object(a.gb)(c)
                                            }
                                        }
                                        return r
                                    }(e);
                                case "node_create":
                                    return function(e) {
                                        var t = {
                                            action: "node_delete"
                                        };
                                        return t.id = e.id, t.name = e.name, t.type = e.type, t.type_id = e.type_id, Object.prototype.hasOwnProperty.call(e, "exists_in_hub") && (t.exists_in_hub = e.exists_in_hub), t
                                    }(e);
                                case "node_update":
                                    return function(e) {
                                        var n = {},
                                            r = t.getNodeById(e.id);
                                        return n.action = "node_update", n.id = r.id, n.prev = {}, Object.keys(e).filter((function(e) {
                                            return ["action", "id", "prev"].indexOf(e) < 0 && "_" !== e[0]
                                        })).forEach((function(t) {
                                            "properties" == t ? (n.properties = {}, n.prev.properties = {}, Object.keys(e.properties).forEach((function(t) {
                                                n.properties[t] = r.properties[t], n.prev.properties[t] = e.properties[t]
                                            }))) : (n[t] = r[t], n.prev[t] = e[t])
                                        })), n
                                    }(e);
                                case "node_delete":
                                    return function(e) {
                                        var r = t.getNodeById(e.id),
                                            o = n(r);
                                        return Object.prototype.hasOwnProperty.call(e, "pos") && (o.pos = Object(a.p)(e.pos)), Object.prototype.hasOwnProperty.call(e, "exists_in_hub") && (o.exists_in_hub = e.exists_in_hub), r.edges.length > 0 && (o.edges = r.edges.map((function(e) {
                                            return Object(a.p)(e)
                                        }))), o
                                    }(e);
                                case "edgetype_create":
                                    return function(e) {
                                        var t = {
                                            action: "edgetype_delete"
                                        };
                                        return t.id = e.id, t
                                    }(e);
                                case "edgetype_update":
                                    return function(e) {
                                        var n = {},
                                            r = t.getEdgeTypeById(e.id),
                                            o = !1;
                                        return Object.prototype.hasOwnProperty.call(e.prev, "properties") && e.prev.properties.find((function(e) {
                                            return 0 === Object.keys(e).length
                                        })) && (o = !0), o ? (n.action = "edgetype_delete", n.id = r.id, n.properties = {}, e.prev.properties.forEach((function(t, r) {
                                            0 === Object.keys(t).length && (n.properties[e.properties[r].name] = !0)
                                        }))) : (n.action = "edgetype_update", n.id = e.id, n.prev = {}, Object.keys(e.prev).forEach((function(t) {
                                            if ("properties" === t) {
                                                var o = e.prev.properties;
                                                n.properties = [], n.prev.properties = [], o.forEach((function(t, r) {
                                                    var o = Object.keys(t);
                                                    if (o.length > 0) {
                                                        var a = {},
                                                            i = {};
                                                        o.forEach((function(n) {
                                                            a[n] = t[n], i[n] = e.properties[r][n]
                                                        })), n.properties.push(a), n.prev.properties.push(i)
                                                    } else console.log("this is a delete signal. Needs to be fixed")
                                                }))
                                            } else n[t] = r[t], n.prev[t] = e[t]
                                        }))), n
                                    }(e);
                                case "edgetype_delete":
                                    return function(e) {
                                        var n = {},
                                            r = t.getEdgeTypeById(e.id);
                                        if (Object.prototype.hasOwnProperty.call(e, "properties")) {
                                            n.action = "edgetype_update", n.id = r.id, n.properties = [], n.prev = {
                                                properties: []
                                            }, Object.keys(e.properties).forEach((function(e) {
                                                var t = r.properties.find((function(t) {
                                                    return t.name === e
                                                }));
                                                n.properties.push(Object(a.p)(t)), n.prev.properties.push({})
                                            }));
                                            var o = t.getEdgesByTypeId(r.id);
                                            o.length > 0 && (n.edge_properties = {}, o.forEach((function(t) {
                                                Object.keys(e.properties).forEach((function(e) {
                                                    t.properties && Object.prototype.hasOwnProperty.call(t.properties, e) && (Object.prototype.hasOwnProperty.call(n.edge_properties, t.id) || (n.edge_properties[t.id] = {}), n.edge_properties[t.id][e] = t.properties[e])
                                                }))
                                            })))
                                        } else {
                                            (n = Object(a.p)(r)).action = "edgetype_create";
                                            var i = t.getEdgesByTypeId(r.id);
                                            i.length > 0 && (n.edges = i.map((function(e) {
                                                return Object(a.p)(e)
                                            })))
                                        }
                                        return n
                                    }(e);
                                case "edge_create":
                                    return function(e) {
                                        var t = {
                                            action: "edge_delete"
                                        };
                                        return t.id = e.id, t.name = e.name, t.name_id = e.name_id, t.from = e.from, t.to = e.to, Object.prototype.hasOwnProperty.call(e, "exists_in_hub") && (t.exists_in_hub = e.exists_in_hub), t
                                    }(e);
                                case "edge_update":
                                    return function(e) {
                                        var n = {},
                                            r = t.getEdgeById(e.id);
                                        return n.action = "edge_update", n.id = r.id, n.from = r.from, n.to = r.to, n.name = r.name, n.name_id = r.name_id, n.prev = {}, Object.keys(e).filter((function(e) {
                                            return ["action", "id", "from", "to", "name", "name_id", "undo", "prev"].indexOf(e) < 0 && "_" !== e[0]
                                        })).forEach((function(t) {
                                            "properties" == t ? (n.properties = {}, n.prev.properties = {}, Object.keys(e.properties).forEach((function(t) {
                                                n.properties[t] = r.properties[t], n.prev.properties[t] = e.properties[t]
                                            }))) : (n[t] = r[t], n.prev[t] = e[t])
                                        })), e.prev && e.prev.name && e.name && (n.prev.name = e.name), n
                                    }(e);
                                case "edge_delete":
                                    return function(e) {
                                        var n = {},
                                            r = t.getEdgeById(e.id);
                                        return (n = Object(a.p)(r)).action = "edge_create", Object.prototype.hasOwnProperty.call(e, "exists_in_hub") && (n.exists_in_hub = e.exists_in_hub), n
                                    }(e);
                                default:
                                    return {}
                            }
                        },
                        markBatchesAfterSaveFailed: function(e) {
                            return e.forEach((function(e) {
                                e._waiting_for_save = !1
                            })), e
                        },
                        markBatchesAfterSaveCompleted: function(e) {
                            return e.forEach((function(e) {
                                e._waiting_for_save = !1, e._saved = !0
                            })), e
                        },
                        markBatchesToBeSaved: function(e) {
                            return e.forEach((function(e) {
                                e._waiting_for_save = !0
                            })), e
                        },
                        getUnsavedBatches: function(e) {
                            return e.filter((function(e) {
                                return !e._saved
                            }))
                        },
                        trimUndoBatches: r,
                        getSignalsFromBatches: i,
                        trimSignals: o,
                        getTrimmedSignals: function(e) {
                            var t = r(e),
                                n = i(t);
                            return o(n)
                        }
                    }
                },
                m = n(9);

            function y(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function b(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? y(Object(n), !0).forEach((function(t) {
                        v(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : y(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function v(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var _ = function(e, t, n, r) {
                var o = e.uiStore,
                    a = e.graphStore,
                    c = e.dispatcher,
                    l = e,
                    d = [],
                    y = [],
                    v = !!t,
                    _ = [],
                    w = {},
                    O = {},
                    E = [],
                    j = {},
                    S = [],
                    x = [],
                    k = m.a.VIEW,
                    C = function(e, t) {
                        var n = Array.isArray(e) ? e : [e],
                            r = [n];
                        n.length && (t && "function" === typeof t.getName && r.push(t.getName()), a.get("id") && Object(p.notifyNodeSelection)(a.get("id"), n), c.emit.apply(c, [t, "onNodeSelected"].concat(r)))
                    };

                function N(e, t) {
                    for (var n = !1, r = 0; r < _.length; r += 1)
                        if (_[r].id === e.id) {
                            console.log("this node exists"), n = !0;
                            break
                        }
                    if (!n) {
                        var o = {
                            action: "node_create",
                            exists_in_hub: !0
                        };
                        for (var a in e)
                            if (Object.prototype.hasOwnProperty.call(e, a)) switch (a) {
                                case "properties":
                                    for (var i in o.properties = {}, e.properties) Object.prototype.hasOwnProperty.call(e.properties, i) && (o.properties[i] = e.properties[i]);
                                    break;
                                case "graphs":
                                    break;
                                default:
                                    o[a] = e[a]
                            }
                        t && (o.pos = t), q(o), t && delete o.pos
                    }
                }

                function T(e) {
                    for (var t = !1, n = 0; n < E.length; n += 1)
                        if (E[n].id === e.id) {
                            console.log("this Vector exists"), t = !0;
                            break
                        }
                    if (!t) {
                        var r = {
                            action: "edge_create",
                            exists_in_hub: !0
                        };
                        for (var o in e)
                            if (Object.prototype.hasOwnProperty.call(e, o)) switch (o) {
                                case "properties":
                                    for (var a in r.properties = {}, e.properties) Object.prototype.hasOwnProperty.call(e.properties, a) && (r.properties[a] = e.properties[a]);
                                    break;
                                default:
                                    r[o] = e[o]
                            }
                        q(r)
                    }
                }
                var L = function(e) {
                        var t = {
                            action: "edge_create",
                            exists_in_hub: !0
                        };
                        for (var n in e)
                            if (Object.prototype.hasOwnProperty.call(e, n)) switch (n) {
                                case "properties":
                                    for (var r in t.properties = {}, e.properties) Object.prototype.hasOwnProperty.call(e.properties, r) && (t.properties[r] = e.properties[r]);
                                    break;
                                default:
                                    t[n] = e[n]
                            }
                        return t
                    },
                    P = function(e) {
                        var t = {
                            action: "node_create",
                            exists_in_hub: !0
                        };
                        for (var n in e)
                            if (Object.prototype.hasOwnProperty.call(e, n)) switch (n) {
                                case "properties":
                                    for (var r in t.properties = {}, e.properties) Object.prototype.hasOwnProperty.call(e.properties, r) && (t.properties[r] = e.properties[r]);
                                    break;
                                case "graphs":
                                    break;
                                default:
                                    t[n] = e[n]
                            }
                        return t
                    },
                    A = function(e, t) {
                        var n = t || [],
                            r = (e || []).map(P),
                            o = n.map(L),
                            a = r.concat(o);
                        a.length > 0 && q(a)
                    },
                    D = function(e, t, n) {
                        R(e), n && M([e]), t && c.emit("trigger", e)
                    };

                function M(e) {
                    var t = me.registerBatch(e);
                    return d.push(t), y.push(t), t
                }

                function q(e, t) {
                    var n = M(Array.isArray(e) ? e : [e]);
                    n.signals.forEach((function(e) {
                        n._undo.signals.unshift(me.createUndoSignal(e)), R(e), c.emit(t, "trigger", e)
                    })), ne(n), c.emit(t, "onSignal", n)
                }
                var I = function() {
                    d = [], y = [], a.set("isDirty", !1), a.set("isSnapshotDirty", !1)
                };

                function R(e) {
                    switch (e.action) {
                        case "nodetype_create":
                            ! function(e) {
                                if (Object.prototype.hasOwnProperty.call(O, e.id)) return void console.log(e.name + "(" + e.id + ") node type already exists");
                                Object.prototype.hasOwnProperty.call(e, "image_as_icon") || (e.image_as_icon = !0);
                                var t;
                                if (O[e.id] = {
                                        id: e.id,
                                        name: e.name,
                                        name_alias: e.name_alias,
                                        description: e.description,
                                        ancestor_id: e.ancestor_id,
                                        image: e.image,
                                        image_as_icon: e.image_as_icon,
                                        display_name: e.display_name,
                                        secondary_display_name: e.secondary_display_name,
                                        color: Object.prototype.hasOwnProperty.call(e, "color") ? e.color : Object(f.randomColor)(),
                                        size: e.size || "metric_degree",
                                        hide_name: e.hide_name || !1,
                                        size_limit: e.size_limit || 48,
                                        size_min_limit: Number(e.size_min_limit) || 8,
                                        centered_display_name: e.centered_display_name,
                                        centered_secondary_display_name: e.centered_secondary_display_name,
                                        properties: [],
                                        count: 0
                                    }, e.properties)
                                    for (t = 0; t < e.properties.length; t += 1) e.properties[t] && O[e.id].properties.push({
                                        name: e.properties[t].name,
                                        name_alias: e.properties[t].name_alias
                                    });
                                e.nodes && e.nodes.forEach(B);
                                e.edges && e.edges.forEach(F)
                            }(e);
                            break;
                        case "nodetype_update":
                            ! function(e) {
                                if (!e.prev) return void console.log("nodetype_update signal does not have prev key");
                                var t, n, r, o = W(e.id);
                                if (!o) return void console.log("Could not find nodeType with id: " + e.id);
                                for (t in e)
                                    if (Object.prototype.hasOwnProperty.call(e, t)) {
                                        if ("id" === t || "action" === t || "prev" === t || "_" === t[0]) continue;
                                        if ("properties" === t) {
                                            if (!Object.prototype.hasOwnProperty.call(e.prev, "properties")) return void console.log("prev key should contain properties object");
                                            if (e.properties.length !== e.prev.properties.length) return void console.log("signal.properties and signal.properties_prev should be the same length");
                                            for (Object.prototype.hasOwnProperty.call(o, "properties") || (o.properties = []), n = 0; n < e.properties.length; n += 1) {
                                                var a = e.prev.properties[n].name,
                                                    i = e.prev.properties[n].name_alias;
                                                if (a || i)
                                                    for (r = 0; r < o.properties.length; r += 1) {
                                                        var s = o.properties[r];
                                                        a && s.name === a && (s.name = e.properties[n].name), i && s.name_alias === i && (s.name_alias = e.properties[n].name_alias)
                                                    } else o.properties.push({
                                                        name: e.properties[n].name,
                                                        name_alias: e.properties[n].name_alias
                                                    })
                                            }
                                        } else o[t] = e[t]
                                    }
                                e.prev.name && Z(o.id).forEach((function(e) {
                                    e.type = o.name
                                }));
                                e.prev.properties && e.prev.properties.forEach((function(t, n) {
                                    if (t.name) {
                                        var r = t.name,
                                            o = e.properties[n].name;
                                        ! function(e, t, n) {
                                            Z(e).forEach((function(e) {
                                                e.properties && e.properties[t] && (e.properties[n] = e.properties[t], delete e.properties[t])
                                            }))
                                        }(e.id, r, o)
                                    }
                                }));
                                e.node_properties && Object.keys(e.node_properties).forEach((function(t) {
                                    var n = X(t);
                                    n && (n.properties || (n.properties = {}), Object.keys(e.node_properties[t]).forEach((function(r) {
                                        n.properties[r] = e.node_properties[t][r]
                                    })))
                                }))
                            }(e);
                            break;
                        case "nodetype_delete":
                            ! function(e) {
                                var t = W(e.id);
                                t || console.log("could not find the nodetype with id: " + e.id);
                                var n, r, o, a = !1;
                                for (n in e)
                                    if (Object.prototype.hasOwnProperty.call(e, n)) {
                                        if ("id" === n || "action" === n || "_" === n[0]) continue;
                                        if (a = !0, "properties" === n) {
                                            for (r in e.properties)
                                                if (Object.prototype.hasOwnProperty.call(e.properties, r))
                                                    for (o = 0; o < t.properties.length; o += 1)
                                                        if (t.properties[o].name === r) {
                                                            t.properties.splice(o, 1);
                                                            break
                                                        }
                                        } else delete t[n]
                                    }
                                if (a) {
                                    Z(t.id).forEach((function(t) {
                                        t.properties && Object.keys(e.properties).forEach((function(e) {
                                            Object.prototype.hasOwnProperty.call(t.properties, e) && delete t.properties[e]
                                        }))
                                    }))
                                } else {
                                    Z(t.id).forEach(H), delete O[t.id]
                                }
                            }(e);
                            break;
                        case "edgetype_create":
                            ! function(e) {
                                if (j[e.id]) return void console.log(e.name + "(" + e.id + ") Vector Order already exists");
                                if (!e.id) return void console.log("signal id is not defined");
                                var t, n;
                                if (j[e.id] = {
                                        id: e.id,
                                        name: e.name,
                                        name_alias: e.name_alias,
                                        description: e.description,
                                        color: Object.prototype.hasOwnProperty.call(e, "color") ? e.color : Object(f.randomColor)(),
                                        weighted: Object.prototype.hasOwnProperty.call(e, "weighted") ? e.weighted : 1,
                                        directed: Object.prototype.hasOwnProperty.call(e, "directed") ? e.directed : 1,
                                        durational: !!Object.prototype.hasOwnProperty.call(e, "durational") && e.durational,
                                        display_name: e.display_name,
                                        count: 0
                                    }, Object.prototype.hasOwnProperty.call(e, "properties") && null != e.properties)
                                    for (n = e.properties, j[e.id].properties = [], t = 0; t < n.length; t += 1) j[e.id].properties.push({
                                        name: n[t].name,
                                        name_alias: n[t].name_alias
                                    });
                                e.edges && e.edges.forEach(F)
                            }(e);
                            break;
                        case "edgetype_update":
                            ! function(e) {
                                if (!e.prev) return void console.log("edgetype_update signal does not have prev key");
                                var t, n, r, o = Y(e.id);
                                if (!o) return void console.log("Could not find  Vector Order with id: " + e.id);
                                for (t in e)
                                    if (Object.prototype.hasOwnProperty.call(e, t)) {
                                        if ("id" === t || "action" === t || "prev" === t || "_" === t[0]) continue;
                                        if ("properties" === t) {
                                            if (!Object.prototype.hasOwnProperty.call(e.prev, "properties")) return void console.log("prev key should contain properties object");
                                            if (e.properties.length !== e.prev.properties.length) return void console.log("signal.properties and signal.properties_prev should be the same length");
                                            for (Object.prototype.hasOwnProperty.call(o, "properties") || (o.properties = []), n = 0; n < e.properties.length; n += 1) {
                                                var a = e.prev.properties[n].name,
                                                    i = e.prev.properties[n].name_alias;
                                                if (a || i)
                                                    for (r = 0; r < o.properties.length; r += 1) {
                                                        var s = o.properties[r];
                                                        a && s.name === a && (s.name = e.properties[n].name), i && s.name_alias === i && (s.name_alias = e.properties[n].name_alias)
                                                    } else o.properties.push({
                                                        name: e.properties[n].name,
                                                        name_alias: e.properties[n].name_alias
                                                    })
                                            }
                                        } else o[t] = e[t]
                                    }
                                e.name && E.forEach((function(t) {
                                    t.name_id === e.id && (t.name = e.name)
                                }));
                                e.prev.properties && e.prev.properties.forEach((function(t, n) {
                                    if (t.name) {
                                        var r = t.name,
                                            o = e.properties[n].name;
                                        ! function(e, t, n) {
                                            J(e).forEach((function(e) {
                                                e.properties && e.properties[t] && (e.properties[n] = e.properties[t], delete e.properties[t])
                                            }))
                                        }(e.id, r, o)
                                    }
                                }));
                                e.edge_properties && Object.keys(e.edge_properties).forEach((function(t) {
                                    var n = $(t);
                                    n && (n.properties || (n.properties = {}), Object.keys(e.edge_properties[t]).forEach((function(r) {
                                        n.properties[r] = e.edge_properties[t][r]
                                    })))
                                }))
                            }(e);
                            break;
                        case "edgetype_delete":
                            ! function(e) {
                                var t = Y(e.id);
                                t || console.log("could not find the Vector Order with id: " + e.id);
                                var n, r, o = !1;
                                for (n in e)
                                    if (Object.prototype.hasOwnProperty.call(e, n)) {
                                        if ("id" === n || "action" === n || "_" === n[0]) continue;
                                        if (o = !0, "properties" === n) {
                                            for (var a in e.properties)
                                                if (Object.prototype.hasOwnProperty.call(e.properties, a))
                                                    for (r = 0; r < t.properties.length; r += 1)
                                                        if (t.properties[r].name === a) {
                                                            t.properties.splice(r, 1);
                                                            break
                                                        }
                                        } else delete t[n]
                                    }
                                if (o) {
                                    J(t.id).forEach((function(t) {
                                        t.properties && Object.keys(e.properties).forEach((function(e) {
                                            Object.prototype.hasOwnProperty.call(t.properties, e) && delete t.properties[e]
                                        }))
                                    }))
                                } else {
                                    for (r = E.length - 1; r >= 0; r -= 1) E[r].name === t.name && E.splice(r, 1);
                                    delete j[t.id]
                                }
                            }(e);
                            break;
                        case "node_create":
                            B(e);
                            break;
                        case "node_update":
                            ! function(e) {
                                var t, n, r = X(e.id);
                                if (!r) return void console.log("could not find node with id " + e.id);
                                var o, a = !1;
                                if (Object.prototype.hasOwnProperty.call(e, "type") || Object.prototype.hasOwnProperty.call(e, "type_id")) {
                                    if (a = !0, Object.prototype.hasOwnProperty.call(e, "type")) {
                                        if (!(o = z(e.type))) return void console.log("node_update: type value does not have a corresponding node type");
                                        e.type_id = o.id
                                    } else {
                                        if (!(o = W(e.type_id))) return void console.log("node_update: type_id value does not have a corresponding node type");
                                        e.type = o.name
                                    }
                                    e.prev.type_id || (e.prev.type_id = r.type_id)
                                }
                                if (a) {
                                    var i = W(e.type_id);
                                    W(e.prev.type_id).count -= 1, i.count += 1
                                }
                                for (t in e)
                                    if (Object.prototype.hasOwnProperty.call(e, t)) {
                                        if ("id" === t || "action" === t || "prev" === t || "_" === t[0]) continue;
                                        if ("properties" === t)
                                            for (n in e.properties) Object.prototype.hasOwnProperty.call(e.properties, n) && (r.properties[n] = e.properties[n]);
                                        else r[t] = e[t] || null
                                    }
                            }(e);
                            break;
                        case "node_delete":
                            H(e);
                            break;
                        case "edge_create":
                            F(e);
                            break;
                        case "edge_update":
                            G(e);
                            break;
                        case "edge_delete":
                            U(e)
                    }
                    ie().setDirty(), se().setDirty()
                }

                function B(e) {
                    var t, n = {};
                    if (Object.prototype.hasOwnProperty.call(e, "id") && Object.prototype.hasOwnProperty.call(e, "type") && Object.prototype.hasOwnProperty.call(e, "name")) {
                        if (Object.prototype.hasOwnProperty.call(e, "type_id")) {
                            if (!Object.prototype.hasOwnProperty.call(O, e.type_id)) return void console.log("nodetype id is not defined. Will not save")
                        } else
                            for (t in O) Object.prototype.hasOwnProperty.call(O, t) && O[t].name === e.type && (e.type_id = t);
                        if (e.type_id) {
                            if (n.id = e.id, n.type = e.type, n.name = e.name, n.description = e.description, n.image = e.image, n.type_id = e.type_id, n.ancestor_id = e.ancestor_id, n.reference = e.reference, n.pos_x = e.pos_x, n.pos_y = e.pos_y, n.graph_count = e.graph_count, n.status = e.status, n.total_edges = e.total_edges || 0, n.degree = 0, n.edges = [], n.is_locked = a.get("layout").lock_node_positions || e.is_locked || e.properties && Object.prototype.hasOwnProperty.call(e.properties, "LatLng"), void 0 === n.status && (a.get("isHub") ? n.status = 2 : a.get("isHubGraph") || (n.status = a.get("status"))), n.properties = {}, Object.prototype.hasOwnProperty.call(e, "properties")) {
                                var r = e.properties;
                                for (t in r) Object.prototype.hasOwnProperty.call(r, t) && (n.properties[t] = r[t])
                            }
                            _.push(n), w[n.id] = n, O[e.type_id].count += 1, Array.isArray(e.edges) && e.edges.forEach(F)
                        } else console.log("nodetype id is not defined. Will not save")
                    } else console.log("addnode signal should contain id, type and name properties")
                }

                function F(e) {
                    var t, n = {};
                    if (Object.prototype.hasOwnProperty.call(e, "name_id")) {
                        if (!Object.prototype.hasOwnProperty.call(j, e.name_id)) return void console.log("edgeType id is not defined. Will not save")
                    } else
                        for (t in j) Object.prototype.hasOwnProperty.call(j, t) && j[t].name === e.name && (e.name_id = t);
                    if (e.name_id) {
                        if (n.id = e.id, n.name = e.name, n.name_id = e.name_id, n.to = e.to, n.from = e.from, n.graph_count = e.graph_count, n.properties = {}, Object.prototype.hasOwnProperty.call(e, "properties") && e.properties)
                            for (t in e.properties) Object.prototype.hasOwnProperty.call(e.properties, t) && (n.properties[t] = e.properties[t]);
                        E.push(n), j[e.name_id].weighted && (n.weight = Number(e.weight) || 1), j[e.name_id].count += 1, w[e.from].degree += 1, w[e.to].degree += 1, w[e.from].edges.push(n), w[e.to].edges.push(n)
                    } else console.log("edgetype id is not defined. Will not save")
                }

                function G(e) {
                    var t, n, r = $(e.id);
                    if (r) {
                        for (t in e)
                            if (Object.prototype.hasOwnProperty.call(e, t)) {
                                if ("id" === t || "action" === t || "name" === t || "name_id" === t || "from" === t || "to" === t || "prev" === t) continue;
                                if ("properties" === t)
                                    for (n in e.properties) Object.prototype.hasOwnProperty.call(e.properties, n) && (r.properties || (r.properties = {}), void 0 !== e.properties[n] && null !== e.properties[n] || !Object.prototype.hasOwnProperty.call(r.properties, n) ? r.properties[n] = e.properties[n] : delete r.properties[n]);
                                else r[t] = e[t]
                            }
                        if (e.prev && e.prev.name && e.name) {
                            var o = Y(r.name_id),
                                a = V(e.name);
                            if (!a) return void console.log("ERROR: new Vector Order name does not exist");
                            r.name = a.name, r.name_id = a.id, o.count -= 1, a.count += 1
                        }
                    } else console.log("Vector with id (" + e.id + ") does not exist")
                }

                function H(e) {
                    var t = X(e.id);
                    t && (Object.prototype.hasOwnProperty.call(e, "type_id") || (e.type_id = t.type_id), t.edges.forEach(U), _.splice(_.indexOf(t), 1), w[t.id] = null, O[t.type_id].count -= 1)
                }

                function U(e) {
                    var t = $(e.id);
                    t && (Object.prototype.hasOwnProperty.call(e, "name_id") || (e.name_id = t.name_id), a.get("belongsToHub") && !e.exists_in_hub && (w[t.from].total_edges -= 1, w[t.to].total_edges -= 1), E.splice(E.indexOf(t), 1), j[t.name_id].count -= 1, w[t.from].degree -= 1, w[t.to].degree -= 1, w[t.from].edges.splice(w[t.from].edges.indexOf(t), 1), w[t.to].edges.splice(w[t.to].edges.indexOf(t), 1))
                }

                function z(e) {
                    if (e) {
                        var t;
                        for (t in O)
                            if (Object.prototype.hasOwnProperty.call(O, t) && O[t].name === e) return O[t];
                        return null
                    }
                    console.log("You should specify a name for nodetype")
                }

                function W(e) {
                    return O[e]
                }

                function Y(e) {
                    return j[e]
                }

                function V(e) {
                    var t;
                    if (e) {
                        for (t in j)
                            if (Object.prototype.hasOwnProperty.call(j, t) && j[t].name === e) return j[t]
                    } else console.log("You should specify a linktype")
                }

                function X(e) {
                    return w[e]
                }

                function K(e, t) {
                    for (var n = 0; n < _.length; n += 1)
                        if (_[n].type === e && _[n].name === t) return _[n]
                }

                function $(e) {
                    for (var t = 0; t < E.length; t += 1)
                        if (E[t].id && E[t].id === e) return E[t]
                }

                function Z(e) {
                    return _.filter((function(t) {
                        return t.type_id === e
                    }))
                }

                function J(e) {
                    var t = E;
                    return e && (t = t.filter((function(t) {
                        return t.name_id === e
                    }))), t
                }
                var Q, ee = function() {
                        var e, t = [];
                        for (e in O) Object.prototype.hasOwnProperty.call(O, e) && t.push(O[e]);
                        return t
                    },
                    te = function() {
                        var e, t = [];
                        for (e in j) Object.prototype.hasOwnProperty.call(j, e) && t.push(j[e]);
                        return t
                    };

                function ne(e) {
                    if (e.signals.find((function(e) {
                            return "node_delete" === e.action || "edge_delete" === e.action
                        }))) {
                        var t = o.get("historySinceLastSave", !0);
                        a.set("isDirty", t.length > 0)
                    } else a.set("isDirty", !0)
                }
                var re, oe, ae;

                function ie() {
                    return re || (re = i(l)), re
                }

                function se() {
                    return oe || (oe = u(l)), oe
                }
                var ce = null,
                    le = function() {
                        _.forEach((function(e) {
                            e.status > a.get("status") && (e.status = a.get("status"))
                        }))
                    };

                function de(e) {
                    w = {}, _ = [], E = [], I(), e ? (Object.keys(O).forEach((function(e) {
                        O[e].count = 0
                    })), Object.keys(j).forEach((function(e) {
                        j[e].count = 0
                    }))) : (O = {}, j = {}), c.emit("clearGraph", e)
                }
                var ue, pe, fe, he = function(e, t) {
                    var n = e.auth,
                        r = e.user;
                    if (n) {
                        var o = document.querySelector("meta[name='csrf-token']");
                        o || ((o = document.createElement("meta")).setAttribute("name", "csrf-token"), document.head.appendChild(o)), o.setAttribute("content", n.csrfToken)
                    }
                    r && (a.update("user", (function(e) {
                        return b(b({}, e), {}, {
                            id: r.id,
                            name: r.name,
                            img_path: r.img_path
                        }, r.hub || {})
                    })), h.a.getUser = function() {
                        return {
                            id: r.id,
                            username: r.username,
                            plan: r.plan,
                            avatar: r.img_path
                        }
                    }), c.emit("onGraphUserChanged"), "function" === typeof t && t(e)
                };
                o.registerFunction("isOnlyExploreAllowed", (function() {
                    return r
                })), o.registerFunction("isExploreAllowed", (function() {
                    return !0
                })), o.register("lastCommentText", null), o.register("isClusterColorsApplied", null), o.register("isPreviewMode", !1), o.register("isImportingBatch", !1), o.registerFunction("historySinceLastSave", (function(e) {
                    var t = me.getUnsavedBatches(d);
                    return e ? me.getTrimmedSignals(t) : me.getSignalsFromBatches(t)
                })), o.registerFunction("hasListenerFocus", (function(e) {
                    return Q === e
                }), 1), o.registerFunction("editMode", (function() {
                    return k
                }), 0), c.bind("updateEditMode", (function(e) {
                    v || o.get("isOnlyExploreAllowed") && [m.a.EXPLORE, m.a.VIEW, m.a.DELETE].indexOf(e) < 0 || (k = e, c.emit("editModeUpdated", k))
                })), o.registerFunction("readOnly", (function() {
                    return v
                })), o.registerFunction("freezeMode", (function() {
                    return pe
                }), 0), c.bind("updateFreezeMode", (function(e) {
                    var t;
                    if (ue)
                        if (e) {
                            if (pe === e) return;
                            t = pe, pe = e
                        } else t = pe, pe = null, ue = !1;
                    else {
                        if (!e) return;
                        pe = e, ue = !0
                    }
                    "filter" === t && (se().clearFilter(), c.emit("onFilterApplied")), ue && c.emit("updateEditMode", m.a.VIEW), c.emit("freezeModeUpdated", pe, t)
                })), o.registerFunction("hasUnsavedBatches", (function() {
                    return !!d.find((function(e) {
                        return !e._saved
                    }))
                })), o.registerFunction("getBatches", (function() {
                    return d
                })), a.register("id", ""), a.register("title", ""), a.register("subtitle", ""), a.register("description", ""), a.register("references", ""), a.register("referencesQualityScore", null), a.register("community", !1), a.register("exploreTemplate", !1), a.register("license", {}), a.register("image", {
                    path: "",
                    ref_name: "",
                    ref_url: ""
                }, (function(e) {
                    var t = b({}, e);
                    return t.url || (t.url = t.path), !t.url || t.url.startsWith("//") || t.url.startsWith("https://") || t.url.startsWith("http://") || (t.url = h.a.getImageAssetsUrl() + t.url), t
                })), a.register("hub", {
                    id: "",
                    name: ""
                }), a.register("user", {}), a.register("users", [], (function(e) {
                    return e.map((function(e) {
                        return e.fullname || (e.first_name && e.last_name ? e.fullname = e.first_name + " " + e.last_name : e.fullname = e.username), /^https:\/\//.test(e.img_path) || (e.img_path = h.a.getImageAssetsUrl() + e.img_path), e
                    }))
                })), a.register("isUserRecommended", !1), a.register("createdAt", Date.now()), a.register("updatedAt", Date.now()), a.register("status", 0), a.register("recommendedCount", 0), a.register("layoutNodeFullname", !1), a.register("filters", [], (function(e) {
                    return e || []
                })), a.register("layout", {
                    springLength: 100,
                    gravity: -2.4,
                    springCoefficient: 2e-4,
                    thetaCoefficient: .8,
                    dragCoefficient: .02,
                    transform: "matrix(1, 0, 0, 1, 0, 0)",
                    algorithm: "force_directed"
                }, (function(e) {
                    return b({
                        zoom: 1
                    }, e)
                })), a.register("circularLayoutSettings", null), a.register("isDirty", !1), a.register("isSnapshotDirty", !1), a.register("isEmbed", !1), a.register("qualityScore", null), a.register("analysisItems", null), a.register("blockedNodesStatement", null), a.register("isWebGL", null), a.register("downloadID", null), a.registerFunction("isHub", (function() {
                    return !!n
                })), a.registerFunction("belongsToHub", (function() {
                    return a.get("isHub") || "" !== (a.get("hub") || {}).id
                })), a.registerFunction("isHubGraph", (function() {
                    return "" !== (a.get("hub") || {}).id && a.get("id") !== a.get("hub").id
                })), a.register("clusterLabelNameSizeFactor", 2.4), c.bind("graphStore.clusterLabelNameSizeFactor.updated", (function() {
                    o.get("readOnly") || (fe && clearTimeout(fe), fe = setTimeout((function() {
                        Object(p.updateClusterParams)(a.get("id"), {
                            clustering_label_scale_factor: a.get("clusterLabelNameSizeFactor")
                        }), fe = null
                    }), 2e3))
                }));
                var ge = {
                    getSelectedNodes: function() {
                        return S.slice(0)
                    },
                    getSelectedEdges: function() {
                        return x.slice(0)
                    },
                    getNodeTypeByName: z,
                    getPropNamesForNodeType: function(e) {
                        if (!e) return console.log("You should specify a nodeType"), [];
                        var t, n, r = [];
                        for (n in O)
                            if (Object.prototype.hasOwnProperty.call(O, n) && n === e && Object.prototype.hasOwnProperty.call(O[n], "properties")) {
                                for (t = 0; t < O[n].properties.length; t += 1) r.push(O[n].properties[t].name);
                                break
                            }
                        return r
                    },
                    getPropAliasesForNodeType: function(e) {
                        var t, n, r = [];
                        if (!e) return console.log("You should specify a nodeType"), [];
                        for (n in O)
                            if (Object.prototype.hasOwnProperty.call(O, n) && n === e && Object.prototype.hasOwnProperty.call(O[n], "properties")) {
                                for (t = 0; t < O[n].properties.length; t += 1) r.push(O[n].properties[t].name_alias);
                                break
                            }
                        return r
                    },
                    getEdgeTypeByName: V,
                    getPropAliasesForLinkType: function(e) {
                        if (!e) return console.log("You should specify a linktype"), [];
                        var t = [],
                            n = j[e];
                        if (n && Object.prototype.hasOwnProperty.call(n, "properties"))
                            for (var r = 0; r < n.properties.length; r += 1) t.push(n.properties[r].name_alias);
                        return t
                    },
                    getPropNamesForLinkType: function(e) {
                        if (!e) return console.log("You should specify a linktype"), [];
                        var t = [],
                            n = j[e];
                        if (n && Object.prototype.hasOwnProperty.call(n, "properties"))
                            for (var r = 0; r < n.properties.length; r += 1) t.push(n.properties[r].name);
                        return t
                    },
                    getNodes: function() {
                        return _
                    },
                    getLinks: function(e) {
                        var t = E;
                        return e && (t = t.filter((function(t) {
                            return t.to === e || t.from === e
                        }))), t
                    },
                    getEdgeCounts: function() {
                        var e, t, n = {};
                        for (e in j) Object.prototype.hasOwnProperty.call(j, e) && (n[e] = {
                            count: 0
                        });
                        for (e = 0; e < E.length; e += 1) t = E[e], Object.prototype.hasOwnProperty.call(n, t.name_id) && (n[t.name_id].count += 1);
                        return n
                    },
                    getLinksForNode: function(e) {
                        var t, n, r, o, a = {},
                            i = !1;
                        for (t = 0; t < E.length; t += 1) i = !1, (r = E[t]).from === e ? (i = !0, (n = {}).id = r.to) : r.to === e && (i = !0, (n = {}).id = r.from), i && (Object.prototype.hasOwnProperty.call(a, r.name_id) || (a[r.name_id] = {}, a[r.name_id].id = r.name_id, a[r.name_id].name = r.name, a[r.name_id].color = j[r.name_id].color, a[r.name_id].to_nodes = []), (o = X(n.id)) && (n.color = O[o.type_id].color, n.name = o.name, n.type = o.type, n.node_degree = o.degree), n.other = e, n.link_id = r.id, a[r.name_id].to_nodes.push(n));
                        return a
                    },
                    getNodeTypes: ee,
                    getNodeTypeById: W,
                    getNodeTypeNames: function() {
                        var e, t = [];
                        for (e in O) Object.prototype.hasOwnProperty.call(O, e) && t.push(O[e].name);
                        return t
                    },
                    getEdgeTypes: te,
                    getEdgeTypeNames: function() {
                        var e, t = [];
                        for (e in j) Object.prototype.hasOwnProperty.call(j, e) && t.push(j[e].name);
                        return t
                    },
                    getEdgeTypeById: Y,
                    getEdgesByTypeId: J,
                    getNodeByTypeAndName: K,
                    getNodeByName: function(e) {
                        for (var t = 0; t < _.length; t += 1)
                            if (_[t].name === e) return _[t]
                    },
                    getEdgeById: $,
                    getNodeById: X,
                    getNodePosition: function(e) {
                        return w[e] ? ae ? ae.getNodePosition(e) : {
                            x: NaN,
                            y: NaN
                        } : null
                    },
                    doesEdgeExist: function(e, t, n, r) {
                        var o;
                        for (o = 0; o < E.length; o += 1)
                            if ((E[o].from === e && E[o].to === t || E[o].to === e && E[o].from === t) && E[o].name === n) {
                                if (!r) return !0;
                                if (E[o].id !== r) return !0
                            }
                        return !1
                    },
                    getNodesByTypeId: Z,
                    isNodeSaved: function(e) {
                        var t, n = o.get("historySinceLastSave");
                        for (t = 0; t < n.length; t += 1)
                            if (n[t].id === e && "node_create" === n[t].action && (!Object.prototype.hasOwnProperty.call(n[t], "exists_in_hub") || !n[t].exists_in_hub)) return !1;
                        return !0
                    },
                    getNodeStatus: function(e) {
                        var t = w[e];
                        return t ? t.status : -1
                    },
                    normalizeNodeStatusesToGraphStatus: le,
                    hasMultiEdges: function() {
                        for (var e, t = {}, n = E.length - 1; n >= 0; n -= 1) {
                            if (t[e = [E[n].from, E[n].to].sort().join("-")]) return !0;
                            t[e] = !0
                        }
                        return !1
                    },
                    nodeDisplayName: function(e) {
                        var t = w[e];
                        if (!t) return null;
                        var n = O[t.type_id];
                        return "name" === n.display_name ? t.name : n && n.display_name ? t.properties && t.properties[n.display_name] || "" : t.name
                    },
                    nodeSecondaryDisplayName: function(e) {
                        var t = w[e];
                        if (!t) return "";
                        var n = O[t.type_id];
                        return "name" === n.secondary_display_name ? t.name : n && n.secondary_display_name && t.properties && t.properties[n.secondary_display_name] || ""
                    },
                    getFilterManager: se,
                    getAnalysisManager: ie,
                    getRenderingController: function() {
                        return ae
                    },
                    setRenderingController: function(e) {
                        ae = e
                    },
                    setOnboardModule: function(e) {
                        ce = e
                    },
                    isOnboardEnabled: function() {
                        return null !== ce
                    },
                    push: D,
                    notify: q,
                    focusNode: function(e, t) {
                        (S = Array.isArray(e) ? e : [e]).length && c.emit(t, "onNodeFocused", e)
                    },
                    focusEdge: function(e, t) {
                        Array.isArray(e) ? x = x.concat(e.map((function(e) {
                            return e.id
                        }))) : x.push(e.id), c.emit(t, "onEdgeFocused", e)
                    },
                    selectNode: function(e, t) {
                        S = Array.isArray(e) ? e : [e], C(e, t)
                    },
                    selectCluster: function(e, t) {
                        S = e.nodes, c.emit(t, "onClusterSelected", e.id, S)
                    },
                    addToSelectedNodes: function(e, t) {
                        S.indexOf(e) < 0 && (S.push(e), C(e, t))
                    },
                    selectEdge: function(e, t) {
                        x = Array.isArray(e) ? e : [e], c.emit(t, "onEdgeSelected", e)
                    },
                    addToSelectedEdges: function(e, t) {
                        Array.isArray(e) ? x = x.concat(e) : x.push(e), c.emit(t, "onEdgeSelected", e)
                    },
                    removeFromSelectedNodes: function(e, t) {
                        S.indexOf(e) >= 0 && (S.splice(S.indexOf(e), 1), c.emit(t, "onNodeUnselected", e))
                    },
                    clearSelectedNodes: function(e) {
                        S = [], x = [], c.emit(e, "onNodesReleased")
                    },
                    importNode: function(e, t, n) {
                        var r, o, a, i, s;
                        for (i in O)
                            if (Object.prototype.hasOwnProperty.call(O, i) && (i === t.id || Object.prototype.hasOwnProperty.call(O[i], "ancestor_id") && O[i].ancestor_id === t.id)) {
                                console.log("this nodetype exists"), r = !0, a = i;
                                break
                            }
                        r || function() {
                            var e = {
                                action: "nodetype_create",
                                id: Object(f.guid)()
                            };
                            for (i in t)
                                if (Object.prototype.hasOwnProperty.call(t, i)) switch (i) {
                                    case "id":
                                        e.ancestor_id = t[i];
                                        break;
                                    case "properties":
                                        e.properties = [], Array.isArray(t.properties) && t.properties.forEach((function(t) {
                                            e.properties.push(Object(f.cloneObj)(t))
                                        }));
                                        break;
                                    default:
                                        e[i] = t[i]
                                }
                            q(e), a = e.id
                        }();
                        for (var c = 0; c < _.length; c += 1)
                            if (_[c].id === e.id) {
                                console.log("this node exists"), o = !0;
                                break
                            }
                        if (!o) {
                            var l = {
                                action: "node_create",
                                id: Object(f.guid)()
                            };
                            for (i in e)
                                if (Object.prototype.hasOwnProperty.call(e, i)) switch (i) {
                                    case "id":
                                        l.ancestor_id = e[i];
                                        break;
                                    case "type_id":
                                        l.type_id = a;
                                        break;
                                    case "properties":
                                        for (s in l.properties = {}, e.properties) Object.prototype.hasOwnProperty.call(e.properties, s) && (l.properties[s] = e.properties[s]);
                                        break;
                                    case "graphs":
                                        break;
                                    default:
                                        l[i] = e[i]
                                }
                            n && (l.pos = n), q(l)
                        }
                    },
                    importExistingNode: N,
                    importHubEdge: T,
                    importHubNodesAndEdges: A,
                    clearSaveList: I,
                    requestFocus: function(e) {
                        e !== Q && (Q = e, c.emit(e, "releaseFocus"))
                    },
                    triggerSnapshot: function(e, t) {
                        v || e && a.set("isSnapshotDirty", !0), c.emit(t, "triggerSnapshot", e)
                    },
                    load: function(e, t) {
                        var n, r = t || {},
                            o = e.graph.nodeTypes,
                            i = e.graph.edgeTypes,
                            s = e.graph.nodes,
                            c = e.graph.edges;
                        if (e.graph.name && a.set("title", e.graph.name), e.graph.subtitle && a.set("subtitle", e.graph.subtitle), e.graph.description && a.set("description", e.graph.description), r.community && a.set("community", r.community), r.explore_template && a.set("exploreTemplate", r.explore_template), e.graph.image && a.set("image", e.graph.image), e.graph.license && a.set("license", e.graph.license), r.graph_users && a.set("users", r.graph_users), r.user && a.set("user", r.user), e.graph.id && a.set("id", e.graph.id), r.embed && a.set("isEmbed", r.embed), e.graph.hub && a.set("hub", e.graph.hub), e.graph.updated_at && a.set("updatedAt", Date.parse(e.graph.updated_at)), e.graph.created_at && a.set("createdAt", Date.parse(e.graph.created_at)), r.user_recommended && a.set("isUserRecommended", r.user_recommended), Object.prototype.hasOwnProperty.call(r, "rec_count") && a.set("recommendedCount", r.rec_count), e.graph.status && a.set("status", e.graph.status), r.layout && a.set("layout", r.layout), r.layout_node_fullname && a.set("layoutNodeFullname", r.layout_node_fullname), a.set("references", e.graph.references), a.set("referencesQualityScore", r.reference_quality_score), a.set("qualityScore", r.quality_score), a.update("layout", (function(e) {
                                return b(b({}, e), {}, {
                                    always_show_edge_names: r.layout_always_show_edge_names,
                                    show_edge_weights: r.layout_show_edge_weights,
                                    lock_node_positions: r.layout_lock_node_positions,
                                    hide_small_node_labels: r.layout_hide_small_node_labels,
                                    use_curved_edges: r.layout_use_curved_edges,
                                    fix_node_overlaps_on_pause: r.layout_fix_node_overlaps_on_pause,
                                    old_snapshot: r.old_snapshot
                                })
                            })), a.set("circularLayoutSettings", r.circular_layout_settings), r.filters && (a.set("filters", r.filters), Object(f.correctFilterIds)(a.get("filters"))), r.analysis_rules && a.set("analysisItems", r.analysis_rules), a.set("isWebGL", r.isWebGL), o)
                            for (n = 0; n < o.length; n += 1) o[n].action = "nodetype_create", D(o[n], !0);
                        if (i)
                            for (n = 0; n < i.length; n += 1) i[n].action = "edgetype_create", D(i[n], !0);
                        if (s)
                            for (n = 0; n < s.length; n += 1) s[n].action = "node_create", D(s[n], !0);
                        if (c)
                            for (n = 0; n < c.length; n += 1) X(c[n].from) && X(c[n].to) && (c[n].action = "edge_create", D(c[n], !0));
                        !e.graph.id && e.graph.hub && (s || c) && A(s, c), a.set("downloadID", r.download_id)
                    },
                    loadHub: function(e, t) {
                        var n, r = t || {},
                            o = e.hub.nodeTypes,
                            i = e.hub.edgeTypes,
                            s = e.hub.nodes,
                            c = e.hub.edges;
                        for (a.set("hub", {
                                id: e.hub.id,
                                name: e.hub.name
                            }), e.hub.name && a.set("title", e.hub.name), e.hub.id && a.set("id", e.hub.id), e.hub.subtitle && a.set("subtitle", e.hub.subtitle), e.hub.description && a.set("description", e.hub.description), e.hub.image && a.set("image", e.hub.image), e.hub.license && a.set("license", e.hub.license), e.hub.users && a.set("users", e.hub.users), r.user && a.set("user", r.user), e.hub.updated_at && a.set("updatedAt", Date.parse(e.hub.updated_at)), e.hub.created_at && a.set("createdAt", Date.parse(e.hub.created_at)), e.hub.status && a.set("status", e.hub.status), r.layout && a.set("layout", r.layout), r.layout_node_fullname && a.set("layoutNodeFullname", r.layout_node_fullname), a.update("layout", (function(e) {
                                return b(b({}, e), {}, {
                                    hide_small_node_labels: r.layout_hide_small_node_labels
                                })
                            })), console.log("adding " + o.length + " Vertex Orders"), n = 0; n < o.length; n += 1) o[n].action = "nodetype_create", D(o[n], !0);
                        for (console.log("adding " + i.length + " Vector Orders"), n = 0; n < i.length; n += 1) i[n].action = "edgetype_create", D(i[n], !0);
                        if (s)
                            for (console.log("adding " + s.length + " Vertexs"), n = 0; n < s.length; n += 1) s[n].action = "node_create", D(s[n], !0);
                        if (c)
                            for (console.log("adding " + c.length + " Vectors"), n = 0; n < c.length; n += 1) X(c[n].from) && X(c[n].to) && (c[n].action = "edge_create", D(c[n], !0))
                    },
                    createNode: function(e, t, n) {
                        if (e.name && e.type) {
                            var r = function(e, r) {
                                var o, a = z(e.type),
                                    i = [];
                                if (a) o = a.id;
                                else {
                                    var c = {
                                        action: "nodetype_create",
                                        id: Object(f.guid)(),
                                        name: e.type,
                                        name_alias: e.type,
                                        color: Object(f.randomColor)()
                                    };
                                    i.push(c), o = c.id
                                }
                                if (K(e.type, e.name)) Object(s.confirm)(l, "Duplicate Node", "A node already exists with that name and type. Do you want to add it anyway?", (function() {
                                    var n = {
                                        id: Object(f.guid)(),
                                        type: e.type,
                                        type_id: o,
                                        name: e.name,
                                        action: "node_create",
                                        description: "",
                                        reference: "",
                                        image: ""
                                    };
                                    t && (n.pos = t), i.push(n), q(i), r()
                                }), (function() {
                                    n(new Error("duplicate node"))
                                }));
                                else {
                                    var d = {
                                        id: Object(f.guid)(),
                                        type: e.type,
                                        type_id: o,
                                        name: e.name,
                                        action: "node_create",
                                        description: "",
                                        reference: "",
                                        image: ""
                                    };
                                    t && (d.pos = t), i.push(d), q(i), r()
                                }
                            };
                            a.get("belongsToHub") ? Object(p.searchNodes)(e.name, e.type, a.get("hub").id, (function(o) {
                                var i, s, c;
                                if (o && o.nodes && o.nodes.length > 0)
                                    for (c = o.nodes.length - 1; c >= 0; c -= 1)(s = o.nodes[c]).name === e.name && s.type === e.type && (X(s.id) || (i = s));
                                if (i) {
                                    N(o.nodes[0], t);
                                    var l = !1;
                                    a.get("belongsToHub") && 1 == a.get("status") && 2 == o.nodes[0].status && (l = !0), n(null, !0, l)
                                } else r(e, (function() {
                                    n()
                                }))
                            }), (function(e) {
                                console.log(e), n(new Error("Cannot reach the database"))
                            })) : r(e, (function() {
                                n()
                            }))
                        } else n(new Error("Name and type should be defined"))
                    },
                    createEdge: function(e, t, n, r, i, s) {
                        var c;
                        Array.isArray(t) || (t = [t]);
                        var l = function(t) {
                                var o, s = [];
                                for (o = 0; o < t.length; o += 1)
                                    if (!ge.doesEdgeExist(e, t[o], n)) {
                                        var l = {
                                            action: "edge_create",
                                            id: Object(f.guid)(),
                                            from: e,
                                            to: t[o],
                                            name: n,
                                            name_id: c,
                                            weight: r,
                                            directed: i ? 1 : 0
                                        };
                                        s.push(l), a.get("belongsToHub") && (w[e].total_edges += 1, w[t[o]].total_edges += 1)
                                    }
                                q(s)
                            },
                            d = V(n);
                        if (d) c = d.id;
                        else {
                            var u = {
                                action: "edgetype_create",
                                id: Object(f.guid)(),
                                name: n,
                                name_alias: n,
                                directed: i ? 1 : 0,
                                weighted: 1,
                                color: Object(f.randomColor)()
                            };
                            q(u), c = u.id
                        }
                        var h = !1;
                        if (a.get("belongsToHub"))
                            for (var g = o.get("historySinceLastSave"), m = 0; m < g.length; m += 1) {
                                var y = g[m];
                                if ("node_create" === y.action && y.id === e && !y.exists_in_hub) {
                                    h = !0;
                                    break
                                }
                            } else h = !0;
                        h ? (l(t), s && s.call()) : Object(p.checkEdgesForNode)(e, n, t, (function(e) {
                            var n, r, o = e.edges,
                                a = 0;
                            for (n = o.length - 1; n >= 0; n -= 1)
                                if (!$((r = o[n]).id)) {
                                    T(r), a += 1;
                                    for (var i = t.length - 1; i >= 0; i -= 1)
                                        if (t[i] === r.to) {
                                            t.splice(i, 1);
                                            break
                                        }
                                }
                            t.length > 0 && l(t), s && s.call(null, null, a)
                        }), (function(e) {
                            404 === e.status ? (l(t), s && s.call()) : (console.log(e), s && s.call(new Error("Server responded with error"), !0))
                        }))
                    },
                    handleUpdateEdge: function(e, t) {
                        var n, r = $(e.id),
                            i = function(e) {
                                var n, o, a = {
                                        id: r.id,
                                        action: "edge_delete",
                                        from: r.from,
                                        to: r.to,
                                        name: r.name,
                                        name_id: r.name_id,
                                        exists_in_hub: !1
                                    },
                                    i = {
                                        action: "edge_create"
                                    };
                                for (n in e)
                                    if (Object.prototype.hasOwnProperty.call(e, n)) switch (n) {
                                        case "fromName":
                                        case "toName":
                                        case "fromType":
                                        case "toType":
                                        case "fromTypeId":
                                        case "toTypeId":
                                            break;
                                        case "properties":
                                            for (o in e.properties = {}, e.properties) Object.prototype.hasOwnProperty.call(e.properties, o) && (i.properties[o] = e.properties[o]);
                                            break;
                                        default:
                                            i[n] = e[n]
                                    }
                                q(a), q(i), t()
                            };
                        if (a.get("belongsToHub") && !a.get("user").is_admin) {
                            var s = o.get("historySinceLastSave"),
                                c = !1;
                            for (n = s.length - 1; n >= 0; n -= 1)
                                if ("edge_create" === s[n].action && s[n].id === r.id) {
                                    c = !0;
                                    break
                                }
                            c ? i(e) : Object(p.checkEdgeOwner)(r.from, r.id, r.name, (function(n) {
                                n.is_owner ? i(e) : t(new Error("not the owner"))
                            }), (function(n) {
                                404 === n.status ? i(e) : (console.log(n), t && t.call(new Error("server error")))
                            }))
                        } else i(e)
                    },
                    updateEdge: G,
                    triggerOnboardAction: function(e, t) {
                        ce && ce.triggerAction(e, t)
                    },
                    buildDeleteSignals: function(e, t, n) {
                        var r = Object(f.shallowCopyArray)(e || []),
                            i = Object(f.shallowCopyArray)(t || []),
                            c = function(e, t) {
                                var n, r, i, s = o.get("isOnlyExploreAllowed") || a.get("belongsToHub");
                                return e > 0 && t > 0 ? s ? (n = "Remove Vertexs and Vectors", i = ["Are you sure you want to remove", Object(f.buildNumericText)(e, "node", "nodes", "{quantity} {item}"), "and", Object(f.buildNumericText)(t, "edge", "edges", "{quantity} {item}")], a.get("isHub") || i.push("from this graph"), r = i.join(" ") + "?") : (n = "Delete Vertexs and Vectors", r = ["Are you sure you want to delete", Object(f.buildNumericText)(e, "node", "nodes", "{quantity} {item}"), "and", Object(f.buildNumericText)(t, "edge", "edges", "{quantity} {item}?")].join(" ")) : e > 0 ? s ? (n = Object(f.buildNumericText)(e, "node", "nodes", "Remove {item}"), r = Object(f.buildNumericText)(e, "node", "nodes", "Are you sure you want to remove {quantity} {item}"), a.get("isHub") ? r += "?" : r += " from this graph?") : (n = Object(f.buildNumericText)(e, "node", "nodes", "Delete {item}"), r = Object(f.buildNumericText)(e, "node", "nodes", "Are you sure you want to delete {quantity} {item}?")) : s ? (n = Object(f.buildNumericText)(t, "edge", "edges", "Remove {item}"), r = Object(f.buildNumericText)(t, "edge", "edges", "Are you sure you want to remove {quantity} {item}"), a.get("isHub") ? r += "?" : r += " from this graph?") : (n = Object(f.buildNumericText)(t, "edge", "edges", "Delete {item}"), r = Object(f.buildNumericText)(t, "edge", "edges", "Are you sure you want to delete {quantity} {item}?")), a.get("belongsToHub") && !a.get("isHub") && !o.get("isOnlyExploreAllowed") && a.get("user").is_admin && (r += Object(f.buildNumericText)(t + e, "It", "They", "<br/>{item} will not be deleted from the hub.")), {
                                    title: n.toUpperCase(),
                                    message: r
                                }
                            }(r ? r.length : 0, i ? i.length : 0),
                            d = c.title,
                            u = c.message,
                            p = function(e) {
                                var t, s, c, l, d = [],
                                    u = !1;
                                a.get("belongsToHub") && !a.get("isHub") && (o.get("isOnlyExploreAllowed") || !a.get("user").is_admin || a.get("user").is_admin && e) && (u = !0);
                                var p = {};
                                for (i.forEach((function(e) {
                                        p[e] = !0
                                    })), r.forEach((function(e) {
                                        var t = w[e];
                                        t && t.edges.map((function(e) {
                                            return e.id
                                        })).forEach((function(e) {
                                            p[e] = !0
                                        }))
                                    })), i = Object.keys(p), l = 0; l < i.length; l += 1)
                                    if (s = $(i[l])) {
                                        var f = {
                                            action: "edge_delete",
                                            id: s.id,
                                            from: s.from,
                                            to: s.to,
                                            name: s.name,
                                            name_id: s.name_id
                                        };
                                        u && (f.exists_in_hub = !0), d.push(f)
                                    }
                                for (l = 0; l < r.length; l += 1)(t = w[r[l]]) && (c = {
                                    action: "node_delete",
                                    id: t.id,
                                    type_id: t.type_id
                                }, u && (c.exists_in_hub = !0), d.push(c));
                                if (!a.get("belongsToHub")) {
                                    var h = {};
                                    r.forEach((function(e) {
                                        var t = ge.getNodeById(e);
                                        t && (h[t.type_id] || (h[t.type_id] = 0), h[t.type_id] += 1)
                                    })), Object.keys(h).forEach((function(e) {
                                        ge.getNodeTypeById(e).count - h[e] <= 0 && d.push({
                                            action: "nodetype_delete",
                                            id: e
                                        })
                                    }))
                                }
                                n(void 0, d)
                            },
                            h = function() {
                                n(!0)
                            };
                        a.get("belongsToHub") && !a.get("isHub") ? Object(s.showDeleteConfirmPanel)(l, d, u, r, p, h) : Object(s.confirm)(l, d, u, p, h)
                    },
                    buildGraphModel: function() {
                        _.forEach((function(e) {
                            e.group_id = null
                        }));
                        var e = Object(f.o2a)(O);
                        a.get("belongsToHub") && (e = e.filter((function(e) {
                            return e.count > 0
                        })));
                        var t = e.map((function(e) {
                            return {
                                id: e.id,
                                name: e.name,
                                color: e.color,
                                count: e.count,
                                isMeta: !0
                            }
                        }));
                        _.forEach((function(e) {
                            e.group_id = e.type_id, e.color = O[e.type_id].color
                        }));
                        var n = {};
                        return E.forEach((function(e) {
                            var t, r, o = X(e.from).type_id,
                                a = X(e.to).type_id,
                                i = Y(e.name_id);
                            (t = i.directed ? [o, a] : [o, a].sort()).push(e.name), r = t.join("-"), n[r] ? n[r].count += 1 : n[r] = {
                                id: r,
                                name: e.name,
                                name_id: e.name_id,
                                from: o,
                                color: i.color,
                                directed: i.directed,
                                to: a,
                                weight: 1,
                                count: 1,
                                isMeta: !0
                            }
                        })), {
                            nodes: t,
                            edges: Object(f.o2a)(n)
                        }
                    },
                    buildClusterGroups: function() {
                        var e = re.getClusters();
                        _.forEach((function(e) {
                            e.group_id = null
                        }));
                        var t = e.map((function(e) {
                            return {
                                id: e.id,
                                name: e.name,
                                color: e.color,
                                count: e.nodes.length,
                                isMeta: !0
                            }
                        }));
                        e.forEach((function(e) {
                            e.nodes.forEach((function(t) {
                                w[t] && (w[t].group_id = e.id, w[t].color = e.color)
                            }))
                        }));
                        var n = {};
                        return E.forEach((function(e) {
                            var t = X(e.from).group_id,
                                r = X(e.to).group_id;
                            if (t && r) {
                                var o, a, i = Y(e.name_id);
                                (o = i.directed ? [t, r] : [t, r].sort()).push(e.name), a = o.join("-"), n[a] ? n[a].count += 1 : n[a] = {
                                    id: a,
                                    name: e.name,
                                    name_id: e.name_id,
                                    from: t,
                                    color: i.color,
                                    directed: i.directed,
                                    to: r,
                                    weight: 1,
                                    count: 1,
                                    isMeta: !0
                                }
                            }
                        })), {
                            nodes: t,
                            edges: Object(f.o2a)(n)
                        }
                    },
                    buildNodeTypePropertyGroups: function(e) {
                        _.forEach((function(e) {
                            e.group_id = null
                        }));
                        var t = {},
                            n = [];
                        e.forEach((function(e) {
                            var r = ge.getNodesByTypeId(e.id);
                            if (e.prop) r.forEach((function(r) {
                                if (r.properties && r.properties[e.prop]) {
                                    var o = r.properties[e.prop].trim(),
                                        a = t[o];
                                    a && a.type_id === r.type_id || (t[o] = {
                                        id: Object(f.guid)(),
                                        name: o,
                                        color: W(r.type_id).color,
                                        count: 0,
                                        isMeta: !0,
                                        type_id: r.type_id
                                    }, a = t[o], n.push(a)), r.group_id = a.id, a.count += 1
                                } else n.push(r)
                            }));
                            else {
                                var o = t[e.id];
                                if (!o) {
                                    var a = W(e.id);
                                    o = {
                                        id: a.id,
                                        name: a.name,
                                        color: a.color,
                                        count: a.count,
                                        isMeta: !0
                                    }, t[e.id] = o, n.push(o)
                                }
                                r.forEach((function(e) {
                                    e.group_id = o.id
                                }))
                            }
                        }));
                        var r = {};
                        return E.forEach((function(e) {
                            var t = X(e.from).group_id,
                                n = X(e.to).group_id;
                            if (t || n) {
                                var o, a;
                                t || (t = e.from), n || (n = e.to);
                                var i = Y(e.name_id);
                                (o = i.directed ? [t, n] : [t, n].sort()).push(e.name), a = o.join("-"), r[a] ? r[a].count += 1 : r[a] = {
                                    id: a,
                                    name: e.name,
                                    name_id: e.name_id,
                                    from: t,
                                    color: i.color,
                                    directed: i.directed,
                                    to: n,
                                    weight: 1,
                                    count: 1,
                                    isMeta: !0
                                }
                            } else r[e.id] = e
                        })), {
                            nodes: n,
                            edges: Object(f.o2a)(r)
                        }
                    },
                    setCanvasAnimation: function(e, t) {
                        e && a.set("isSnapshotDirty", !1), c.emit(t, "onCanvasPauseStateChanged", e)
                    },
                    clearGraph: de,
                    undoHistorySinceLastSave: function() {
                        a.get("downloadID") ? Object(s.showWaitMessage)(l, "Please wait...", "", (function(e) {
                            var t = function(t) {
                                    de();
                                    var n = t.graph.nodeTypes,
                                        r = t.graph.edgeTypes,
                                        a = t.graph.nodes,
                                        i = t.graph.edges;
                                    if (n)
                                        for (var s = 0; s < n.length; s += 1) n[s].action = "nodetype_create", D(n[s], !1);
                                    if (r)
                                        for (var l = 0; l < r.length; l += 1) r[l].action = "edgetype_create", D(r[l], !1);
                                    if (a)
                                        for (var d = 0; d < a.length; d += 1) a[d].action = "node_create", D(a[d], !1);
                                    if (i)
                                        for (var u = 0; u < i.length; u += 1) X(i[u].from) && X(i[u].to) && (i[u].action = "edge_create", D(i[u], !1));
                                    c.emit("refreshGraph"), c.emit("updateEditMode", o.get("isOnlyExploreAllowed") ? m.a.EXPLORE : m.a.EDIT), e()
                                },
                                n = function() {
                                    Object(s.displayMessage)(l, "Error", "Failed to revert changes"), e()
                                };
                            Object(p.getGraph)(a.get("downloadID"), null, t, n)
                        })) : (de(!0), c.emit("updateEditMode", o.get("isExploreAllowed") ? m.a.EXPLORE : m.a.EDIT))
                    },
                    saveGraph: function(e) {
                        c.emit("onGraphSaveStarted");
                        var t = me.getUnsavedBatches(d);
                        me.markBatchesToBeSaved(t);
                        var n = me.getTrimmedSignals(t);
                        e.graph.history = n, Object(p.saveGraph)(a.get("id"), e, (function() {
                            e.graph.history && (me.markBatchesAfterSaveCompleted(t), a.get("isHubGraph") && le());
                            var n = Object.prototype.hasOwnProperty.call(e.graph, "positions");
                            c.emit("onGraphSaved", null, n), a.set("isDirty", !1), a.set("isSnapshotDirty", !1)
                        }), (function(e) {
                            me.markBatchesAfterSaveFailed(t), 402 === e.status ? c.emit("onPaymentRequired", null, e.responseJSON) : c.emit("onGraphSaveFailed")
                        }))
                    },
                    saveNewGraph: function(e, t) {
                        c.emit("onGraphSaveStarted"), e.graph.history = me.getTrimmedSignals(d), Object(p.saveNewGraph)(e, (function(e) {
                            c.emit("onGraphCreated", null, e.id, t)
                        }), (function(e) {
                            402 === e.status ? c.emit("onPaymentRequired", null, e.responseJSON) : c.emit("onGraphSaveFailed")
                        }))
                    },
                    saveHub: function() {
                        c.emit("onGraphSaveStarted");
                        var e = me.getUnsavedBatches(d);
                        me.markBatchesToBeSaved(e);
                        var t = me.getTrimmedSignals(e),
                            n = {
                                hub: {
                                    id: a.get("hub").id,
                                    history: t
                                }
                            };
                        Object(p.saveHub)(n.hub.id, n, (function() {
                            n.hub.history && me.markBatchesAfterSaveCompleted(e), c.emit("onGraphSaved", null)
                        }), (function(t) {
                            me.markBatchesAfterSaveFailed(e), 402 === t.status ? c.emit("onPaymentRequired", null, t.responseJSON) : c.emit("onGraphSaveFailed")
                        }))
                    },
                    saveNewCommunityGraph: function(e, t) {
                        c.emit("onGraphSaveStarted"), e.hub.history = [], ge.getNodes().forEach((function(t) {
                            e.hub.history.push({
                                action: "node_create",
                                id: t.id,
                                name: t.name,
                                type: t.type,
                                type_id: t.type_id,
                                exists_in_hub: !0
                            })
                        })), ge.getLinks().forEach((function(t) {
                            e.hub.history.push({
                                action: "edge_create",
                                id: t.id,
                                from: t.from,
                                to: t.to,
                                name: t.name,
                                name_id: t.name_id,
                                exists_in_hub: !0
                            })
                        }));
                        Object(p.createHubGraph)(a.get("hub").id, e, (function(e) {
                            c.emit("onGraphCreated", null, e.id, t)
                        }), (function(e) {
                            402 === e.status ? c.emit("onPaymentRequired", null, e.responseJSON) : c.emit("onGraphSaveFailed")
                        }))
                    },
                    signIn: function(e) {
                        Object(p.signIn)(e.email, e.password, e.hub_id, (function(t) {
                            he(t, e.onSuccess)
                        }), (function(t) {
                            "function" === typeof e.onFail && e.onFail(t)
                        }))
                    },
                    signUp: function(e) {
                        Object(p.signUp)(e.username, e.email, e.password, e.passwordConfirm, (function(t) {
                            he(t, e.onSuccess)
                        }), (function(t) {
                            "function" === typeof e.onFail && e.onFail(t)
                        }))
                    },
                    undo: function() {
                        if (y.length > 0) {
                            var e = y.pop(),
                                t = e._undo;
                            d.push(t), t.signals.forEach((function(e) {
                                R(e), c.emit("trigger", e)
                            })), ne(t), c.emit("onUndo", e, y.length)
                        } else console.log("WARNING: Nothing to undo.")
                    },
                    handleNodeTypeRename: function(e, t) {
                        var n, r, o, i, c = W(e),
                            d = z(t);
                        d ? a.get("isHubGraph") ? Object(s.displayMessage)(l, "Node type already exists", "There is already a nodetype named " + t + ".") : (r = d, o = (n = c).count, i = [r.name + " node type already exists.", o > 0 ? "The existing nodes of " + n.name + " will be transferred to this node type." : "", n.name + " will be deleted."].join(" "), Object(s.confirm)(l, "Renaming to an existing node type", i, (function() {
                            var e = [];
                            ge.getNodesByTypeId(n.id).forEach((function(t) {
                                e.push({
                                    action: "node_update",
                                    id: t.id,
                                    type: r.name,
                                    type_id: r.id,
                                    prev: {
                                        type_id: n.id,
                                        type: n.name
                                    }
                                })
                            })), e.push({
                                action: "nodetype_delete",
                                id: n.id
                            }), ge.notify(e)
                        }), (function() {}))) : function(e, t) {
                            var n = ["The types of " + e.count + " existing nodes of " + e.name + " will be updated.", "Are you sure?"].join(" ");
                            Object(s.confirm)(l, "Confirm node type rename", n, (function() {
                                ge.notify({
                                    action: "nodetype_update",
                                    id: e.id,
                                    name: t,
                                    prev: {
                                        name: e.name
                                    }
                                })
                            }), (function() {}))
                        }(c, t)
                    },
                    handleEdgeTypeRename: function(e, t) {
                        var n, r, o, i, c = Y(e),
                            d = V(t);
                        d ? a.get("isHubGraph") ? Object(s.displayMessage)(l, "Vector Order already exists", "There is already an Vector Order named " + t + ".") : (r = d, o = (n = c).count, i = [r.name + " Vector Order already exists.", o > 0 ? "The existing Vectors of " + n.name + " will be transferred to this Vector Order." : "", n.name + " will be deleted."].join(" "), Object(s.confirm)(l, "Renaming to an existing Vector Order", i, (function() {
                            var e = [];
                            J(n.id).forEach((function(t) {
                                e.push({
                                    action: "edge_update",
                                    id: t.id,
                                    from: t.from,
                                    to: t.to,
                                    name: r.name,
                                    prev: {
                                        name: t.name
                                    }
                                })
                            })), e.push({
                                action: "edgetype_delete",
                                id: n.id
                            }), ge.notify(e)
                        }), (function() {}))) : function(e, t) {
                            var n = ["The types of " + e.count + " existing Vectors of " + e.name + " will be updated.", "Are you sure?"].join(" ");
                            Object(s.confirm)(l, "Confirm Vector Order rename", n, (function() {
                                ge.notify({
                                    action: "edgetype_update",
                                    id: e.id,
                                    name: t,
                                    prev: {
                                        name: e.name
                                    }
                                })
                            }), (function() {}))
                        }(c, t)
                    },
                    storeGraphInStorage: function(e) {
                        var t = {};
                        t.nodeTypes = ee(), t.edgeTypes = te(), t.nodes = _.map((function(e) {
                            return Object(f.cloneObj)(e, ["edges"])
                        })), t.edges = E, t.hub = a.get("hub"), Object(f.storeInLocalStorage)(e, JSON.stringify({
                            graph: t
                        }))
                    }
                };
                l = b(b({}, e), {}, {
                    GraphHistory: ge
                });
                var me = g(l);
                return ge
            }
        },
        7: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "advancedExplorePanel", (function() {
                return h
            })), n.d(t, "analysisCompositionPanel", (function() {
                return w
            })), n.d(t, "authenticationPanel", (function() {
                return j
            })), n.d(t, "buildExpandedNodeCard", (function() {
                return A
            })), n.d(t, "circularLayoutSettingsPanel", (function() {
                return I
            })), n.d(t, "commentWithImagePanel", (function() {
                return R
            })), n.d(t, "confirm", (function() {
                return C
            })), n.d(t, "copyToClipboardDialog", (function() {
                return B
            })), n.d(t, "creditCardPanel", (function() {
                return W
            })), n.d(t, "datatablePreviewPanel", (function() {
                return Y
            })), n.d(t, "displayMessage", (function() {
                return l
            })), n.d(t, "editGraphPanel", (function() {
                return V
            })), n.d(t, "editNodePanel", (function() {
                return N
            })), n.d(t, "embedDialog", (function() {
                return X
            })), n.d(t, "expandedNodeCard", (function() {
                return P
            })), n.d(t, "expandedRangeFilter", (function() {
                return K
            })), n.d(t, "exploreFindNodesPanel", (function() {
                return Q
            })), n.d(t, "exploreFindPathsPanel", (function() {
                return re
            })), n.d(t, "exportDialogue", (function() {
                return oe
            })), n.d(t, "filterCompositionPanel", (function() {
                return ce
            })), n.d(t, "forceAtlas2Settings", (function() {
                return le
            })), n.d(t, "forceDirectedSettings", (function() {
                return de
            })), n.d(t, "getClusteringResolution", (function() {
                return ue
            })), n.d(t, "helpPanel", (function() {
                return pe
            })), n.d(t, "hubGraphCreateDialog", (function() {
                return fe
            })), n.d(t, "hubPanel", (function() {
                return he
            })), n.d(t, "imgPanel", (function() {
                return S
            })), n.d(t, "initializeWithExpandedRangeFilter", (function() {
                return ge
            })), n.d(t, "loaderPulsingCircle", (function() {
                return ve
            })), n.d(t, "loaderThreePoints", (function() {
                return _e
            })), n.d(t, "loaderView", (function() {
                return be
            })), n.d(t, "newEdge", (function() {
                return je
            })), n.d(t, "newEdgeType", (function() {
                return Se
            })), n.d(t, "newGraphSaveDialog", (function() {
                return ke
            })), n.d(t, "newNode", (function() {
                return Le
            })), n.d(t, "newNodeType", (function() {
                return Pe
            })), n.d(t, "nodeEmbedPanel", (function() {
                return L
            })), n.d(t, "onboardWelcomePanel", (function() {
                return Ae
            })), n.d(t, "propertyFilterDialog", (function() {
                return Me
            })), n.d(t, "recommendDialog", (function() {
                return qe
            })), n.d(t, "shareableLink", (function() {
                return Ie
            })), n.d(t, "showAnalysisChart", (function() {
                return ze
            })), n.d(t, "showCartographyPanel", (function() {
                return We
            })), n.d(t, "showCollaboratorsPanel", (function() {
                return Ke
            })), n.d(t, "showContributorsPanel", (function() {
                return $e
            })), n.d(t, "showDeleteConfirmPanel", (function() {
                return Ze
            })), n.d(t, "showGraphMergePanel", (function() {
                return dt
            })), n.d(t, "showGraphQualityPanel", (function() {
                return ut
            })), n.d(t, "showGraphReferencePanel", (function() {
                return pt
            })), n.d(t, "showGraphStatus", (function() {
                return ft
            })), n.d(t, "showHubDataPrivacyDialog", (function() {
                return ht
            })), n.d(t, "showHubMembersPanel", (function() {
                return vt
            })), n.d(t, "showHubTaxonomyPanel", (function() {
                return St
            })), n.d(t, "showImportPanel", (function() {
                return Bt
            })), n.d(t, "showLicensingPanel", (function() {
                return Ft
            })), n.d(t, "showMergePanel", (function() {
                return It
            })), n.d(t, "showNameColorDialog", (function() {
                return Gt
            })), n.d(t, "showNodeUrl", (function() {
                return Ht
            })), n.d(t, "showPlanUpgrade", (function() {
                return Rt
            })), n.d(t, "showRedirectWarning", (function() {
                return Ut
            })), n.d(t, "showRequestInvite", (function() {
                return zt
            })), n.d(t, "showSaveExplorePanel", (function() {
                return Wt
            })), n.d(t, "showSiteAboutPanel", (function() {
                return Yt
            })), n.d(t, "showSocialAuthentication", (function() {
                return Vt
            })), n.d(t, "showStoryQualityPanel", (function() {
                return Xt
            })), n.d(t, "showStorySharePanel", (function() {
                return Kt
            })), n.d(t, "showUserPanel", (function() {
                return $t
            })), n.d(t, "showWaitMessage", (function() {
                return z
            })), n.d(t, "signinPartialHelper", (function() {
                return O
            })), n.d(t, "signupPartialHelper", (function() {
                return E
            })), n.d(t, "singleTextEntry", (function() {
                return Zt
            })), n.d(t, "startGraphDialogView", (function() {
                return Jt
            })), n.d(t, "startStoryDialog", (function() {
                return en
            })), n.d(t, "startStoryDialogView", (function() {
                return Qt
            })), n.d(t, "submitEmailDialog", (function() {
                return tn
            })), n.d(t, "textFieldEntry", (function() {
                return nn
            }));
            var r = n(4),
                o = n(12),
                a = n.n(o),
                i = n(5),
                s = n(0),
                c = n(3),
                l = function(e, t, n, r, o, a) {
                    var i = {
                            title: t,
                            message: n,
                            close_text: o || "OK"
                        },
                        l = c.a["site/message_dialogue"](i);
                    document.body.appendChild(l.trim().toDOM());
                    var d = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                r && r.call()
                            },
                            disableCancel: a
                        }, e || {}),
                        u = document.body.lastElementChild.querySelector(".gc-dlg-action").querySelector(".gc-dlg-cancel");
                    d.closeButton(u)
                },
                d = n(2);

            function u(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function p(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? u(Object(n), !0).forEach((function(t) {
                        f(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : u(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function f(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var h = function(e, t, n, o) {
                    var u, f, h = e.uiStore,
                        g = e.graphStore,
                        m = e.GraphHistory,
                        y = (t = t || {}).fnLoadData,
                        b = t.onSubmit,
                        v = function() {
                            P.number_only = !1;
                            var e = Array.from(L.querySelectorAll('div.newedge-body-item input[type="checkbox"]'));
                            if (e.find((function(e) {
                                    return !e.checked
                                }))) {
                                var n = e.filter((function(e) {
                                    return e.checked
                                })).map((function(e) {
                                    return {
                                        name: e.getAttribute("data-name"),
                                        src: e.getAttribute("data-src"),
                                        trg: e.getAttribute("data-trg")
                                    }
                                }));
                                P.requested_relation_type = n.map((function(e) {
                                    return e.name
                                })), P.requested_relation_source = n.map((function(e) {
                                    return e.src
                                })), P.requested_relation_target = n.map((function(e) {
                                    return e.trg
                                }))
                            } else P.requested_edgetypes = [], P.requested_relation_source = [], P.requested_relation_target = [];
                            var r, a = L.querySelector("input#cbOnlyNodesWithEdges");
                            if (P.only_nodes_with_edges = a && a.checked, P.with_links && (P.existing_nodes = m.getNodes().map((function(e) {
                                    return e.id
                                })).join(",")), u || f) {
                                var c = ["Getting"];
                                u && c.push(Object(s.k)(u, "Node", "Nodes")), f && (2 == c.length && c.push("and"), c.push(Object(s.k)(f, "Edge", "Edges"))), r = c.join(" "), u + f > 100 && (r += " This might take a while...")
                            } else r = "Getting Vertexs and Vectors";
                            t.showWaitMessage("Please wait... ".concat(r)), Object(i.queryAdvancedExplore)(g.get("hub").id, P, (function(e) {
                                ! function(e, t) {
                                    if (h.set("isImportingBatch", !0), Array.isArray(e)) {
                                        var n = Math.min(10 * e.length, 300);
                                        e.forEach((function(e) {
                                            var t = Number(Math.random() * (2 * n)) - n,
                                                r = Number(Math.random() * (2 * n)) - n;
                                            m.importExistingNode(e, {
                                                x: o.x + t,
                                                y: o.y + r
                                            })
                                        }))
                                    }
                                    Array.isArray(t) && t.forEach((function(e) {
                                        m.importHubEdge(e)
                                    }));
                                    h.set("isImportingBatch", !1)
                                }(e.nodes, e.edges), t.hideWaitMessage(), "function" === typeof b && b()
                            }), (function(e) {
                                console.error(e), t.hideWaitMessage(), "function" === typeof b && b()
                            }))
                        };
                    var _ = function(e, t) {
                            var n = e.data("ttTypeahead");
                            n && n._onQueryChanged(null, t)
                        },
                        w = function() {
                            for (; I.firstChild;) I.removeChild(I.firstChild);
                            R.disabled = !0, Object(s.h)(q, "hidden"), C ? (C.typeahead("destroy"), Object(s.nb)(M, "dropdown"), C = null) : (M.removeEventListener("blur", N), M.removeEventListener("keyup", T)), Object(s.h)(M, "hidden"), Object(s.h)(D, "hidden"), x.typeahead("val", ""), S.focus()
                        },
                        O = function(e, t) {
                            for (; I.firstChild;) I.removeChild(I.firstChild);
                            t.is_nt ? function(e, t) {
                                var n = {
                                        name: "All Node Types" == t.type_name ? "Node Types" : t.type_name,
                                        color: t.type_color,
                                        count: "...",
                                        property: t.property,
                                        comparison: t.comparison,
                                        first_value: t.first_value,
                                        second_value: t.second_value
                                    },
                                    r = c.a["graphs/advanced_explore_nodetype_selection"](n);
                                I.appendChild(r.trim().toDOM()), I.querySelector("button.remove-selection").addEventListener("click", (function() {
                                    w()
                                })), t.with_links = !0
                            }(0, t) : function(e, t) {
                                var n = {
                                        name: "All Vector Orders" == t.type_name ? "Edge Types" : t.type_name,
                                        color: t.type_color,
                                        count: "...",
                                        property: t.property,
                                        comparison: t.comparison,
                                        first_value: t.first_value,
                                        second_value: t.second_value
                                    },
                                    r = c.a["graphs/advanced_explore_edgetype_selection"](n);
                                I.appendChild(r.trim().toDOM()), I.querySelector("button.remove-selection").addEventListener("click", (function() {
                                    w()
                                })), t.with_links = !1
                            }(0, t), u = null, f = null, t.number_only = !0, t.existing_nodes = m.getNodes().map((function(e) {
                                return e.id
                            })).join(","), Object(i.queryAdvancedExplore)(g.get("hub").id, t, (function(n) {
                                if (L.querySelector('div[data-name="selection-row"]')) {
                                    L.querySelector("span.result-count").innerHTML = t.is_nt ? n.total_nodes : n.total_edges, u = n.total_nodes, f = n.total_edges;
                                    var r = L.querySelector("div.selection-holder"),
                                        o = r.querySelector("div.selection-details");
                                    if (o && r.removeChild(o), n.edges && n.edges.length > 0) {
                                        n.edges.forEach((function(t) {
                                            var n = e.edgeTypes.find((function(e) {
                                                return e.name === t.name
                                            }));
                                            n && (t.color = n.color), t.src_initial = t.src_count, t.trg_initial = t.trg_count;
                                            var r = e.nodeTypes.find((function(e) {
                                                return e.name === t.src_type
                                            }));
                                            r && (t.src_color = r.color);
                                            var o = e.nodeTypes.find((function(e) {
                                                return e.name === t.trg_type
                                            }));
                                            o && (t.trg_color = o.color)
                                        })), n.edges = n.edges.sort((function(e, t) {
                                            return t.count - e.count
                                        }));
                                        var a = n.edges.length >= 5,
                                            i = c.a["graphs/advanced_explore_nodetype_selection_detail"]({
                                                edges: n.edges,
                                                show_toggles: a,
                                                is_nt: t.is_nt
                                            });
                                        if (r.appendChild(i.trim().toDOM()), Array.from(r.querySelectorAll("div.newedge-body-item")).forEach((function(e) {
                                                var t = e.querySelector('input[type="checkbox"]');
                                                e.addEventListener("click", (function() {
                                                    t.checked = !t.checked
                                                })), t.addEventListener("click", (function(e) {
                                                    return e.stopPropagation(), !1
                                                }))
                                            })), a) {
                                            var l = r.querySelector("button.toggle-all");
                                            l && l.addEventListener("click", (function() {
                                                Array.from(r.querySelectorAll('div.gc-edge-check input[type="checkbox"]')).forEach((function(e) {
                                                    e.checked = !0
                                                }))
                                            }));
                                            var d = r.querySelector("button.toggle-none");
                                            d && d.addEventListener("click", (function() {
                                                Array.from(r.querySelectorAll('div.gc-edge-check input[type="checkbox"]')).forEach((function(e) {
                                                    e.checked = !1
                                                }))
                                            }))
                                        }
                                    }
                                    var p = L.querySelector(".loading");
                                    Object(s.h)(p, "not-shown")
                                }
                            })), R.disabled = !1, R.focus()
                        },
                        E = function(e) {
                            Array.isArray(e.nodeTypes) && (e.nodeTypes = e.nodeTypes.sort((function(e, t) {
                                return e.name < t.name ? -1 : e.name > t.name ? 1 : 0
                            })), e.total_nodes = e.nodeTypes.reduce((function(e, t) {
                                return e + t.count
                            }), 0)), Array.isArray(e.edgeTypes) && (e.edgeTypes = e.edgeTypes.sort((function(e, t) {
                                return e.name < t.name ? -1 : e.name > t.name ? 1 : 0
                            })), e.total_edges = e.edgeTypes.reduce((function(e, t) {
                                return e + t.count
                            }), 0));
                            var t, n, o, i = Object(d.ExplorePanelDataHelper)(e),
                                l = Object(s.v)(e.nodeTypes, e.edgeTypes);
                            T = function(t) {
                                if (13 === t.keyCode)
                                    if ("BETWEEN" === P.comparison) q.focus();
                                    else {
                                        if ("" === M.value.trim()) return;
                                        P.first_value = M.value, O(e, P)
                                    }
                            }, N = function() {
                                "" !== M.value.trim() && (P.first_value = M.value, "BETWEEN" !== P.comparison && (P.first_value = M.value, O(e, P)))
                            };
                            var u = function() {
                                    "" !== q.value.trim() && "" !== M.value.trim() && (P.second_value = q.value, O(e, P))
                                },
                                f = function(t) {
                                    if (13 === t.keyCode) {
                                        if ("" === q.value.trim() || "" === M.value.trim()) return;
                                        P.second_value = q.value, O(e, P)
                                    }
                                },
                                h = function() {
                                    C.typeahead("val", ""), _(C, "")
                                },
                                g = function(t, n) {
                                    P.first_value = n.name, O(e, P)
                                },
                                m = function() {
                                    C && (C.off("focus", h), C.off("typeahead:selected", g), C.typeahead("destroy"), C = null)
                                };
                            (S = Object(r.a)("input#type-selector").typeahead(p(p({}, s.b), {}, {
                                autoselect: !0
                            }), p(p({}, s.c), {}, {
                                name: "types",
                                displayKey: "name",
                                source: function(e, t) {
                                    var n = new RegExp(e, "i");
                                    t(l.filter((function(e) {
                                        return n.test(e.name)
                                    })))
                                },
                                templates: {
                                    suggestion: c.a["graphs/node_edge_type_typeahead_suggestion"]
                                }
                            }))).on("focus", (function() {
                                S.typeahead("val", ""), _(S, ""), C ? C.typeahead("val", "") : M.value = "", q.value = "", P.comparison = "", P.first_value = "", P.second_value = ""
                            })), S.on("typeahead:selected", (function(n, r) {
                                Object(s.h)(D, "hidden"), Object(s.h)(M, "hidden"), Object(s.h)(q, "hidden"), Object(s.nb)(A, "hidden"), a.a.remove(M), a.a.remove(q), M.placeholder = "", q.placeholder = "", M.value = "", q.value = "", P.property = "", P.comparison = "", P.first_value = "", P.second_value = "", P = function(e, t) {
                                    var n = t.is_nt ? e.nodeTypes : e.edgeTypes,
                                        r = {};
                                    if (r.is_nt = t.is_nt, "All Node Types" === t.name || "All Vector Orders" === t.name) r.type_id = "All", r.type_name = t.name, r.type_color = "#333333";
                                    else {
                                        var o = n.find((function(e) {
                                            return e.name === t.name
                                        }));
                                        r.type_id = o.id, r.type_name = o.name, r.type_color = o.color
                                    }
                                    return r
                                }(e, r), 1 === (t = i.setPropertyInputOptions(r)).length ? (P.property = "All", x.typeahead("val", "All"), O(e, P)) : x.focus()
                            })), S.on("blur", (function() {
                                "" == S.typeahead("val") && S.typeahead("val", P.type_name)
                            })), (x = Object(r.a)(A).typeahead(p(p({}, s.b), {}, {
                                autoselect: !0
                            }), p(p({}, s.c), {}, {
                                name: "properties",
                                displayKey: "name",
                                source: function(e, n) {
                                    var r = [],
                                        o = new RegExp(e, "i");
                                    t && (r = t.filter((function(e) {
                                        return o.test(e)
                                    })).map((function(e) {
                                        return {
                                            name: e
                                        }
                                    }))), n(r)
                                }
                            }))).on("focus", (function() {
                                x.typeahead("val", ""), _(x, "")
                            })), x.on("typeahead:selected", (function(t, c) {
                                if ("All" == c.name) return P.property = "All", x.typeahead("val", "All"), Object(s.h)(D, "hidden"), Object(s.h)(M, "hidden"), Object(s.h)(q, "hidden"), M.value = "", q.value = "", P.first_value = "", P.second_value = "", P.comparison = "", void O(e, P);
                                P.comparison = null, P.property = c.name, M.disabled = !1, Object(s.nb)(D, "hidden"), Object(s.h)(q, "hidden"), M.value = "", q.value = "", P.comparison = "", P.first_value = "", P.second_value = "", i.isSelectedPropertyNominal(P, c) ? (P.comparison = "IS", k.typeahead("val", "IS"), n = ["IS"], o = i.setValueInputOptions(P, c), a.a.remove(M), a.a.remove(q), M.placeholder = "", q.placeholder = "", Object(s.nb)(M, "hidden"), C || (m(), (C = Object(r.a)(M).typeahead(p(p({}, s.b), {}, {
                                    autoselect: !0
                                }), p(p({}, s.c), {}, {
                                    name: "properties",
                                    displayKey: "name",
                                    source: function(e, t) {
                                        var n = new RegExp(e, "i");
                                        t(o.filter((function(e) {
                                            return n.test(e)
                                        })).map((function(e) {
                                            return {
                                                name: e
                                            }
                                        })))
                                    }
                                }))).on("focus", h), C.on("typeahead:selected", g)), C.focus()) : (Object(s.h)(M, "hidden"), n = ["IS", "GREATER", "SMALLER", "BETWEEN"], k.focus(), m(), M.addEventListener("blur", N), M.addEventListener("keyup", T))
                            })), x.on("blur", (function() {
                                "" == x.typeahead("val") && x.typeahead("val", P.property)
                            })), (k = Object(r.a)(D).typeahead(p(p({}, s.b), {}, {
                                autoselect: !0
                            }), p(p({}, s.c), {}, {
                                name: "comparison",
                                displayKey: "name",
                                source: function(e, t) {
                                    var r = new RegExp(e, "i");
                                    t(n.filter((function(e) {
                                        return r.test(e)
                                    })).map((function(e) {
                                        return {
                                            name: e
                                        }
                                    })))
                                }
                            }))).on("focus", (function() {
                                k.typeahead("val", ""), _(k, ""), C ? C.typeahead("val", "") : M.value = "", q.value = "", P.comparison = "", P.first_value = "", P.second_value = ""
                            })), k.on("typeahead:selected", (function(e, t) {
                                P.comparison = t.name, C ? C.focus() : (Object(s.nb)(M, "hidden"), M.focus()), "BETWEEN" === P.comparison ? (Object(s.nb)(q, "hidden"), q.disabled = !1, q.addEventListener("blur", u), q.addEventListener("keyup", f)) : (Object(s.h)(q, "hidden"), q.value = "", q.disabled = !0, q.removeEventListener("blur", u), q.removeEventListener("keyup", f))
                            })), S.focus()
                        },
                        j = c.a["graphs/advanced_explore_panel"]({});
                    n.appendChild(j.trim().toDOM());
                    var S, x, k, C, N, T, L = n,
                        P = {},
                        A = L.querySelector("input#property-selector"),
                        D = L.querySelector("input#comparison-selector"),
                        M = document.querySelector("input#first-value-selector"),
                        q = document.querySelector("input#second-value-selector"),
                        I = L.querySelector("div.selection-holder"),
                        R = L.querySelector("button.gc-dlg-submit");
                    R.addEventListener("click", (function() {
                        v()
                    })), L.querySelector(".gc-dlg-cancel").addEventListener("click", (function() {
                        t.onCancel()
                    })), y && y(e, (function(e) {
                        E(e)
                    }), (function(t) {
                        l(e, "Error", t)
                    }))
                },
                g = n(71);

            function m(e) {
                return function(e) {
                    if (Array.isArray(e)) return y(e)
                }(e) || function(e) {
                    if ("undefined" !== typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                }(e) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return y(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return y(e, t)
                }(e) || function() {
                    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function y(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }

            function b(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function v(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? b(Object(n), !0).forEach((function(t) {
                        _(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : b(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function _(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var w = function(e, t, n) {
                    var o = e.graphStore,
                        a = e.GraphHistory,
                        i = "Degree Centrality",
                        l = "Betweenness Centrality",
                        d = function(e, t) {
                            var n = e.data("ttTypeahead");
                            n && n._onQueryChanged(null, t)
                        },
                        u = function(e) {
                            var t = {},
                                n = !1;
                            if ("nt" === e.type)
                                if ("All" === e.id) {
                                    var r = S.allnodes;
                                    t.type = "All Node Types", t.count = Object(s.k)(w.length, "Type", "Types", "{quantity} Node {item}"), t.prop = e.analysis, e.analysis === i ? t.range = r.degree.msg : e.analysis === l && (t.range = r.betweenness.msg), t.allTypes = !0
                                } else {
                                    var o = S[e.id];
                                    t.type = o.name, t.count = Object(s.k)(o.count, "Node", "Nodes", "{quantity} {item}"), t.prop = e.analysis, e.analysis === i ? t.range = o.degree.msg : e.analysis === l && (t.range = o.betweenness.msg)
                                }
                            else if ("nt_prop" === e.type) {
                                var a = S[e.id];
                                ! function(e, t) {
                                    if (!e) return !1;
                                    var n = !1;
                                    switch (t.type) {
                                        case "nt":
                                        case "et":
                                            "All" === t.id && (n = !0);
                                            break;
                                        case "nt_centrality":
                                            "degree" !== t.centrality && "betweenness" !== t.centrality || (n = !0);
                                            break;
                                        case "et_weight":
                                            e.isNodeType || (n = !0);
                                            break;
                                        case "nt_prop":
                                        case "et_prop":
                                            Object.prototype.hasOwnProperty.call(e.properties, t.prop) && (n = !0)
                                    }
                                    return n
                                }(a, e) ? n = !0: (t.type = a.name, t.color = a.color, t.count = Object(s.k)(a.count, "Node", "Nodes", "{quantity} {item}"), t.range = a.properties[e.prop].msg, t.prop = e.prop)
                            }
                            if (!n) {
                                var d = c.a["graphs/analysis_composition_list_li"](t).trim().toDOM();
                                L.appendChild(d);
                                var u = L.lastElementChild;
                                u.querySelector("button").addEventListener("click", (function() {
                                    ! function(e) {
                                        var t, n = L.querySelectorAll("li");
                                        for (t = 0; t < n.length && n[t] !== e; t += 1);
                                        L.removeChild(e), x.splice(t, 1)
                                    }(u)
                                }))
                            }
                        },
                        p = function() {
                            var e, t = E.typeahead("val").trim(),
                                n = j.typeahead("val").trim(),
                                r = {};
                            if ("All Node Types" === t) r = {
                                type: "nt",
                                id: "All",
                                analysis: n
                            };
                            else switch (e = function(e) {
                                var t;
                                for (t = w.length - 1; t >= 0; t -= 1)
                                    if (w[t].name === e.trim()) return w[t].id;
                                for (t = O.length - 1; t >= 0; t -= 1)
                                    if (O[t].name === e.trim()) return O[t].id
                            }(t), n) {
                                case i:
                                case l:
                                    r = {
                                        type: "nt",
                                        id: e,
                                        analysis: n
                                    };
                                    break;
                                default:
                                    r = {
                                        type: "nt_prop",
                                        id: e,
                                        prop: n
                                    }
                            }(function(e) {
                                var t, n;
                                for (t = x.length - 1; t >= 0; t -= 1)
                                    if ((n = x[t]).type === e.type && n.id === e.id && (Object.prototype.hasOwnProperty.call(e, "analysis") && n.analysis === e.analysis || Object.prototype.hasOwnProperty.call(e, "prop") && n.prop === e.prop)) return !0;
                                return !1
                            })(r) || (u(r), x.push(r), E.typeahead("val", ""), j.typeahead("val", ""), j.prop("placeholder", "PROPERTIES"))
                        },
                        f = function(e, t) {
                            j.typeahead("val", ""), j.attr("placeholder", e), j.prop("disabled", t)
                        },
                        h = function() {
                            var e = E.typeahead("val").trim();
                            if ("All Node Types" === e)(C = []).push({
                                name: i,
                                metric: !0
                            }), C.push({
                                name: l,
                                metric: !0
                            }), f("Node Types", !1);
                            else {
                                var t = function(e, t) {
                                    var n;
                                    if (e)
                                        for (n = e.length - 1; n >= 0; n -= 1)
                                            if (e[n].name === t) return e[n]
                                }(w, e);
                                t ? ((C = []).push({
                                    name: i,
                                    metric: !0
                                }), C.push({
                                    name: l,
                                    metric: !0
                                }), t.properties && t.properties.forEach((function(e) {
                                    "empty" !== S[t.id].properties[e.name].type && C.push({
                                        name: e.name
                                    })
                                })), f(C.length + " Properties", !1)) : (C = [], f("Unknown Type", !0))
                            }
                        },
                        y = c.a["graphs/analysis_composition_panel"]({});
                    document.body.appendChild(y.trim().toDOM());
                    var b = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: n,
                            close_actions: function() {
                                E.removeData().typeahead("destroy"), j.removeData().typeahead("destroy")
                            }
                        }, e),
                        _ = document.body.lastElementChild,
                        w = a.getNodeTypes(),
                        O = a.getEdgeTypes();
                    o.get("isHubGraph") && (w = w.filter((function(e) {
                        return e.count > 0
                    })));
                    var E, j, S = a.getAnalysisManager().getTypeSummaries(),
                        x = m(o.get("analysisItems") || []),
                        k = Object(s.v)(w),
                        C = [],
                        N = _.querySelector("input#type-selector"),
                        T = _.querySelector("input#property-selector"),
                        L = _.querySelector("ul#filter-list"),
                        P = _.querySelector(".gc-pnl-action"),
                        A = P.querySelector(".gc-dlg-submit"),
                        D = P.querySelector(".gc-dlg-cancel");
                    return (E = Object(r.a)(N)).typeahead(v(v({}, s.b), {}, {
                        autoselect: !0
                    }), v(v({}, s.c), {}, {
                        name: "types",
                        displayKey: "name",
                        source: function(e, t) {
                            var n, r = [],
                                o = new RegExp(e, "i");
                            for (n = 0; n < k.length; n += 1) o.test(k[n].name) && r.push(k[n]);
                            t(r)
                        },
                        templates: {
                            suggestion: c.a["graphs/node_edge_type_typeahead_suggestion"]
                        }
                    })).on("typeahead:selected", (function() {
                        h(), j.is(":disabled") || j.focus()
                    })), E.on("focus", (function() {
                        E.typeahead("val", ""), d(E, "")
                    })), E.on("blur", (function() {
                        h()
                    })), (j = Object(r.a)(T)).typeahead(v(v({}, s.b), {}, {
                        autoselect: !0
                    }), v(v({}, s.c), {}, {
                        name: "props",
                        displayKey: "name",
                        source: function(e, t) {
                            var n = [],
                                r = new RegExp(e, "i");
                            C.filter((function(e) {
                                return !e.metric
                            })).forEach((function(e) {
                                r.test(e.name) && n.push(e)
                            })), t(n)
                        },
                        templates: {
                            header: '<h5 class="tt-header">Properties</h5>'
                        }
                    }), v(v({}, s.c), {}, {
                        name: "metric",
                        displayKey: "name",
                        source: function(e, t) {
                            var n = [],
                                r = new RegExp(e, "i");
                            C.filter((function(e) {
                                return e.metric
                            })).forEach((function(e) {
                                r.test(e.name) && n.push(e)
                            })), t(n)
                        },
                        templates: {
                            header: '<h5 class="tt-header">Network Metrics</h5>'
                        }
                    })).on("typeahead:selected", (function() {
                        p()
                    })), j.on("focus", (function() {
                        j.typeahead("val", ""), d(j, "")
                    })), A.addEventListener("click", (function() {
                        t && t.call(null, x), b.close()
                    })), b.closeButton(D), x.forEach((function(e) {
                        u(e)
                    })), g.a.create(L, {
                        onUpdate: function(e) {
                            var t, n, r;
                            t = e.oldIndex, n = e.newIndex, r = x.splice(t, 1), x.splice(n, 0, r[0])
                        }
                    }), b.ext = {}, b.ext.getCurrentFilters = function() {
                        return x
                    }, b.ext.isFilterValid = function() {}, b
                },
                O = function(e, t, n) {
                    var o = e.graphStore,
                        a = e.GraphHistory,
                        c = n.form,
                        l = n.btnClose,
                        d = n.onSignedIn,
                        u = c.querySelector("#user_login"),
                        p = c.querySelector("#user_password"),
                        f = c.querySelector('input[type="submit"]'),
                        h = c.querySelector(".sign-in-error"),
                        g = function(e) {
                            var n;
                            d ? (t.close(), d.call(null, e.user, e.auth)) : null !== e && void 0 !== e && null !== (n = e.user) && void 0 !== n && n.redirect_path ? Object(s.lb)(e.user.redirect_path) : window.location.reload()
                        },
                        m = function() {
                            l.firstChild.data = "Close", l.disabled = !1, f.disabled = !1, h.classList.remove("not-shown")
                        },
                        y = function(e) {
                            if (e.preventDefault(), h.classList.add("not-shown"), l.firstChild.data = "Working...", l.disabled = !0, f.disabled = !0, a) {
                                var t = a ? o.get("hub").id : null;
                                a.signIn({
                                    email: u.value,
                                    password: p.value,
                                    hub_id: t,
                                    onSuccess: g,
                                    onFail: m
                                })
                            } else Object(i.signIn)(u.value, p.value, void 0, g, m);
                            return !1
                        };
                    Object(r.a)(c).submit(y), p.addEventListener("keydown", (function(e) {
                        13 == e.keyCode && y(e)
                    }), !1), u.addEventListener("keydown", (function(e) {
                        13 == e.keyCode && y(e)
                    }), !1)
                },
                E = function(e, t, n) {
                    var o = e.GraphHistory,
                        a = n.form,
                        c = n.btnClose,
                        l = n.onSignedUp,
                        d = a.querySelector(".signup-username-container"),
                        u = a.querySelector(".signup-email-container"),
                        p = a.querySelector(".signup-password-container"),
                        f = d.querySelector("span.text-muted"),
                        h = u.querySelector("span.text-muted"),
                        g = p.querySelector("span.text-muted"),
                        m = a.querySelector("#user_username"),
                        y = a.querySelector("#user_email"),
                        b = a.querySelector("#user_password"),
                        v = a.querySelector('input[type="submit"]'),
                        _ = !1,
                        w = function() {
                            _ || (v.disabled = "" === m.value.trim() || "" === y.value.trim() || "" === b.value.trim())
                        },
                        O = function(e) {
                            var n;
                            l ? (t.close(), l.call(null, e.user, e.auth)) : null !== e && void 0 !== e && null !== (n = e.user) && void 0 !== n && n.redirect_path ? Object(s.lb)(e.user.redirect_path) : e.privacy && e.hub_limit > 0 ? window.location = "/hubs/new" : window.location = "/graphs/new?welcome=true"
                        },
                        E = function(e) {
                            var n = e.responseJSON;
                            n && (n.username && (d.classList.add("signup-error"), f.innerHTML = "Username " + n.username), n.email && (u.classList.add("signup-error"), h.innerHTML = "Email " + n.email), n.password && (p.classList.add("signup-error"), g.innerHTML = "Password " + n.password)), m.disabled = !1, y.disabled = !1, b.disabled = !1, c.firstChild.data = "Close", c.disabled = !1, v.disabled = !1, v.value = "Sign up for OntoGraph", t.setWorking(!1), _ = !1
                        };

                    function j(e) {
                        e && e.preventDefault();
                        var n = m.value,
                            r = y.value,
                            a = b.value;
                        return "" === n || "" === r || "" === a || (_ = !0, t.setWorking(!0), c.firstChild.data = "Working...", c.disabled = !0, v.value = "Signing up...", v.disabled = !0, m.disabled = !0, y.disabled = !0, b.disabled = !0, d.classList.remove("signup-error"), f.innerHTML = "No space, no special characters", u.classList.remove("signup-error"), h.innerHTML = "A valid email address", p.classList.remove("signup-error"), g.innerHTML = "Minimum 8 characters", o ? o.signUp({
                            username: n,
                            email: r,
                            password: a,
                            passwordConfirm: null,
                            onSuccess: O,
                            onFail: E
                        }) : Object(i.signUp)(n, r, a, null, O, E)), !1
                    }
                    Object(r.a)(a).submit(j), b.addEventListener("keydown", (function(e) {
                        13 === e.keyCode && j()
                    }), !1), m.addEventListener("keyup", w, !1), y.addEventListener("keyup", w, !1), b.addEventListener("keyup", w, !1)
                },
                j = function(e, t) {
                    var n = {
                            data: t.data,
                            for_story: t.for_story
                        },
                        o = c.a["site/authentication_panel"](n);
                    document.body.appendChild(o.trim().toDOM());
                    var a = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        i = document.body.lastElementChild,
                        l = i.querySelector(".gc-dlg-action").querySelector(".gc-dlg-cancel");
                    a.closeButton(l), Object(r.a)(i).foundation({
                        tab: {
                            callback: function() {}
                        }
                    }), O(e, a, {
                        form: i.querySelector("div#sign_in form"),
                        btnClose: l,
                        onSignedIn: t.onSignedIn
                    }), E(e, a, {
                        form: i.querySelector("div#sign_up form"),
                        btnClose: l,
                        onSignedUp: t.onSignedUp
                    });
                    var d = t.redirect_to ? "redirect_to=" + encodeURIComponent(t.redirect_to) : encodeURIComponent(window.location.href);
                    if (t.signup_redirect_to && (d += "&signup_redirect_to=" + encodeURIComponent(t.signup_redirect_to)), !t.email_only) {
                        var u = i.querySelector("a.button.tw");
                        u.href = u.href + "?" + d;
                        var p = i.querySelector("a.button.fb");
                        p.href = p.href + "?" + d;
                        var f = i.querySelector("a.button.google");
                        f.href = f.href + "?" + d
                    }
                },
                S = function(e, t, n) {
                    var r = c.a["graphs/img_panel"]({
                        img: t.image,
                        name: t.name
                    });
                    document.body.appendChild(r.trim().toDOM());
                    var o = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: n
                        }, e),
                        a = document.body.lastElementChild,
                        i = a.querySelector(".gc-dlg-cancel");
                    o.closeButton(i);
                    var l = a.querySelector(".fitted-bg-image");
                    return l && l.addEventListener("click", (function() {
                        o.close()
                    })), o
                },
                x = n(6),
                k = n.n(x),
                C = function(e, t, n, r, o, a, i, l) {
                    var d = {
                            title: t,
                            message: n,
                            show_checkbox: void 0 != a,
                            checkbox_message: a,
                            warning: i,
                            confirm_text: l || "OK"
                        },
                        u = c.a["graphs/confirm_dialogue"](d);
                    document.body.appendChild(u.trim().toDOM());
                    var p = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {},
                            onCancel: function() {
                                o && o.call(null, h && h.checked)
                            }
                        }, e),
                        f = document.body.lastElementChild,
                        h = f.querySelector(".gc-dlg").querySelector(".confirm-checkbox"),
                        g = f.querySelector(".gc-dlg-action"),
                        m = g.querySelector(".gc-btn-confirm");
                    m.addEventListener("click", (function() {
                        p.close(), r && setTimeout((function() {
                            r(h && h.checked)
                        }), 2)
                    }), !1), m.disabled = !1;
                    var y = g.querySelector(".gc-dlg-cancel");
                    p.closeButton(y)
                },
                N = function e(t, n, r) {
                    var o, i, l = t.graphStore,
                        d = t.GraphHistory,
                        u = !1,
                        p = {},
                        f = d.getNodeById(n),
                        h = d.getNodeTypeById(f.type_id);
                    if (p.name = f.name, p.description = f.description, p.image = f.image, p.reference = f.reference, p.current_type = f.type_id, p.type_options = d.getNodeTypes().map((function(e) {
                            return {
                                id: e.id,
                                name: e.name
                            }
                        })), p.color = h.color, p.image = f.image, p.reference = f.reference, p.props = [], f.image || (p.allow_color_update = !0), h.properties)
                        for (o = 0; o < h.properties.length; o += 1) i = {
                            key: h.properties[o].name,
                            label: h.properties[o].name_alias
                        }, f.properties ? i.value = f.properties[i.key] || "" : i.value = "", p.props.push(i);
                    p.show_add_prop = l.get("belongsToHub") && l.get("user").is_admin || !l.get("belongsToHub") && l.get("user").can_edit;
                    var g = c.a["graphs/edit_node_panel"](p);
                    document.body.appendChild(g.trim().toDOM());
                    var m = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                d.isOnboardEnabled() && d.triggerOnboardAction("cancelled")
                            }
                        }, d),
                        y = document.body.lastElementChild.querySelector(".gc-pnl"),
                        b = y.querySelector(".gc-pnl-body"),
                        v = y.querySelector("#node_name"),
                        _ = y.querySelector("select#node_type"),
                        w = y.querySelector(".gc-btn-confirm"),
                        O = y.querySelector(".gc-dlg-cancel");
                    m.closeButton(O), a.a.create(".node-description-tips", {
                        position: "bottom",
                        size: "small",
                        hideOnClickOutside: !0
                    });
                    var E;
                    p.show_add_prop && y.querySelector(".gc-add-property").addEventListener("click", (function(e) {
                        e.preventDefault();
                        var t = c.a["graphs/edit_node_panel_prop_row"]();
                        b.appendChild(t.trim().toDOM()), L && L.removeEventListener("keydown", k, !1);
                        var n = b.lastElementChild,
                            r = n.querySelector("input.node-prop-name");
                        if ((L = n.querySelector("input.node-prop-value")).addEventListener("keydown", k, !1), n.querySelector("span.ss-delete").addEventListener("click", (function(e) {
                                return e.preventDefault(),
                                    function(e) {
                                        var t = e.parentNode.lastElementChild === e,
                                            n = e.parentNode;
                                        n.removeChild(e);
                                        var r = n.querySelectorAll("div.new-prop");
                                        t && r.length > 0 && (L = r[r.length - 1].querySelector("input.node-prop-value")).addEventListener("keydown", k, !1);
                                        var o = n.querySelectorAll("div.node-prop");
                                        0 === r.length && 0 === o.length && document.querySelector(".properties-header").classList.add("not-shown")
                                    }(n), !1
                            })), Object(s.eb)(b, b.scrollHeight), document.querySelector(".properties-header").classList.remove("not-shown"), d.isOnboardEnabled()) {
                            var o = b.children.length - 2;
                            d.triggerOnboardAction("node_edit_property_added", {
                                prop_count: o,
                                target: r.parentNode
                            }), r.addEventListener("keyup", (function() {
                                r.value.trim().length > 0 && d.triggerOnboardAction("node_edit_property_key_added", {
                                    prop_count: o,
                                    target: L,
                                    value: r.value.trim().toLowerCase()
                                }), 1 === o ? "city" === r.value.trim().toLowerCase() && L.focus() : 2 === o && "year" === r.value.trim().toLowerCase() && L.focus()
                            })), L.addEventListener("keyup", (function() {
                                L.value.trim().length > 0 && d.triggerOnboardAction("node_edit_property_val_added", {
                                    target: L,
                                    prop_count: o,
                                    value: L.value.trim().toLowerCase()
                                })
                            }))
                        }
                        return r.focus(), !1
                    }), !1);
                    if (p.allow_color_update) {
                        var j = y.querySelector("div.gc-pnl-header"),
                            S = y.querySelector("button.change-color");
                        E = y.querySelector('input[type="color"].color-picker');
                        S.addEventListener("click", (function() {
                            E.click()
                        })), E.addEventListener("change", (function() {
                            u = !0, j.style.backgroundColor = E.value
                        }))
                    }
                    y.querySelector("button#btnDeleteNode").addEventListener("click", (function() {
                        d.buildDeleteSignals([f.id], null, (function(e, t) {
                            var n;
                            if (e) d.clearSelectedNodes();
                            else
                                for (m.close(), d.clearSelectedNodes(), n = 0; n < t.length; n += 1) d.notify(t[n])
                        }))
                    }));
                    var x = function(e) {
                        var n;
                        e && e.preventDefault();
                        var o = y.querySelectorAll(".new-prop");
                        if (u) {
                            var a = {
                                action: "nodetype_update",
                                id: h.id,
                                color: E.value,
                                prev: {
                                    color: h.color
                                }
                            };
                            d.notify(a)
                        }
                        if (o && o.length > 0) {
                            var i = {
                                action: "nodetype_update",
                                id: h.id,
                                properties: [],
                                prev: {
                                    properties: []
                                }
                            };
                            for (n = 0; n < o.length; n += 1) {
                                var s = o[n].querySelector("input.node-prop-name");
                                s && s.value && (i.properties.push({
                                    name: s.value,
                                    name_alias: s.value
                                }), i.prev.properties.push({}))
                            }
                            i.properties.length > 0 && d.notify(i)
                        }
                        var c = !1,
                            l = !1,
                            p = {
                                action: "node_update"
                            };
                        p.id = f.id;
                        var g = y.querySelector("#node_name");
                        g.value.trim() !== f.name && (p.name = g.value.trim(), p.prev = p.prev || {}, p.prev.name = f.name, c = !0, l = !0);
                        var b = y.querySelector("#node_description");
                        b.value.trim() !== (f.description || "") && (p.description = b.value.trim(), p.prev = p.prev || {}, p.prev.description = f.description, c = !0);
                        var v = y.querySelector("#node_image");
                        v.value.trim() !== (f.image || "") && (p.image = v.value.trim(), p.prev = p.prev || {}, p.prev.image = f.image, c = !0);
                        var _ = y.querySelector("#node_reference");
                        _.value.trim() !== (f.reference || "") && (p.reference = _.value.trim(), p.prev = p.prev || {}, p.prev.reference = f.reference, c = !0);
                        var w = y.querySelectorAll("div.node-prop");
                        for (n = 0; n < w.length; n += 1) {
                            var O = w[n].querySelector("input"),
                                j = O.getAttribute("data-node-type");
                            O.value.trim() ? f.properties && f.properties[j] === O.value.trim() || (p.properties = p.properties || {}, p.properties[j] = O.value.trim(), p.prev = p.prev || {}, p.prev.properties = p.prev.properties || {}, p.prev.properties[j] = f.properties && f.properties[j] ? f.properties[j] : null, c = !0) : f.properties && Object.prototype.hasOwnProperty.call(f.properties, j) && "" !== f.properties[j] && (p.properties = p.properties || {}, p.properties[j] = O.value.trim(), p.prev = p.prev || {}, p.prev.properties = p.prev.properties || {}, p.prev.properties[j] = f.properties[j], c = !0)
                        }
                        if (o)
                            for (n = 0; n < o.length; n += 1) {
                                var S = o[n].querySelector("input.node-prop-value"),
                                    x = o[n].querySelector("input.node-prop-name").value;
                                p.properties = p.properties || {}, p.properties[x] = S.value.trim(), p.prev = p.prev || {}, p.prev.properties = p.prev.properties || {}, p.prev.properties[x] = null, c = !0
                            }
                        return c ? (m.setWorking(!0), l && d.getNodeByTypeAndName(f.type, p.name) ? C(t, "Duplicate Node", "A node already exists with that name and type. Do you want to add it anyway?", (function() {
                            d.notify(p), m.close(), r && r()
                        }), (function() {
                            m.setWorking(!1)
                        })) : (d.notify(p), m.close(), r && r())) : (m.close(), r && r()), d.isOnboardEnabled() && d.triggerOnboardAction("onboard_completed"), !1
                    };

                    function k(e) {
                        13 == e.keyCode && x()
                    }
                    var N = function() {
                            m.setWorking(!1), d.notify({
                                action: "node_update",
                                id: f.id,
                                type_id: _.value,
                                type: _.options[_.selectedIndex].innerHTML,
                                prev: {
                                    type: f.type,
                                    type_id: f.type_id
                                }
                            }), m.close();
                            var t = [d, n];
                            r && t.push(r), e.apply(null, t)
                        },
                        T = function() {
                            _.value = f.type_id, m.setWorking(!1)
                        };
                    _.addEventListener("change", (function() {
                        _.value !== f.type_id && (m.setWorking(!0), C(t, "Node type change", "Are you sure you want to change the type of this node? <br/>(Change will be applied immediately)", N, T))
                    }), !1), v.addEventListener("keyup", (function() {
                        w.disabled = "" === v.value
                    }), !1), v.addEventListener("keydown", k, !1), w.addEventListener("click", x, !1);
                    var L = null,
                        P = y.querySelectorAll("div.node-prop");
                    if (P.length > 0 ? (L = P[P.length - 1].querySelector("input")).addEventListener("keydown", k, !1) : document.querySelector(".properties-header").classList.add("not-shown"), v.focus(), d.isOnboardEnabled()) {
                        var A = y.querySelector("#node_description"),
                            D = y.querySelector("#node_image");
                        A.focus(), A.addEventListener("keyup", (function() {
                            A.value.trim().length > 2 && d.triggerOnboardAction("node_edit_description_added", {
                                target: D,
                                value: A.value
                            })
                        })), D.addEventListener("keyup", (function() {
                            D.value.trim().length > 2 && d.triggerOnboardAction("node_edit_image_added", {
                                target: "button.gc-btn.gc-add-property",
                                value: A.value
                            })
                        })), d.triggerOnboardAction("node_edit_opened", {
                            target: A,
                            type_name: f.type
                        })
                    }
                    return m
                },
                T = n(45),
                L = function(e, t, n) {
                    var r, o, a, l, d, u, p, f, h, g = {
                            props: [],
                            edgetypes: [],
                            graphs: !1
                        },
                        m = function() {
                            var e = "p=";
                            e += g.props.map((function(e) {
                                return encodeURIComponent(e)
                            })).join(",");
                            var n = "et=";
                            n += g.edgetypes.map((function(e) {
                                return encodeURIComponent(e)
                            })).join(",");
                            var r = "";
                            g.graphs && (r = "g=true");
                            var o = "?" + e + "&" + n + "&" + r,
                                a = '<iframe src="%url%/nodes/%id%/embed%params%" frameborder="0" style="overflow:auto;width:320px;min-width:320px;height:100%;min-height:460px;border:1px solid #CCCCCC;" width="320" height="460"></iframe>'.replace(/%id%/, t).replace("%params%", o).replace("%url%", Object(s.B)());
                            E.innerHTML = a
                        },
                        y = function() {
                            var e = this.getAttribute("data-item-name"),
                                t = parseInt(this.getAttribute("data-item-index")),
                                n = !this.checked;
                            n ? g.props.splice(g.props.indexOf(e), 1) : g.props.splice(g.props.indexOf(e), 0, e), m(), r && (n ? r.removeProperty(e) : r.insertProperty(l[t], t))
                        },
                        b = function() {
                            var e = this.getAttribute("data-item-name"),
                                t = parseInt(this.getAttribute("data-item-index")),
                                n = this.getAttribute("data-item-id"),
                                o = !this.checked;
                            o ? g.edgetypes.splice(g.edgetypes.indexOf(e), 1) : g.edgetypes.splice(g.edgetypes.indexOf(e), 0, e), m(), r && (o ? r.removeEdgeType(n) : r.insertEdgeType(d[t], t))
                        },
                        v = function() {
                            var e = !this.checked;
                            g.graphs = !e, m(), r && (e ? r.removeGraphs() : r.insertGraphs(u))
                        },
                        _ = c.a["site/node_embed_panel"]();
                    document.body.appendChild(_.trim().toDOM());
                    var w = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: n
                        }, e),
                        O = document.body.lastElementChild,
                        E = O.querySelector("textarea"),
                        j = O.querySelector("div.embed-preview-container"),
                        S = O.querySelector("div.properties-holder"),
                        x = O.querySelector("div.edgetypes-holder"),
                        k = O.querySelector("div.graphs-holder"),
                        C = O.querySelector("input#remember-settings"),
                        N = O.querySelector("button.gc-dlg-cancel");
                    return C && N.addEventListener("click", (function() {
                        h && C.checked && Object(i.setNodeTypeEmbedDefaults)(a.id, g), w.close()
                    })), E.addEventListener("click", (function() {
                        this.selectionStart = 0, this.selectionEnd = this.value.length
                    })), Object(i.embedNodeDetails)(t, (function(e) {
                        h = e.is_admin, o = e.node || {}, a = e.nodetype, p = e.hub || {}, f = e.graph || {}, u = e.graphs || [], d = e.edgetypes || [], l = [];
                        var t = a && a.embed_defaults && Object.keys(a.embed_defaults).length > 0;
                        a && Array.isArray(a.properties) && o.properties && a.properties.forEach((function(e) {
                                o.properties[e.name] && l.push({
                                    name: e.name,
                                    value: o.properties[e.name]
                                })
                            })), t ? g = {
                                props: a.embed_defaults.props || [],
                                edgetypes: a.embed_defaults.edgetypes || [],
                                graphs: a.embed_defaults.graphs || !1
                            } : (g.props = l.map((function(e) {
                                return e.name
                            })), g.edgetypes = d.map((function(e) {
                                return e.name
                            })), g.graphs = !0), m(), r = Object(T.embedNodeCard)({
                                parent: j,
                                node: o,
                                nodeType: a,
                                hub: p,
                                graph: f,
                                graphs: g.graphs ? u : null,
                                properties: l.filter((function(e) {
                                    return g.props.indexOf(e.name) >= 0
                                })),
                                edge_types: d.filter((function(e) {
                                    return g.edgetypes.indexOf(e.name) >= 0
                                }))
                            }),
                            function(e) {
                                var t = S.querySelector("ul");
                                e.forEach((function(e, n) {
                                    var r = c.a["site/node_embed_item"]({
                                        name: e.name,
                                        checked: g.props.indexOf(e.name) >= 0,
                                        index: n
                                    });
                                    t.appendChild(r.trim().toDOM()), t.lastElementChild.querySelector("input").addEventListener("click", y)
                                })), Object(s.nb)(S, "not-shown"), Object(s.nb)(t, "not-shown")
                            }(l),
                            function(e) {
                                var t = x.querySelector("ul");
                                e.forEach((function(e, n) {
                                    var r = c.a["site/node_embed_item"]({
                                        name: e.name,
                                        checked: g.edgetypes.indexOf(e.name) >= 0,
                                        index: n,
                                        id: e.id
                                    });
                                    t.appendChild(r.trim().toDOM()), t.lastElementChild.querySelector("input").addEventListener("click", b)
                                })), Object(s.nb)(x, "not-shown"), Object(s.nb)(t, "not-shown")
                            }(d), Object.prototype.hasOwnProperty.call(p, "name") && function(e) {
                                if (e.length > 0) {
                                    var t = k.querySelector("ul"),
                                        n = c.a["site/node_embed_item"]({
                                            name: Object(s.k)(e.length, "graph", "graphs", "Show {quantity} {item}"),
                                            checked: g.graphs
                                        });
                                    t.appendChild(n.trim().toDOM()), t.lastElementChild.querySelector("input").addEventListener("click", v), Object(s.nb)(t, "not-shown")
                                } else {
                                    var r = k.querySelector("label.no-items");
                                    Object(s.nb)(r, "not-shown")
                                }
                                Object(s.nb)(k, "not-shown")
                            }(u), h && Object(s.nb)(C.parentNode, "not-shown")
                    }), (function(e) {
                        console.log(e)
                    })), w
                },
                P = function(e, t, n, r) {
                    var o = e.GraphHistory,
                        a = e.graphStore,
                        l = c.a["graphs/node_panel"](t);
                    document.body.appendChild(l.toDOM());
                    var d = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                Object(s.yb)("show", null), Object(s.yb)("nid", null)
                            },
                            onCancel: r
                        }, e),
                        u = document.body.lastElementChild,
                        p = u.querySelector(".gc-pnl");
                    Array.from(u.querySelectorAll(".linkify")).forEach((function(e) {
                        Object(s.ab)(e)
                    }));
                    var f = u.querySelectorAll("a.gc-card-relation-node");
                    if (f)
                        for (var h = f.length - 1; h >= 0; h--) f[h].addEventListener("click", (function() {
                            var r = this.getAttribute("data-from"),
                                a = this.getAttribute("data-to"),
                                i = t.id === r ? a : r;
                            d.close(), A(e, o.getNodeById(i), n)
                        }));
                    var g = u.querySelector("a.zoom-in");
                    g && g.addEventListener("click", (function() {
                        d.setWorking(!0), S(e, t, (function() {
                            d.setWorking(!1)
                        }))
                    }));
                    t.node_saved && Object(i.getGraphsForNode)(t.id, (function(e) {
                        if (e && e.length) {
                            var t = p.querySelector(".node-graphs");
                            e = (e = e.sort((function(e, t) {
                                var n = new Date(e.signals_added_at);
                                return new Date(t.signals_added_at).getTime() - n.getTime()
                            }))).map((function(e) {
                                var t = k()(e.signals_added_at);
                                return k()().diff(t, "days") > 7 ? e.signals_added_at = t.format("MMM d, YYYY") : e.signals_added_at = t.fromNow(), e
                            }));
                            var n = {};
                            a.get("isHub") ? (n.graphs = e, n.count = e.length) : (n.graphs = e.filter((function(e) {
                                return e.id !== a.get("id")
                            })), n.count = e.length - 1);
                            var r = c.a["graphs/node_graphs_section"](n);
                            t.appendChild(r.toDOM())
                        }
                    }), (function(e) {
                        console.log(e)
                    }));
                    var m = u.querySelector(".gc-pnl-action");
                    if (d.closeButton(m.querySelector(".gc-dlg-cancel")), t.editable) {
                        var y = u.querySelector("a.edit-node");
                        y && y.addEventListener("click", (function() {
                            d.close(), N(e, t.id)
                        }))
                    }
                    if (!t.hideFooterLinks && t.node_saved && t.allow_share) {
                        var b = u.querySelector(".share-node");
                        n ? b.addEventListener("click", (function(e) {
                            e.preventDefault(), d.close(), n(t.id)
                        })) : Object(s.U)(e, {
                            id: t.id,
                            name: t.name
                        }, {
                            parent: b,
                            tipped: u.querySelector("ul#node-share-menu-" + t.id),
                            position: "top"
                        });
                        var v = u.querySelector("a.embed-share");
                        v && v.addEventListener("click", (function(n) {
                            return n.preventDefault(), d.setWorking(!0), L(e, t.id, (function() {
                                d.setWorking(!1)
                            })), !1
                        }))
                    }
                    return Object(s.yb)("show", "node"), Object(s.yb)("nid", t.id), d
                },
                A = function(e, t, n, r) {
                    var o = e.uiStore,
                        a = e.graphStore,
                        i = e.GraphHistory,
                        c = a.get("id"),
                        l = a.get("title"),
                        u = i.getNodeTypeById(t.type_id),
                        p = i.getLinksForNode(t.id),
                        f = !1;
                    o.get("freezeMode") || !1 !== o.get("readOnly") || (f = !0);
                    var h, g, m, y, b = {
                        graph_id: c,
                        graph_name: l,
                        id: t.id,
                        name: t.name,
                        type: u.name,
                        image: t.image,
                        description: Object(d.transformMarkdown)(t.description),
                        reference: t.reference,
                        color: u.color,
                        properties: [],
                        edge_types: [],
                        node_saved: !1,
                        allow_share: !1,
                        allow_edit: !o.get("readOnly") && !o.get("isOnlyExploreAllowed"),
                        editable: f
                    };
                    (a.get("belongsToHub") && (b.hub_id = a.get("hub").id, b.hub_name = a.get("hub").name), a.get("isEmbed")) && ("false" === Object(s.L)("topbar") && (b.hideFooterLinks = !0));
                    if (b.node_saved = i.isNodeSaved(t.id), b.node_saved && (b.allow_share = 2 !== i.getNodeStatus(t.id)), Object.prototype.hasOwnProperty.call(t, "properties"))
                        for (g in t.properties) Object.prototype.hasOwnProperty.call(t.properties, g) && b.properties.push({
                            name: g,
                            value: t.properties[g]
                        });
                    for (g in p)
                        if (Object.prototype.hasOwnProperty.call(p, g)) {
                            for (m = p[g].to_nodes.length, y = {
                                    id: p[g].id,
                                    color: p[g].color,
                                    name: p[g].name,
                                    to_nodes: [],
                                    nodes_count: m,
                                    toggle_more: m > 3
                                }, h = 0; h < m; h += 1) y.to_nodes.push({
                                edge_id: p[g].to_nodes[h].link_id,
                                from_id: p[g].to_nodes[h].other,
                                to_id: p[g].to_nodes[h].id,
                                name: p[g].to_nodes[h].name,
                                typeChar: p[g].to_nodes[h].type.charAt(0).toUpperCase(),
                                type: p[g].to_nodes[h].type,
                                color: p[g].to_nodes[h].color,
                                degree: p[g].to_nodes[h].node_degree,
                                degree_text: Object(s.k)(p[g].to_nodes[h].node_degree, "edge", "edges", "{quantity} {item}")
                            });
                            y.to_nodes = y.to_nodes.sort((function(e, t) {
                                return t.degree - e.degree
                            })), b.edge_types.push(y)
                        }
                    b.edge_types = b.edge_types.sort((function(e, t) {
                        return t.nodes_count - e.nodes_count
                    })), P(e, b, n, r)
                };

            function D(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function M(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? D(Object(n), !0).forEach((function(t) {
                        q(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : D(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function q(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var I = function(e, t, n) {
                    var o = e.graphStore,
                        a = e.GraphHistory,
                        i = function(e, t) {
                            var n = e.data("ttTypeahead");
                            n && n._onQueryChanged(null, t)
                        },
                        l = c.a["graphs/circular_layout_settings_panel"](t);
                    document.body.appendChild(l.trim().toDOM());
                    var d = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        u = document.body.lastElementChild,
                        p = u.querySelector(".gc-btn-confirm"),
                        f = u.querySelector(".gc-dlg-cancel");
                    d.closeButton(f), p.addEventListener("click", (function() {
                        ! function() {
                            var e = m.typeahead("val").trim();
                            if (e) {
                                var t = y.typeahead("val").trim();
                                if (t) {
                                    var r = v.typeahead("val").trim();
                                    if (r) {
                                        var o = b.typeahead("val").trim();
                                        if (o) {
                                            var a = _.typeahead("val").trim();
                                            if (a) {
                                                var i = O.typeahead("val").trim();
                                                if (i) {
                                                    var s = E.checked;
                                                    d.close(), n({
                                                        pivot_type: e,
                                                        surround_type: t,
                                                        group_surround_type: o,
                                                        support_relation: r,
                                                        oppose_relation: a,
                                                        double_arc: s,
                                                        pivot_order: i,
                                                        save: !0
                                                    })
                                                } else O.focus()
                                            } else _.focus()
                                        } else b.focus()
                                    } else v.focus()
                                } else y.focus()
                            } else m.focus()
                        }()
                    }));
                    var h = function() {
                            return function(e, t) {
                                var n = new RegExp(e, "i");
                                t(a.getNodeTypes().filter((function(e) {
                                    return e.count > 0 && n.test(e.name)
                                })).map((function(e) {
                                    return {
                                        is_nt: !0,
                                        color: e.color,
                                        name: e.name,
                                        count: e.count
                                    }
                                })))
                            }
                        },
                        g = function() {
                            return function(e, t) {
                                var n = new RegExp(e, "i");
                                t(a.getEdgeTypes().filter((function(e) {
                                    return e.count > 0 && n.test(e.name)
                                })).map((function(e) {
                                    return {
                                        is_nt: !1,
                                        color: e.color,
                                        name: e.name,
                                        count: e.count
                                    }
                                })))
                            }
                        },
                        m = Object(r.a)("input#txtPivotType");
                    m.typeahead(M(M({}, s.b), {}, {
                        autoselect: !0
                    }), M(M({}, s.c), {}, {
                        name: "types",
                        displayKey: "name",
                        source: h(),
                        templates: {
                            suggestion: c.a["graphs/node_edge_type_typeahead_suggestion"]
                        }
                    })).on("typeahead:selected", (function() {
                        y.focus()
                    })), m.on("focus", (function() {
                        m.typeahead("val", ""), i(m, "")
                    }));
                    var y = Object(r.a)("input#txtSurroundType");
                    y.typeahead(M(M({}, s.b), {}, {
                        autoselect: !0
                    }), M(M({}, s.c), {}, {
                        name: "types",
                        displayKey: "name",
                        source: h(),
                        templates: {
                            suggestion: c.a["graphs/node_edge_type_typeahead_suggestion"]
                        }
                    })).on("typeahead:selected", (function() {
                        b.focus()
                    })), y.on("focus", (function() {
                        y.typeahead("val", ""), i(y, "")
                    }));
                    var b = Object(r.a)("input#txtGroupSurroundBy");
                    b.typeahead(M(M({}, s.b), {}, {
                        autoselect: !0
                    }), M(M({}, s.c), {}, {
                        name: "types",
                        displayKey: "name",
                        source: function(e, t) {
                            var n = new RegExp(e, "i"),
                                r = a.getNodeTypeByName(y.typeahead("val").trim());
                            t(r && Array.isArray(r.properties) ? r.properties.filter((function(e) {
                                return n.test(e.name)
                            })).map((function(e) {
                                return {
                                    name: e.name
                                }
                            })).sort((function(e, t) {
                                return e.name < t.name ? -1 : e.name > t.name ? 1 : 0
                            })) : [])
                        }
                    })).on("typeahead:selected", (function() {
                        v.focus()
                    })), b.on("focus", (function() {
                        b.typeahead("val", ""), i(b, "")
                    }));
                    var v = Object(r.a)("input#txtSupportRel");
                    v.typeahead(M(M({}, s.b), {}, {
                        autoselect: !0
                    }), M(M({}, s.c), {}, {
                        name: "types",
                        displayKey: "name",
                        source: g(),
                        templates: {
                            suggestion: c.a["graphs/node_edge_type_typeahead_suggestion"]
                        }
                    })).on("typeahead:selected", (function() {
                        _.focus()
                    })), v.on("focus", (function() {
                        v.typeahead("val", ""), i(v, "")
                    }));
                    var _ = Object(r.a)("input#txtOpposeRel");
                    _.typeahead(M(M({}, s.b), {}, {
                        autoselect: !0
                    }), M(M({}, s.c), {}, {
                        name: "types",
                        displayKey: "name",
                        source: g(),
                        templates: {
                            suggestion: c.a["graphs/node_edge_type_typeahead_suggestion"]
                        }
                    })).on("typeahead:selected", (function() {
                        O.focus()
                    })), _.on("focus", (function() {
                        _.typeahead("val", ""), i(_, "")
                    }));
                    var w, O = Object(r.a)("input#txtPivotOrder");
                    O.typeahead(M(M({}, s.b), {}, {
                        autoselect: !0
                    }), M(M({}, s.c), {}, {
                        name: "types",
                        displayKey: "name",
                        source: (w = ["Default", "Support/Oppose Ratio"], function(e, t) {
                            var n = new RegExp(e, "i");
                            t(w.filter((function(e) {
                                return n.test(e)
                            })).map((function(e) {
                                return {
                                    name: e
                                }
                            })))
                        })
                    })).on("typeahead:selected", (function() {
                        p.focus()
                    })), O.on("focus", (function() {
                        O.typeahead("val", ""), i(O, "")
                    }));
                    var E = u.querySelector("#cbDoubleArc"),
                        j = o.get("circularLayoutSettings");
                    return j && (m.typeahead("val", j.pivot_type || ""), y.typeahead("val", j.surround_type || ""), b.typeahead("val", j.group_surround_type || ""), v.typeahead("val", j.support_relation || ""), _.typeahead("val", j.oppose_relation || ""), O.typeahead("val", j.pivot_order || ""), E.checked = j.double_arc), d
                },
                R = function(e, t, n) {
                    var r = e.graphStore;
                    n = n || {};
                    var o = function() {
                            var e = d.querySelector("img#image"),
                                t = e.parentNode.getBoundingClientRect(),
                                n = t.height,
                                r = t.width - 380,
                                o = e.getBoundingClientRect(),
                                a = o.height,
                                i = o.width,
                                s = r / i,
                                c = n / a,
                                l = Math.min(s, c);
                            e.parentNode.style.paddingTop = Math.floor((n - a * l) / 2) + "px", e.parentNode.style.paddingLeft = Math.floor((r - i * l) / 2) + "px", e.style.width = Math.floor(i * l) + "px", e.style.height = Math.floor(a * l) + "px"
                        },
                        a = c.a["graphs/comment_panel"](t);
                    document.body.appendChild(a.trim().toDOM());
                    var i, l = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: n.onClose,
                            close_actions: function() {
                                var e;
                                window.removeEventListener("resize", o), e = "/graphs/" + r.get("id") + "?show=comments", history.replaceState(r.get("id"), r.get("title"), e)
                            }
                        }, e),
                        d = document.body.lastElementChild;
                    return window.addEventListener("resize", o), l.closeButton(d.querySelector("button.gc-dlg-cancel")), d.querySelector("img#image").onload = function() {
                        o()
                    }, t.id, i = "/graphs/" + r.get("id") + "/comments/" + t.id + "?show=comments", history.replaceState(t.id, "", i), l
                },
                B = function(e, t, n) {
                    var r = {
                            text: t
                        },
                        o = c.a["site/copy_to_clipboard"](r);
                    document.body.appendChild(o.trim().toDOM());
                    var a = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: n
                        }, e),
                        i = document.body.lastElementChild.querySelector(".gc-dlg");
                    i.querySelector('input[type="text"]').select();
                    var l = i.querySelector(".gc-dlg-cancel");
                    a.closeButton(l)
                },
                F = n(351),
                G = n.n(F),
                H = n(81),
                U = n.n(H),
                z = function(e, t, n, r, o) {
                    var a = {
                            title: t,
                            message: n
                        },
                        i = c.a["site/message_dialogue"](a);
                    document.body.appendChild(i.trim().toDOM());
                    var l = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                o && o.call()
                            }
                        }, e || {}),
                        d = document.body.lastElementChild;
                    return d.className += " full-cover__reveal", d.querySelector(".gc-dlg-action").querySelector(".gc-dlg-cancel").classList.add("not-shown"), l.setWorking(!0), r && setTimeout((function() {
                        r.call(null, (function() {
                            l.close()
                        }))
                    }), 40), l
                },
                W = function(e, t, n, r) {
                    var o = {
                            plan: n
                        },
                        a = null,
                        i = c.a["site/credit_card_panel"](o);
                    document.body.appendChild(i.trim().toDOM());
                    var l = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        d = l.elem().querySelector(".gc-btn-confirm"),
                        u = l.elem().querySelector(".gc-dlg-cancel");
                    l.closeButton(u);
                    var p = function(e, t) {
                            a.close(), l.setWorking(!1), l.close(), r && r.call(null, t.id)
                        },
                        f = function() {
                            var e = m.value,
                                n = g.value,
                                r = h.value.split("/")[0].trim(),
                                o = h.value.split("/")[1].trim(),
                                a = y.value,
                                i = b.value,
                                s = window.Stripe;
                            s.setPublishableKey(t), s.card.createToken({
                                number: e,
                                cvc: a,
                                exp_month: parseInt(r),
                                exp_year: parseInt(o),
                                address_zip: i,
                                name: n
                            }, p)
                        };
                    new G.a({
                        form: "form.credit-card",
                        container: ".card-wrapper",
                        formSelectors: {
                            numberInput: "input#card_number",
                            expiryInput: "input#card_expiry",
                            cvcInput: "input#card_cvc",
                            nameInput: "input#card_holder"
                        },
                        width: 320,
                        formatting: !0,
                        messages: {
                            validDate: "valid\ndate",
                            monthYear: "mm/yyyy"
                        },
                        placeholders: {
                            number: "\u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022",
                            name: "Full Name",
                            expiry: "\u2022\u2022/\u2022\u2022",
                            cvc: "\u2022\u2022\u2022"
                        },
                        classes: {
                            invalid: "invalid"
                        },
                        debug: !1
                    });
                    var h = l.elem().querySelector("input#card_expiry"),
                        g = l.elem().querySelector("input#card_holder"),
                        m = l.elem().querySelector("input#card_number"),
                        y = l.elem().querySelector("input#card_cvc"),
                        b = l.elem().querySelector("input#card_zip_code");
                    b.addEventListener("keyup", (function() {
                        "" !== this.value ? Object(s.nb)(this, "invalid") : Object(s.h)(this, "invalid")
                    }), !1);
                    var v = function() {
                            if (!U.a.fns.validateCardNumber(m.value)) return Object(s.h)(m, "invalid"), !1;
                            if ("" == g.value.trim()) return Object(s.h)(g, "invalid"), !1;
                            var e = h.value.split("/");
                            if (2 !== e.length) return Object(s.h)(h, "invalid"), !1;
                            var t = e[0].trim(),
                                n = e[1].trim();
                            if (!U.a.fns.validateCardExpiry(t, n)) return Object(s.h)(h, "invalid"), !1;
                            var r = U.a.fns.cardType(m.value.trim());
                            return U.a.fns.validateCardCVC(y.value.trim(), r) ? "" != b.value.trim() || (Object(s.h)(b, "invalid"), !1) : (Object(s.h)(y, "invalid"), !1)
                        },
                        _ = function() {
                            v() ? d.disabled = !1 : d.disabled = !0
                        };
                    return h.addEventListener("keyup", _, !1), g.addEventListener("keyup", _, !1), m.addEventListener("keyup", _, !1), y.addEventListener("keyup", _, !1), b.addEventListener("keyup", _, !1), d.addEventListener("click", (function() {
                        v() && (l.setWorking(!0), a = z(e, "Please wait...", "Processing your credit card", f))
                    })), m.focus(), l
                },
                Y = function(e, t) {
                    var n = t || {},
                        o = {
                            title: n.title,
                            subtitle: n.subtitle
                        },
                        a = c.a["graphs/datatable_preview"](o);
                    document.body.appendChild(a.trim().toDOM());
                    var i = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {},
                            onCancel: n.onCancel
                        }, e),
                        l = document.body.lastElementChild,
                        d = l.querySelector(".gc-pnl-body").getBoundingClientRect(),
                        u = l.querySelector(".gc-pnl-action").getBoundingClientRect().top - d.top - 40,
                        p = Object(r.a)(l.querySelector(".data-holder")),
                        f = function(e, t) {
                            for (var n = [], r = 0; r < e; r += 1) n.push(t);
                            return n
                        }(n.columnHeaders.length, 160);
                    return p.handsontable({
                        minSpareRows: 0,
                        rowHeaders: !0,
                        colHeaders: n.columnHeaders,
                        columns: n.columns,
                        data: n.data,
                        height: u,
                        stretchH: "last",
                        undo: !1,
                        manualColumnResize: !0,
                        columnSorting: !0,
                        fillHandle: !1,
                        colWidths: f
                    }), p.handsontable("getInstance"), l.querySelector("#btnDownload").addEventListener("click", (function(e) {
                        return e.preventDefault(), this.blur(), n.onExportRequested(), i.close(), !1
                    })), i
                },
                V = function(e, t) {
                    var n = e.graphStore,
                        o = {
                            id: n.get("id"),
                            title: n.get("title"),
                            subtitle: n.get("subtitle"),
                            description: n.get("description"),
                            references: n.get("references"),
                            image: n.get("image"),
                            token: Object(s.C)(),
                            hub_member_graph: n.get("belongsToHub") && !n.get("community"),
                            hub_explore_template: n.get("exploreTemplate")
                        },
                        l = c.a["graphs/edit_graph_panel"](o);
                    document.body.appendChild(l.trim().toDOM());
                    var d = Object(s.bb)({
                        element: document.body.lastElementChild,
                        url_param: "edit-info",
                        close_others: !0,
                        onCancel: function() {
                            t && t.call()
                        }
                    }, e);
                    a.a.create(".description-tips", {
                        position: "bottom",
                        size: "small",
                        hideOnClickOutside: !0
                    });
                    var u = function() {
                            b.classList.add("not-shown"), m.firstChild.data = "Working...", m.disabled = !0, y.disabled = !0, Object(r.a)(f).ajaxSubmit((function(e) {
                                n.set("title", e.name), n.set("subtitle", e.subtitle), n.set("description", e.description), n.set("references", e.references), n.set("image", e.image);
                                var r = document.getElementById("graph-name");
                                r && (r.innerHTML = e.name || "Untitled graph"), d.close(), t && t.call()
                            }))
                        },
                        p = document.body.lastElementChild,
                        f = p.querySelector("#edit_graph_" + o.id);
                    f.addEventListener("submit", (function(e) {
                        return e.preventDefault(), u(), !1
                    }), !1);
                    var h = p.querySelector(".gc-pnl"),
                        g = p.querySelector(".gc-pnl-action"),
                        m = g.querySelector(".gc-btn-confirm");
                    m.disabled = !1;
                    var y = g.querySelector(".gc-dlg-cancel");
                    d.closeButton(y);
                    for (var b = g.querySelector(".gc-dlg-error"), v = h.querySelectorAll("input"), _ = function(e) {
                            if (13 == e.keyCode) return e.preventDefault(), u(), !1
                        }, w = 0; w < v.length; w += 1) v[w].addEventListener("keydown", _, !1);
                    var O = h.querySelector("#export-template");
                    O && O.addEventListener("change", (function() {
                        Object(i.setGraphAsExploreTemplate)(n.get("id"), !O.checked, (function(e) {
                            e.success && n.set("exploreTemplate", e.explore_template)
                        }))
                    }), !1);
                    var E = h.querySelector("#btnDeleteGraph");
                    E && E.addEventListener("click", (function(e) {
                        return e.preventDefault(), confirm("Are you sure you want to delete this graph?") && r.a.ajax({
                            method: "DELETE",
                            url: "/graphs/" + n.get("id") + ".json",
                            beforeSend: function(e) {
                                e.setRequestHeader("X-CSRF-Token", Object(r.a)('meta[name="csrf-token"]').attr("content"))
                            }
                        }).complete((function() {
                            n.get("belongsToHub") && n.get("hub") ? window.location = "/hubs/" + n.get("hub").id : window.location = "/"
                        })), !1
                    }))
                },
                X = function(e, t, n) {
                    var r = e.graphStore,
                        o = function() {
                            var e, n, r;
                            m.checked ? (g.disabled = !0, e = "100%") : (g.disabled = !1, e = g.value), v.checked ? (b.disabled = !0, n = "100%") : (b.disabled = !1, n = b.value);
                            var o = {};
                            _.checked || (o.auto = "false"), w.checked && (o.show = "Graph"), O.checked && (o.topbar = "false"), E.checked && (o.fitgraph = "true"), r = Object(s.l)(o), f.value = function(e, t, n, r) {
                                var o = a;
                                o = (o = (o = o.replace(/%url%/, window.location.origin)).replace(/%id%/, e)).replace(/%width%/g, t), o = "100%" === t ? o.replace(/%width_style%/g, "width:1px;min-width:100%") : o.replace(/%width_style%/g, "width:" + t + "px;min-width:600px;");
                                o = o.replace(/%height%/g, n), o = "100%" === n ? o.replace(/%height_style%/g, "height: 100vh;min-height:400px") : o.replace(/%height_style%/g, "height:" + n + "px;min-height:400px");
                                o = "100%" !== t || "100%" !== n ? o.replace(/%border_style%/g, "border:1px solid #DDDDDD;") : o.replace(/%border_style%/g, "");
                                return o = o.replace(/%params%/g, r || "")
                            }(t, e, n, r)
                        },
                        a = '<iframe src="%url%/graphs/%id%/embed%params%" frameborder="0" style="overflow:hidden;%border_style%%width_style%;%height_style%;" width="%width%" height="%height%" allowfullscreen></iframe>';
                    var l = c.a["graphs/embed_dialogue"]({});
                    document.body.appendChild(l.trim().toDOM());
                    var d = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_others: !1,
                            url_param: "embedgraph",
                            onCancel: n
                        }, e),
                        u = document.body.lastElementChild,
                        p = u.querySelector(".gc-dlg"),
                        f = p.querySelector(".embed-url");
                    f.addEventListener("focus", (function() {
                        this.select()
                    }), !1);
                    var h = p.querySelector(".dim-width"),
                        g = h.querySelector('input[type="number"]'),
                        m = h.querySelector("input[type=checkbox]");
                    g.addEventListener("blur", o, !1), m.addEventListener("change", o, !1);
                    var y = p.querySelector(".dim-height"),
                        b = y.querySelector('input[type="number"]'),
                        v = y.querySelector('input[type="checkbox"]');
                    b.addEventListener("blur", o, !1), v.addEventListener("change", o, !1);
                    var _ = p.querySelector('input[type="checkbox"].auto-enter');
                    _.addEventListener("change", o, !1);
                    var w = p.querySelector('input[type="checkbox"].show-card');
                    w.addEventListener("change", o, !1);
                    var O = p.querySelector('input[type="checkbox"].hide-topbar');
                    O.addEventListener("change", o, !1);
                    var E = p.querySelector('input[type="checkbox"].fit-graph');
                    E.addEventListener("change", o, !1);
                    var j = u.querySelector(".gc-dlg-cancel");
                    if (d.closeButton(j), 2 === r.get("status")) {
                        var S = function(e) {
                            t = e.share_link, o()
                        };
                        Object(i.getShareableLink)(t, (function(e) {
                            "" === e.share_link ? Object(i.createShareableLink)(t, S) : S(e)
                        }))
                    } else o();
                    return d
                },
                K = function(e, t, n, r, o) {
                    var i = e.GraphHistory,
                        l = e.dispatcher,
                        u = function() {
                            O = w(), E.innerHTML = ["Showing", _ - O, v, "out of", _].join(" ")
                        },
                        p = function(e) {
                            var t = i.getFilterManager();
                            l.emit("onBeforeFilterApplied"), e.forEach((function(e) {
                                e.add ? t.addRule(e.rule, !0) : e.remove && t.removeRule(e.rule, !0)
                            })), l.emit("onFilterApplied", e.map((function(e) {
                                return e.rule
                            }))), u()
                        },
                        f = c.a["graphs/expanded_range_filter"](r);
                    document.body.appendChild(f.trim().toDOM());
                    var h = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                Object(s.yb)("expanded-filter", null), y && y.destroy()
                            },
                            onCancel: o
                        }, e),
                        g = document.body.lastElementChild;
                    g.querySelector("button.btn-close").addEventListener("click", (function() {
                        h.close(!0)
                    }));
                    var m = g.querySelector("svg.bar-chart"),
                        y = Object(d.BarChart)(e, {
                            container: m,
                            filter: t,
                            expanded: !0,
                            onRangeChanged: function() {
                                var e, r;
                                e = y.getMin(), (r = y.getMax()) === n.max && e === n.min ? p([{
                                    remove: !0,
                                    rule: {
                                        type: t.type,
                                        id: t.id,
                                        centrality: t.centrality,
                                        prop: t.prop,
                                        max_range: !0
                                    }
                                }]) : p([{
                                    add: !0,
                                    rule: {
                                        type: t.type,
                                        id: t.id,
                                        centrality: t.centrality,
                                        prop: t.prop,
                                        range: {
                                            min: e,
                                            max: r
                                        }
                                    }
                                }])
                            }
                        }),
                        b = i.getFilterManager().getRules().filter((function(e) {
                            return e.type === t.type && e.id === t.id && Object.prototype.hasOwnProperty.call(e, "range")
                        }));
                    b.length > 0 && y.setRange(b[0].range.min, b[0].range.max);
                    var v, _, w, O, E = g.querySelector(".filtered-count");
                    if ("nt_" === t.type.substring(0, 3) ? "nt_all" === t.id ? (v = "Nodes", _ = i.getNodes().length, w = function() {
                            return i.getFilterManager().getTotalFilteredNodeCount()
                        }) : (v = i.getNodeTypeById(t.id).name, _ = i.getNodeTypeById(t.id).count, w = function() {
                            return i.getFilterManager().getFilteredNodeCountForType(t.id)
                        }) : "et_all" === t.id ? (v = "Edges", _ = i.getLinks().length, w = function() {
                            return i.getFilterManager().getTotalFilteredEdgeCount()
                        }) : (v = i.getEdgeTypeById(t.id).name, _ = i.getEdgeTypeById(t.id).count, w = function() {
                            return i.getFilterManager().getFilteredEdgeCountForType(t.id)
                        }), u(), r.type_names) {
                        var j = g.querySelector("span.all-types");
                        a.a.create(j, g.querySelector("ul.type_names"), {
                            position: "right"
                        })
                    }
                    return Object(s.yb)("expanded-filter", encodeURIComponent(JSON.stringify(t))), h
                };

            function $(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Z(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? $(Object(n), !0).forEach((function(t) {
                        J(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : $(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function J(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var Q = function(e, t) {
                var n = e.dispatcher,
                    o = e.graphStore,
                    a = e.GraphHistory,
                    d = (t = t || {}).onCancel,
                    u = t.onSubmit,
                    p = t.onSwitch,
                    f = {
                        hub_name: o.get("hub").name
                    };
                f.show_advanced = o.get("user").is_member;
                var h = c.a["graphs/explore_find_nodes"](f);
                document.body.appendChild(h.trim().toDOM());
                var g = Object(s.bb)({
                        element: document.body.lastElementChild,
                        onCancel: function() {
                            d && d.call(), a.isOnboardEnabled() && a.triggerOnboardAction("cancelled")
                        }
                    }, a),
                    m = document.body.lastElementChild,
                    y = m.querySelectorAll(".gc-dlg-node-kv")[0].querySelector("input"),
                    b = Object(s.Q)(e, null, y);
                Object(r.a)(y).typeahead(s.b, Z(Z({}, s.c), {}, {
                    name: "edgename-suggest",
                    displayKey: "name",
                    source: b.getBloodhound().ttAdapter(),
                    templates: {
                        suggestion: c.a["graphs/search_result_remote"]
                    }
                })).on("typeahead:selected", (function(t, n) {
                    g.close();
                    var r = function(t, n) {
                            (a.importHubNodesAndEdges(t, n), o.get("belongsToHub") && 1 == o.get("status")) && (t.find((function(e) {
                                return 2 === e.status
                            })) && l(e, "Private Node", "This node is private, it will be published when you save this graph."));
                            "function" === typeof u && u()
                        },
                        s = a.getNodes().map((function(e) {
                            return e.id
                        })),
                        c = [n.data],
                        d = [];
                    s.length > 0 ? Object(i.checkEdgesForNodesInHub)(o.get("hub").id, [n.data.id], s, (function(e) {
                        d = e.edges
                    }), (function(e) {
                        console.log(e), console.log("some error occurred")
                    }), (function() {
                        r(c, d)
                    })) : r(c, d)
                }));
                var v = m.querySelector(".gc-dlg-action").querySelector(".gc-dlg-cancel");
                return g.closeButton(v), m.querySelector("#btnSearchPaths").addEventListener("click", (function(e) {
                    return e.preventDefault(), g.close(), "function" == typeof p ? p("find_paths", a) : n.emit("onExplorePanelOpened", "find_paths"), !1
                })), m.querySelector("#btnAdvancedExplore").addEventListener("click", (function(e) {
                    return e.preventDefault(), g.close(), "function" == typeof p ? p("explore", a) : n.emit("onExplorePanelOpened", "explore"), !1
                })), y.focus(), g
            };

            function ee(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function te(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? ee(Object(n), !0).forEach((function(t) {
                        ne(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : ee(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function ne(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var re = function(e, t) {
                    var n = e.dispatcher,
                        o = e.graphStore,
                        a = e.GraphHistory,
                        l = (t = t || {}).init_pos,
                        d = t.onCancel,
                        u = t.onSubmit,
                        p = t.onSwitch,
                        f = {};
                    f.show_advanced = o.get("user").is_member;
                    var h = c.a["graphs/explore_find_paths_panel"](f);
                    document.body.appendChild(h.trim().toDOM());
                    var g = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                d && d.call(), a.isOnboardEnabled() && a.triggerOnboardAction("cancelled")
                            }
                        }, a),
                        m = document.body.lastElementChild,
                        y = m.querySelectorAll(".gc-dlg-node-kv"),
                        b = y[0].querySelector("input"),
                        v = Object(s.Q)(e, null, b);
                    Object(r.a)(b).typeahead(s.b, te(te({}, s.c), {}, {
                        name: "edgename-suggest",
                        displayKey: "name",
                        source: v.getBloodhound().ttAdapter(),
                        templates: {
                            suggestion: c.a["graphs/search_result_remote"]
                        }
                    })).on("typeahead:selected", (function(e, t) {
                        E = t.data, S()
                    }));
                    var _ = y[1].querySelector("input"),
                        w = Object(s.Q)(e, null, _);
                    Object(r.a)(_).typeahead(s.b, te(te({}, s.c), {}, {
                        name: "tonode-suggest",
                        displayKey: "name",
                        source: w.getBloodhound().ttAdapter(),
                        templates: {
                            suggestion: c.a["graphs/search_result_remote"]
                        }
                    })).on("typeahead:selected", (function(e, t) {
                        O = t.data, S()
                    }));
                    var O, E, j = m.querySelector(".gc-dlg-action").querySelector(".gc-dlg-cancel");
                    g.closeButton(j), m.querySelector("#btnSearchNodes").addEventListener("click", (function(e) {
                        return e.preventDefault(), g.close(), "function" == typeof p ? p("find_nodes", a) : n.emit("onExplorePanelOpened", "find_nodes"), !1
                    })), m.querySelector("#btnAdvancedExplore").addEventListener("click", (function(e) {
                        return e.preventDefault(), g.close(), "function" == typeof p ? p("explore", a) : n.emit("onExplorePanelOpened", "explore"), !1
                    }));

                    function S() {
                        O && E && Object(i.getPathsInHub)(o.get("hub").id, E.id, O.id, (function(t) {
                            t.paths && 0 !== t.paths.length ? (! function(e, t) {
                                var n;
                                for (n in e) Object.prototype.hasOwnProperty.call(e, n) && a.importHubNode(e[n], l);
                                for (n in t) Object.prototype.hasOwnProperty.call(t, n) && a.importHubEdge(t[n]);
                                E = null, O = null
                            }(t.nodes, t.edges), g.close(), "function" === typeof u && u()) : (g.close(), C(e, "No Paths Found", "We couldn't find a path between these two nodes.<br/>Do you want to add them to the graph as two isolated nodes?", (function() {
                                a.importHubNode(E), a.importHubNode(O), E = null, O = null, "function" === typeof u && u()
                            }), (function() {
                                E = null, O = null
                            }), null, null, "ADD"))
                        }), (function(e) {
                            console.dir(e), "function" === typeof u && u()
                        }))
                    }
                    return b.focus(), g
                },
                oe = function(e, t, n) {
                    var r = e.graphStore,
                        o = {
                            id: t,
                            updated_at: k()(r.get("updatedAt")).fromNow(),
                            license: r.get("license"),
                            users: r.get("users")
                        };
                    switch (o.license.type = "Creative Commons " + (o.license.cc_by ? "Attribution" : "") + (o.license.cc_nc ? "-NonCommercial" : "") + (o.license.cc_sa ? "-ShareAlike" : "") + (o.license.cc_nd ? "-NoDerivatives" : "") + " 4.0 International", o.license.type_short = "Creative Commons " + (o.license.cc_by ? "BY" : "") + (o.license.cc_nc ? "-NC" : "") + (o.license.cc_sa ? "-SA" : "") + (o.license.cc_nd ? "-ND" : "") + " 4.0 International", o.license.link = "http://creativecommons.org/licenses/by" + (o.license.cc_nc ? "-nc" : "") + (o.license.cc_sa ? "-sa" : "") + (o.license.cc_nd ? "-nd" : "") + "/4.0/", r.get("status")) {
                        case 0:
                            o.status = "Work in progress", o.show_warning = !0;
                            break;
                        case 2:
                            o.status = "Private", o.show_warning = !0
                    }
                    var a = c.a["graphs/export_dialogue"](o);
                    document.body.appendChild(a.trim().toDOM());
                    var i = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: "export",
                            onCancel: n
                        }, e),
                        l = document.body.lastElementChild.querySelector(".gc-btn-confirm");
                    return i.closeButton(l), i
                };

            function ae(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function ie(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? ae(Object(n), !0).forEach((function(t) {
                        se(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : ae(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function se(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var ce = function(e, t, n) {
                    var o = e.graphStore,
                        a = e.GraphHistory,
                        i = "Degree Centrality",
                        d = "Betweenness Centrality",
                        u = {
                            degree: i,
                            betweenness: d
                        },
                        p = function(e, t) {
                            var n;
                            if (e)
                                for (n = e.length - 1; n >= 0; n -= 1)
                                    if (e[n].name === t) return e[n]
                        },
                        f = function(e, t) {
                            var n = e.data("ttTypeahead");
                            n && n._onQueryChanged(null, t)
                        },
                        h = function(e, t) {
                            return e[t.id]
                        },
                        m = function(e) {
                            var t = {},
                                n = !1;
                            if ("nt" === e.type || "et" === e.type) t.allTypes = !0, "nt" === e.type ? (t.type = "All Node Types", t.count = Object(s.k)(a.getNodes().length, "node", "nodes", "{quantity} {item}"), t.prop = "Node Type", t.range = Object(s.k)(j.length, "Type", "Types"), t.allTypes = !0) : (t.type = "All Vector Orders", t.count = Object(s.k)(a.getLinks().length, "edge", "edges", "{quantity} {item}"), t.prop = "Edge Type", t.range = Object(s.k)(S.length, "Type", "Types"));
                            else {
                                var r = h(C, e);
                                if (function(e, t) {
                                        if (!e) return !1;
                                        var n = !1;
                                        switch (t.type) {
                                            case "nt":
                                                if ("nt_all" === t.id) return !0;
                                                break;
                                            case "et":
                                                "et_all" === t.id && (n = !0);
                                                break;
                                            case "nt_centrality":
                                                "degree" !== t.centrality && "betweenness" !== t.centrality || (n = !0);
                                                break;
                                            case "et_weight":
                                                e.isNodeType || (n = !0);
                                                break;
                                            case "nt_prop":
                                            case "et_prop":
                                                Object.prototype.hasOwnProperty.call(e.properties, t.prop) && (n = !0)
                                        }
                                        return n
                                    }(r, e)) switch (t.type = r.name, t.color = r.color, r.isNodeType ? t.count = Object(s.k)(r.count, "node", "nodes", "{quantity} {item}") : t.count = Object(s.k)(r.count, "edge", "edges", "{quantity} {item}"), e.type) {
                                    case "nt_centrality":
                                        t.range = r[e.centrality].msg, t.prop = u[e.centrality];
                                        break;
                                    case "et_weight":
                                        t.range = r.weight.msg, t.prop = "Weight", "et_all" === e.id && (t.allTypes = !0);
                                        break;
                                    case "nt_prop":
                                    case "et_prop":
                                        t.range = r.properties[e.prop].msg, t.prop = e.prop;
                                        break;
                                    default:
                                        n = !0
                                } else n = !0
                            }
                            if (!n) {
                                var o = c.a["graphs/filter_composition_list_li"](t).trim().toDOM();
                                D.appendChild(o);
                                var i = D.lastElementChild;
                                i.querySelector("button").addEventListener("click", (function() {
                                    ! function(e) {
                                        var t, n = D.querySelectorAll("li");
                                        for (t = 0; t < n.length && n[t] !== e; t += 1);
                                        D.removeChild(e), N.splice(t, 1)
                                    }(i)
                                }))
                            }
                        },
                        y = function() {
                            var t = x.typeahead("val").trim(),
                                n = k.typeahead("val").trim(),
                                r = {};
                            if ("All Node Types" === t) switch (n) {
                                case "Type":
                                    r = {
                                        type: "nt",
                                        id: "nt_all"
                                    };
                                    break;
                                case "Degree Centrality":
                                    r = {
                                        type: "nt_centrality",
                                        centrality: "degree",
                                        id: "nt_all"
                                    };
                                    break;
                                case "Betweenness Centrality":
                                    r = {
                                        type: "nt_centrality",
                                        centrality: "betweenness",
                                        id: "nt_all"
                                    };
                                    break;
                                default:
                                    for (var o in C.nt_all.properties)
                                        if (n === o) {
                                            r = {
                                                type: "nt_prop",
                                                id: "nt_all",
                                                prop: o
                                            };
                                            break
                                        }
                            } else if ("All Vector Orders" === t) switch (n) {
                                case "Weight":
                                    r = {
                                        type: "et_weight",
                                        id: "et_all"
                                    };
                                    break;
                                case "Type":
                                    r = {
                                        type: "et",
                                        id: "et_all"
                                    };
                                    break;
                                default:
                                    for (var a in C.et_all.properties)
                                        if (n === a) {
                                            r = {
                                                type: "et_prop",
                                                id: "et_all",
                                                prop: a
                                            };
                                            break
                                        }
                            } else {
                                var s = function(e) {
                                    var t;
                                    for (t = j.length - 1; t >= 0; t -= 1)
                                        if (j[t].name === e.trim()) return j[t].id;
                                    for (t = S.length - 1; t >= 0; t -= 1)
                                        if (S[t].name === e.trim()) return S[t].id
                                }(t);
                                if (C[s].isNodeType) switch (n) {
                                    case i:
                                        r = {
                                            type: "nt_centrality",
                                            id: s,
                                            centrality: "degree"
                                        };
                                        break;
                                    case d:
                                        r = {
                                            type: "nt_centrality",
                                            id: s,
                                            centrality: "betweenness"
                                        };
                                        break;
                                    default:
                                        r = {
                                            type: "nt_prop",
                                            id: s,
                                            prop: n
                                        }
                                } else switch (n) {
                                    case "Weight":
                                        r = {
                                            type: "et_weight",
                                            id: s
                                        };
                                        break;
                                    default:
                                        r = {
                                            type: "et_prop",
                                            id: s,
                                            prop: n
                                        }
                                }
                            }
                            if (("nt_prop" === r.type || "et_prop" === r.type) && "empty" === h(C, r).properties[r.prop].type) return b(), void l(e, "No Values", "This filter does not contain any values");
                            ! function(e) {
                                var t, n;
                                for (t = N.length - 1; t >= 0; t -= 1)
                                    if ((n = N[t]).type === e.type && n.id === e.id) {
                                        if (Object.prototype.hasOwnProperty.call(n, "centrality") && n.centrality === e.centrality) return !0;
                                        if (Object.prototype.hasOwnProperty.call(n, "prop") && n.prop === e.prop) return !0
                                    }
                                return !1
                            }(r) ? (m(r), N.push(r), b()) : b()
                        };

                    function b() {
                        x.typeahead("val", ""), k.typeahead("val", ""), k.prop("placeholder", "PROPERTIES")
                    }
                    var v = function(e, t) {
                            var n;
                            if (Array.isArray(e)) {
                                var r = e.filter((function(e) {
                                        return !e.metric
                                    })).length,
                                    o = e.length - r,
                                    a = [];
                                r > 0 && a.push(r + " Properties"), a.push(o + " Metrics"), n = a.join(", ")
                            } else n = e;
                            k.typeahead("val", ""), k.attr("placeholder", n), k.prop("disabled", t)
                        },
                        _ = function() {
                            var e = x.typeahead("val").trim();
                            if ("" === e) return L = [], void v("PROPERTIES", !0);
                            if ("All Node Types" === e) {
                                for (var t in (L = []).push({
                                        name: "Type"
                                    }), L.push({
                                        name: "Degree Centrality",
                                        metric: !0
                                    }), L.push({
                                        name: "Betweenness Centrality",
                                        metric: !0
                                    }), C.nt_all.properties) L.push({
                                    name: t
                                });
                                v(L, !1)
                            } else if ("All Vector Orders" === e) {
                                for (var n in (L = []).push({
                                        name: "Type"
                                    }), L.push({
                                        name: "Weight",
                                        metric: !0
                                    }), C.et_all.properties) L.push({
                                    name: n
                                });
                                v(L, !1)
                            } else {
                                var r = p(j, e);
                                if (r)(L = r.properties ? r.properties.map((function(e) {
                                    return {
                                        name: e.name
                                    }
                                })) : []).push({
                                    name: "Betweenness Centrality",
                                    metric: !0
                                }), L.push({
                                    name: "Degree Centrality",
                                    metric: !0
                                }), v(L, !1);
                                else {
                                    var o = p(S, e);
                                    o ? ((L = o.properties ? o.properties.map((function(e) {
                                        return {
                                            name: e.name
                                        }
                                    })) : []).push({
                                        name: "Weight",
                                        metric: !0
                                    }), v(L, !1)) : (L = [], v("PROPERTIES", !0))
                                }
                            }
                        },
                        w = c.a["graphs/filter_composition_panel"]({});
                    document.body.appendChild(w.trim().toDOM());
                    var O = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: n,
                            close_actions: function() {
                                x.removeData().typeahead("destroy"), k.removeData().typeahead("destroy")
                            }
                        }, e),
                        E = document.body.lastElementChild,
                        j = a.getNodeTypes(),
                        S = a.getEdgeTypes();
                    o.get("isHubGraph") && (j = j.filter((function(e) {
                        return e.count > 0
                    })), S = S.filter((function(e) {
                        return e.count > 0
                    })));
                    var x, k, C = Object(s.j)(e),
                        N = [].slice.call(o.get("filters"), []),
                        T = Object(s.v)(j, S),
                        L = [],
                        P = E.querySelector("input#type-selector"),
                        A = E.querySelector("input#property-selector"),
                        D = E.querySelector("ul#filter-list"),
                        M = E.querySelector(".gc-pnl-action"),
                        q = M.querySelector(".gc-dlg-submit"),
                        I = M.querySelector(".gc-dlg-cancel");
                    return function() {
                        (x = Object(r.a)(P)).typeahead(ie(ie({}, s.b), {}, {
                            autoselect: !0
                        }), ie(ie({}, s.c), {}, {
                            name: "types",
                            displayKey: "name",
                            source: function(e, t) {
                                var n, r = [],
                                    o = new RegExp(e, "i");
                                for (n = 0; n < T.length; n += 1) o.test(T[n].name) && r.push(T[n]);
                                t(r)
                            },
                            templates: {
                                suggestion: c.a["graphs/node_edge_type_typeahead_suggestion"]
                            }
                        })).on("typeahead:selected", (function() {
                            _(), k.is(":disabled") || k.focus()
                        })), x.on("focus", (function() {
                            x.typeahead("val", ""), f(x, "")
                        })), x.on("blur", (function() {
                            _()
                        }));
                        var e = [Object(s.k)(j.length, "NODE TYPE", "NODE TYPES")];
                        S.length > 0 && e.push(Object(s.k)(S.length, "EDGE TYPE", "EDGE TYPES")), x.attr("placeholder", e.join(", "))
                    }(), (k = Object(r.a)(A)).typeahead(ie(ie({}, s.b), {}, {
                        autoselect: !0
                    }), ie(ie({}, s.c), {}, {
                        name: "props",
                        displayKey: "name",
                        source: function(e, t) {
                            var n = [],
                                r = new RegExp(e, "i");
                            L.filter((function(e) {
                                return !e.metric
                            })).forEach((function(e) {
                                r.test(e.name) && n.push(e)
                            })), t(n)
                        },
                        templates: {
                            header: '<h5 class="tt-header">Properties</h5>'
                        }
                    }), ie(ie({}, s.c), {}, {
                        name: "metric",
                        displayKey: "name",
                        source: function(e, t) {
                            var n = [],
                                r = new RegExp(e, "i");
                            L.filter((function(e) {
                                return e.metric
                            })).forEach((function(e) {
                                r.test(e.name) && n.push(e)
                            })), t(n)
                        },
                        templates: {
                            header: '<h5 class="tt-header">Network Metrics</h5>'
                        }
                    })).on("typeahead:selected", (function() {
                        y()
                    })), k.on("focus", (function() {
                        k.typeahead("val", ""), f(k, "")
                    })), q.addEventListener("click", (function() {
                        t && t.call(null, N), O.close()
                    })), O.closeButton(I), N.forEach((function(e) {
                        m(e)
                    })), g.a.create(D, {
                        onUpdate: function(e) {
                            var t, n, r;
                            t = e.oldIndex, n = e.newIndex, r = N.splice(t, 1), N.splice(n, 0, r[0])
                        }
                    }), O.ext = {}, O.ext.getCurrentFilters = function() {
                        return N
                    }, O.ext.isFilterValid = function() {}, O
                },
                le = function(e, t, n) {
                    var r = function() {
                            if (n) {
                                var e = {
                                    linLogMode: f.checked,
                                    outboundAttractionDistribution: h.checked,
                                    adjustSizes: g.checked,
                                    edgeWeightInfluence: parseFloat(m.value),
                                    scalingRatio: parseFloat(y.value),
                                    strongGravityMode: b.checked,
                                    gravity: parseFloat(v.value),
                                    slowDown: parseFloat(_.value),
                                    barnesHutOptimize: w.checked,
                                    barnesHutTheta: parseFloat(O.value),
                                    startingIterations: parseInt(E.value),
                                    iterationsPerRender: parseInt(j.value),
                                    stableThreshold: parseFloat(S.value)
                                };
                                n.call(null, e), l.close()
                            }
                        },
                        o = function(e) {
                            13 === e.keyCode && r()
                        },
                        i = c.a["graphs/force_atlas2_settings_panel"](t);
                    document.body.appendChild(i.trim().toDOM());
                    var l = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        d = document.body.lastElementChild,
                        u = d.querySelector(".gc-btn-confirm"),
                        p = d.querySelector(".gc-dlg-cancel");
                    l.closeButton(p);
                    var f = d.querySelector("#linLogMode"),
                        h = d.querySelector("#outboundAttractionDistribution"),
                        g = d.querySelector("#adjustSizes"),
                        m = d.querySelector("#edgeWeightInfluence"),
                        y = d.querySelector("#scalingRatio"),
                        b = d.querySelector("#strongGravityMode"),
                        v = d.querySelector("#gravity"),
                        _ = d.querySelector("#slowDown"),
                        w = d.querySelector("#barnesHutOptimize"),
                        O = d.querySelector("#barnesHutTheta"),
                        E = d.querySelector("#startingIterations"),
                        j = d.querySelector("#iterationsPerRender"),
                        S = d.querySelector("#stableThreshold");
                    f.addEventListener("keydown", o, !1), h.addEventListener("keydown", o, !1), g.addEventListener("keydown", o, !1), m.addEventListener("keydown", o, !1), y.addEventListener("keydown", o, !1), b.addEventListener("keydown", o, !1), v.addEventListener("keydown", o, !1), _.addEventListener("keydown", o, !1), w.addEventListener("keydown", o, !1), O.addEventListener("keydown", o, !1), E.addEventListener("keydown", o, !1), j.addEventListener("keydown", o, !1), S.addEventListener("keydown", o, !1), u.addEventListener("click", (function() {
                        r()
                    }));
                    for (var x = d.querySelectorAll("ul.layout-settings label"), k = 0; k < x.length; k += 1) a.a.create(x[k], {
                        position: "left",
                        size: "large",
                        maxWidth: 200,
                        hideOnClickOutside: !0
                    });
                    return l
                },
                de = function(e, t, n) {
                    var r = function() {
                            if (n) {
                                var e = {
                                    springLength: parseFloat(f.value),
                                    springCoeff: parseFloat(h.value),
                                    gravity: parseFloat(g.value),
                                    theta: parseFloat(m.value),
                                    dragCoeff: parseFloat(y.value),
                                    timeStep: parseFloat(b.value),
                                    stableThreshold: parseFloat(v.value)
                                };
                                n.call(null, e), l.close()
                            }
                        },
                        o = function(e) {
                            13 === e.keyCode && r()
                        },
                        i = c.a["graphs/force_directed_settings_panel"](t);
                    document.body.appendChild(i.trim().toDOM());
                    var l = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        d = document.body.lastElementChild,
                        u = d.querySelector(".gc-btn-confirm"),
                        p = d.querySelector(".gc-dlg-cancel");
                    l.closeButton(p);
                    var f = d.querySelector("#springLength"),
                        h = d.querySelector("#springCoeff"),
                        g = d.querySelector("#gravity"),
                        m = d.querySelector("#theta"),
                        y = d.querySelector("#dragCoeff"),
                        b = d.querySelector("#timeStep"),
                        v = d.querySelector("#stableThreshold");
                    f.addEventListener("keydown", o, !1), h.addEventListener("keydown", o, !1), g.addEventListener("keydown", o, !1), m.addEventListener("keydown", o, !1), y.addEventListener("keydown", o, !1), b.addEventListener("keydown", o, !1), v.addEventListener("keydown", o, !1), u.addEventListener("click", (function() {
                        r()
                    }));
                    for (var _ = d.querySelectorAll("ul.layout-settings label"), w = 0; w < _.length; w += 1) a.a.create(_[w], {
                        position: "left",
                        size: "large",
                        maxWidth: 200,
                        hideOnClickOutside: !0
                    });
                    return l
                },
                ue = function(e, t, n) {
                    var r = c.a["graphs/clustering_resolution"]({
                        resolution: t || 1
                    });
                    document.body.appendChild(r.trim().toDOM());
                    var o = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        a = document.body.lastElementChild,
                        i = a.querySelector("#txtClusteringResolution");
                    i.addEventListener("keyup", (function() {
                        var e = Number(i.value.trim());
                        isNaN(e) || e < 0 ? l.disabled = !0 : l.disabled = !1
                    }));
                    var l = a.querySelector(".gc-btn-confirm");
                    return l.addEventListener("click", (function(e) {
                        return e.preventDefault(), o.close(), n(Number(i.value.trim())), !1
                    })), o
                },
                pe = function(e, t) {
                    e.uiStore, e.graphStore;
                    var n = t || {};
                    n.focus = n.focus || "videos";
                    var o = c.a["graphs/help_panel"]({
                        active_videos: "videos" === n.focus,
                        active_shortcuts: "shortcuts" === n.focus
                    });
                    document.body.appendChild(o.trim().toDOM());
                    var a, i = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: "shortcuts",
                            close_others: !0
                        }, e),
                        l = document.body.lastElementChild,
                        d = document.getElementById("videos"),
                        u = document.getElementById("shortcuts");
                    ! function() {
                        var e = {
                                initial_video_id: "SXvD2gzXE4Q",
                                videos: [{
                                    id: "SXvD2gzXE4Q",
                                    thumbnail: "https://i.ytimg.com/vi/SXvD2gzXE4Q/hqdefault.jpg",
                                    duration: "1:59",
                                    title: "Introduction to OntoGraph"
                                }]
                            },
                            t = c.a["graphs/video_tutorials"](e);
                        d.appendChild(t.trim().toDOM());
                        var n = Object(r.a)(".gc-pnl"),
                            o = Object(r.a)(".gc-pnl-body"),
                            a = Object(r.a)("#video-player");
                        n.fitVids(), Object(r.a)("ul.video-grid li a").on("click", (function(e) {
                            e.preventDefault();
                            var t = "<iframe src='https://player.vimeo.com/video/" + this.getAttribute("id") + "?color=ffffff&title=0&byline=0&portrait=0&autoplay=1' width='720' height='378' frameborder='0' webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>";
                            a.html(t), o.animate({
                                scrollTop: 0
                            }, "slow"), n.fitVids()
                        }))
                    }(), a = c.a["graphs/shortcuts_panel"](), u.appendChild(a.trim().toDOM()), Object(r.a)(l).foundation({
                        tab: {
                            callback: function() {}
                        }
                    });
                    var p = l.querySelector(".gc-dlg-cancel");
                    return i.closeButton(p), i
                },
                fe = function(e, t, n) {
                    var r = c.a["graphs/graph_create"]({});
                    document.body.appendChild(r.trim().toDOM());
                    var o = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        a = document.body.lastElementChild,
                        l = a.querySelector(".gc-dlg"),
                        d = a.querySelector(".gc-dlg-action"),
                        u = d.querySelector(".gc-dlg-cancel");
                    o.closeButton(u);
                    var p = d.querySelector(".gc-btn-confirm");
                    p.addEventListener("click", (function(e) {
                        e.preventDefault(), o.close();
                        var t = l.querySelector('input[name="selected_hub"]:checked').value;
                        return 0 != t ? Object(i.createGraph)(t) : Object(i.createGraph)(), !1
                    }), !1), d.querySelector(".gc-dlg-error").classList.add("not-shown"), p.firstChild.data = "Working...", p.disabled = !0, u.disabled = !0;
                    var f = l.querySelector(".wait"),
                        h = l.querySelector(".hub-list");
                    Object(i.getUserHubs)(t, (function(e) {
                        if (h.classList.remove("not-shown"), f.classList.add("not-shown"), Array.isArray(e))
                            for (var t = 0; t < e.length; t += 1) {
                                e[t].checked = e[t].id === n;
                                var r = c.a["graphs/hub_option"](e[t]);
                                h.appendChild(r.trim().toDOM())
                            }
                        p.firstChild.data = "Create", p.disabled = !1, u.disabled = !1
                    }), (function(e) {
                        console.dir(e)
                    }))
                },
                he = function(e, t, n) {
                    var r = c.a["hubs/hub_panel"]({
                        name: t.name,
                        subtitle: t.subtitle,
                        description: t.description,
                        image: t.image,
                        image_path: t.image.path,
                        created_at: k()(t.created_at).format("MMMM YYYY"),
                        website: t.website,
                        email: t.email,
                        node_types: t.node_types
                    });
                    document.body.appendChild(r.trim().toDOM());
                    var o = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: "about",
                            onCancel: n
                        }, e),
                        a = document.body.lastElementChild;
                    Array.from(a.querySelectorAll(".linkify")).forEach((function(e) {
                        Object(s.ab)(e)
                    }));
                    var i = a.querySelector(".gc-dlg-cancel");
                    o.closeButton(i);
                    var l = a.querySelector(".fitted-bg-image");
                    return l && l.addEventListener("click", (function() {
                        o.close()
                    })), o
                },
                ge = function(e, t, n) {
                    var r = e.GraphHistory.getFilterManager();
                    r.calculateCentralities();
                    var o, a = Object(s.j)(e);
                    switch (n.type) {
                        case "et_weight":
                            var i = a[n.id];
                            o = {
                                filteredPropName: "Weight",
                                filteredTypeName: i.name,
                                color: i.color,
                                count: i.count,
                                all_types: "et_all" === n.id
                            };
                            break;
                        case "nt_centrality":
                            var c = a[n.id];
                            o = {
                                filteredPropName: {
                                    degree: "Degree Centrality",
                                    betweenness: "Betweenness Centrality"
                                }[n.centrality],
                                filteredTypeName: c.name,
                                color: c.color,
                                count: c.count
                            };
                            break;
                        case "et_prop":
                        case "nt_prop":
                            var l = a[n.id],
                                d = l.properties[n.prop];
                            "range" === d.type && (o = {
                                filteredPropName: n.prop,
                                filteredTypeName: l.name,
                                color: l.color,
                                count: l.count,
                                type_names: d.type_list
                            })
                    }
                    if (o) {
                        var u = K(e, n, {}, o, (function() {
                            r.setActiveExpandedFilter(null), t.requestBar("filters")
                        }));
                        r.setActiveExpandedFilter(u)
                    }
                },
                me = "site/loaders/loader_three_points",
                ye = "site/loaders/loader_pulsing_circle",
                be = function(e, t) {
                    var n = t || {},
                        r = t.type;
                    r && c.a[r] || (r = ye);
                    var o = c.a[r]({
                        text: n.text
                    });
                    document.body.appendChild(o.trim().toDOM());
                    var a = document.body.lastElementChild,
                        i = Object(s.bb)({
                            element: a
                        }, e);
                    return n.fn && setTimeout((function() {
                        n.fn.call(null, (function() {
                            i.close()
                        }))
                    }), 40), i
                },
                ve = function(e, t, n) {
                    return be(e, {
                        fn: n,
                        text: t,
                        type: ye
                    })
                },
                _e = function(e, t, n) {
                    return be(e, {
                        fn: n,
                        text: t,
                        type: me
                    })
                };

            function we(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Oe(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? we(Object(n), !0).forEach((function(t) {
                        Ee(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : we(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function Ee(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var je = function(e, t, n, o, i, l) {
                    var d = e.graphStore,
                        u = e.GraphHistory,
                        p = d.get("belongsToHub") && d.get("user").is_admin,
                        f = function(e) {
                            13 !== e.keyCode || G.disabled || h()
                        };

                    function h() {
                        var e = A.value.trim(),
                            t = D.value.trim(),
                            n = B.checked;
                        if (e) {
                            if (d.get("belongsToHub") && !d.get("user").is_admin && v.indexOf(e) < 0) return alert("Select a valid Vector name"), A.value = "", void A.focus();
                            G.disabled = !0, G.firstChild.data = "Working...", H.disabled = !0, i ? setTimeout((function() {
                                i(e, t, n, (function() {
                                    k.close()
                                }))
                            }), 50) : k.close()
                        }
                    }

                    function g() {
                        var e = A.value.trim(),
                            t = D.value.trim();
                        G.disabled = !(e && t)
                    }

                    function m() {
                        var e = A.value.trim();
                        R.style.display = v.indexOf(e) < 0 ? "block" : "none"
                    }
                    for (var y, b = function() {
                            if (p) {
                                var e = A.value.trim();
                                e.length > 0 && v.indexOf(e) < 0 ? q.classList.remove("not-shown") : q.classList.add("not-shown")
                            }
                        }, v = u.getEdgeTypeNames(), _ = u.getNodeTypes(), w = 0; w < _.length; w += 1)
                        if (_[w].id === t.data.type_id) {
                            y = _[w];
                            break
                        }
                    for (var O = {
                            source: {
                                name: t.data.name,
                                type_char: t.data.type.substr(0, 1).toUpperCase(),
                                color: y.color
                            },
                            targets: [],
                            hub_admin: p
                        }, E = 0; E < n.length; E += 1) {
                        for (var j = void 0, S = 0; S < _.length; S += 1)
                            if (_[S].id === n[E].data.type_id) {
                                j = _[S];
                                break
                            }
                        O.targets.push({
                            name: n[E].data.name,
                            type_char: n[E].data.type.substr(0, 1).toUpperCase(),
                            color: j.color
                        })
                    }
                    var x = c.a["graphs/edge_dialogue"](O);
                    document.body.appendChild(x.trim().toDOM());
                    var k = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                A.removeEventListener("keyup", m, !1), A.removeEventListener("keyup", g, !1), D.removeEventListener("keydown", g, !1), Object(r.a)(".tpd-tooltip").css("display", "none")
                            },
                            onCancel: function() {
                                l && l.call()
                            }
                        }, e),
                        C = document.body.lastElementChild,
                        N = C.querySelector(".gc-dlg");
                    Array.from(N.querySelectorAll(".tip")).forEach((function(e) {
                        a.a.create(e, {
                            position: "bottom",
                            size: "large",
                            hideOnClickOutside: !0
                        })
                    })), a.a.create(N.querySelector(".weight-tip"), {
                        position: "top",
                        size: "large",
                        hideOnClickOutside: !0
                    });
                    var T = document.createElement("div");
                    T.className = "gc-dlg", C.appendChild(T);
                    var L = C.querySelector(".gc-edge-rel"),
                        P = L.querySelectorAll("input"),
                        A = P[0],
                        D = P[1];
                    A.addEventListener("keyup", m, !1), A.addEventListener("keydown", g, !1), A.addEventListener("keydown", f, !1);
                    var M, q, I = Object(r.a)(A);
                    I.typeahead(s.b, Oe(Oe({}, s.c), {}, {
                        name: "edgetype-suggest",
                        displayKey: "name",
                        source: (M = v, function(e, t) {
                            var n, r = [],
                                o = new RegExp(e, "i");
                            for (n = 0; n < M.length; n += 1) o.test(M[n]) && r.push({
                                name: M[n]
                            });
                            t(r)
                        })
                    })).on("typeahead:selected", (function() {
                        b(), g(), D.focus()
                    })), I.focus((function() {
                        I.typeahead("val", "a"), I.typeahead("val", ""), I.typeahead("open"), b()
                    })), p && (q = C.querySelector(".gc-dlg-typewarning "), A.addEventListener("keyup", b, !1)), L.querySelector(".twitter-typeahead").style.display = "inline", D.addEventListener("keydown", (function() {
                        setTimeout((function() {
                            g()
                        }), 100)
                    }), !1), D.addEventListener("keydown", f, !1), D.addEventListener("focus", g, !1);
                    var R = C.querySelector(".gc-edge-rel-directed"),
                        B = R.querySelector("input");
                    B.addEventListener("keydown", f, !1);
                    var F = C.querySelector(".gc-dlg-action"),
                        G = F.querySelector(".gc-btn-confirm");
                    G.addEventListener("click", h, !1);
                    var H = F.querySelector(".gc-dlg-cancel");
                    k.closeButton(H), o ? (A.value = o, Object(r.a)(A).typeahead("val", o), D.focus()) : A.focus(), g(), u.isOnboardEnabled() && (A.addEventListener("keyup", (function() {
                        A.value.trim().length > 0 && u.triggerOnboardAction("edge_name_entered", {
                            target: B,
                            value: A.value.trim()
                        })
                    })), u.triggerOnboardAction("add_edge_dialogue_opened", {
                        target: A,
                        to_count: n.length
                    }), B.addEventListener("change", (function() {
                        B.checked && u.triggerOnboardAction("edge_direction_selected", {
                            target: G
                        })
                    })), u.getLinks().length > 0 && (I.typeahead("val", "a"), I.typeahead("val", ""), I.typeahead("open"), A.focus()))
                },
                Se = function(e, t, n) {
                    var r = function() {
                        var e = u.value.trim();
                        e && (l.close(), t && t(e))
                    };

                    function o(e) {
                        13 === e.keyCode && r()
                    }

                    function a() {
                        f.disabled = !u.value.trim()
                    }
                    var i = c.a["graphs/edgetype_dialogue"]({});
                    document.body.appendChild(i.trim().toDOM());
                    var l = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                u.removeEventListener("keydown", a, !1), u.removeEventListener("keydown", o, !1)
                            },
                            onCancel: function() {
                                n && n.call()
                            }
                        }, e),
                        d = document.body.lastElementChild,
                        u = d.querySelector(".gc-dlg-body").querySelector("input");
                    u.addEventListener("keyup", a, !1), u.addEventListener("keydown", o, !1);
                    var p = d.querySelector(".gc-dlg-action"),
                        f = p.querySelector(".gc-btn-confirm");
                    f.addEventListener("click", r, !1);
                    var h = p.querySelector(".gc-dlg-cancel");
                    l.closeButton(h), u.focus()
                },
                xe = n(21),
                ke = function(e, t, n, r) {
                    var o = e.graphStore,
                        a = e.GraphHistory,
                        i = {
                            msg: t,
                            hub_name: (o.get("hub") || {}).name
                        };
                    if (a && o.get("belongsToHub")) i.select_private = !0, i.show_upgrade = !1;
                    else if (xe.a && "function" === typeof xe.a.getUser) {
                        var l = xe.a.getUser();
                        l && l.id && (i.show_upgrade = "Free" == l.plan)
                    }
                    var d = function() {
                        O.classList.add("not-shown"), y.firstChild.data = "Working...", y.disabled = !0, w.disabled = !0, E.disabled = !0, f.setWorking(!0);
                        n && n.call(null, E.value, parseInt(function() {
                            if (b.checked) return b.value;
                            if (v.checked) return v.value;
                            if (_.checked) return _.value
                        }()), (function() {
                            u()
                        }))
                    };

                    function u() {
                        y.firstChild.data = "SAVE", y.disabled = !1, w.disabled = !1, E.disabled = !1, f.setWorking(!1)
                    }
                    var p = c.a["hubs/save_as_new_graph_dialog"](i);
                    document.body.appendChild(p.trim().toDOM());
                    var f = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                r && r.call()
                            }
                        }, e),
                        h = document.body.lastElementChild,
                        g = h.querySelector(".gc-dlg"),
                        m = h.querySelector(".gc-dlg-action"),
                        y = m.querySelector(".gc-btn-confirm");
                    y.disabled = !1, y.addEventListener("click", d, !1);
                    var b = h.querySelector("#graph_status_0"),
                        v = h.querySelector("#graph_status_1"),
                        _ = h.querySelector("#graph_status_2"),
                        w = m.querySelector(".gc-dlg-cancel");
                    f.closeButton(w);
                    var O = m.querySelector(".gc-dlg-error"),
                        E = g.querySelector("#graph_name");
                    return E.addEventListener("keydown", (function(e) {
                        if (13 == e.keyCode) return e.preventDefault(), d(), !1
                    }), !1), E.focus(), f.ext = {
                        revert: u
                    }, f
                };

            function Ce(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Ne(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Ce(Object(n), !0).forEach((function(t) {
                        Te(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Ce(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function Te(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var Le = function(e, t, n, o, a, i, d) {
                    var u = e.uiStore,
                        p = e.graphStore,
                        f = e.GraphHistory,
                        h = function() {
                            if (!u.get("isOnlyExploreAllowed")) {
                                var e = S.value.trim(),
                                    t = C.value.trim();
                                if (e && t) {
                                    if (p.get("belongsToHub") && !p.get("user").is_admin && n.indexOf(e) < 0) return alert("Select a valid node type"), S.value = "", void S.focus();
                                    i ? setTimeout((function() {
                                        i(e, t, (function() {
                                            _.close()
                                        }))
                                    }), 50) : _.close(), P.firstChild.data = "Working...", P.disabled = !0, A.disabled = !0
                                }
                            }
                        };

                    function g(e) {
                        13 === e.keyCode && (v || h())
                    }

                    function m(e) {
                        if (!u.get("isOnlyExploreAllowed") && (!e || 13 !== e.keyCode)) {
                            var t = S.value.trim(),
                                n = C.value.trim();
                            P.disabled = !(t && n)
                        }
                    }
                    var y = {
                            hub_admin: p.get("belongsToHub") && p.get("user").is_admin
                        },
                        b = c.a["graphs/node_dialogue"](y);
                    document.body.appendChild(b.trim().toDOM());
                    var v = !1,
                        _ = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                S.removeEventListener("keydown", m, !1), C.removeEventListener("keydown", m, !1), C.removeEventListener("keydown", g, !1)
                            },
                            onCancel: function() {
                                d && d.call(), f.isOnboardEnabled() && f.triggerOnboardAction("cancelled")
                            }
                        }, f),
                        w = document.body.lastElementChild,
                        O = w.querySelectorAll(".gc-dlg-node-kv");
                    if (2 == O.length) {
                        var E = O[0],
                            j = O[1],
                            S = E.querySelector("input");
                        S.addEventListener("keyup", m, !1), o && (S.value = o);
                        var x, k, C = j.querySelector("input"),
                            N = Object(r.a)(S);
                        if (N.typeahead(s.b, Ne(Ne({}, s.c), {}, {
                                name: "nodetype-suggest",
                                displayKey: "name",
                                source: (x = n, function(e, t) {
                                    var n, r = [],
                                        o = new RegExp(e, "i");
                                    for (n = 0; n < x.length; n += 1) o.test(x[n]) && r.push({
                                        name: x[n]
                                    });
                                    t(r)
                                })
                            })).on("typeahead:selected", (function() {
                                C.focus()
                            })), N.focus((function() {
                                N.typeahead("val", "a"), N.typeahead("val", ""), N.typeahead("open")
                            })), p.get("belongsToHub") && p.get("user").is_admin && (k = w.querySelector(".gc-dlg-typewarning "), S.addEventListener("keyup", (function() {
                                var e = S.value.trim();
                                n.indexOf(e) < 0 ? k.classList.remove("not-shown") : k.classList.add("not-shown")
                            }), !1)), !f.isOnboardEnabled()) {
                            var T = Object(s.Q)(e, S, C);
                            Object(r.a)(C).typeahead(s.b, Ne(Ne({}, s.c), {}, {
                                name: "edgename-suggest",
                                displayKey: "name",
                                source: T.getBloodhound().ttAdapter(),
                                templates: {
                                    suggestion: c.a["graphs/search_result_remote"]
                                }
                            })).on("typeahead:selected", (function(t, n) {
                                var r;
                                v = !0;
                                for (var o = T.getLastResponse(), i = 0; i < o.nodeTypes.length; i += 1)
                                    if (o.nodeTypes[i].id === n.type_id) {
                                        r = o.nodeTypes[i];
                                        break
                                    }
                                r && (p.get("belongsToHub") ? f.importHubNode(n.data, a) : f.importNode(n.data, r), _.close(), p.get("belongsToHub") && 1 == p.get("status") && n.data && 2 == n.data.status && l(e, "Private Node", "This node is private, it will be published when you save this graph."))
                            }))
                        }
                        C.addEventListener("keydown", g, !1), C.addEventListener("keyup", m, !1);
                        var L = w.querySelector(".gc-dlg-action"),
                            P = L.querySelector(".gc-btn-confirm");
                        P.addEventListener("click", h, !1);
                        var A = L.querySelector(".gc-dlg-cancel");
                        return _.closeButton(A), setTimeout((function() {
                            o ? C.focus() : S.focus(), m(), f.isOnboardEnabled() && ("" === S.value.trim() ? f.triggerOnboardAction("add_node_dialogue_opened", {
                                target: S
                            }) : f.triggerOnboardAction("add_node_dialogue_opened_type_selected", {
                                target_name: C,
                                target_type: S
                            }), S.addEventListener("keyup", (function() {
                                S.value.trim().length > 0 && f.triggerOnboardAction("nodetype_entered", {
                                    target: C,
                                    value: S.value.trim()
                                }), "person" !== S.value.trim().toLowerCase() && "organization" !== S.value.trim().toLowerCase() || C.focus()
                            })), C.addEventListener("focus", (function() {
                                f.triggerOnboardAction("nodetype_entered", {
                                    target: C,
                                    value: S.value.trim(),
                                    force: !0
                                })
                            })), 3 === f.getNodes().length && 3 === f.getLinks().length && (N.typeahead("val", "a"), N.typeahead("val", ""), N.typeahead("open"), S.focus()))
                        }), 5), _
                    }
                },
                Pe = function(e, t, n) {
                    var r = function() {
                        var e = u.value.trim();
                        e && (l.close(), t && t(e))
                    };

                    function o(e) {
                        13 === e.keyCode && r()
                    }

                    function a() {
                        f.disabled = !u.value.trim()
                    }
                    var i = c.a["graphs/nodetype_dialogue"]({});
                    document.body.appendChild(i.trim().toDOM());
                    var l = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                u.removeEventListener("keydown", a, !1), u.removeEventListener("keydown", o, !1)
                            },
                            onCancel: function() {
                                n && n.call()
                            }
                        }, e),
                        d = document.body.lastElementChild,
                        u = d.querySelector(".gc-dlg-body").querySelector("input");
                    u.addEventListener("keyup", a, !1), u.addEventListener("keydown", o, !1);
                    var p = d.querySelector(".gc-dlg-action"),
                        f = p.querySelector(".gc-btn-confirm");
                    f.addEventListener("click", r, !1);
                    var h = p.querySelector(".gc-dlg-cancel");
                    l.closeButton(h), u.focus()
                },
                Ae = function(e, t, n, r) {
                    var o = {
                            show_checkbox: t
                        },
                        a = c.a["graphs/onboard_welcome_dialog"](o);
                    document.body.appendChild(a.trim().toDOM());
                    var i = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {},
                            onCancel: function() {
                                r && r.call(null, d && d.checked)
                            },
                            disableCancel: !0
                        }, e),
                        l = document.body.lastElementChild,
                        d = l.querySelector(".gc-dlg").querySelector(".confirm-checkbox"),
                        u = l.querySelector(".gc-dlg-action");
                    u.querySelector(".gc-btn-confirm").addEventListener("click", (function() {
                        i.close(), n && n(null, d && d.checked)
                    }), !1);
                    var p = u.querySelector(".gc-dlg-cancel");
                    i.closeButton(p)
                },
                De = function(e) {
                    var t = e.querySelectorAll("td"),
                        n = t[0].querySelector('input[type="checkbox"]');
                    t[1].querySelector("label").addEventListener("click", (function(e) {
                        return e.preventDefault(), n.checked = !n.checked, !1
                    }), !1)
                },
                Me = function(e, t, n, r, o, a) {
                    var i = e.GraphHistory,
                        l = i.getFilterManager(),
                        d = n ? "nt_prop" : "et_prop",
                        u = n ? i.getNodesByTypeId(t) : i.getEdgesByTypeId(t),
                        p = {},
                        f = {
                            count: 0,
                            unchecked: !1
                        };
                    u.forEach((function(e) {
                        var t = !0;
                        if (e.properties && Object.prototype.hasOwnProperty.call(e.properties, r)) {
                            var n = e.properties[r];
                            null !== n && void 0 !== n && "" !== n.trim() && (Object.prototype.hasOwnProperty.call(p, n) || (p[n] = {
                                count: 0,
                                name: n
                            }), p[n].count += 1, t = !1)
                        }
                        t && (f.count += 1)
                    })), l.getRules().forEach((function(e) {
                        e.type === d && e.id === t && (Object.prototype.hasOwnProperty.call(e, "hide_empty") ? f.unchecked = !0 : Object.prototype.hasOwnProperty.call(p, e.value) && (p[e.value].unchecked = !0))
                    }));
                    var h = {
                            props: Object(s.gb)(p),
                            title: r,
                            all: {
                                count: u.length
                            },
                            empty: f
                        },
                        g = c.a["graphs/property_filter_dialog"](h);
                    document.body.appendChild(g.trim().toDOM());
                    var m = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                a && a.call()
                            }
                        }, e),
                        y = document.body.lastElementChild,
                        b = y.querySelector(".gc-dlg"),
                        v = y.querySelector(".gc-dlg-cancel");
                    m.closeButton(v), y.querySelector(".gc-btn-confirm").addEventListener("click", (function() {
                        if (m.close(), o) {
                            var e = function() {
                                var e, n, o, a = !1,
                                    i = l.getRules(),
                                    s = b.querySelectorAll("table tbody tr"),
                                    c = {
                                        add: [],
                                        remove: []
                                    },
                                    u = s[1].querySelector('input[type="checkbox"]').checked;
                                for (e = 0; e < i.length; e += 1)(o = i[e]).type === d && o.id === t && o.prop === r && Object.prototype.hasOwnProperty.call(o, "hide_empty") && (a = !0);
                                for (a && u && (c.hide_empty = !1), a || u || (c.hide_empty = !0), n = 2; n < s.length; n += 1) {
                                    var p = s[n].getAttribute("data-for"),
                                        f = s[n].querySelector('input[type="checkbox"]').checked;
                                    for (a = !1, e = 0; e < i.length; e += 1)
                                        if ((o = i[e]).type === d && o.id === t && o.prop === r && o.value === p) {
                                            a = !0;
                                            break
                                        }
                                    f && a && c.remove.push(p), f || a || c.add.push(p)
                                }
                                return c
                            }();
                            o.call(null, e)
                        }
                    }));
                    for (var _ = y.querySelectorAll("table.graph-settings tbody tr"), w = _.length - 1; w >= 1; w -= 1) De(_[w]);
                    return y.querySelector("a.select-all").addEventListener("click", (function(e) {
                        e.preventDefault();
                        var t, n = y.querySelectorAll('input[type="checkbox"]');
                        for (t = n.length - 1; t >= 0; t -= 1) n[t].checked = !0;
                        return !1
                    }), !1), y.querySelector("a.select-none").addEventListener("click", (function(e) {
                        e.preventDefault();
                        var t, n = y.querySelectorAll('input[type="checkbox"]');
                        for (t = n.length - 1; t >= 0; t -= 1) n[t].checked = !1;
                        return !1
                    }), !1), m
                },
                qe = function(e) {
                    var t = e.graphStore,
                        n = c.a["graphs/recommend_panel"]({});
                    document.body.appendChild(n.trim().toDOM());
                    var r = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        o = document.body.lastElementChild,
                        a = o.querySelector(".gc-dlg"),
                        l = o.querySelector(".gc-dlg-action"),
                        d = l.querySelector(".gc-dlg-cancel");
                    r.closeButton(d), l.querySelector(".gc-dlg-error").classList.add("not-shown"), d.firstChild.data = "Working...", d.disabled = !0;
                    var u = a.querySelector(".wait"),
                        p = a.querySelector(".recommenders");
                    return Object(i.getRecommenders)(t.get("id"), 0, (function(e) {
                        var t = e.count;
                        p.classList.remove("not-shown"), u.classList.add("not-shown");
                        var n = o.querySelector(".gc-dlg-title");
                        switch (t) {
                            case 0:
                                n.innerHTML = "Be the first one to recommend!";
                                break;
                            case 1:
                                n.innerHTML = "Recommended by one person";
                                break;
                            default:
                                n.innerHTML = "Recommended by " + t + " people"
                        }
                        var r = p.querySelector(".users"),
                            a = e.recommenders;
                        if (a)
                            for (var i = 0; i < a.length; i += 1) {
                                var s = c.a["graphs/recommend_user"](a[i]);
                                r.appendChild(s.trim().toDOM())
                            }
                        d.firstChild.data = "OK", d.disabled = !1
                    }), (function(e) {
                        console.dir(e)
                    })), r
                },
                Ie = function(e, t) {
                    var n, r = e.GraphHistory,
                        o = e.graphStore,
                        a = t || {};
                    if ("function" === typeof a.fnLinkGenerator) n = a.fnLinkGenerator;
                    else {
                        var l = "",
                            u = r.getSelectedNodes();
                        Array.isArray(u) && u.length > 0 && (l = "/selection/" + u.join(",")), n = Object(d.DefaultPrivateLinkBuilder)(l)
                    }
                    var p = c.a["graphs/shareable_link"]({
                        share_link: ""
                    });
                    document.body.appendChild(p.trim().toDOM());
                    var f = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        h = document.body.lastElementChild,
                        g = h.querySelector(".gc-dlg-action").querySelector(".gc-dlg-cancel");
                    f.closeButton(g), f.setWorking(!0);
                    var m = function(e) {
                            f.setWorking(!1), v.classList.add("not-shown"), "" === e.share_link ? _.classList.remove("not-shown") : (w.classList.remove("not-shown"), O.value = n(e.share_link), O.focus())
                        },
                        y = function() {
                            console.log("error occurred")
                        },
                        b = function(e) {
                            return e.preventDefault(), f.setWorking(!0), _.classList.add("not-shown"), w.classList.add("not-shown"), v.classList.remove("not-shown"), Object(i.createShareableLink)(o.get("id"), m, y), !1
                        },
                        v = h.querySelector("div.wait"),
                        _ = h.querySelector("div.create-link");
                    _.querySelector("button").addEventListener("click", b);
                    var w = h.querySelector("div.reset-link"),
                        O = w.querySelector("input");
                    O.addEventListener("focus", (function() {
                        this.select()
                    }), !1), f.closeButton(g), w.querySelector("button").addEventListener("click", b), Object(i.getShareableLink)(o.get("id"), m, y)
                },
                Re = n(108),
                Be = n.n(Re);

            function Fe(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Ge(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Fe(Object(n), !0).forEach((function(t) {
                        He(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Fe(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function He(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var Ue = function(e, t) {
                    var n = e.data("ttTypeahead");
                    n && n._onQueryChanged(null, t)
                },
                ze = function(e, t, n) {
                    var o = e.graphStore,
                        a = e.GraphHistory;

                    function i(e, t, n) {
                        var r = a.getNodeTypeById(e.type),
                            o = [r.name],
                            i = [],
                            s = {};
                        switch (s[r.name] = r.color, t.detail) {
                            case "Degree Centrality":
                            case "In Degree Centrality":
                            case "Out Degree Centrality":
                            case "Betweenness Centrality":
                                var l;
                                switch (t.detail) {
                                    case "Degree Centrality":
                                        l = y.getDegreeCentralities();
                                        break;
                                    case "In Degree Centrality":
                                        l = y.getInDegreeCentralities();
                                        break;
                                    case "Out Degree Centrality":
                                        l = y.getOutDegreeCentralities();
                                        break;
                                    case "Betweenness Centrality":
                                        l = y.getBetweennessCentralities()
                                }
                                l.forEach((function(e) {
                                    var t = a.getNodeById(e.key);
                                    t.type_id === r.id && (o.push(e.value), i.push(t.id))
                                }));
                                break;
                            default:
                                a.getNodesByTypeId(r.id).filter((function(e) {
                                    return !(!e.properties || isNaN(parseFloat(e.properties[t.detail])))
                                })).sort((function(e, n) {
                                    var r = parseFloat(e.properties[t.detail]);
                                    return parseFloat(n.properties[t.detail]) - r
                                })).forEach((function(e) {
                                    i.push(e.id), o.push(e.properties[t.detail])
                                }))
                        }
                        n(null, {
                            bindto: "#chart",
                            legend: {
                                show: !0
                            },
                            data: {
                                columns: [o],
                                colors: s,
                                type: "scatter"
                            },
                            zoom: {
                                enabled: !0
                            },
                            point: {
                                r: 5
                            },
                            tooltip: {
                                contents: function(e) {
                                    var n = i[parseInt(e[0].x)],
                                        o = a.getNodeById(n),
                                        s = {
                                            name: a.nodeDisplayName(n),
                                            typeChar: o.type.charAt(0).toUpperCase(),
                                            color: r.color
                                        },
                                        l = e[0].value;
                                    return l % 1 !== 0 && (l = parseFloat(l.toFixed(2))), c.a["graphs/analysis_tooltip_node_first"]({
                                        node: s,
                                        yParam: t.detail,
                                        yValue: l
                                    })
                                }
                            }
                        }, {
                            hideXLabels: !0,
                            yAxisLabel: t.detail,
                            xAxisLabel: ""
                        })
                    }

                    function d(e, t, n, r, o) {
                        var i = a.getNodeTypeById(e.type),
                            s = b[i.id].properties[e.detail],
                            l = [i.name],
                            u = [],
                            p = [],
                            f = {};
                        f[i.name] = i.color, s.values.forEach((function(e) {
                            r && e.name.length > 16 ? u.push(e.name.substring(0, 13) + "...") : u.push(e.name), p.push(e.name), l.push(e.count)
                        }));
                        var h = {
                            bindto: "#chart",
                            legend: {
                                show: !0
                            },
                            data: {
                                columns: [l],
                                colors: f,
                                type: "bar"
                            },
                            axis: {
                                x: {
                                    type: "category",
                                    categories: u,
                                    tick: {
                                        multiline: !1
                                    },
                                    height: 100
                                }
                            },
                            zoom: {
                                enabled: !0
                            },
                            tooltip: {
                                contents: function(e) {
                                    var t = e[0],
                                        n = p[t.index];
                                    return c.a["graphs/analysis_tooltip_nominal_bar"]({
                                        category: n,
                                        value: e[0].value,
                                        color: i.color,
                                        typeChar: i.name.toUpperCase()[0],
                                        nodes: s.values[t.index].nodes
                                    })
                                }
                            },
                            onrendered: function() {
                                if (!r && function() {
                                        var e = Array.from(document.getElementById("chart").querySelectorAll("g.c3-axis.c3-axis-x g.tick"));
                                        if (e.length > 1) {
                                            var t = e[0],
                                                n = e[1],
                                                r = t.getAttribute("transform"),
                                                o = n.getAttribute("transform"),
                                                a = Number(r.match(/translate\(([-]*[\d]+),\s\d+\)/)[1]);
                                            return Number(o.match(/translate\(([-]*[\d]+),\s\d+\)/)[1]) - a
                                        }
                                    }() < Array.from(document.getElementById("chart").querySelectorAll("g.c3-axis.c3-axis-x > g > text")).reduce((function(e, t) {
                                        return Math.max(e, t.getBoundingClientRect().width)
                                    }), 0)) {
                                    var o = document.getElementById("chart").querySelector("g.c3-chart").getBoundingClientRect().width;
                                    d(e, t, n, !0, o)
                                }
                            }
                        };
                        r && (h.axis.x.tick.rotate = -90, h.axis.x.tick.culling = {
                            max: Math.floor(o / 15)
                        }), n(null, h, {
                            yAxisLabel: "Frequency",
                            xAxisLabel: e.detail
                        })
                    }

                    function u(e, t, n) {
                        var r, o, i, s, l = a.getAnalysisManager(),
                            d = !1,
                            u = !1;
                        switch (e.detail) {
                            case "Degree Centrality":
                                r = l.getDegreeCentralities(), d = !0;
                                break;
                            case "In Degree Centrality":
                                r = l.getInDegreeCentralities(), d = !0;
                                break;
                            case "Out Degree Centrality":
                                r = l.getOutDegreeCentralities(), d = !0;
                                break;
                            case "Betweenness Centrality":
                                r = l.getBetweennessCentralities(), d = !0
                        }
                        switch (d && (o = {}, r.forEach((function(e) {
                            o[e.key] = e.value
                        }))), t.detail) {
                            case "Degree Centrality":
                                i = l.getDegreeCentralities(), u = !0;
                                break;
                            case "In Degree Centrality":
                                i = l.getInDegreeCentralities(), u = !0;
                                break;
                            case "Out Degree Centrality":
                                i = l.getOutDegreeCentralities(), u = !0;
                                break;
                            case "Betweenness Centrality":
                                i = l.getBetweennessCentralities(), u = !0
                        }
                        u && (s = {}, i.forEach((function(e) {
                            s[e.key] = e.value
                        })));
                        var p = a.getNodeTypeById(e.type),
                            f = {},
                            h = {},
                            g = {},
                            m = {};
                        g[p.name] = "x" + p.name, h[p.name] = [p.name], h["x" + p.name] = ["x" + p.name], m[p.name] = p.color, a.getNodesByTypeId(p.id).forEach((function(n) {
                            var r, a;
                            d ? r = o[n.id] : n.properties && (r = parseFloat(n.properties[e.detail])), isNaN(r) || (u ? a = s[n.id] : n.properties && (a = parseFloat(n.properties[t.detail])), isNaN(a) || (r % 1 !== 0 && (r = parseFloat(r.toFixed(2))), a % 1 !== 0 && (a = parseFloat(a.toFixed(2))), h["x" + n.type].push(r), h[n.type].push(a), f[r + "-" + a] || (f[r + "-" + a] = []), f[r + "-" + a].push(n.id)))
                        }));
                        var y = [];
                        for (var b in h) Object.prototype.hasOwnProperty.call(h, b) && ("x" === b[0] ? y.splice(0, 0, h[b]) : y.push(h[b]));
                        n(null, {
                            bindto: "#chart",
                            legend: {
                                show: !0
                            },
                            data: {
                                xs: g,
                                columns: y,
                                colors: m,
                                type: "scatter"
                            },
                            zoom: {
                                enabled: !0
                            },
                            point: {
                                r: 5
                            },
                            tooltip: {
                                contents: function(n) {
                                    var r = n[0].x,
                                        o = n[0].value;
                                    r % 1 !== 0 && (r = parseFloat(r.toFixed(2))), o % 1 !== 0 && (o = parseFloat(o.toFixed(2)));
                                    var i = f[r + "-" + o].map((function(e) {
                                        return {
                                            name: a.nodeDisplayName(e),
                                            typeChar: p.name.charAt(0).toUpperCase(),
                                            color: p.color
                                        }
                                    }));
                                    return c.a["graphs/analysis_tooltip"]({
                                        title: i.length > 1 ? "Showing " + i.length + " nodes" : null,
                                        nodes: i,
                                        xParam: e.detail,
                                        xValue: r,
                                        yParam: t.detail,
                                        yValue: o
                                    })
                                }
                            }
                        }, {
                            yAxisLabel: t.detail,
                            xAxisLabel: e.detail
                        })
                    }

                    function p(e, t, n) {
                        var r, o = a.getAnalysisManager();
                        switch (t.detail) {
                            case "Degree Centrality":
                                r = o.getDegreeCentralities();
                                break;
                            case "In Degree Centrality":
                                r = o.getInDegreeCentralities();
                                break;
                            case "Out Degree Centrality":
                                r = o.getOutDegreeCentralities();
                                break;
                            case "Betweenness Centrality":
                                r = o.getBetweennessCentralities();
                                break;
                            default:
                                return
                        }
                        var i = {},
                            s = {},
                            l = {},
                            d = [];
                        a.getNodeTypes().forEach((function(e) {
                            s[e.name] = "x" + e.name, i[e.name] = [e.name], i["x" + e.name] = ["x" + e.name], l[e.name] = e.color
                        })), r.forEach((function(e, t) {
                            var n = a.getNodeById(e.key);
                            d[t] = n.id, i["x" + n.type].push(t), i[n.type].push(e.value)
                        }));
                        var u = [];
                        for (var p in i) Object.prototype.hasOwnProperty.call(i, p) && ("x" === p[0] ? u.splice(0, 0, i[p]) : u.push(i[p]));
                        n(null, {
                            bindto: "#chart",
                            data: {
                                xs: s,
                                columns: u,
                                colors: l,
                                type: "scatter"
                            },
                            zoom: {
                                enabled: !0
                            },
                            point: {
                                r: 5
                            },
                            tooltip: {
                                contents: function(e) {
                                    var n = d[parseInt(e[0].x)],
                                        r = a.getNodeById(n),
                                        o = a.getNodeTypeById(r.type_id),
                                        i = {
                                            name: a.nodeDisplayName(n),
                                            typeChar: r.type.charAt(0).toUpperCase(),
                                            color: o.color
                                        },
                                        s = e[0].value;
                                    return s % 1 !== 0 && (s = parseFloat(s.toFixed(2))), c.a["graphs/analysis_tooltip_node_first"]({
                                        node: i,
                                        yParam: t.detail,
                                        yValue: s
                                    })
                                }
                            }
                        }, {
                            hideXLabels: !0,
                            yAxisLabel: t.detail,
                            xAxisLabel: "All Nodes"
                        })
                    }

                    function f(e, t, n) {
                        var r, o, i = a.getAnalysisManager(),
                            s = {};
                        switch (e.detail) {
                            case "Degree Centrality":
                                r = i.getDegreeCentralities();
                                break;
                            case "In Degree Centrality":
                                r = i.getInDegreeCentralities();
                                break;
                            case "Out Degree Centrality":
                                r = i.getOutDegreeCentralities();
                                break;
                            case "Betweenness Centrality":
                                r = i.getBetweennessCentralities();
                                break;
                            default:
                                return
                        }
                        r.forEach((function(e) {
                            s[e.key] = e.value
                        }));
                        var l = {};
                        switch (t.detail) {
                            case "Degree Centrality":
                                o = i.getDegreeCentralities();
                                break;
                            case "In Degree Centrality":
                                o = i.getInDegreeCentralities();
                                break;
                            case "Out Degree Centrality":
                                o = i.getOutDegreeCentralities();
                                break;
                            case "Betweenness Centrality":
                                o = i.getBetweennessCentralities();
                                break;
                            default:
                                return
                        }
                        o.forEach((function(e) {
                            l[e.key] = e.value
                        }));
                        var d = {},
                            u = {},
                            p = {},
                            f = {};
                        a.getNodeTypes().forEach((function(e) {
                            p[e.name] = "x" + e.name, u[e.name] = [e.name], u["x" + e.name] = ["x" + e.name], f[e.name] = e.color
                        })), a.getNodes().forEach((function(e) {
                            var t = s[e.id],
                                n = l[e.id];
                            t % 1 !== 0 && (t = parseFloat(t.toFixed(2))), n % 1 !== 0 && (n = parseFloat(n.toFixed(2))), u["x" + e.type].push(t), u[e.type].push(n), d[t + "-" + n] || (d[t + "-" + n] = []), d[t + "-" + n].push(e.id)
                        }));
                        var h = [];
                        for (var g in u) Object.prototype.hasOwnProperty.call(u, g) && ("x" === g[0] ? h.splice(0, 0, u[g]) : h.push(u[g]));
                        n(null, {
                            bindto: "#chart",
                            data: {
                                xs: p,
                                columns: h,
                                colors: f,
                                type: "scatter"
                            },
                            zoom: {
                                enabled: !0
                            },
                            point: {
                                r: 5
                            },
                            tooltip: {
                                contents: function(n) {
                                    var r = n[0].x,
                                        o = n[0].value;
                                    r % 1 !== 0 && (r = parseFloat(r.toFixed(2))), o % 1 !== 0 && (o = parseFloat(o.toFixed(2)));
                                    var i = d[r + "-" + o].map((function(e) {
                                        var t = a.getNodeById(e),
                                            n = a.getNodeTypeById(t.type_id);
                                        return {
                                            name: a.nodeDisplayName(e),
                                            typeChar: t.type.charAt(0).toUpperCase(),
                                            color: n.color
                                        }
                                    }));
                                    return c.a["graphs/analysis_tooltip"]({
                                        title: i.length > 1 ? "Showing " + i.length + " nodes" : null,
                                        nodes: i,
                                        xParam: e.detail,
                                        xValue: r,
                                        yParam: t.detail,
                                        yValue: o
                                    })
                                }
                            }
                        }, {
                            yAxisLabel: t.detail,
                            xAxisLabel: e.detail
                        })
                    }
                    var h = function() {
                            S && x ? function(e, t, n) {
                                var r;
                                if (e.detail)
                                    if ("All" === e.type) r = f;
                                    else {
                                        var o = b[e.type].properties[e.detail];
                                        r = o && "distinct" === o.type ? d : u
                                    }
                                else r = "All" === e.type ? p : i;
                                r && r(e, t, n)
                            }(S, x, (function(e, t, n) {
                                if (n = n || {}, E && (E = E.destroy()), j = t, E = Be.a.generate(j), k.innerHTML = n.yAxisLabel, C.innerHTML = n.xAxisLabel, n.hideXLabels) {
                                    var r = E.element.querySelector("g.c3-axis.c3-axis-x");
                                    Object(s.h)(r, "hide-labels")
                                }
                            })) : console.log("nothing selected")
                        },
                        g = function(e) {
                            return function(t, n) {
                                var r, o = [],
                                    a = new RegExp(t, "i");
                                for (r = 0; r < e.length; r += 1) a.test(e[r].name) && o.push(e[r]);
                                n(o)
                            }
                        };

                    function m() {
                        if (S)
                            if (N.prop("disabled", !1), N.attr("placeholder", "Y-AXIS"), L.splice(0, L.length), "All" === S.type) "Degree Centrality" !== S.detail && L.push({
                                name: "Degree Centrality",
                                type: "All",
                                detail: "Degree Centrality"
                            }), "In Degree Centrality" !== S.detail && L.push({
                                name: "In-Degree Centrality",
                                type: "All",
                                detail: "In Degree Centrality"
                            }), "Out Degree Centrality" !== S.detail && L.push({
                                name: "Out-Degree Centrality",
                                type: "All",
                                detail: "Out Degree Centrality"
                            }), "Betweenness Centrality" !== S.detail && L.push({
                                name: "Betweenness Centrality",
                                type: "All",
                                detail: "Betweenness Centrality"
                            });
                            else {
                                var t = b[S.type],
                                    n = !1,
                                    r = !1;
                                if (S.detail && Object.prototype.hasOwnProperty.call(t.properties, S.detail)) switch (t.properties[S.detail].type) {
                                    case "distinct":
                                        n = !0;
                                        break;
                                    case "empty":
                                        r = !0
                                }
                                if (r) return _.setWorking(!0), void l(e, "Empty Group", "There is no data available for this property.", (function() {
                                    _.setWorking(!1), T.focus()
                                }));
                                if (n) N.attr("placeholder", ""), N.typeahead("val", ""), N.prop("disabled", !0), T.blur(), x = {}, h();
                                else
                                    for (var o in "Degree Centrality" !== S.detail && L.push({
                                            name: "Degree Centrality",
                                            type: S.type,
                                            detail: "Degree Centrality"
                                        }), "In Degree Centrality" !== S.detail && L.push({
                                            name: "In-Degree Centrality",
                                            type: S.type,
                                            detail: "In Degree Centrality"
                                        }), "Out Degree Centrality" !== S.detail && L.push({
                                            name: "Out-Degree Centrality",
                                            type: S.type,
                                            detail: "Out Degree Centrality"
                                        }), "Betweenness Centrality" !== S.detail && L.push({
                                            name: "Betweenness Centrality",
                                            type: S.type,
                                            detail: "Betweenness Centrality"
                                        }), t.properties) Object.prototype.hasOwnProperty.call(t.properties, o) && "range" === t.properties[o].type && S.detail !== o && L.push({
                                        name: o,
                                        type: S.type,
                                        detail: o
                                    })
                            }
                    }
                    var y = a.getAnalysisManager(),
                        b = y.getTypeSummaries(),
                        v = c.a["graphs/analysis_chart"]();
                    document.body.appendChild(v.trim().toDOM());
                    var _ = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: n
                        }, e),
                        w = document.body.lastElementChild,
                        O = w.querySelector(".gc-dlg-cancel");
                    _.closeButton(O);
                    var E, j, S, x, k = w.querySelector("div.new-y-axis span"),
                        C = w.querySelector("div.new-x-axis span"),
                        N = Object(r.a)("#y-selector"),
                        T = Object(r.a)("#x-selector"),
                        L = [];
                    return function() {
                            var e = [Ge(Ge({}, s.b), {}, {
                                autoselect: !0
                            })];
                            e.push({
                                name: "xaxis-All",
                                displayKey: "name",
                                source: g([{
                                    name: "All Nodes",
                                    type: "All"
                                }, {
                                    name: "Degree Centrality",
                                    type: "All",
                                    detail: "Degree Centrality"
                                }, {
                                    name: "In-Degree Centrality",
                                    type: "All",
                                    detail: "In Degree Centrality"
                                }, {
                                    name: "Out-Degree Centrality",
                                    type: "All",
                                    detail: "Out Degree Centrality"
                                }, {
                                    name: "Betweenness Centrality",
                                    type: "All",
                                    detail: "Betweenness Centrality"
                                }]),
                                templates: {
                                    header: c.a["graphs/analysis_chart_xaxis_typeahead_header"]({
                                        name: "All Node Types"
                                    }),
                                    suggestion: c.a["graphs/analysis_chart_xaxis_typeahead_duggestion"]
                                }
                            });
                            var t = a.getNodeTypes();
                            o.get("belongsToHub") && (t = t.filter((function(e) {
                                return e.count > 0
                            }))), t.sort((function(e, t) {
                                var n = e.name.toLowerCase(),
                                    r = t.name.toLowerCase();
                                return n < r ? -1 : n > r ? 1 : 0
                            })).forEach((function(t) {
                                var n = [];
                                n.push({
                                    name: ["All", t.name, "Nodes"].join(" "),
                                    type: t.id
                                }), n.push({
                                    name: "Degree Centrality",
                                    type: t.id,
                                    detail: "Degree Centrality"
                                }), n.push({
                                    name: "In-Degree Centrality",
                                    type: t.id,
                                    detail: "In Degree Centrality"
                                }), n.push({
                                    name: "Out-Degree Centrality",
                                    type: t.id,
                                    detail: "Out Degree Centrality"
                                }), n.push({
                                    name: "Betweenness Centrality",
                                    type: t.id,
                                    detail: "Betweenness Centrality"
                                }), t.properties.forEach((function(e) {
                                    n.push({
                                        name: e.name,
                                        type: t.id,
                                        detail: e.name
                                    })
                                })), e.push({
                                    name: "xaxis-" + t.id,
                                    displayKey: "name",
                                    source: g(n),
                                    templates: {
                                        header: c.a["graphs/analysis_chart_xaxis_typeahead_header"]({
                                            name: t.name
                                        }),
                                        suggestion: c.a["graphs/analysis_chart_xaxis_typeahead_duggestion"]
                                    }
                                })
                            })), T.typeahead.apply(T, e).on("typeahead:selected", (function(e, t, n) {
                                S = t, m(), N.focus();
                                var r = n.substring(6);
                                r = "All" === r ? "All Node Types" : a.getNodeTypeById(r).name, t.detail && (r += " - " + t.detail), T.typeahead("val", r)
                            })), T.on("focus", (function() {
                                S = null, T.typeahead("val", ""), Ue(T, "")
                            }))
                        }(), N.typeahead(Ge(Ge({}, s.b), {}, {
                            autoselect: !0
                        }), Ge(Ge({}, s.c), {}, {
                            name: "yaxis",
                            displayKey: "name",
                            source: g(L)
                        })).on("typeahead:selected", (function(e, t) {
                            x = t, h(), N.blur()
                        })), N.on("focus", (function() {
                            x = null, N.typeahead("val", ""), Ue(N, "")
                        })),
                        function(e) {
                            if ("nt" === e.type)
                                if ("All" === e.id) S = {
                                    name: "All Node Types",
                                    type: "All"
                                }, "Degree Centrality" === e.analysis ? x = {
                                    name: "All Node Types - Degree Centrality",
                                    type: "All",
                                    detail: "Degree Centrality"
                                } : "Betweenness Centrality" === e.analysis && (x = {
                                    name: "All Node Types - Betweenness Centrality",
                                    type: "All",
                                    detail: "Betweenness Centrality"
                                });
                                else {
                                    var t = b[e.id];
                                    S = {
                                        name: t.name,
                                        type: e.id
                                    }, "Degree Centrality" === e.analysis ? x = {
                                        name: t.name + " - Degree Centrality",
                                        type: e.id,
                                        detail: "Degree Centrality"
                                    } : "Betweenness Centrality" === e.analysis && (x = {
                                        name: t.name + " - Betweenness Centrality",
                                        type: e.id,
                                        detail: "Betweenness Centrality"
                                    })
                                }
                            else if ("nt_prop" === e.type) {
                                var n = b[e.id],
                                    r = n.properties[e.prop];
                                "distinct" === r.type ? (S = {
                                    name: n.name,
                                    type: e.id,
                                    detail: e.prop
                                }, x = {}) : Object.prototype.hasOwnProperty.call(r, "range") && (S = {
                                    name: n.name,
                                    type: e.id
                                }, x = {
                                    name: n.name + " - " + e.prop,
                                    type: e.id,
                                    detail: e.prop
                                })
                            }
                        }(t), S ? (T.typeahead("val", S.name), m()) : T.prop("disabled", !0), x ? N.typeahead("val", x.name) : N.prop("disabled", !0), h(), _
                },
                We = function(e, t, n) {
                    var r, o = e.GraphHistory,
                        a = e.graphStore,
                        l = document.querySelector('meta[name="csrf-token"]'),
                        d = {
                            id: a.get("id"),
                            token: l ? l.getAttribute("content") : "",
                            read_only: a.get("belongsToHub") && !a.get("user").is_admin,
                            show_edge_weights: a.get("layout").show_edge_weights,
                            lock_node_positions: a.get("layout").lock_node_positions,
                            use_curved_edges: a.get("layout").use_curved_edges
                        };
                    a.get("belongsToHub") ? (d.node_types = o.getNodeTypes().filter((function(e) {
                        return e.count > 0
                    })), d.edge_types = o.getEdgeTypes().filter((function(e) {
                        return e.count > 0
                    }))) : (d.node_types = o.getNodeTypes(), d.edge_types = o.getEdgeTypes());
                    var u = function() {
                            E.classList.add("not-shown"), v && (v.firstChild.data = "Working...", v.disabled = !0), O.disabled = !0
                        },
                        p = function() {
                            v && (v.firstChild.data = "SAVE", v.disabled = !1), O.disabled = !1
                        },
                        f = c.a["graphs/cartography_panel"](d);
                    document.body.appendChild(f.trim().toDOM());
                    var h = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                n && n.call()
                            },
                            close_others: !0,
                            url_param: "cartography"
                        }, e),
                        g = document.body.lastElementChild,
                        m = g.querySelector("input#cbShowEdgeWeights"),
                        y = g.querySelector("input#cbLockNodePositions"),
                        b = g.querySelector("input#cbUseCurvedEdges");
                    g.querySelector("#edit_graph_" + d.id).addEventListener("submit", (function() {
                        return d.read_only || Object(i.updateGraph)(a.get("id"), {
                            graph: {
                                layout_show_edge_weights: m.checked,
                                layout_lock_node_positions: y.checked,
                                layout_use_curved_edges: b.checked
                            },
                            id: a.get("id")
                        }), u(), !1
                    }), !1);
                    var v, _ = g.querySelector(".gc-pnl"),
                        w = g.querySelector(".gc-pnl-action");
                    d.read_only || ((v = w.querySelector(".gc-btn-confirm")).disabled = !1);
                    var O = w.querySelector(".gc-dlg-cancel");
                    h.closeButton(O);
                    var E = w.querySelector(".gc-dlg-error"),
                        j = function(e, t) {
                            "neutral" == e.value ? t.disabled = !0 : t.disabled = !1
                        },
                        S = function(e) {
                            var t = e.querySelector("td select"),
                                n = e.querySelector('td input[type="number"]'),
                                r = e.querySelector('td input[type="color"]'),
                                o = e.querySelector("td div.bold");
                            r && r.addEventListener("change", (function() {
                                o.style.color = r.value
                            })), j(t, n), t.addEventListener("change", (function() {
                                j(t, n)
                            }))
                        },
                        x = function(e) {
                            var t = e.querySelector('td input[type="color"]'),
                                n = e.querySelector("td div.bold");
                            t && t.addEventListener("change", (function() {
                                n.style.color = t.value
                            }))
                        },
                        k = _.querySelectorAll("table.graph-settings.for-nodetypes tbody tr");
                    for (r = 0; r < k.length; r += 1) S(k[r]);
                    var C = _.querySelectorAll("table.graph-settings.for-edgetypes tbody tr");
                    for (r = 0; r < C.length; r += 1) x(C[r]);
                    var N = _.querySelectorAll("a.remove-item");
                    for (r = N.length - 1; r >= 0; r -= 1) N[r].addEventListener("click", (function(e) {
                        e.preventDefault(), u();
                        var t = "Are you sure to remove this type?";
                        if (a.get("belongsToHub") && a.get("user").is_admin && (t += "\n(Type will also be removed from the hub)"), confirm(t)) {
                            var n = /node_types/.test(this.getAttribute("href")),
                                r = this.getAttribute("id"),
                                s = function() {
                                    var e = _.querySelector("#tr_" + r);
                                    e && e.parentNode.removeChild(e), o.push({
                                        action: n ? "nodetype_delete" : "edgetype_delete",
                                        id: r
                                    }, !0, !1), p()
                                },
                                c = function() {
                                    E.classList.remove("not-shown"), E.innerHTML = "Please try again!", p()
                                };
                            n ? Object(i.deleteNodeType)(r, s, c) : Object(i.deleteEdgeType)(r, s, c)
                        } else p();
                        return !1
                    }), !1);
                    return h
                };

            function Ye(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Ve(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Ye(Object(n), !0).forEach((function(t) {
                        Xe(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Ye(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function Xe(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var Ke = function(e, t) {
                    var n, o, a = e.graphStore,
                        l = a.get("user"),
                        d = [],
                        u = {
                            id: a.get("id"),
                            is_admin: l.is_admin
                        },
                        p = function() {
                            E.classList.add("not-shown"), O.firstChild.data = "Working...", O.disabled = !0, o && o.attr("disabled", !0)
                        },
                        f = function() {
                            O.firstChild.data = "OK", O.disabled = !1, o && o.attr("disabled", !1)
                        },
                        h = function(e, t, r) {
                            if (e) {
                                var o = e.parentNode.parentNode;
                                e.addEventListener("click", (function(e) {
                                    e.preventDefault();
                                    var a, s = o.getAttribute("id"),
                                        c = s === r;
                                    return a = c ? "Are you sure you want to remove yourself from collaborators?" : "Are you sure you want to remove this collaborator?", confirm(a) && Object(i.removeCollaborator)(t, s, (function() {
                                        o.parentNode.removeChild(o);
                                        for (var e = 0; e < d.length; e += 1)
                                            if (d[e].id === s) {
                                                d.splice(e, 1);
                                                break
                                            }
                                        n && n.clearRemoteCache(), c && window.location.reload()
                                    }), (function() {
                                        E.innerHTML = "Failed to remove collaborator", E.classList.remove("not-shown")
                                    })), !1
                                }))
                            }
                        },
                        g = function(e, t, n) {
                            var r = e.getAttribute("id").replace("collab_status_", ""),
                                o = n === r;
                            e.addEventListener("change", (function(e) {
                                e.preventDefault();
                                var n = this;
                                return n.disabled = !0, confirm(o ? "Are you sure you want to change your own collaborator status?" : "Are you sure you want to change the status of this collaborator?") ? (Object(i.updateCollaboratorStatus)(t, r, 1 == n.selectedIndex, (function() {
                                    for (var e = 0; e < d.length; e += 1) d[e].id === r && (d[e].is_admin = 1 === n.selectedIndex);
                                    o && window.location.reload()
                                }), (function() {
                                    n.selectedIndex = 1 - n.selectedIndex, E.innerHTML = "Error updating status", E.classList.remove("not-shown")
                                }), (function(e) {
                                    n.disabled = !1, console.log(e.responseJSON)
                                })), !1) : (n.disabled = !1, void(n.selectedIndex = 1 - n.selectedIndex))
                            }))
                        },
                        m = function(e) {
                            var t, r, o, a, s, p = c.a["graphs/new_collaborator_li"](e);
                            if (_.appendChild(p.trim().toDOM()), p = _.lastElementChild, e.allow_remove && (e.invited ? function(e) {
                                    if (e) {
                                        var t = e.parentNode.parentNode;
                                        e.addEventListener("click", (function(e) {
                                            e.preventDefault();
                                            var r = t.getAttribute("id");
                                            return confirm("Are you sure you want to cancel this collaborator's invitation?") && Object(i.deleteInvitation)(r, (function() {
                                                t.parentNode.removeChild(t);
                                                for (var e = 0; e < d.length; e += 1)
                                                    if (d[e].id === r) {
                                                        d.splice(e, 1);
                                                        break
                                                    }
                                                n && n.clearRemoteCache()
                                            }), (function() {
                                                E.innerHTML = "Failed to remove collaborator", E.classList.remove("not-shown")
                                            })), !1
                                        }))
                                    }
                                }(_.lastElementChild.querySelector(".remove-item")) : h(_.lastElementChild.querySelector(".remove-item"), u.id, l.id)), !l.is_admin || e.is_owner || e.invited || e.requested || g(_.lastElementChild.querySelector("select.collab-status"), u.id, l.id), l.is_admin && e.requested) {
                                var f = _.lastElementChild.querySelector("button.request-accept"),
                                    m = _.lastElementChild.querySelector("a.request-reject");
                                t = p, r = f, o = m, a = u.id, s = e.id, r.addEventListener("click", (function() {
                                    Object(i.UpdateGraphMembershipRequest)(a, s, !0, (function() {
                                        var e = r.parentNode;
                                        e.removeChild(r);
                                        var t = document.createElement("select");
                                        t.setAttribute("id", "collab_status_" + s), t.setAttribute("class", "collab-status"), e.appendChild(t);
                                        var n = document.createElement("option");
                                        n.innerHTML = "Editor", n.value = 0, n.selected = !0, t.appendChild(n);
                                        var a = document.createElement("option");
                                        a.innerHTML = "Admin", a.value = 1, a.selected = !1, t.appendChild(a), e.removeChild(o);
                                        var i = document.createElement("a");
                                        i.setAttribute("href", "#"), i.setAttribute("class", "remove-item"), e.appendChild(i);
                                        var c = document.createElement("span");
                                        c.setAttribute("class", "icon-tiny close-icon"), i.appendChild(c), g(t, u.id, l.id), h(i, u.id, l.id)
                                    }))
                                })), o.addEventListener("click", (function() {
                                    Object(i.UpdateGraphMembershipRequest)(a, s, !1, (function() {
                                        t.parentNode.removeChild(t)
                                    }))
                                }))
                            }
                        };
                    var y = c.a["graphs/collaborators_panel"](u);
                    document.body.appendChild(y.trim().toDOM());
                    var b = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: "collaborators",
                            close_others: !0,
                            onCancel: function() {
                                t && t()
                            }
                        }, e),
                        v = document.body.lastElementChild,
                        _ = v.querySelector(".gc-pnl").querySelector("ul.users"),
                        w = v.querySelector(".gc-pnl-action"),
                        O = w.querySelector(".gc-dlg-cancel");
                    b.closeButton(O);
                    var E = w.querySelector(".gc-dlg-error");
                    if (p(), Object(i.graphCollaborators)(a.get("id"), (function(e) {
                            var t;
                            for (t = 0; t < e.length; t += 1) e[t].invited ? (e[t].allow_editor_update = !1, e[t].allow_remove = l.is_admin, e[t].role = "Invited, membership pending...") : e[t].requested ? (e[t].allow_editor_update = !1, e[t].role = "Membership requested") : (e[t].allow_editor_update = l.is_admin, e[t].allow_remove = l.is_admin || l.id === e[t].id, e[t].role = e[t].is_owner ? "Owner" : e[t].is_admin ? "Admin" : "Editor"), m(e[t]), d.push(e[t]);
                            f()
                        }), (function() {
                            E.innerHTML = "Please try again", E.classList.remove("not-shown"), f()
                        })), l.is_admin) {
                        n = Object(s.T)(d);
                        o = Object(r.a)("div.users input");
                        var j = function e() {
                            E.classList.add("not-shown"), o.unbind("keydown", e)
                        };
                        o.typeahead(Ve(Ve({}, s.b), {}, {
                            minLength: 2
                        }), Ve(Ve({}, s.c), {}, {
                            name: "users",
                            displayKey: "username",
                            source: function(e, t, r) {
                                n.search(e, null, (function(t) {
                                    0 === t.length ? r([{
                                        empty: !0,
                                        query: e
                                    }]) : r(t)
                                }))
                            },
                            templates: {
                                suggestion: c.a["graphs/collaborator_result"]
                            }
                        })).on("typeahead:selected", (function(e, t) {
                            p(), t.empty ? Object(i.inviteToGraph)(t.query, a.get("id"), (function(e) {
                                (e = e.user).allow_remove = !0, e.allow_editor_update = !1, e.role = "Invited, membership pending...", m(e), f(), o.val(""), d.push(e), n.clearRemoteCache()
                            }), (function(e) {
                                var t = e.responseJSON;
                                t && t.recipient_email ? E.innerHTML = "email " + t.recipient_email[0] : E.innerHTML = "Please try again", E.classList.remove("not-shown"), o.keydown(j), o.val(""), f()
                            })) : Object(i.addCollaborator)(a.get("id"), t.id, (function(e) {
                                (e = e.user).allow_remove = !0, e.allow_editor_update = l.is_admin, m(e), f(), o.val(""), d.push(e), n.clearRemoteCache()
                            }), (function(e) {
                                console.log(e), E.innerHTML = "Please try again", E.classList.remove("not-shown"), f(), o.val("")
                            }))
                        }))
                    }
                    return b
                },
                $e = function(e, t, n) {
                    var o = e.graphStore,
                        a = o.get("user"),
                        l = {
                            is_admin: a.is_admin
                        },
                        d = c.a["graphs/contributors_panel"](l);
                    document.body.appendChild(d.trim().toDOM());
                    var u = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_others: !0,
                            url_param: "collaborators",
                            onCancel: function() {
                                n && n.call()
                            }
                        }, e),
                        p = document.body.lastElementChild,
                        f = p.querySelector(".gc-pnl"),
                        h = Object(r.a)(f.querySelector("ul.users"));
                    (Object(i.graphContributors)(o.get("id"), (function(e) {
                        (console.dir(e), e.length) || p.querySelector("#divNoContributors").classList.remove("not-shown");
                        for (var t = 0; t < e.length; t += 1) {
                            e[t].role = e[t].is_owner ? "Owner" : e[t].is_admin ? "Admin" : "Member";
                            var n = Object(r.a)(c.a["graphs/contributors_li"](e[t]));
                            h.append(n)
                        }
                    }), (function(e) {
                        console.log(e), alert("Error retrieving members. Try again")
                    })), a.is_admin) && p.querySelector("#btnEditMembers").addEventListener("click", (function() {
                        window.open("/hubs/" + o.get("hub").id + "?show=members", "_blank")
                    }), !1);
                    var g = p.querySelector(".gc-pnl-action").querySelector(".gc-dlg-cancel");
                    return u.closeButton(g), u
                },
                Ze = function(e, t, n, r, o, a) {
                    var i = e.graphStore,
                        l = e.GraphHistory,
                        d = [],
                        u = {
                            title: t,
                            message: n,
                            is_admin: i.get("user").is_admin
                        },
                        p = c.a["graphs/delete_confirm_panel"](u);
                    document.body.appendChild(p.trim().toDOM());
                    var f = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                a && a.call()
                            }
                        }, e),
                        h = document.body.lastElementChild,
                        g = h.querySelector("div.delete-confirm"),
                        m = h.querySelector(".wait"),
                        y = h.querySelector(".gc-dlg-action"),
                        b = y.querySelector("input#cbSelectAll"),
                        v = y.querySelector(".gc-btn-confirm");
                    v.addEventListener("click", (function() {
                        f.close();
                        var e = !0;
                        b && (e = !b.checked), o && o.call(null, e)
                    }), !1);
                    var _, w, O = y.querySelector(".gc-dlg-cancel");
                    if (f.closeButton(O), r)
                        for (var E = 0; E < r.length; E += 1) {
                            var j = (_ = r[E], w = void 0, {
                                id: (w = l.getNodeById(_)).id,
                                name: w.name,
                                type: w.type,
                                typeFirstChar: w.type.charAt(0).toUpperCase(),
                                color: l.getNodeTypeById(w.type_id).color
                            });
                            d.push(j)
                        }! function() {
                            if (d.length > 0) {
                                var e = c.a["graphs/delete_confirm_table_body"]({
                                    nodes: d
                                });
                                g.appendChild(e.trim().toDOM())
                            }
                            m.classList.add("not-shown"), v.disabled = !1
                        }()
                };

            function Je(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function Qe(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? Je(Object(n), !0).forEach((function(t) {
                        et(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : Je(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function et(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var tt = function(e) {
                    var t, n, r = !1;
                    for (t in e)
                        if (Object.prototype.hasOwnProperty.call(e, t)) {
                            if ("" === e[t].name_typeahead.typeahead("val").trim()) {
                                r = !0;
                                break
                            }
                            if (e[t].properties)
                                for (n = 0; n < e[t].properties.length; n += 1)
                                    if ("" === e[t].properties[n].propname_typeahead.typeahead("val")) {
                                        r = !0;
                                        break
                                    }
                        }
                    return r
                },
                nt = function(e, t, n) {
                    var r;
                    if (e.properties)
                        for (r = e.properties.length - 1; r >= 0; r -= 1) e.properties[r].name === t && (e.properties[r].name = n, e.properties[r].name_alias = n)
                },
                rt = function(e, t) {
                    var n;
                    if (e.properties)
                        for (n = e.properties.length - 1; n >= 0; n -= 1)
                            if (e.properties[n].name === t) {
                                e.properties.splice(n, 1);
                                break
                            }
                },
                ot = function(e, t) {
                    var n;
                    for (n = e.length - 1; n >= 0; n -= 1)
                        if (e[n].name === t) return e[n].id;
                    return null
                },
                at = function(e, t) {
                    var n;
                    for (n = e.length - 1; n >= 0; n -= 1)
                        if (e[n].id === t) return e[n];
                    return null
                },
                it = function(e, t) {
                    var n, r = e.properties;
                    if (!r || 0 === r.length) return !1;
                    for (n = r.length - 1; n >= 0; n -= 1)
                        if (r[n].name === t) return !0;
                    return !1
                },
                st = function(e, t) {
                    var n = [],
                        o = [],
                        a = function() {
                            var e = Object(r.a)(this);
                            e.typeahead("val", ""), e.typeahead("val", "a"), e.typeahead("val", ""), e.typeahead("open")
                        },
                        i = function() {
                            o.forEach((function(e) {
                                e.removeClass("dropdown"), e.off("focus", a)
                            }));
                            var r = function(e, t) {
                                var n;
                                for (n = e.length - 1; n >= 0; n -= 1)
                                    if (e[n].name === t) return e[n];
                                return null
                            }(t, e.typeahead("val"));
                            r && r.properties && r.properties.length > 0 && (n = r.properties, o.forEach((function(e) {
                                e.addClass("dropdown"), e.on("focus", a)
                            })))
                        };
                    return e.on("blur", (function() {
                        i()
                    })), {
                        addTT: function(e) {
                            o.push(e), i()
                        },
                        fn: function(e, t) {
                            var o, a;
                            o = [], a = new RegExp(e, "i"), r.a.each(n, (function(e, t) {
                                a.test(t.name) && o.push(t)
                            })), t(o)
                        }
                    }
                },
                ct = function(e) {
                    return function(t, n) {
                        var o, a;
                        o = [], a = new RegExp(t, "i"), r.a.each(e, (function(e, t) {
                            a.test(t.name) && o.push(t)
                        })), n(o)
                    }
                },
                lt = 0,
                dt = function(e, t, n, o, a, i) {
                    var l = e.graphStore,
                        d = Object(s.g)(t, "id"),
                        u = Object(s.g)(n, "id");
                    for (var p in d) Object.prototype.hasOwnProperty.call(d, p) && (d[p].nodes = []);
                    for (var f in u) Object.prototype.hasOwnProperty.call(u, f) && (u[f].edges = []);
                    if (o)
                        for (var h = 0, g = o.length; h < g; h += 1) d[o[h].type_id].nodes.push(o[h]);
                    if (a)
                        for (var m = 0, y = a.length; m < y; m += 1) u[a[m].name_id].edges.push(a[m]);
                    var b = {};
                    b.nodeTypes = Object(s.gb)(d), b.edgeTypes = Object(s.gb)(u), b.is_hub = l.get("belongsToHub");
                    var v = c.a["graphs/merge_panel"](b);
                    document.body.appendChild(v.trim().toDOM());
                    var _ = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        w = document.body.lastElementChild,
                        O = w.querySelector(".gc-btn-confirm"),
                        E = w.querySelector(".gc-dlg-cancel");
                    _.closeButton(E);
                    for (var j, S, x, k = w.querySelectorAll("table.for-nodetypes tbody tr"), C = w.querySelectorAll("table.for-edgetypes tbody tr"), N = function(e) {
                            _.setWorking(e > 0)
                        }, T = 1 === k.length, L = 0; L < k.length; L += 1) {
                        S = (j = k[L]).getAttribute("id").substring(3);
                        var P = j.querySelectorAll("td");
                        x = Object(r.a)(P[2].querySelector(".nodetype.typeahead")), d[S].name_typeahead = x.typeahead(Qe(Qe({}, s.b), {}, {
                            hint: !0
                        }), Qe(Qe({}, s.c), {}, {
                            name: "nodetypes",
                            displayKey: "name",
                            source: ct(T ? [] : b.nodeTypes)
                        })).on("typeahead:selected", (function() {
                            H()
                        })).on("blur", (function() {
                            H(), lt = Math.max(0, lt - 1), _.setWorking(lt > 0)
                        })).on("focus", (function() {
                            N(lt += 1)
                        })), T ? x.removeClass("dropdown") : d[S].name_typeahead.on("focus", (function() {
                            var e = Object(r.a)(this);
                            e.typeahead("val", ""), e.typeahead("val", "a"), e.typeahead("val", ""), e.typeahead("open")
                        }));
                        var A = P[3].querySelectorAll("div");
                        if (A.length > 0)
                            for (var D = st(d[S].name_typeahead, b.nodeTypes), M = 0; M < A.length; M += 1) x = Object(r.a)(A[M].querySelector("input.propname.typeahead")), d[S].properties[M].propname_typeahead = x.typeahead(Qe(Qe({}, s.b), {}, {
                                hint: !0
                            }), Qe(Qe({}, s.c), {}, {
                                name: "nodetype-properties",
                                displayKey: "name",
                                source: D.fn
                            })).on("focus", (function() {
                                N(lt += 1)
                            })).on("typeahead:selected", (function() {
                                H()
                            })).on("blur", (function() {
                                H(), lt = Math.max(0, lt - 1), _.setWorking(lt > 0)
                            })), D.addTT(d[S].properties[M].propname_typeahead)
                    }
                    for (var q = 1 === C.length, I = 0; I < C.length; I += 1) {
                        S = (j = C[I]).getAttribute("id").substring(3);
                        var R = j.querySelectorAll("td");
                        x = Object(r.a)(j.querySelector(".edgetype.typeahead")), u[S].name_typeahead = x.typeahead(Qe(Qe({}, s.b), {}, {
                            hint: !0
                        }), Qe(Qe({}, s.c), {}, {
                            name: "nodetypes",
                            displayKey: "name",
                            source: ct(q ? [] : b.edgeTypes)
                        })).on("typeahead:selected", (function() {
                            H()
                        })).on("blur", (function() {
                            H(), lt = Math.max(0, lt - 1), _.setWorking(lt > 0)
                        })).on("focus", (function() {
                            N(lt += 1)
                        })), q ? x.removeClass("dropdown") : u[S].name_typeahead.on("focus", (function() {
                            var e = Object(r.a)(this);
                            e.typeahead("val", ""), e.typeahead("val", "a"), e.typeahead("val", ""), e.typeahead("open")
                        }));
                        var B = R[3].querySelectorAll("div");
                        if (B.length > 0)
                            for (var F = st(u[S].name_typeahead, b.edgeTypes), G = 0; G < B.length; G += 1) x = Object(r.a)(B[G].querySelector("input.propname.typeahead")), u[S].properties[G].propname_typeahead = x.typeahead(Qe(Qe({}, s.b), {}, {
                                hint: !0
                            }), Qe(Qe({}, s.c), {}, {
                                name: "edgetype-properties",
                                displayKey: "name",
                                source: F.fn
                            })).on("focus", (function() {
                                N(lt += 1)
                            })).on("typeahead:selected", (function() {
                                H()
                            })).on("blur", (function() {
                                H(), lt = Math.max(0, lt - 1), _.setWorking(lt > 0)
                            })), F.addTT(u[S].properties[G].propname_typeahead)
                    }

                    function H() {
                        tt(d) || tt(u) ? O.disabled = !0 : O.disabled = !1
                    }
                    return O.addEventListener("click", (function() {
                        var e = b.nodeTypes.map((function(e) {
                                var t, n = {};
                                if (n.id = e.id, n.name = e.name, e.properties)
                                    for (n.properties = [], t = 0; t < e.properties.length; t += 1) n.properties.push({
                                        name: e.properties[t].name,
                                        name_alias: e.properties[t].name_alias
                                    });
                                return n
                            })),
                            t = b.edgeTypes.map((function(e) {
                                var t, n = {};
                                if (n.id = e.id, n.name = e.name, e.properties)
                                    for (n.properties = [], t = 0; t < e.properties.length; t += 1) n.properties.push({
                                        name: e.properties[t].name,
                                        name_alias: e.properties[t].name_alias
                                    });
                                return n
                            })),
                            n = {
                                isHub: l.get("isHub"),
                                belongsToHub: l.get("belongsToHub")
                            },
                            r = function(e, t, n) {
                                var r, o, a, i, c, l, d, u, p = [],
                                    f = [];
                                for (r = 0; r < t.length; r += 1)
                                    if (u = {}, (c = e[i = t[r].id].name_typeahead.typeahead("val")) === e[i].name) {
                                        if (l = e[i].id, d = at(t, l), e[i].properties)
                                            for (o = 0; o < e[i].properties.length; o += 1) {
                                                var h = e[i].properties[o].name,
                                                    g = e[i].properties[o].propname_typeahead.typeahead("val").trim();
                                                if (h !== g)
                                                    if (it(d, g)) {
                                                        for (a = 0; a < e[i].nodes.length; a += 1)
                                                            if (e[i].nodes[a].properties && Object.prototype.hasOwnProperty.call(e[i].nodes[a].properties, h)) {
                                                                var m = {
                                                                    action: "node_update",
                                                                    id: e[i].nodes[a].id,
                                                                    properties: {},
                                                                    prev: {
                                                                        properties: {}
                                                                    }
                                                                };
                                                                m.properties[g] = e[i].nodes[a].properties[h], m.prev.properties[g] = null, f.push(m)
                                                            }
                                                        var y = {
                                                            action: "nodetype_delete",
                                                            id: d.id,
                                                            properties: {}
                                                        };
                                                        y.properties[h] = null, f.push(y), rt(d, h)
                                                    } else f.push({
                                                        action: "nodetype_update",
                                                        id: d.id,
                                                        properties: [{
                                                            name: g,
                                                            name_alias: g
                                                        }],
                                                        prev: {
                                                            properties: [{
                                                                name: h,
                                                                name_alias: h
                                                            }]
                                                        }
                                                    }), nt(d, h, g)
                                            }
                                    } else if ((l = ot(t, c)) || (l = ot(p, c)), l) {
                                    if (d = at(p.concat(t), l), e[i].properties) {
                                        var b = {
                                            action: "nodetype_update",
                                            id: d.id,
                                            properties: [],
                                            prev: {
                                                properties: []
                                            }
                                        };
                                        for (o = 0; o < e[i].properties.length; o += 1) {
                                            var v = e[i].properties[o].name,
                                                _ = e[i].properties[o].propname_typeahead.typeahead("val").trim();
                                            v !== _ && (u[v] = _), it(d, _) || (b.properties.push({
                                                name: _,
                                                name_alias: _
                                            }), b.prev.properties.push({}), d.properties.push({
                                                name: _,
                                                name_alias: _
                                            }))
                                        }
                                        b.properties.length > 0 && f.push(b)
                                    }
                                    for (o = 0; o < e[i].nodes.length; o += 1) {
                                        var w = {
                                            action: "node_update",
                                            id: e[i].nodes[o].id,
                                            type: d.name,
                                            type_id: d.id,
                                            prev: {
                                                type: e[i].name,
                                                type_id: e[i].id
                                            }
                                        };
                                        if (e[i].nodes[o].properties)
                                            for (a in u) Object.prototype.hasOwnProperty.call(u, a) && Object.prototype.hasOwnProperty.call(e[i].nodes[o].properties, a) && (w.properties || (w.properties = {}, w.prev.properties = {}), w.properties[u[a]] = e[i].nodes[o].properties[a], w.prev.properties[u[a]] = null);
                                        f.push(w)
                                    }!n.isHub && n.belongsToHub || f.push({
                                        action: "nodetype_delete",
                                        id: e[i].id
                                    })
                                } else {
                                    l = Object(s.M)();
                                    var O = {
                                            id: i,
                                            name: c,
                                            prev: e[i].name
                                        },
                                        E = {
                                            action: "nodetype_update",
                                            id: i,
                                            name: c,
                                            prev: {
                                                name: e[i].name
                                            }
                                        };
                                    if (f.push(E), p.push(O), d = O, e[i].properties)
                                        for (O.properties = Object(s.o)(e[i].properties), o = 0; o < e[i].properties.length; o += 1) {
                                            var j = e[i].properties[o].name,
                                                S = e[i].properties[o].propname_typeahead.typeahead("val").trim();
                                            if (j !== S)
                                                if (it(d, S)) {
                                                    for (a = 0; a < e[i].nodes.length; a += 1)
                                                        if (e[i].nodes[a].properties && Object.prototype.hasOwnProperty.call(e[i].nodes[a].properties, j)) {
                                                            var x = {
                                                                action: "node_update",
                                                                id: e[i].nodes[a].id,
                                                                properties: {},
                                                                prev: {
                                                                    properties: {}
                                                                }
                                                            };
                                                            x.properties[S] = e[i].nodes[a].properties[j], x.prev.properties[S] = null, f.push(x)
                                                        }
                                                    var k = {
                                                        action: "nodetype_delete",
                                                        id: d.id,
                                                        properties: {}
                                                    };
                                                    k.properties[j] = null, f.push(k), rt(d, j)
                                                } else f.push({
                                                    action: "nodetype_update",
                                                    id: d.id,
                                                    properties: [{
                                                        name: S,
                                                        name_alias: S
                                                    }],
                                                    prev: {
                                                        properties: [{
                                                            name: j,
                                                            name_alias: j
                                                        }]
                                                    }
                                                }), nt(d, j, S)
                                        } else O.properties = []
                                }
                                return f
                            }(d, e, n),
                            o = function(e, t, n) {
                                var r, o, a, i, c, l, d, u, p = [],
                                    f = [];
                                for (r = 0; r < t.length; r += 1)
                                    if (u = {}, (c = e[i = t[r].id].name_typeahead.typeahead("val")) === e[i].name) {
                                        if (l = e[i].id, d = at(t, l), e[i].properties)
                                            for (o = 0; o < e[i].properties.length; o += 1) {
                                                var h = e[i].properties[o].name,
                                                    g = e[i].properties[o].propname_typeahead.typeahead("val").trim();
                                                if (h !== g)
                                                    if (it(d, g)) {
                                                        for (a = 0; a < e[i].edges.length; a += 1)
                                                            if (e[i].edges[a].properties && Object.prototype.hasOwnProperty.call(e[i].edges[a].properties, h)) {
                                                                var m = {
                                                                    action: "edge_update",
                                                                    id: e[i].edges[a].id,
                                                                    from: e[i].edges[a].from,
                                                                    to: e[i].edges[a].to,
                                                                    properties: {},
                                                                    prev: {
                                                                        properties: {}
                                                                    }
                                                                };
                                                                m.properties[g] = e[i].edges[a].properties[h], m.prev.properties[g] = null, f.push(m)
                                                            }
                                                        var y = {
                                                            action: "edgetype_delete",
                                                            id: d.id,
                                                            properties: {}
                                                        };
                                                        y.properties[h] = null, f.push(y), rt(d, h)
                                                    } else f.push({
                                                        action: "edgetype_update",
                                                        id: d.id,
                                                        properties: [{
                                                            name: g,
                                                            name_alias: g
                                                        }],
                                                        prev: {
                                                            properties: [{
                                                                name: h,
                                                                name_alias: h
                                                            }]
                                                        }
                                                    }), nt(d, h, g)
                                            }
                                    } else if ((l = ot(t, c)) || (l = ot(p, c)), l) {
                                    if (d = at(p.concat(t), l), e[i].properties) {
                                        var b = {
                                            action: "edgetype_update",
                                            id: d.id,
                                            properties: [],
                                            prev: {
                                                properties: []
                                            }
                                        };
                                        for (o = 0; o < e[i].properties.length; o += 1) {
                                            var v = e[i].properties[o].name,
                                                _ = e[i].properties[o].propname_typeahead.typeahead("val").trim();
                                            v !== _ && (u[v] = _), it(d, _) || (b.properties.push({
                                                name: _,
                                                name_alias: _
                                            }), b.prev.properties.push({}), d.properties.push({
                                                name: _,
                                                name_alias: _
                                            }))
                                        }
                                        b.properties.length > 0 && f.push(b)
                                    }
                                    for (o = 0; o < e[i].edges.length; o += 1) {
                                        var w = {
                                            action: "edge_update",
                                            id: e[i].edges[o].id,
                                            from: e[i].edges[o].from,
                                            to: e[i].edges[o].to,
                                            name: d.name,
                                            name_id: d.id,
                                            prev: {
                                                name: e[i].name,
                                                name_id: e[i].id
                                            }
                                        };
                                        if (e[i].edges[o].properties)
                                            for (a in u) Object.prototype.hasOwnProperty.call(u, a) && Object.prototype.hasOwnProperty.call(e[i].edges[o].properties, a) && (w.properties || (w.properties = {}, w.prev.properties = {}), w.properties[u[a]] = e[i].edges[o].properties[a], w.prev.properties[u[a]] = null);
                                        f.push(w)
                                    }!n.isHub && n.belongsToHub || f.push({
                                        action: "edgetype_delete",
                                        id: e[i].id
                                    })
                                } else {
                                    l = Object(s.M)();
                                    var O = {
                                            id: i,
                                            name: c,
                                            prev: e[i].name
                                        },
                                        E = {
                                            action: "edgetype_update",
                                            id: i,
                                            name: c,
                                            prev: {
                                                name: e[i].name
                                            }
                                        };
                                    if (f.push(E), p.push(O), d = O, e[i].properties)
                                        for (O.properties = Object(s.o)(e[i].properties), o = 0; o < e[i].properties.length; o += 1) {
                                            var j = e[i].properties[o].name,
                                                S = e[i].properties[o].propname_typeahead.typeahead("val").trim();
                                            if (j !== S)
                                                if (it(d, S)) {
                                                    for (a = 0; a < e[i].edges.length; a += 1)
                                                        if (e[i].edges[a].properties && Object.prototype.hasOwnProperty.call(e[i].edges[a].properties, j)) {
                                                            var x = {
                                                                action: "edge_update",
                                                                id: e[i].edges[a].id,
                                                                from: e[i].edges[a].from,
                                                                to: e[i].edges[a].to,
                                                                properties: {},
                                                                prev: {
                                                                    properties: {}
                                                                }
                                                            };
                                                            x.properties[S] = e[i].edges[a].properties[j], x.prev.properties[S] = null, f.push(x)
                                                        }
                                                    var k = {
                                                        action: "edgetype_delete",
                                                        id: d.id,
                                                        properties: {}
                                                    };
                                                    k.properties[j] = null, f.push(k), rt(d, j)
                                                } else f.push({
                                                    action: "edgetype_update",
                                                    id: d.id,
                                                    properties: [{
                                                        name: S,
                                                        name_alias: S
                                                    }],
                                                    prev: {
                                                        properties: [{
                                                            name: j,
                                                            name_alias: j
                                                        }]
                                                    }
                                                }), nt(d, j, S)
                                        } else O.properties = []
                                }
                                return f
                            }(u, t, n);
                        i && (i.call(null, r.concat(o)), _.close())
                    }), !1), _
                },
                ut = function(e, t, n) {
                    var r = n || {},
                        o = c.a["graphs/quality_check"]({
                            check_groups: t.checks,
                            no_header: r.read_only
                        });
                    document.body.appendChild(o.trim().toDOM());
                    var a = document.body.lastElementChild,
                        i = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: r.read_only ? null : "checklist"
                        }, e);
                    return Array.from(a.querySelectorAll('a[data-action="open-stories"]')).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), i.close(), r.onNewStoryRequested(), !1
                        }))
                    })), Array.from(a.querySelectorAll('a[data-action="open-graph-edit"]')).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), i.close(), r.onGraphEditRequested(), !1
                        }))
                    })), Array.from(a.querySelectorAll('a[data-action="open-analysis"]')).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), i.close(), r.onAnalysisRequested(), !1
                        }))
                    })), Array.from(a.querySelectorAll('a[data-action="open-clustering"]')).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), i.close(), r.onClusteringRequested(), !1
                        }))
                    })), Array.from(a.querySelectorAll('a[data-action="open-filters"]')).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), i.close(), r.onFiltersRequested(), !1
                        }))
                    })), Array.from(a.querySelectorAll('a[data-action="open-cartography"]')).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), i.close(), r.onCartographyRequested(), !1
                        }))
                    })), Array.from(a.querySelectorAll('a[data-action="open-datatable"]')).forEach((function(e) {
                        e.addEventListener("click", (function(e) {
                            return e.preventDefault(), i.close(), r.onDatatableRequested(), !1
                        }))
                    })), i
                },
                pt = function(e, t) {
                    var n = c.a["graphs/reference_check"](t);
                    document.body.appendChild(n.trim().toDOM());
                    var r = document.body.lastElementChild,
                        o = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: "references"
                        }, e);
                    return Array.from(r.querySelectorAll(".to-linkify")).forEach((function(e) {
                        Object(s.ab)(e)
                    })), o
                },
                ft = function(e, t, n) {
                    var r = e.graphStore,
                        o = e.GraphHistory,
                        a = r.get("status"),
                        i = {
                            is_private: 2 == a,
                            is_wip: 0 == a,
                            is_published: 1 == a
                        };
                    if (o && r.get("belongsToHub")) i.show_upgrade = !1;
                    else if (xe.a && "function" === typeof xe.a.getUser) {
                        var l = xe.a.getUser();
                        l && l.id && (i.show_upgrade = "Free" == l.plan)
                    }
                    var d = c.a["graphs/status_dialogue"](i);
                    document.body.appendChild(d.trim().toDOM());
                    var u = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: "status",
                            close_others: !0,
                            onCancel: n
                        }, e),
                        p = document.body.lastElementChild,
                        f = p.querySelector(".gc-dlg-action"),
                        h = f.querySelector(".gc-btn-confirm");
                    h.addEventListener("click", (function() {
                        m.classList.add("not-shown"), h.firstChild.data = "Working...", h.disabled = !0, g.disabled = !0, t ? setTimeout((function() {
                            var e = p.querySelector(' input[type="radio"]:checked'),
                                n = parseInt(e.value),
                                r = document.querySelector("a.share span.status-title");
                            0 == n ? r.className = "status-title wip-icon" : 1 == n ? r.className = "status-title globe-icon" : 2 == n && (r.className = "status-title lock-icon"), t(n, (function(e) {
                                e ? (m.classList.remove("not-shown"), m.innerHTML = e.msg, h.firstChild.data = "OK", h.disabled = !1, g.disabled = !1) : u.close()
                            }))
                        }), 50) : u.close()
                    }), !1), h.disabled = !1;
                    var g = f.querySelector(".gc-dlg-cancel");
                    u.closeButton(g);
                    var m = f.querySelector(".gc-dlg-error");
                    return u
                },
                ht = function(e, t) {
                    var n = c.a["hubs/hub_data_privacy_dialog"]({});
                    document.body.appendChild(n.trim().toDOM());
                    var r = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        o = document.body.lastElementChild.querySelector(".gc-dlg-action"),
                        a = o.querySelector(".gc-btn-confirm");
                    a.addEventListener("click", (function() {
                        d.classList.add("not-shown"), a.firstChild.data = "Working...", a.disabled = !0, l.disabled = !0, r.setWorking(!0);
                        Object(i.setHubDataStatus)(t, 1, (function() {
                            r.close()
                        }), (function(e) {
                            console.log(e), a.firstChild.data = "SAVE", a.disabled = !1, l.disabled = !1, r.setWorking(!1), d.classList.remove("not-shown"), d.innerHTML = "Please try again"
                        }))
                    }), !1), a.disabled = !1;
                    var l = o.querySelector(".gc-dlg-cancel");
                    r.closeButton(l);
                    var d = o.querySelector(".gc-dlg-error")
                },
                gt = n(16);

            function mt(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function yt(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? mt(Object(n), !0).forEach((function(t) {
                        bt(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : mt(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function bt(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var vt = function(e, t) {
                    var n = {
                            is_admin: t.is_admin
                        },
                        o = c.a["hubs/members_panel"](n);
                    document.body.appendChild(o.trim().toDOM());
                    var a, l = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: "members",
                            close_others: !0
                        }, {}),
                        d = document.body.lastElementChild,
                        u = d.querySelector(".gc-pnl"),
                        p = Object(r.a)(u.querySelector("ul.users")),
                        f = [],
                        h = [],
                        g = function(n) {
                            var r = n.attr("user-id"),
                                o = r == t.id,
                                a = n.find(".remove-item");
                            a.hasClass("hidden") || a.click((function() {
                                confirm(o ? "Are you sure you want to remove yourself from this hub?" : "Are you sure you want to remove this user from this hub?") && Object(i.removeHubMember)(r, e, (function() {
                                    n.remove(), f.splice(f.indexOf(r), 1)
                                }))
                            })), n.find(".collab-status").on("change", (function(t) {
                                t.preventDefault();
                                var n = this;
                                return n.disabled = !0, confirm(o ? "Are you sure you want to change your own member status?" : "Are you sure you want to change the status of this member?") ? (Object(i.updateHubMemberStatus)(r, e, 1 == n.selectedIndex, (function() {
                                    o && window.location.reload()
                                }), (function() {
                                    n.selectedIndex = 1 - n.selectedIndex
                                }), (function(e) {
                                    n.disabled = !1, console.log(e.responseJSON)
                                })), !1) : (n.disabled = !1, void(n.selectedIndex = 1 - n.selectedIndex))
                            }))
                        },
                        m = function(e) {
                            var t = e.attr("user-id"),
                                n = e.attr("user-name"),
                                r = e.find(".remove-item");
                            r.hasClass("hidden") || r.click((function(r) {
                                r.preventDefault(), r.stopPropagation();
                                confirm("Are you sure to cancel the invitation for this user?") && Object(i.deleteInvitation)(t, (function() {
                                    e.remove(), f.splice(f.indexOf(t), 1), h = h.filter((function(e) {
                                        return e !== n
                                    }))
                                }))
                            }))
                        };
                    Object(i.getHubMembers)(e, (function(n) {
                        f = n.map((function(e) {
                            return e.id
                        })), h = n.filter((function(e) {
                            return e.invited
                        })).map((function(e) {
                            return e.username
                        })), a && a.clear();
                        for (var o = 0; o < n.length; o += 1) {
                            n[o].invited ? (n[o].allow_remove = t.is_admin, n[o].allow_editor_update = !1, n[o].role = "Invited, membership pending...") : (n[o].allow_remove = !n[o].is_owner && (n[o].id == t.id || t.is_admin), n[o].allow_editor_update = !n[o].is_owner && t.is_admin, n[o].role = n[o].is_owner ? "Owner" : n[o].is_admin ? "Admin" : "Member");
                            var l = Object(r.a)(c.a["hubs/member_li"](n[o]));
                            p.append(l), n[o].invited ? m(l) : g(l)
                        }! function() {
                            a = Object(s.T)([]);
                            var n = Object(r.a)("input#ttMemberSearch");

                            function o() {
                                v.classList.add("not-shown"), n.unbind("keydown", o)
                            }
                            n.typeahead(yt(yt({}, s.b), {}, {
                                hint: !0,
                                highlight: !1,
                                minLength: 2
                            }), yt(yt({}, s.c), {}, {
                                name: "users",
                                displayKey: "value",
                                source: function(e, t, n) {
                                    a.search(e, null, (function(t) {
                                        var r = Object(gt.keyBy)(f),
                                            o = Object(gt.keyBy)(h);
                                        0 === t.length ? o[e.trim()] ? n([{
                                            already_invited: !0
                                        }]) : n([{
                                            empty: !0,
                                            query: e
                                        }]) : 1 === t.length && r[t[0].id] ? n([{
                                            already_member: !0
                                        }]) : n(t.filter((function(e) {
                                            return !r[e.id]
                                        })))
                                    }))
                                },
                                templates: {
                                    suggestion: c.a["hubs/member_suggestion"]
                                }
                            })).on("typeahead:selected", (function(s, l) {
                                l.empty ? Object(i.inviteToHub)(l.query, e, (function(e) {
                                    (e = e.user).allow_remove = t.is_admin, e.allow_editor_update = !1, e.role = "Invited, membership pending...";
                                    var n = Object(r.a)(c.a["hubs/member_li"](e));
                                    p.append(n), m(n), f.push(e.id), h.push(e.username), a.clear()
                                }), (function(e) {
                                    var t = e.responseJSON;
                                    t && t.recipient_email ? v.innerHTML = "email " + t.recipient_email[0] : v.innerHTML = "Please try again", v.classList.remove("not-shown"), n.keydown(o)
                                })) : Object(i.addHubMember)(l.id, e, (function(e) {
                                    (e = e.user).allow_remove = !e.is_owner && (e.id == t.id || t.is_admin), e.allow_editor_update = !e.is_owner && t.is_admin;
                                    var n = Object(r.a)(c.a["hubs/member_li"](e));
                                    p.append(n), g(n), f.push(l.id)
                                }), (function() {
                                    v.innerHTML = "Error adding member", v.classList.remove("not-shown")
                                }))
                            }))
                        }()
                    }), (function(e) {
                        console.log(e), alert("Error retrieving members. Try again")
                    }));
                    var y = d.querySelector(".gc-pnl-action"),
                        b = y.querySelector(".gc-dlg-cancel");
                    l.closeButton(b);
                    var v = y.querySelector(".gc-dlg-error");
                    return l
                },
                _t = n(1),
                wt = n.n(_t),
                Ot = n(38),
                Et = n.n(Ot),
                jt = n(72),
                St = function(e, t) {
                    t && t.is_admin;
                    var n = document.createElement("div");
                    n.classList.add("full-cover"), document.body.appendChild(n), Et.a.render(wt.a.createElement(jt.b, {
                        hubId: e,
                        onClose: function() {
                            return r.close()
                        }
                    }), n);
                    var r = Object(s.bb)({
                        element: n,
                        url_param: "taxonomy",
                        close_others: !0
                    }, {})
                };

            function xt(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function kt(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? xt(Object(n), !0).forEach((function(t) {
                        Ct(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : xt(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function Ct(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }
            var Nt = function(e) {
                    var t, n, r = !1;
                    for (t in e)
                        if (Object.prototype.hasOwnProperty.call(e, t)) {
                            if ("" === e[t].name_typeahead.typeahead("val").trim()) {
                                r = !0;
                                break
                            }
                            if (e[t].properties)
                                for (n = 0; n < e[t].properties.length; n += 1)
                                    if ("" === e[t].properties[n].propname_typeahead.typeahead("val")) {
                                        r = !0;
                                        break
                                    }
                        }
                    return r
                },
                Tt = function(e, t, n) {
                    var r, o = e.length;
                    for (r = 0; r < o; r += 1)
                        if (e[r].action === t && e[r].id === n) return e[r];
                    return null
                },
                Lt = function(e, t) {
                    var n;
                    for (n = e.length - 1; n >= 0; n -= 1)
                        if (e[n].name === t) return e[n].id;
                    return null
                },
                Pt = function(e, t) {
                    var n;
                    for (n = e.length - 1; n >= 0; n -= 1)
                        if (e[n].id === t) return e[n];
                    return null
                },
                At = function(e, t) {
                    var n, r = e.properties;
                    if (!r || 0 === r.length) return !1;
                    for (n = r.length - 1; n >= 0; n -= 1)
                        if (r[n].name === t) return !0;
                    return !1
                },
                Dt = function(e, t, n) {
                    var o = [],
                        a = [],
                        i = function() {
                            var e = Object(r.a)(this);
                            e.typeahead("val", ""), e.typeahead("val", "a"), e.typeahead("val", ""), e.typeahead("open")
                        },
                        s = function() {
                            o = [], a.forEach((function(e) {
                                e.removeClass("dropdown"), e.off("focus", i)
                            }));
                            var r = function(e, t) {
                                var n;
                                for (n = e.length - 1; n >= 0; n -= 1)
                                    if (e[n].name === t) return e[n];
                                return null
                            }(t.concat(n), e.typeahead("val"));
                            r && r.properties && r.properties.length > 0 && (o = r.properties, a.forEach((function(e) {
                                e.addClass("dropdown"), e.on("focus", i)
                            })))
                        };
                    return e.on("blur", (function() {
                        s()
                    })), {
                        addTT: function(e) {
                            a.push(e), s()
                        },
                        fn: function(e, t) {
                            var n, a;
                            n = [], a = new RegExp(e, "i"), r.a.each(o, (function(e, t) {
                                a.test(t.name) && n.push(t)
                            })), t(n)
                        }
                    }
                },
                Mt = function(e) {
                    return function(t, n) {
                        var o, a;
                        o = [], a = new RegExp(t, "i"), r.a.each(e, (function(e, t) {
                            a.test(t.name) && o.push(t)
                        })), n(o)
                    }
                },
                qt = 0,
                It = function(e, t, n, o, a, i) {
                    var l, d = {},
                        u = {},
                        p = {};
                    for (l = 0; l < t.length; l += 1) switch (t[l].action) {
                        case "nodetype_create":
                            u[t[l].id] = {
                                id: t[l].id,
                                name: t[l].name,
                                count: 0
                            }, Array.isArray(t[l].properties) && (u[t[l].id].properties = t[l].properties.map((function(e) {
                                return {
                                    name: e.name
                                }
                            })));
                            break;
                        case "edgetype_create":
                            p[t[l].id] = {
                                id: t[l].id,
                                name: t[l].name,
                                count: 0
                            }, Array.isArray(t[l].properties) && (p[t[l].id].properties = t[l].properties.map((function(e) {
                                return {
                                    name: e.name
                                }
                            })));
                            break;
                        case "node_create":
                            u[t[l].type_id].count += 1;
                            break;
                        case "edge_create":
                            p[t[l].name_id].count += 1
                    }
                    d.nodeTypes = Object(s.gb)(u), d.edgeTypes = Object(s.gb)(p);
                    var f = c.a["graphs/merge_panel"](d);
                    document.body.appendChild(f.trim().toDOM());
                    var h = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                i && i.call()
                            }
                        }, e),
                        g = document.body.lastElementChild,
                        m = g.querySelector(".gc-btn-confirm"),
                        y = g.querySelector(".gc-dlg-cancel");
                    h.closeButton(y);
                    for (var b, v, _, w = g.querySelectorAll("table.for-nodetypes tbody tr"), O = g.querySelectorAll("table.for-edgetypes tbody tr"), E = function(e) {
                            h.setWorking(e > 0)
                        }, j = 1 === w.length, S = 0; S < w.length; S += 1) {
                        v = (b = w[S]).getAttribute("id").substring(3);
                        var x = b.querySelectorAll("td");
                        _ = Object(r.a)(x[2].querySelector(".nodetype.typeahead")), u[v].name_typeahead = _.typeahead(kt(kt({}, s.b), {}, {
                            hint: !0
                        }), kt(kt({}, s.c), {}, {
                            name: "nodetypes",
                            displayKey: "name",
                            source: Mt(n)
                        })).on("typeahead:selected", (function() {
                            M()
                        })).on("blur", (function() {
                            M(), qt = Math.max(0, qt - 1), h.setWorking(qt > 0)
                        })).on("focus", (function() {
                            E(qt += 1)
                        })), j ? _.removeClass("dropdown") : u[v].name_typeahead.on("focus", (function() {
                            var e = Object(r.a)(this);
                            e.typeahead("val", ""), e.typeahead("val", "a"), e.typeahead("val", ""), e.typeahead("open")
                        }));
                        var k = x[3].querySelectorAll("div");
                        if (k.length > 0)
                            for (var C = Dt(u[v].name_typeahead, n, d.nodeTypes), N = 0; N < k.length; N += 1) _ = Object(r.a)(k[N].querySelector("input.propname.typeahead")), u[v].properties[N].propname_typeahead = _.typeahead(kt(kt({}, s.b), {}, {
                                hint: !0
                            }), kt(kt({}, s.c), {}, {
                                name: "nodetype-properties",
                                displayKey: "name",
                                source: C.fn
                            })).on("focus", (function() {
                                E(qt += 1)
                            })).on("typeahead:selected", (function() {
                                M()
                            })).on("blur", (function() {
                                M(), qt = Math.max(0, qt - 1), h.setWorking(qt > 0)
                            })), C.addTT(u[v].properties[N].propname_typeahead)
                    }
                    var T = 1 === O.length;
                    for (l = 0; l < O.length; l += 1) {
                        v = (b = O[l]).getAttribute("id").substring(3);
                        var L = b.querySelectorAll("td");
                        _ = Object(r.a)(b.querySelector(".edgetype.typeahead")), p[v].name_typeahead = _.typeahead(kt(kt({}, s.b), {}, {
                            hint: !0
                        }), kt(kt({}, s.c), {}, {
                            name: "nodetypes",
                            displayKey: "name",
                            source: Mt(o)
                        })).on("typeahead:selected", (function() {
                            M()
                        })).on("blur", (function() {
                            M(), qt = Math.max(0, qt - 1), h.setWorking(qt > 0)
                        })).on("focus", (function() {
                            E(qt += 1)
                        })), T ? _.removeClass("dropdown") : p[v].name_typeahead.on("focus", (function() {
                            var e = Object(r.a)(this);
                            e.typeahead("val", ""), e.typeahead("val", "a"), e.typeahead("val", ""), e.typeahead("open")
                        }));
                        var P = L[3].querySelectorAll("div");
                        if (P.length > 0)
                            for (var A = Dt(p[v].name_typeahead, o, d.edgeTypes), D = 0; D < P.length; D += 1) _ = Object(r.a)(P[D].querySelector("input.propname.typeahead")), p[v].properties[D].propname_typeahead = _.typeahead(kt(kt({}, s.b), {}, {
                                hint: !0
                            }), kt(kt({}, s.c), {}, {
                                name: "edgetype-properties",
                                displayKey: "name",
                                source: A.fn
                            })).on("focus", (function() {
                                E(qt += 1)
                            })).on("typeahead:selected", (function() {
                                M()
                            })).on("blur", (function() {
                                M(), qt = Math.max(0, qt - 1), h.setWorking(qt > 0)
                            })), A.addTT(p[v].properties[D].propname_typeahead)
                    }

                    function M() {
                        Nt(u) || Nt(p) ? m.disabled = !0 : m.disabled = !1
                    }
                    return m.addEventListener("click", (function() {
                        var e = d.nodeTypes.map((function(e) {
                                return e.id
                            })),
                            r = d.edgeTypes.map((function(e) {
                                return e.id
                            })),
                            i = function(e, t, n, r) {
                                var o, a, i, c, l, d, u, p, f = [],
                                    h = [];
                                for (o = 0; o < e.length; o += 1) {
                                    if (p = {}, l = t[c = e[o]].name_typeahead.typeahead("val"), (d = Lt(n, l)) || (d = Lt(f, l)), d) {
                                        var g = Tt(r, "nodetype_create", c);
                                        if (g.properties && g.properties.length > 0) {
                                            var m = {
                                                action: "nodetype_update",
                                                id: d,
                                                properties: [],
                                                prev: {
                                                    properties: []
                                                }
                                            };
                                            for (u = Pt(f.concat(n), d), a = t[c].properties.length - 1; a >= 0; a -= 1) {
                                                var y = t[c].properties[a].name,
                                                    b = t[c].properties[a].propname_typeahead.typeahead("val");
                                                y !== b && (p[y] = b)
                                            }
                                            for (a = 0; a < g.properties.length; a += 1) {
                                                var v = g.properties[a].name;
                                                Object.prototype.hasOwnProperty.call(p, v) && (v = p[v]), At(u, v) || (m.properties.push({
                                                    name: v,
                                                    name_alias: v
                                                }), m.prev.properties.push({}), u.properties || (u.properties = [{}]), u.properties.push({
                                                    name: v,
                                                    name_alias: v
                                                }))
                                            }
                                            m.properties.length > 0 && h.push(m)
                                        }
                                    } else {
                                        var _ = {
                                                id: d = Object(s.M)(),
                                                name: l
                                            },
                                            w = Tt(r, "nodetype_create", c),
                                            O = Object(s.p)(w);
                                        if (O.id = d, O.name = l, _.properties = O.properties, t[c].properties)
                                            for (a = t[c].properties.length - 1; a >= 0; a -= 1) {
                                                var E = t[c].properties[a].name,
                                                    j = t[c].properties[a].propname_typeahead.typeahead("val");
                                                E !== j && (p[E] = j, At(_, j) ? _.properties.splice(a, 1) : (_.properties[a].name = j, _.properties[a].name_alias = j))
                                            }
                                        h.push(O), f.push(_), u = _
                                    }
                                    for (a = 0; a < r.length; a += 1)
                                        if ("node_create" === r[a].action && r[a].type_id === c) {
                                            if (r[a].type = l, r[a].type_id = d, r[a].properties)
                                                for (i in p) Object.prototype.hasOwnProperty.call(p, i) && Object.prototype.hasOwnProperty.call(r[a].properties, i) && (r[a].properties[p[i]] = r[a].properties[i], delete r[a].properties[i]);
                                            h.push(r[a])
                                        }
                                }
                                return h
                            }(e, u, n, t),
                            c = function(e, t, n, r) {
                                var o, a, i, c, l, d, u, p, f = [],
                                    h = [];
                                for (o = 0; o < e.length; o += 1) {
                                    if (p = {}, l = t[c = e[o]].name_typeahead.typeahead("val"), (d = Lt(n, l)) || (d = Lt(f, l)), d) {
                                        var g = Tt(r, "edgetype_create", c);
                                        if (g.properties && g.properties.length > 0) {
                                            var m = {
                                                action: "edgetype_update",
                                                id: d,
                                                properties: [],
                                                prev: {
                                                    properties: []
                                                }
                                            };
                                            for (u = Pt(f.concat(n), d), a = t[c].properties.length - 1; a >= 0; a -= 1) {
                                                var y = t[c].properties[a].name,
                                                    b = t[c].properties[a].propname_typeahead.typeahead("val");
                                                y !== b && (p[y] = b)
                                            }
                                            for (a = 0; a < g.properties.length; a += 1) {
                                                var v = g.properties[a].name;
                                                Object.prototype.hasOwnProperty.call(p, v) && (v = p[v]), At(u, v) || (m.properties.push({
                                                    name: v,
                                                    name_alias: v
                                                }), m.prev.properties.push({}), u.properties || (u.properties = [{}]), u.properties.push({
                                                    name: v,
                                                    name_alias: v
                                                }))
                                            }
                                            m.properties.length > 0 && h.push(m)
                                        }
                                    } else {
                                        var _ = {
                                                id: d = Object(s.M)(),
                                                name: l
                                            },
                                            w = Tt(r, "edgetype_create", c),
                                            O = Object(s.p)(w);
                                        if (O.id = d, O.name = l, _.properties = O.properties, t[c].properties)
                                            for (a = t[c].properties.length - 1; a >= 0; a -= 1) {
                                                var E = t[c].properties[a].name,
                                                    j = t[c].properties[a].propname_typeahead.typeahead("val");
                                                E !== j && (p[E] = j, At(_, j) ? _.properties.splice(a, 1) : (_.properties[a].name = j, _.properties[a].name_alias = j))
                                            }
                                        h.push(O), f.push(_), u = _
                                    }
                                    for (a = 0; a < r.length; a += 1)
                                        if ("edge_create" === r[a].action && r[a].name_id === c) {
                                            if (r[a].name = l, r[a].name_id = d, r[a].properties)
                                                for (i in p) Object.prototype.hasOwnProperty.call(p, i) && Object.prototype.hasOwnProperty.call(r[a].properties, i) && (r[a].properties[p[i]] = r[a].properties[i], delete r[a].properties[i]);
                                            h.push(r[a])
                                        }
                                }
                                return h
                            }(r, p, o, t);
                        a && (a.call(null, i.concat(c)), h.close())
                    }), !1), h
                },
                Rt = function(e, t, n) {
                    var r = t.current_plan_limit - t.private_nodes_remaining,
                        o = r - t.existing_private_nodes,
                        a = -1 * t.private_nodes_remaining,
                        i = Math.floor(t.existing_private_nodes / r * 100),
                        l = Math.floor(t.private_nodes_remaining / r * -100),
                        d = 100 - i - l,
                        u = "";
                    u = "Free" === t.plan_name ? "You need to have a paid plan to create and save private graphs.<br />" : "With the addition of " + o + " new private nodes, you will exceed the private data limit on your <em>" + t.plan_name + " plan (" + t.current_plan_limit + ")</em>.<br /><br />";
                    var p = {
                            message: u += "Please consider upgrading to <strong>" + t.rec_plan_name + " Plan (" + t.rec_plan_limit + ")</strong> to be able to save your graph as private.",
                            current: i,
                            remaining: d,
                            exceeding: l,
                            existing_count: t.existing_private_nodes,
                            remaining_count: t.current_plan_limit - t.existing_private_nodes,
                            exceeding_count: a,
                            show_progress: "Free" !== t.plan_name
                        },
                        f = c.a["graphs/plan_upgrade_dialog"](p);
                    document.body.appendChild(f.trim().toDOM());
                    var h = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: n
                        }, e),
                        g = document.body.lastElementChild.querySelector(".gc-dlg-action");
                    g.querySelector(".gc-btn-confirm").addEventListener("click", (function() {
                        h.close(), window.open("/me/billing", "_blank")
                    }), !1);
                    var m = g.querySelector(".gc-dlg-cancel");
                    h.closeButton(m)
                },
                Bt = function(e, t) {
                    var n, o = e.uiStore,
                        a = e.graphStore,
                        d = e.GraphHistory,
                        u = d.getNodeTypes(),
                        p = d.getEdgeTypes(),
                        f = a.get("id"),
                        h = {},
                        g = {},
                        m = function(t) {
                            n.close(), k.attr({
                                value: "Save"
                            }).removeAttr("disabled"), It(e, t, u, p, (function(t) {
                                f ? function(t) {
                                    z(e, "Please Wait", "Saving data..", (function(n) {
                                        var r = {
                                            graph: {
                                                id: f,
                                                history: t,
                                                import: !0
                                            }
                                        };
                                        Object(i.saveGraph)(f, r, (function() {
                                            Object(s.lb)("/graphs/" + f + "?show=Graph&auto=true")
                                        }), (function(t) {
                                            n(), 402 === t.status ? y(t.responseJSON, (function() {
                                                E.setWorking(!1)
                                            })) : l(e, "Error", "We could not import your data.<br />Please try again", (function() {
                                                E.setWorking(!1)
                                            }))
                                        }))
                                    }))
                                }(t) : function(t) {
                                    var n = {
                                            graph: {
                                                history: t,
                                                import: !0
                                            }
                                        },
                                        r = ke(e, "Set name and status of your new graph", (function(t, o, s) {
                                            n.graph.status = o, t && (n.graph.name = t), a.get("belongsToHub") && (n.graph.hub = a.get("hub").id), z(e, "Please Wait", "Saving data..", (function(t) {
                                                Object(i.saveNewGraph)(n, (function(e) {
                                                    t(), window.location = "/graphs/" + e.id + "?show=Graph&auto=true"
                                                }), (function(n) {
                                                    t(), 402 === n.status ? y(n.responseJSON, s) : (r.close(), l(e, "Error", "We could not import your data.<br />Please try again", (function() {
                                                        E.setWorking(!1)
                                                    })))
                                                }))
                                            }))
                                        }), (function() {
                                            E.setWorking(!1)
                                        }))
                                }(t)
                            }), (function() {
                                E.setWorking(!1)
                            }))
                        };

                    function y(t, n) {
                        Rt(e, t, n)
                    }
                    var b = function(t) {
                            n.close(), k.attr({
                                value: "Save"
                            }).removeAttr("disabled");
                            var r = "We could not read your data. <br />Please try again";
                            t && t.warning && (r = t.warning), l(e, "Error", r, (function() {
                                E.setWorking(!1)
                            }))
                        },
                        v = function(e) {
                            var t = Object(r.a)(e);
                            h[t.attr("name")] = void 0, g[t.attr("name")] = void 0, t.val("")
                        },
                        _ = document.querySelector('meta[name="csrf-token"]'),
                        w = {
                            id: a.get("id"),
                            token: _ ? _.getAttribute("content") : "",
                            read_only: o.get("readOnly")
                        },
                        O = c.a["graphs/import_panel"](w);
                    document.body.appendChild(O.trim().toDOM());
                    var E = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                t && t.call()
                            },
                            close_others: !0,
                            url_param: "import"
                        }, e),
                        j = document.lastElementChild.querySelector(".gc-dlg-cancel");
                    E.closeButton(j);
                    var S, x, k = Object(r.a)("button[type=submit]");
                    return Object(r.a)(document).foundation({
                        tab: {
                            callback: function(e) {
                                console.log(e)
                            }
                        }
                    }), S = Object(r.a)("form"), x = S.fileupload({
                        type: "POST",
                        autoUpload: !1,
                        replaceFileInput: !1,
                        fileInput: Object(r.a)("input:file")
                    }).on("fileuploadadd", (function(e, t) {
                        h[t.paramName] = t.files[0], g[t.paramName] = e.delegatedEvent.target.name
                    })).on("fileuploaddone", (function(e, t) {
                        t.result ? m(t.result) : b()
                    })).on("fileuploadfail", (function(e, t) {
                        b(t.jqXHR.responseJSON)
                    })), S.submit((function(t) {
                        t.preventDefault(), E.setWorking(!0), k.attr({
                            disabled: "disabled",
                            value: "Saving, please wait..."
                        }), n = z(e, "Please Wait", "Preparing data...");
                        var o = Object(s.gb)(h),
                            a = Object(s.gb)(g);
                        return o.length > 0 ? (x.fileupload("send", {
                            files: o,
                            paramName: a,
                            formData: S.serializeArray()
                        }), !1) : (Object(r.a)(this).ajaxSubmit({
                            success: function(e) {
                                e ? m(e) : b()
                            },
                            error: function(e) {
                                b(e.responseJSON)
                            },
                            beforeSubmit: function(e) {
                                var t;
                                for (t = e.length - 1; t >= 0; t -= 1) "file" === e[t].type && "" === e[t].value && e.splice(t, 1)
                            }
                        }), !1)
                    })), Object(r.a)("input[type=file]#graph_csv_edges_file").on("change", (function() {
                        Object(r.a)("input#graph_import_url1").val(""), Object(r.a)("input#graph_import_url").val(""), v("input[type=file]#graph_json_file")
                    })), Object(r.a)("input#graph_import_url1").on("change", (function() {
                        v("input[type=file]#graph_csv_edges_file"), Object(r.a)("input#graph_import_url").val(""), v("input[type=file]#graph_json_file")
                    })), Object(r.a)("input[type=file]#graph_csv_nodes_file").on("change", (function() {
                        Object(r.a)("input#graph_import_url2").val(""), Object(r.a)("input#graph_import_url").val(""), v("input[type=file]#graph_json_file")
                    })), Object(r.a)("input#graph_import_url2").on("change", (function() {
                        v("input[type=file]#graph_csv_nodes_file"), Object(r.a)("input#graph_import_url").val(""), v("input[type=file]#graph_json_file")
                    })), Object(r.a)("input[type=file]#graph_json_file").on("change", (function() {
                        Object(r.a)("input#graph_import_url").val(""), Object(r.a)("input#graph_import_url1").val(""), v("input[type=file]#graph_csv_edges_file"), v("input[type=file]#graph_csv_nodes_file"), Object(r.a)("input#graph_import_url2").val("")
                    })), Object(r.a)("input#graph_import_url").on("change", (function() {
                        v("input[type=file]#graph_json_file"), Object(r.a)("input#graph_import_url1").val(""), v("input[type=file]#graph_csv_edges_file"), v("input[type=file]#graph_csv_nodes_file"), Object(r.a)("input#graph_import_url2").val("")
                    })), E
                },
                Ft = function(e, t, n) {
                    var r = e.graphStore,
                        o = function(e) {
                            return "Creative Commons " + (e.cc_by ? "Attribution" : "") + (e.cc_nc ? "-Non Commercial" : "") + (e.cc_sa ? "-Share Alike" : "") + (e.cc_nd ? "-No Derivatives" : "") + " 4.0 International"
                        },
                        a = {
                            license: {
                                cc_by: r.get("license").cc_by,
                                cc_nc: r.get("license").cc_nc,
                                cc_sa: r.get("license").cc_sa,
                                cc_nd: r.get("license").cc_nd
                            }
                        };
                    a.license.type = o(a.license);
                    var i = c.a["graphs/license_panel"](a);
                    document.body.appendChild(i.trim().toDOM());
                    var l, d = Object(s.bb)({
                            element: document.body.lastElementChild,
                            url_param: "license",
                            close_others: !0,
                            onCancel: n
                        }, e),
                        u = document.body.lastElementChild,
                        p = u.querySelector(".gc-dlg"),
                        f = p.querySelector(".license-text"),
                        h = p.querySelector(".license_cc_nc"),
                        g = p.querySelector(".license_cc_nd"),
                        m = p.querySelector(".license_cc_sa"),
                        y = document.getElementsByName("graph[license_cc_nc]");
                    for (l = 0; l < y.length; l += 1) y[l].addEventListener("click", (function() {
                        parseInt(this.value) ? (h.classList.remove("not-shown"), a.license.cc_nc = !0) : (h.classList.add("not-shown"), a.license.cc_nc = !1), f.innerHTML = o(a.license)
                    }), !1);
                    var b = document.getElementsByName("graph[license_cc_nd]");
                    for (l = 0; l < b.length; l += 1) b[l].addEventListener("click", (function() {
                        switch (parseInt(this.value)) {
                            case 0:
                                g.classList.add("not-shown"), m.classList.add("not-shown"), a.license.cc_nd = !1, a.license.cc_sa = !1;
                                break;
                            case 1:
                                g.classList.add("not-shown"), m.classList.remove("not-shown"), a.license.cc_nd = !1, a.license.cc_sa = !0;
                                break;
                            case 2:
                                g.classList.remove("not-shown"), m.classList.add("not-shown"), a.license.cc_nd = !0, a.license.cc_sa = !1
                        }
                        f.innerHTML = o(a.license)
                    }), !1);
                    var v = u.querySelector(".gc-dlg-action"),
                        _ = v.querySelector(".gc-btn-confirm");
                    _.disabled = !1, _.addEventListener("click", (function(e) {
                        return t ? (O.classList.add("not-shown"), _.firstChild.data = "Working...", _.disabled = !0, w.disabled = !0, t.call(null, a.license, (function() {
                            d.close()
                        }), (function() {
                            O.classList.remove("not-shown"), O.innerHTML = "Please try again!", _.firstChild.data = "SAVE", _.disabled = !1, w.disabled = !1
                        }))) : d.close(), e.preventDefault(), !1
                    }), !1);
                    var w = v.querySelector(".gc-dlg-cancel");
                    d.closeButton(w);
                    var O = v.querySelector(".gc-dlg-error");
                    return d
                },
                Gt = function(e, t, n, r, o, a) {
                    var i = function() {
                        var e = m.value.trim(),
                            t = y.value;
                        e && (v.innerHTML = "Updating...", v.disabled = !0, o ? setTimeout((function() {
                            o(e, t, (function() {
                                f.close()
                            }))
                        }), 100) : f.close())
                    };

                    function l(e) {
                        13 === e.keyCode && i()
                    }

                    function d() {
                        v.disabled = !m.value.trim()
                    }
                    var u = {
                            title: t,
                            input_text: n,
                            color: r,
                            button_text: "UPDATE",
                            warning: a
                        },
                        p = c.a["graphs/name_color_dialogue"](u);
                    document.body.appendChild(p.trim().toDOM());
                    var f = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                m.removeEventListener("keyup", d, !1), m.removeEventListener("keydown", l, !1)
                            }
                        }, e),
                        h = document.body.lastElementChild,
                        g = h.querySelector(".gc-dlg-body"),
                        m = g.querySelector('input[type="text"]');
                    m.addEventListener("keyup", d, !1), m.addEventListener("keydown", l, !1);
                    var y = g.querySelector('input[type="color"]'),
                        b = h.querySelector(".gc-dlg-action"),
                        v = b.querySelector(".gc-btn-confirm");
                    v.addEventListener("click", i, !1), m.value.trim() && (v.disabled = !1);
                    var _ = b.querySelector(".gc-dlg-cancel");
                    return f.closeButton(_), m.focus(), f
                },
                Ht = function(e, t) {
                    var n = {
                            url: t
                        },
                        r = c.a["graphs/copy_node_link"](n);
                    document.body.appendChild(r.trim().toDOM());
                    var o = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: null
                        }, e),
                        a = document.body.lastElementChild,
                        i = a.querySelector(".gc-dlg").querySelector(".node-url");
                    i.addEventListener("focus", (function() {
                        this.select()
                    }), !1);
                    var l = a.querySelector(".gc-dlg-cancel");
                    o.closeButton(l), i.focus()
                },
                Ut = function(e, t) {
                    var n = c.a["site/staging_warning"]({});
                    document.body.appendChild(n.trim().toDOM());
                    var r = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        o = document.body.lastElementChild,
                        a = o.querySelector(".gc-dlg"),
                        i = o.querySelector(".gc-dlg-cancel");
                    return r.closeButton(i), a.querySelector("button.btnRedirect").addEventListener("click", (function(e) {
                        return e.preventDefault(), Object(s.lb)("https://graphcommons.com" + t), !1
                    })), r
                },
                zt = function(e, t) {
                    var n = function() {
                            m.firstChild.data = "Close", m.disabled = !1, h.disabled = !1
                        },
                        r = c.a["site/request_invite_dialogue"]();
                    document.body.appendChild(r.trim().toDOM());
                    var o = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        a = document.body.lastElementChild,
                        l = a.querySelector(".gc-dlg"),
                        d = function() {
                            b.classList.remove("not-shown"), n()
                        },
                        u = function(e) {
                            e = e.responseJSON, n(), e && e.recipient_email ? y.innerHTML = "email " + e.recipient_email : y.innerHTML = "Please try again", y.classList.remove("not-shown"), b.classList.add("not-shown")
                        };

                    function p(e) {
                        return e && e.preventDefault && e.preventDefault(), y.classList.add("not-shown"), m.firstChild.data = "Working...", m.disabled = !0, h.disabled = !0, b.classList.add("not-shown"), Object(i.requestInvite)(f.value, d, u), !1
                    }
                    var f = l.querySelector("#invitation_recipient_email");
                    f.addEventListener("keydown", (function(e) {
                        13 === e.keyCode && p()
                    }), !1), f.focus(), l.querySelector(".btn-sign-in").addEventListener("click", (function(e) {
                        return e.preventDefault(), o.close(), t && t.call(), !1
                    }), !1);
                    var h = l.querySelector('input[type="submit"]');
                    h.addEventListener("click", p, !1);
                    var g = a.querySelector(".gc-dlg-action"),
                        m = g.querySelector(".gc-dlg-cancel");
                    o.closeButton(m);
                    var y = g.querySelector(".gc-dlg-error"),
                        b = l.querySelector(".invitation-success")
                },
                Wt = function(e, t, n) {
                    var r, o, a, i = e.graphStore,
                        l = {
                            community: !i.get("user").is_member,
                            hub_name: i.get("hub").name
                        },
                        d = function() {
                            b.classList.add("not-shown"), m.firstChild.data = "Working...", m.disabled = !0, y.disabled = !0, v.disabled = !0, t && t.call(null, v.value, l.community ? void 0 : parseInt(function() {
                                if (r.checked) return r.value;
                                if (o.checked) return o.value;
                                if (a.checked) return a.value
                            }()))
                        };
                    var u = c.a["hubs/save_as_community_graph_panel"](l);
                    document.body.appendChild(u.trim().toDOM());
                    var p = Object(s.bb)({
                            element: document.body.lastElementChild,
                            onCancel: function() {
                                n && n.call()
                            }
                        }, e),
                        f = document.body.lastElementChild,
                        h = f.querySelector(".gc-dlg"),
                        g = f.querySelector(".gc-dlg-action"),
                        m = g.querySelector(".gc-btn-confirm");
                    m.disabled = !1, m.addEventListener("click", d, !1);
                    var y = g.querySelector(".gc-dlg-cancel");
                    p.closeButton(y), l.community || (r = f.querySelector("#graph_status_0"), o = f.querySelector("#graph_status_1"), a = f.querySelector("#graph_status_2"));
                    var b = g.querySelector(".gc-dlg-error"),
                        v = h.querySelector("#graph_name");
                    return v.addEventListener("keydown", (function(e) {
                        if (13 == e.keyCode) return e.preventDefault(), d(), !1
                    }), !1), p
                },
                Yt = function(e, t) {
                    var n = t || {},
                        r = {
                            show_sign_up: null === xe.a.getUser(),
                            show_home: null !== xe.a.getUser()
                        },
                        o = c.a["site/about_panel"](r);
                    document.body.appendChild(o.trim().toDOM());
                    var a = document.body.lastElementChild,
                        i = Object(s.bb)({
                            element: a
                        }, e);
                    r.show_sign_up && a.querySelector(".btn-sign-up").addEventListener("click", (function(e) {
                        return e.preventDefault(), n.onAuthenticationRequested(), !1
                    }));
                    return i
                },
                Vt = function(e) {
                    var t = c.a["site/social_auth_dialogue"]();
                    document.body.appendChild(t.trim().toDOM()), Object(s.bb)({
                        element: document.body.lastElementChild
                    }, e)
                },
                Xt = function(e, t, n) {
                    var r = n || {},
                        o = c.a["stories/quality_check"]({
                            checks: t.checks,
                            allow_publish: r.allow_publish
                        });
                    document.body.appendChild(o.trim().toDOM());
                    var a = document.body.lastElementChild,
                        i = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e);
                    r.allow_publish && a.querySelector("button#btnForcePublish").addEventListener("click", (function(e) {
                        e.preventDefault(), i.close(), r.onForcePublishRequested()
                    }));
                    r.onEditRequested && a.querySelector("button.gc-dlg-cancel").addEventListener("click", (function(e) {
                        e.preventDefault(), r.onEditRequested()
                    }));
                    return i
                },
                Kt = function(e, t) {
                    var n = t || {},
                        r = c.a["stories/story_share"]({});
                    document.body.appendChild(r.trim().toDOM());
                    var o = document.body.lastElementChild,
                        a = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e);
                    return o.querySelector(".tw-share").addEventListener("click", (function(e) {
                        e.preventDefault(), n.onShareRequested("twitter")
                    })), o.querySelector(".fb-share").addEventListener("click", (function(e) {
                        e.preventDefault(), n.onShareRequested("facebook")
                    })), o.querySelector(".link-share").addEventListener("click", (function(e) {
                        e.preventDefault(), n.onShareRequested("link")
                    })), a
                },
                $t = function(e, t) {
                    var n = t || {},
                        r = {
                            obj: t.obj,
                            is_hub: t.is_hub,
                            show_sign_up: null === xe.a.getUser()
                        },
                        o = c.a["stories/user_panel"](r);
                    document.body.appendChild(o.trim().toDOM());
                    var a = document.body.lastElementChild,
                        i = Object(s.bb)({
                            element: a
                        }, e),
                        l = a.querySelector(".description");
                    (l && Object(s.ab)(l), r.show_sign_up) && a.querySelector(".btn-sign-up").addEventListener("click", (function(e) {
                        return e.preventDefault(), n.onAuthenticationRequested(), !1
                    }));
                    return i
                },
                Zt = function(e, t, n, r, o, a, i) {
                    var l = function() {
                        var e = m.value.trim();
                        e && (h.close(), o && o(e))
                    };

                    function d(e) {
                        13 === e.keyCode && l()
                    }

                    function u() {
                        b.disabled = !m.value.trim()
                    }
                    var p = {
                            title: t,
                            input_text: n,
                            button_text: r,
                            warning: i
                        },
                        f = c.a["graphs/single_text_dialogue"](p);
                    document.body.appendChild(f.trim().toDOM());
                    var h = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                m.removeEventListener("keyup", u, !1), m.removeEventListener("keydown", d, !1)
                            },
                            onCancel: function() {
                                a && a.call()
                            }
                        }, e),
                        g = document.body.lastElementChild,
                        m = g.querySelector(".gc-dlg-body").querySelector("input");
                    m.addEventListener("keyup", u, !1), m.addEventListener("keydown", d, !1);
                    var y = g.querySelector(".gc-dlg-action"),
                        b = y.querySelector(".gc-btn-confirm");
                    b.addEventListener("click", l, !1), m.value.trim() && (b.disabled = !1);
                    var v = y.querySelector(".gc-dlg-cancel");
                    h.closeButton(v), m.focus()
                },
                Jt = function(e) {
                    var t = c.a["site/start_graph_dialog"]({});
                    document.body.appendChild(t.trim().toDOM());
                    var n = document.body.querySelector('div.full-cover[data-modal-name="start-graph-dialog"]'),
                        r = Object(s.bb)({
                            element: n
                        }, e);
                    return n.querySelector(".btn-link").addEventListener("click", (function() {
                        r.close()
                    })), r
                },
                Qt = function(e, t) {
                    var n = {
                        published_graphs: t.graphs.filter((function(e) {
                            return 1 == e.status
                        })),
                        drafted_graphs: t.graphs.filter((function(e) {
                            return 0 == e.status
                        })),
                        private_graphs: t.graphs.filter((function(e) {
                            return 2 == e.status
                        }))
                    };
                    n.published_graph_count = n.published_graphs.length, n.drafted_graph_count = n.drafted_graphs.length, n.private_graph_count = n.private_graphs.length, n.has_private_graphs = n.private_graph_count > 0;
                    var o = c.a["site/start_story_dialog"](n);
                    document.body.appendChild(o.trim().toDOM()), Object(r.a)(document).foundation({
                        tab: {
                            callback: function() {
                                l.scrollTop = 0
                            }
                        }
                    });
                    var a = document.body.querySelector('div.full-cover[data-modal-name="start-story-dialog"]'),
                        i = Object(s.bb)({
                            element: a,
                            close_actions: function() {
                                Object(s.nb)(document.body, "hide-overflow")
                            }
                        }, e),
                        l = a.querySelector("div.hub-list");
                    Array.from(l.querySelectorAll("label.select-graph")).forEach((function(e) {
                        e.addEventListener("click", (function() {
                            d.disabled = !1
                        }))
                    }));
                    var d = a.querySelector("button.gc-btn-confirm");
                    return d.addEventListener("click", (function() {
                        t.onSubmitted(function(e) {
                            var t = Array.from(e.querySelectorAll('div.hub-list label input[type="radio"]')).find((function(e) {
                                return e.checked
                            }));
                            if (t) return t.getAttribute("data-id")
                        }(a))
                    })), Object(s.h)(document.body, "hide-overflow"), i
                },
                en = function(e, t) {
                    var n = function() {
                            o && (o.close(), o = null)
                        },
                        r = function(e) {
                            Object(s.lb)("/graphs/" + e + "?show=stories&new=true")
                        },
                        o = z(e, "Retrieving Graphs", "Please wait");
                    return Object(i.getUserGraphs)(t.userId, (function(o) {
                        if (n(), 0 == o.graphs.length) Jt(e, t);
                        else {
                            var a = {
                                graphs: o.graphs,
                                onSubmitted: r
                            };
                            Qt(e, a)
                        }
                    }), (function() {
                        n()
                    })), {
                        destroy: function() {
                            n()
                        }
                    }
                },
                tn = function(e, t) {
                    var n = c.a["site/submit_email"]({
                        text: "Email the desktop link for this story"
                    });
                    document.body.appendChild(n.trim().toDOM());
                    var r = Object(s.bb)({
                            element: document.body.lastElementChild
                        }, e),
                        o = document.body.lastElementChild.querySelector(".gc-pnl"),
                        a = o.querySelector('input[type="email"]');
                    a.addEventListener("keyup", (function() {
                        a.value.trim() ? i.disabled = !1 : i.disabled = !0
                    }));
                    var i = o.querySelector('input[type="submit"]');
                    i.addEventListener("click", (function(e) {
                        return e.preventDefault(), a.value.trim() && (t(a.value.trim()), r.close()), !1
                    }));
                    var l = o.querySelector(".gc-dlg-cancel");
                    r.closeButton(l)
                },
                nn = function(e, t, n, r, o, a, i) {
                    var l = function() {
                        var e = m.value.trim();
                        e && (h.close(), a && a(e))
                    };

                    function d(e) {
                        13 === e.keyCode && l()
                    }

                    function u() {
                        b.disabled = !m.value.trim()
                    }
                    var p = {
                            title: t,
                            input_text: n,
                            cancel_text: r || "Cancel",
                            confirm_text: o || "OK"
                        },
                        f = c.a["graphs/single_textfield_dialogue"](p);
                    document.body.appendChild(f.trim().toDOM());
                    var h = Object(s.bb)({
                            element: document.body.lastElementChild,
                            close_actions: function() {
                                m.removeEventListener("keyup", u, !1), m.removeEventListener("keydown", d, !1)
                            },
                            onCancel: function() {
                                i && i.call()
                            }
                        }, e),
                        g = document.body.lastElementChild,
                        m = g.querySelector(".gc-dlg-body").querySelector("textarea");
                    m.addEventListener("keyup", u, !1), m.addEventListener("keydown", d, !1);
                    var y = g.querySelector(".gc-dlg-action"),
                        b = y.querySelector(".gc-btn-confirm");
                    b.addEventListener("click", l, !1), m.value.trim() && (b.disabled = !1);
                    var v = y.querySelector(".gc-dlg-cancel");
                    h.closeButton(v), m.focus()
                }
        },
        72: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return _
            }));
            var r = n(1),
                o = n.n(r),
                a = n(16),
                i = n(51),
                s = n.n(i),
                c = n(110),
                l = n(5),
                d = n(2);

            function u(e, t) {
                var n = Object.keys(e);
                if (Object.getOwnPropertySymbols) {
                    var r = Object.getOwnPropertySymbols(e);
                    t && (r = r.filter((function(t) {
                        return Object.getOwnPropertyDescriptor(e, t).enumerable
                    }))), n.push.apply(n, r)
                }
                return n
            }

            function p(e) {
                for (var t = 1; t < arguments.length; t++) {
                    var n = null != arguments[t] ? arguments[t] : {};
                    t % 2 ? u(Object(n), !0).forEach((function(t) {
                        f(e, t, n[t])
                    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : u(Object(n)).forEach((function(t) {
                        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                    }))
                }
                return e
            }

            function f(e, t, n) {
                return t in e ? Object.defineProperty(e, t, {
                    value: n,
                    enumerable: !0,
                    configurable: !0,
                    writable: !0
                }) : e[t] = n, e
            }

            function h(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || m(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function g(e) {
                return function(e) {
                    if (Array.isArray(e)) return y(e)
                }(e) || function(e) {
                    if ("undefined" !== typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                }(e) || m(e) || function() {
                    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function m(e, t) {
                if (e) {
                    if ("string" === typeof e) return y(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? y(e, t) : void 0
                }
            }

            function y(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }

            function b() {
                return "#" + ("00000" + (Math.random() * (1 << 24) | 0).toString(16)).slice(-6)
            }

            function v(e, t, n) {
                var r = g(e);
                return r.splice(n, 0, r.splice(t, 1)[0]), r
            }
            var _ = "Email",
                w = function(e) {
                    var t = e.value,
                        n = e.onChange,
                        a = e.color,
                        i = e.isReadOnly,
                        c = e.placeholder,
                        l = h(Object(r.useState)(!t), 2),
                        d = l[0],
                        u = l[1],
                        p = Object(r.useRef)(null);
                    return Object(r.useEffect)((function() {
                        d && p.current && p.current.focus()
                    }), [p, p.current, d]), d ? o.a.createElement("input", {
                        ref: p,
                        type: "text",
                        className: "type-name",
                        placeholder: c,
                        value: t,
                        onChange: function(e) {
                            return n(e.target.value)
                        },
                        onBlur: function() {
                            return u(!1)
                        },
                        onKeyDown: function(e) {
                            "Enter" === e.key && p.current.blur()
                        }
                    }) : o.a.createElement("span", {
                        className: s()("type-name", !!t && "bold", !i && "grabbable"),
                        placeholder: "New type name",
                        style: {
                            color: a
                        },
                        onClick: function() {
                            return !i && u(!0)
                        }
                    }, t)
                },
                O = Object(c.c)((function() {
                    return o.a.createElement("span", {
                        style: {
                            paddingRight: 5,
                            userSelect: "none"
                        }
                    }, "\u205e\u205e")
                })),
                E = Object(c.b)((function(e) {
                    var t = e.value,
                        n = e.onChange,
                        r = e.onDelete,
                        a = e.isSelfEditEnabled;
                    return o.a.createElement("div", {
                        className: "type-prop hover-in grabbable"
                    }, o.a.createElement(O, null), a && o.a.createElement("input", {
                        type: "checkbox",
                        checked: t.name_alias !== _ && !!t.self_editable,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                self_editable: e.target.checked
                            }))
                        },
                        disabled: t.name_alias === _
                    }), o.a.createElement("input", {
                        type: "text",
                        className: "prop-name room-for-del",
                        placeholder: "New Property (press ENTER)",
                        value: t.name_alias,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                name_alias: e.target.value,
                                self_editable: e.target.value !== _ && t.self_editable
                            }))
                        }
                    }), o.a.createElement("span", {
                        className: "ss-gizmo ss-trash icon grabbable",
                        onClick: function() {
                            return r()
                        }
                    }))
                })),
                j = Object(c.a)((function(e) {
                    var t = e.items,
                        n = e.onChange,
                        r = t.find((function(e) {
                            return e.name_alias === _
                        }));
                    return o.a.createElement(o.a.Fragment, null, t.map((function(e, a) {
                        return o.a.createElement(E, {
                            key: a,
                            index: a,
                            value: e,
                            onChange: function(e) {
                                return n(t.map((function(t, n) {
                                    return n === a ? e : t
                                })))
                            },
                            onDelete: function() {
                                return n(t.filter((function(e, t) {
                                    return t !== a
                                })))
                            },
                            isSelfEditEnabled: r
                        })
                    })))
                })),
                S = function(e) {
                    var t = e.value,
                        n = e.onChange,
                        a = e.onDelete,
                        i = e.isAdmin,
                        s = e.isReadOnly,
                        c = h(Object(r.useState)(""), 2),
                        l = c[0],
                        d = c[1],
                        u = Object(r.useRef)(null);
                    return o.a.createElement("tr", null, o.a.createElement("td", null, o.a.createElement(w, {
                        value: t.name,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                name: e
                            }))
                        },
                        color: t.color,
                        isReadOnly: s,
                        placeholder: t.isNew ? "New Type name" : "Type name"
                    }), t.name && !t.isNew && o.a.createElement("div", {
                        className: "text-muted"
                    }, t.count, " node", t.count > 1 ? "s" : "")), !s && o.a.createElement("td", null, o.a.createElement("input", {
                        type: "color",
                        value: t.color,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                color: e.target.value
                            }))
                        }
                    })), o.a.createElement("td", null, o.a.createElement("div", {
                        className: "type-prop default"
                    }, o.a.createElement("span", {
                        className: "default-prop"
                    }, "Description")), o.a.createElement("div", {
                        className: "type-prop default"
                    }, o.a.createElement("span", {
                        className: "default-prop"
                    }, "Image")), o.a.createElement("div", {
                        className: "type-prop default",
                        ref: u
                    }, o.a.createElement("span", {
                        className: "default-prop"
                    }, "Reference"), s ? t.properties.map((function(e, t) {
                        return o.a.createElement("div", {
                            className: "type-prop default",
                            key: t
                        }, o.a.createElement("span", {
                            className: "default-prop",
                            style: {
                                color: "#000"
                            }
                        }, e.name_alias))
                    })) : o.a.createElement(j, {
                        items: t.properties,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                properties: e
                            }))
                        },
                        onSortEnd: function(e) {
                            var r = e.oldIndex,
                                o = e.newIndex;
                            return n(p(p({}, t), {}, {
                                properties: v(t.properties, r, o)
                            }))
                        },
                        getContainer: function() {
                            return document.body
                        },
                        helperContainer: function() {
                            return u.current
                        }
                    })), !s && o.a.createElement("input", {
                        type: "text",
                        className: "prop-name add-type-property",
                        placeholder: "New Property (press ENTER)",
                        value: l,
                        onChange: function(e) {
                            return d(e.target.value)
                        },
                        onKeyDown: function(e) {
                            "Enter" === e.key && l && (n(p(p({}, t), {}, {
                                properties: t.properties.concat([{
                                    name: l,
                                    name_alias: l
                                }])
                            })), d(""))
                        }
                    })), i && !t.count && o.a.createElement("td", null, o.a.createElement("a", {
                        className: "remove-item remove-type",
                        style: {
                            padding: 0
                        },
                        onClick: function() {
                            return a()
                        }
                    }, o.a.createElement("span", {
                        className: "ss-gizmo ss-trash"
                    }))))
                },
                x = function(e) {
                    var t = e.value,
                        n = e.onChange,
                        a = e.onDelete,
                        i = e.isAdmin,
                        s = e.isReadOnly,
                        c = h(Object(r.useState)(""), 2),
                        l = c[0],
                        d = c[1],
                        u = Object(r.useRef)(null);
                    return o.a.createElement("tr", null, o.a.createElement("td", null, o.a.createElement(w, {
                        value: t.name,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                name: e
                            }))
                        },
                        color: t.color,
                        isReadOnly: s,
                        placeholder: t.isNew ? "New Type name" : "Type name"
                    }), t.name && !t.isNew && o.a.createElement("div", {
                        className: "text-muted"
                    }, t.count, " Vector", t.count > 1 ? "s" : "")), !s && o.a.createElement("td", null, o.a.createElement("input", {
                        type: "color",
                        value: t.color,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                color: e.target.value
                            }))
                        }
                    })), o.a.createElement("td", null, o.a.createElement("div", {
                        className: "type-prop default",
                        ref: u
                    }, o.a.createElement("span", {
                        className: "default-prop"
                    }, "Weight"), s ? t.properties.map((function(e, t) {
                        return o.a.createElement("div", {
                            className: "type-prop default",
                            key: t
                        }, o.a.createElement("span", {
                            className: "default-prop",
                            style: {
                                color: "#000"
                            }
                        }, e.name_alias))
                    })) : o.a.createElement(j, {
                        items: t.properties,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                properties: e
                            }))
                        },
                        onSortEnd: function(e) {
                            var r = e.oldIndex,
                                o = e.newIndex;
                            return n(p(p({}, t), {}, {
                                properties: v(t.properties, r, o)
                            }))
                        },
                        getContainer: function() {
                            return document.body
                        },
                        helperContainer: function() {
                            return u.current
                        }
                    })), !s && o.a.createElement("input", {
                        type: "text",
                        className: "prop-name add-type-property",
                        placeholder: "New Property (press ENTER)",
                        value: l,
                        onChange: function(e) {
                            return d(e.target.value)
                        },
                        onKeyDown: function(e) {
                            "Enter" === e.key && l && (n(p(p({}, t), {}, {
                                properties: t.properties.concat([{
                                    name: l,
                                    name_alias: l
                                }])
                            })), d(""))
                        }
                    })), !s && o.a.createElement("td", {
                        style: {
                            whiteSpace: "nowrap"
                        }
                    }, o.a.createElement("input", {
                        id: "edgetype-".concat(t.id, "-selfconnect"),
                        type: "checkbox",
                        checked: !!t.self_connect,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                self_connect: !!e.target.checked
                            }))
                        }
                    }), o.a.createElement("label", {
                        htmlFor: "edgetype-".concat(t.id, "-selfconnect")
                    }, "Allowed")), o.a.createElement("td", {
                        style: {
                            whiteSpace: "nowrap"
                        }
                    }, o.a.createElement("input", {
                        id: "edgetype-".concat(t.id, "-direction"),
                        type: "checkbox",
                        checked: !!t.is_directed,
                        onChange: function(e) {
                            return n(p(p({}, t), {}, {
                                is_directed: !!e.target.checked
                            }))
                        },
                        disabled: !!s
                    }), o.a.createElement("label", {
                        htmlFor: "edgetype-".concat(t.id, "-direction")
                    }, "Directed")), i && !t.count && o.a.createElement("td", null, o.a.createElement("a", {
                        className: "remove-item remove-type",
                        style: {
                            padding: 0
                        },
                        onClick: function() {
                            return a()
                        }
                    }, o.a.createElement("span", {
                        className: "ss-gizmo ss-trash"
                    }))))
                };
            t.b = function(e) {
                var t = e.hubId,
                    n = e.onClose,
                    i = !0,
                    s = !1,
                    c = h(Object(r.useState)(!0), 2),
                    u = c[0],
                    f = c[1],
                    g = h(Object(r.useState)(!1), 2),
                    m = g[0],
                    y = g[1],
                    v = h(Object(r.useState)({
                        baseNodeTypes: [],
                        baseEdgeTypes: [],
                        nodeTypes: [],
                        edgeTypes: []
                    }), 2),
                    _ = v[0],
                    w = v[1],
                    O = Object(r.useMemo)((function() {
                        return !Object(a.isEqual)(_.nodeTypes, _.baseNodeTypes) || !Object(a.isEqual)(_.edgeTypes, _.baseEdgeTypes)
                    }), [_]),
                    E = h(Object(r.useState)(null), 2),
                    j = E[0],
                    k = E[1];
                return Object(r.useEffect)((function() {
                    Object(l.getHubTaxonomy)(t, (function(e) {
                        w({
                            baseNodeTypes: e.node_types,
                            baseEdgeTypes: e.edge_types,
                            nodeTypes: e.node_types,
                            edgeTypes: e.edge_types
                        }), f(!1)
                    }))
                }), []), o.a.createElement("div", {
                    className: "gc-pnl"
                }, o.a.createElement("div", {
                    className: "gc-pnl-header"
                }, o.a.createElement("div", {
                    className: "inner"
                }, o.a.createElement("h2", null, "Hub Taxonomy"))), o.a.createElement("div", {
                    className: "gc-pnl-body"
                }, o.a.createElement("h5", null, "Vertexs"), o.a.createElement("table", {
                    role: "grid",
                    summary: "Node Type settings",
                    className: "graph-settings tbl-nodetypes",
                    style: {
                        border: "none"
                    }
                }, o.a.createElement("thead", null, o.a.createElement("tr", null, o.a.createElement(o.a.Fragment, null, o.a.createElement("th", {
                    style: {
                        width: "25%"
                    }
                }, "Type"), o.a.createElement("th", {
                    style: {
                        width: "10%"
                    }
                }, "Color")), o.a.createElement("th", {
                    style: {
                        width: "60%"
                    }
                }, "Properties", o.a.createElement("span", {
                    className: "with-tooltip"
                }, o.a.createElement("span", {
                    className: "ss-gizmo ss-info"
                }), o.a.createElement("div", {
                    className: "tooltip-input"
                }, "Drag to change display order", o.a.createElement("br", null), "Check to allow members self-edit"))), o.a.createElement("th", {
                    style: {
                        width: "5%"
                    }
                }))), o.a.createElement("tbody", null, _.nodeTypes.map((function(e) {
                    return o.a.createElement(S, {
                        key: e.id,
                        value: e,
                        onChange: function(e) {
                            return w(p(p({}, _), {}, {
                                nodeTypes: _.nodeTypes.map((function(t) {
                                    return t.id === e.id ? e : t
                                }))
                            }))
                        },
                        onDelete: function() {
                            return w(p(p({}, _), {}, {
                                nodeTypes: _.nodeTypes.filter((function(t) {
                                    return t.id !== e.id
                                }))
                            }))
                        },
                        isAdmin: i,
                        isReadOnly: s
                    })
                })))), u && o.a.createElement("div", {
                    className: "text-center",
                    style: {
                        height: "3em",
                        lineHeight: "3em"
                    }
                }, o.a.createElement("span", {
                    className: "loading",
                    style: {
                        width: "1em",
                        height: "1em",
                        display: "inline-block",
                        marginRight: "0.3em"
                    }
                }), " ", "Loading..."), o.a.createElement(o.a.Fragment, null, o.a.createElement("a", {
                    className: "button btn-new-nodetype btn-outline",
                    href: "#",
                    onClick: function(e) {
                        e.preventDefault(), u || w(p(p({}, _), {}, {
                            nodeTypes: _.nodeTypes.concat([{
                                isNew: !0,
                                id: Object(d.guid)(),
                                name: "",
                                color: b(),
                                properties: []
                            }])
                        }))
                    }
                }, "New Vertex Order"), o.a.createElement("br", null)), o.a.createElement("br", null), o.a.createElement("h5", null, "Vectors"), o.a.createElement("table", {
                    role: "grid",
                    summary: "Edge Type settings",
                    className: "graph-settings tbl-edgetypes",
                    style: {
                        border: "none"
                    }
                }, o.a.createElement("thead", null, o.a.createElement("tr", null, o.a.createElement("th", {
                    style: {
                        width: "25%"
                    }
                }, "Type"), o.a.createElement("th", {
                    style: {
                        width: "10%"
                    }
                }, "Color"), o.a.createElement("th", {
                    style: {
                        width: "40%"
                    }
                }, "Properties"), o.a.createElement("th", {
                    style: {
                        width: "15%"
                    }
                }, "Self-Connect", " ", o.a.createElement("span", {
                    className: "with-tooltip"
                }, o.a.createElement("span", {
                    className: "ss-gizmo ss-info"
                }), o.a.createElement("div", {
                    className: "tooltip-input"
                }, "Check to allow members to make connections"))), o.a.createElement("th", {
                    style: {
                        width: "5%"
                    }
                }, "Direction"), o.a.createElement("th", {
                    style: {
                        width: "5%"
                    }
                }))), o.a.createElement("tbody", null, _.edgeTypes.map((function(e) {
                    return o.a.createElement(x, {
                        key: e.id,
                        value: e,
                        onChange: function(e) {
                            w(p(p({}, _), {}, {
                                edgeTypes: _.edgeTypes.map((function(t) {
                                    return t.id === e.id ? e : t
                                }))
                            }))
                        },
                        onDelete: function() {
                            return w(p(p({}, _), {}, {
                                edgeTypes: _.edgeTypes.filter((function(t) {
                                    return t.id !== e.id
                                }))
                            }))
                        },
                        isAdmin: i,
                        isReadOnly: s
                    })
                })))), u && o.a.createElement("div", {
                    className: "text-center",
                    style: {
                        height: "3em",
                        lineHeight: "3em"
                    }
                }, o.a.createElement("span", {
                    className: "loading",
                    style: {
                        width: "1em",
                        height: "1em",
                        display: "inline-block",
                        marginRight: "0.3em"
                    }
                }), " ", "Loading..."), o.a.createElement(o.a.Fragment, null, o.a.createElement("a", {
                    className: "button btn-new-edgetype btn-outline",
                    href: "#",
                    onClick: function(e) {
                        e.preventDefault(), u || w(p(p({}, _), {}, {
                            edgeTypes: _.edgeTypes.concat([{
                                isNew: !0,
                                id: Object(d.guid)(),
                                name: "",
                                color: b(),
                                properties: []
                            }])
                        }))
                    }
                }, "New Vector Order"), o.a.createElement("br", null))), m && o.a.createElement("div", {
                    style: {
                        position: "absolute",
                        inset: 0,
                        background: "#ffffffcc",
                        display: "flex",
                        alignItems: "center",
                        justifyContent: "center"
                    }
                }, o.a.createElement("span", {
                    className: "loading",
                    style: {
                        width: "1em",
                        height: "1em",
                        display: "inline-block",
                        marginRight: "0.3em"
                    }
                }), " ", "Saving..."), o.a.createElement("div", {
                    className: "gc-pnl-action"
                }, j && o.a.createElement("label", {
                    className: "gc-dlg-error",
                    style: "info" === j.type ? {
                        color: "#43AC6A"
                    } : {}
                }, j.message), o.a.createElement("button", {
                    className: "gc-btn gc-dlg-save",
                    onClick: function() {
                        O && !m && (Object(l.saveHubTaxonomy)(t, {
                            nodeTypes: _.nodeTypes,
                            edgeTypes: _.edgeTypes
                        }, (function() {
                            y(!1), k({
                                message: "Your modifications have successfully been saved.",
                                type: "info"
                            }), w(p(p({}, _), {}, {
                                baseNodeTypes: _.nodeTypes,
                                baseEdgeTypes: _.edgeTypes
                            }))
                        }), (function() {
                            y(!1), k({
                                message: "An error occured while saving your modifications.",
                                type: "error"
                            })
                        })), y(!0))
                    },
                    disabled: !O || m
                }, "Save"), o.a.createElement("button", {
                    className: "gc-btn gc-dlg-cancel",
                    onClick: function() {
                        return n()
                    },
                    disabled: m
                }, "Close")))
            }
        },
        76: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return i
            }));
            var r = n(71),
                o = n(3),
                a = n(0),
                i = function(e) {
                    var t, n = 150,
                        i = e || {},
                        s = i.root,
                        c = i.slideData,
                        l = i.onNewSlideRequested,
                        d = i.onPresentationModeRequested,
                        u = i.onSwitchSlideRequested,
                        p = i.onSlideDeleteRequested,
                        f = i.onSlideReorderRequested,
                        h = function(e) {
                            if ((37 == e.keyCode || 39 == e.keyCode) && !Object(a.W)(document.activeElement)) switch (e.keyCode) {
                                case 37:
                                    ! function() {
                                        if (m > 0) {
                                            u(c[m - 1].id);
                                            var e = b.querySelector(".mCSB_container").style.left;
                                            e = Math.abs(Number(e.replace("px", ""))), n * m < e && c[Math.max(0, m - 2)].dom.scrollIntoView(!0)
                                        }
                                    }();
                                    break;
                                case 39:
                                    ! function() {
                                        if (m < c.length - 1) {
                                            u(c[m + 1].id);
                                            var e = b.querySelector(".mCSB_container").style.left;
                                            e = Math.abs(Number(e.replace("px", ""))), n * (m + 1) >= t + e && c[m].dom.scrollIntoView(!0)
                                        }
                                    }()
                            }
                        },
                        g = !1,
                        m = 1,
                        y = s.querySelector(".slides-bottom-container"),
                        b = s.querySelector(".thumbnail-strip"),
                        v = s.querySelector(".thumbnail-strip-wrapper");
                    s.querySelector(".new-slide").addEventListener("click", (function() {
                        l()
                    })), s.querySelector(".present-mode").addEventListener("click", (function() {
                        d()
                    })), Array.from(v.querySelectorAll(".thumbnail")).forEach((function(e, t) {
                        c[t].dom = e;
                        var n = c[t].id;
                        e.addEventListener("click", (function() {
                            u(n, !0)
                        }));
                        var r = e.querySelector(".delete-slide");
                        r && r.addEventListener("click", (function(e) {
                            return e.preventDefault(), e.stopPropagation(), p(n), !1
                        }))
                    })), b.classList.add("gc-custom-scrollbar");
                    var _ = function(e) {
                        e.ctrlKey && 77 == e.keyCode && (g || l())
                    };
                    return r.a.create(v, {
                        filter: ".static",
                        onUpdate: function(e) {
                            f(e.oldIndex, e.newIndex)
                        },
                        onMove: function(e) {
                            if (Object(a.N)(e.related, "static")) return !1
                        }
                    }), window.addEventListener("keydown", h), window.addEventListener("keydown", _), {
                        addNewSlide: function(e) {
                            var t = o.a["graphs/story_thumbnail"]({
                                order: e.order,
                                is_cover: e.is_cover,
                                id: e.id,
                                selected: e.selected,
                                thumbnail_image: e.image || e.svg_capture_image
                            });
                            v.appendChild(t.trim().toDOM());
                            var r = v.lastElementChild,
                                a = e.id;
                            return r.addEventListener("click", (function() {
                                u(a, !0)
                            })), r.querySelector(".delete-slide").addEventListener("click", (function(e) {
                                return e.preventDefault(), e.stopPropagation(), p(a), !1
                            })), v.style.width = c.length * n + "px", r.scrollIntoView(!0), r
                        },
                        resize: function(e, r) {
                            r || (t = e.x - 248, b.style.width = t + "px", v.style.width = c.length * n + "px")
                        },
                        enterPresentationMode: function() {
                            g = !0, Object(a.h)(y, "not-shown")
                        },
                        exitPresentationMode: function() {
                            g = !1, Object(a.nb)(y, "not-shown"), v.style.width = c.length * n + "px"
                        },
                        setSelectedSlide: function(e) {
                            m = e.order, Object(a.h)(e.dom, "selected")
                        },
                        unsetSelectedSlide: function(e) {
                            Object(a.nb)(e.dom, "selected")
                        },
                        removeSlide: function(e) {
                            e && e.dom.parentNode.removeChild(e.dom)
                        },
                        refreshThumbnails: function(e) {
                            e.slice(1).forEach((function(e) {
                                e.dom.setAttribute("data-index", e.order), e.dom.querySelector("label").innerHTML = e.order
                            }))
                        },
                        refreshSlide: function(e) {
                            e.dom.setAttribute("data-index", e.order), e.dom.querySelector("label").innerHTML = e.is_cover ? "Cover" : e.order, e.thumbnail_image ? e.dom.querySelector("div.preview").style.backgroundImage = "url(" + e.thumbnail_image + ")" : e.dom.querySelector("div.preview").style.backgroundImage = null
                        },
                        destroy: function() {
                            window.removeEventListener("keydown", h), window.addEventListener("keydown", _)
                        },
                        notifySaveStart: function() {
                            console.log("thumbnail received story start")
                        },
                        notifyStorySaved: function(e) {
                            e.thumbnail_image && (e.dom.querySelector(".preview").style.backgroundImage = "url(" + e.thumbnail_image + ")")
                        }
                    }
                }
        },
        77: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "exportData", (function() {
                return o
            })), n.d(t, "prepareData", (function() {
                return a
            }));
            var r = function(e) {
                    if (void 0 === e || null === e) return "";
                    if (!isNaN(e)) return e;
                    var t = e.replace(/"/g, '""');
                    return t.search(/("|,|\n)/g) >= 0 && (t = '"' + t + '"'), t
                },
                o = function(e) {
                    var t = e.columns,
                        n = e.columnHeaders,
                        o = e.data,
                        a = t.map((function(e) {
                            return e.data
                        })),
                        i = [],
                        s = n.map((function(e) {
                            return r(e)
                        })).join(",");
                    return i.push(s), o.forEach((function(e) {
                        var t = a.map((function(t) {
                            return r(e[t])
                        })).join(",");
                        i.push(t)
                    })), i.join("\n")
                },
                a = function(e, t) {
                    var n = e.GraphHistory,
                        r = [{
                            data: "type",
                            readOnly: !0
                        }, {
                            data: "name",
                            readOnly: !0
                        }, {
                            data: "description",
                            readOnly: !0
                        }],
                        o = ["Type", "Name", "Description"],
                        a = [],
                        i = {};
                    return t.forEach((function(e) {
                        var t = n.getNodeById(e);
                        if (t) {
                            var s = {
                                type: t.type,
                                name: t.name,
                                description: t.description
                            };
                            t.properties && Object.keys(t.properties).forEach((function(e) {
                                Object.prototype.hasOwnProperty.call(i, e) || (i[e] = !0, o.push(e), r.push({
                                    data: "prop_" + e,
                                    readOnly: !0
                                })), s["prop_" + e] = t.properties[e]
                            })), a.push(s)
                        }
                    })), {
                        columns: r,
                        columnHeaders: o,
                        data: a
                    }
                }
        },
        78: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, "CaptureBounds", (function() {
                return r.a
            })), n.d(t, "CaptureControllerButtons", (function() {
                return o.a
            })), n.d(t, "Card", (function() {
                return a.a
            })), n.d(t, "ProgressMeter", (function() {
                return s
            })), n.d(t, "SVGCapturePanel", (function() {
                return c.a
            })), n.d(t, "Bars", (function() {
                return l
            })), n.d(t, "Cards", (function() {
                return d
            })), n.d(t, "Dialogs", (function() {
                return u
            })), n.d(t, "Story", (function() {
                return p
            }));
            var r = n(66),
                o = n(100),
                a = n(101),
                i = n(0),
                s = function(e, t) {
                    var n = t || {},
                        r = 2 * Math.PI * 22,
                        o = n.root || document.querySelector("div.progress-meter"),
                        a = o.querySelector(".progress__value"),
                        s = o.querySelector(".progress__text");
                    a && (a.style.strokeDasharray = r);
                    return {
                        setProgress: function(e) {
                            var t = r * (1 - e / 100);
                            a && (a.style.strokeDashoffset = t), s && (s.innerHTML = e + "%")
                        },
                        show: function() {
                            Object(i.nb)(o, "not-shown")
                        }
                    }
                },
                c = n(65),
                l = n(46),
                d = n(45),
                u = n(7),
                p = n(55)
        },
        79: function(e, t, n) {
            "use strict";
            n.d(t, "b", (function() {
                return u
            })), n.d(t, "a", (function() {
                return f
            }));
            var r = n(16),
                o = n(1);

            function a(e, t) {
                return function(e) {
                    if (Array.isArray(e)) return e
                }(e) || function(e, t) {
                    var n = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (null == n) return;
                    var r, o, a = [],
                        i = !0,
                        s = !1;
                    try {
                        for (n = n.call(e); !(i = (r = n.next()).done) && (a.push(r.value), !t || a.length !== t); i = !0);
                    } catch (c) {
                        s = !0, o = c
                    } finally {
                        try {
                            i || null == n.return || n.return()
                        } finally {
                            if (s) throw o
                        }
                    }
                    return a
                }(e, t) || function(e, t) {
                    if (!e) return;
                    if ("string" === typeof e) return i(e, t);
                    var n = Object.prototype.toString.call(e).slice(8, -1);
                    "Object" === n && e.constructor && (n = e.constructor.name);
                    if ("Map" === n || "Set" === n) return Array.from(e);
                    if ("Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return i(e, t)
                }(e, t) || function() {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                }()
            }

            function i(e, t) {
                (null == t || t > e.length) && (t = e.length);
                for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];
                return r
            }

            function s(e, t) {
                if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
            }

            function c(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r)
                }
            }

            function l(e, t, n) {
                return t && c(e.prototype, t), n && c(e, n), e
            }
            var d = function() {
                function e(t, n) {
                    s(this, e), this.state = void 0, this.validateReducer = void 0, this.validateReducer = n, this.set(t)
                }
                return l(e, [{
                    key: "validate",
                    value: function(e) {
                        return "function" === typeof this.validateReducer ? this.validateReducer(e) : e
                    }
                }, {
                    key: "set",
                    value: function(e) {
                        this.state = this.validate(e)
                    }
                }, {
                    key: "update",
                    value: function(e) {
                        this.state = this.validate(e(this.state))
                    }
                }, {
                    key: "get",
                    value: function() {
                        return this.state
                    }
                }]), e
            }();

            function u(e, t) {
                var n = a(Object(o.useState)(e.get(t)), 2),
                    r = n[0],
                    i = n[1],
                    s = Object(o.useCallback)((function() {
                        i(e.get(t))
                    }), [i]);
                return Object(o.useEffect)((function() {
                    return e.bindKey(t, s),
                        function() {
                            e.unbindKey(t, s)
                        }
                }), [s]), [r, i]
            }
            var p = function() {
                    function e(t, n) {
                        s(this, e), this.getter = void 0, this.argumentsCounts = void 0, this.getter = t, this.argumentsCounts = n ? Array.isArray(n) ? n : [n] : []
                    }
                    return l(e, [{
                        key: "get",
                        value: function() {
                            if (this.argumentsCounts.length && !this.argumentsCounts.includes(arguments.length)) throw new Error("StoreFunction#get: This store function expects an arguments count in [".concat(this.argumentsCounts.join(", "), "], but received ").concat(arguments.length, " instead."));
                            return this.getter.apply(this, arguments)
                        }
                    }]), e
                }(),
                f = function() {
                    function e(t, n) {
                        s(this, e), this.name = void 0, this.dispatcher = void 0, this.storeBoxes = {}, this.storeFunctions = {}, this.name = t, this.dispatcher = n
                    }
                    return l(e, [{
                        key: "bindKey",
                        value: function(e, t) {
                            this.dispatcher.bind("".concat(this.name, ".updated"), t)
                        }
                    }, {
                        key: "unbindKey",
                        value: function(e, t) {
                            this.dispatcher.unbind("".concat(this.name, ".updated"), t)
                        }
                    }, {
                        key: "register",
                        value: function(e, t, n) {
                            if (this.storeBoxes[e] || this.storeFunctions[e]) throw new Error("".concat(this.name, ".register: A store has already been registered under the '").concat(e, "' key."));
                            this.storeBoxes[e] = new d(t, n)
                        }
                    }, {
                        key: "registerFunction",
                        value: function(e, t, n) {
                            if (this.storeBoxes[e] || this.storeFunctions[e]) throw new Error("".concat(this.name, ".register: A store has already been registered under the '").concat(e, "' key."));
                            this.storeFunctions[e] = new p(t, n)
                        }
                    }, {
                        key: "unregister",
                        value: function(e) {
                            if (!this.storeBoxes[e] && !this.storeFunctions[e]) throw new Error("".concat(this.name, ".unregister: No store has been registered yet under the '").concat(e, "' key."));
                            this.storeBoxes = Object(r.omit)(this.storeBoxes, [e]), this.storeFunctions = Object(r.omit)(this.storeFunctions, [e])
                        }
                    }, {
                        key: "set",
                        value: function(e, t) {
                            if (this.storeFunctions[e] instanceof p) throw new Error("".concat(this.name, ".set: This method cannot be called on a function store."));
                            if (!this.storeBoxes[e]) throw new Error("".concat(this.name, ".set: No store has been registered yet under the '").concat(e, "' key."));
                            var n = this.storeBoxes[e].get();
                            this.storeBoxes[e].set(t), this.dispatcher.emit("".concat(this.name, ".").concat(e, ".updated"), t, n)
                        }
                    }, {
                        key: "update",
                        value: function(e, t) {
                            if (this.storeFunctions[e] instanceof p) throw new Error("".concat(this.name, ".update: This method cannot be called on a function store."));
                            if (!this.storeBoxes[e]) throw new Error("".concat(this.name, ".update: No store has been registered yet under the '").concat(e, "' key."));
                            var n = this.storeBoxes[e].get();
                            this.storeBoxes[e].update(t), this.dispatcher.emit("".concat(this.name, ".").concat(e, ".updated"), this.storeBoxes[e].get(), n)
                        }
                    }, {
                        key: "get",
                        value: function(e) {
                            var t;
                            if (!this.storeBoxes[e] && !this.storeFunctions[e]) throw new Error("".concat(this.name, ".get: No store has been registered yet under the '").concat(e, "' key."));
                            for (var n = arguments.length, r = new Array(n > 1 ? n - 1 : 0), o = 1; o < n; o++) r[o - 1] = arguments[o];
                            if (this.storeBoxes[e] && r.length) throw new Error("".concat(this.name, ".get: No store has been registered yet under the '").concat(e, "' key."));
                            return this.storeBoxes[e] ? this.storeBoxes[e].get() : (t = this.storeFunctions[e]).get.apply(t, r)
                        }
                    }]), e
                }()
        },
        8: function(e, t, n) {
            "use strict";
            n.d(t, "a", (function() {
                return o
            }));
            var r = n(4),
                o = function(e, t, n, o, a, i) {
                    r.a.ajax({
                        type: e,
                        url: t,
                        dataType: "json",
                        contentType: "application/json",
                        beforeSend: function(e) {
                            e.setRequestHeader("X-CSRF-Token", Object(r.a)('meta[name="csrf-token"]').attr("content"))
                        },
                        data: "GET" === e ? n : JSON.stringify(n)
                    }).done(o).fail(a).always(i)
                }
        },
        9: function(e, t, n) {
            "use strict";
            t.a = {
                VIEW: 0,
                EDIT: 1,
                DELETE: 2,
                FILTER: 3,
                FREEZE: 4,
                EXPLORE: 5
            }
        },
        929: function(e, t) {}
    },
    [
        [1003, 2, 0, 5]
    ]
]);
//# sourceMappingURL=application-26e3a342810735b2d44e.chunk.js.map